{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/commit.ts"],"sourcesContent":["import { ResourceFiber, RenderResult } from \"./types\";\n\nexport function commitRender(renderResult: RenderResult): void {\n  const errors: unknown[] = [];\n\n  for (const task of renderResult.commitTasks) {\n    try {\n      task();\n    } catch (error) {\n      errors.push(error);\n    }\n  }\n\n  if (errors.length > 0) {\n    if (errors.length === 1) {\n      throw errors[0];\n    } else {\n      for (const error of errors) {\n        console.error(error);\n      }\n      throw new AggregateError(errors, \"Errors during commit\");\n    }\n  }\n}\n\nexport function cleanupAllEffects<R, P>(executionContext: ResourceFiber<R, P>) {\n  const errors: unknown[] = [];\n  for (const cell of executionContext.cells) {\n    if (cell?.type === \"effect\") {\n      cell.deps = null; // Reset deps so effect runs again on next mount\n\n      if (cell.cleanup) {\n        try {\n          cell.cleanup?.();\n        } catch (e) {\n          errors.push(e);\n        } finally {\n          cell.cleanup = undefined;\n        }\n      }\n    }\n  }\n  if (errors.length > 0) {\n    if (errors.length === 1) {\n      throw errors[0];\n    } else {\n      for (const error of errors) {\n        console.error(error);\n      }\n      throw new AggregateError(errors, \"Errors during cleanup\");\n    }\n  }\n}\n"],"names":[],"mappings":";;;;;;AAEO,SAAS,aAAa,YAA0B;IACrD,MAAM,SAAoB,EAAE;IAE5B,KAAK,MAAM,QAAQ,aAAa,WAAW,CAAE;QAC3C,IAAI;YACF;QACF,EAAE,OAAO,OAAO;YACd,OAAO,IAAI,CAAC;QACd;IACF;IAEA,IAAI,OAAO,MAAM,GAAG,GAAG;QACrB,IAAI,OAAO,MAAM,KAAK,GAAG;YACvB,MAAM,MAAM,CAAC,EAAE;QACjB,OAAO;YACL,KAAK,MAAM,SAAS,OAAQ;gBAC1B,QAAQ,KAAK,CAAC;YAChB;YACA,MAAM,IAAI,eAAe,QAAQ;QACnC;IACF;AACF;AAEO,SAAS,kBAAwB,gBAAqC;IAC3E,MAAM,SAAoB,EAAE;IAC5B,KAAK,MAAM,QAAQ,iBAAiB,KAAK,CAAE;QACzC,IAAI,MAAM,SAAS,UAAU;YAC3B,KAAK,IAAI,GAAG,MAAM,gDAAgD;YAElE,IAAI,KAAK,OAAO,EAAE;gBAChB,IAAI;oBACF,KAAK,OAAO;gBACd,EAAE,OAAO,GAAG;oBACV,OAAO,IAAI,CAAC;gBACd,SAAU;oBACR,KAAK,OAAO,GAAG;gBACjB;YACF;QACF;IACF;IACA,IAAI,OAAO,MAAM,GAAG,GAAG;QACrB,IAAI,OAAO,MAAM,KAAK,GAAG;YACvB,MAAM,MAAM,CAAC,EAAE;QACjB,OAAO;YACL,KAAK,MAAM,SAAS,OAAQ;gBAC1B,QAAQ,KAAK,CAAC;YAChB;YACA,MAAM,IAAI,eAAe,QAAQ;QACnC;IACF;AACF"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/env.ts"],"sourcesContent":["export const isDevelopment =\n  process.env[\"NODE_ENV\"] === \"development\" ||\n  process.env[\"NODE_ENV\"] === \"test\";\n"],"names":[],"mappings":";;;;AAAO,MAAM,gBACX,oDAA4B,iBAC5B,oDAA4B"}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/execution-context.ts"],"sourcesContent":["import { isDevelopment } from \"./env\";\nimport { ResourceFiber } from \"./types\";\n\nlet currentResourceFiber: ResourceFiber<any, any> | null = null;\n\nexport function withResourceFiber<R, P>(\n  fiber: ResourceFiber<R, P>,\n  fn: () => void,\n): void {\n  fiber.currentIndex = 0;\n\n  const previousContext = currentResourceFiber;\n  currentResourceFiber = fiber;\n  try {\n    fn();\n\n    fiber.isFirstRender = false;\n\n    // ensure hook count matches\n    if (fiber.cells.length !== fiber.currentIndex) {\n      throw new Error(\n        `Rendered ${fiber.currentIndex} hooks but expected ${fiber.cells.length}. ` +\n          \"Hooks must be called in the exact same order in every render.\",\n      );\n    }\n  } finally {\n    currentResourceFiber = previousContext;\n  }\n}\nexport function getCurrentResourceFiber(): ResourceFiber<unknown, unknown> {\n  if (!currentResourceFiber) {\n    throw new Error(\"No resource fiber available\");\n  }\n  return currentResourceFiber;\n}\n\nexport function getDevStrictMode(enable: boolean) {\n  if (!isDevelopment) return null;\n  if (currentResourceFiber?.devStrictMode)\n    return currentResourceFiber.isFirstRender ? \"child\" : \"root\";\n\n  return enable ? \"root\" : null;\n}\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGA,IAAI,uBAAuD;AAEpD,SAAS,kBACd,KAA0B,EAC1B,EAAc;IAEd,MAAM,YAAY,GAAG;IAErB,MAAM,kBAAkB;IACxB,uBAAuB;IACvB,IAAI;QACF;QAEA,MAAM,aAAa,GAAG;QAEtB,4BAA4B;QAC5B,IAAI,MAAM,KAAK,CAAC,MAAM,KAAK,MAAM,YAAY,EAAE;YAC7C,MAAM,IAAI,MACR,CAAC,SAAS,EAAE,MAAM,YAAY,CAAC,oBAAoB,EAAE,MAAM,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,GACzE;QAEN;IACF,SAAU;QACR,uBAAuB;IACzB;AACF;AACO,SAAS;IACd,IAAI,CAAC,sBAAsB;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;AAEO,SAAS,iBAAiB,MAAe;IAC9C,IAAI,CAAC,sJAAa,EAAE,OAAO;IAC3B,IAAI,sBAAsB,eACxB,OAAO,qBAAqB,aAAa,GAAG,UAAU;IAExD,OAAO,SAAS,SAAS;AAC3B"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/call-resource-fn.ts"],"sourcesContent":["import { Resource } from \"./types\";\n\n/**\n * Renders a resource with the given props.\n * @internal This is for internal use only.\n */\nexport function callResourceFn<R, P>(resource: Resource<R, P>, props: P): R {\n  const fn = (resource as unknown as { [fnSymbol]?: (props: P) => R })[\n    fnSymbol\n  ];\n  if (!fn) {\n    throw new Error(\"ResourceElement.type is not a valid Resource\");\n  }\n  return fn(props);\n}\n\n/**\n * Symbol used to store the ResourceFn in the Resource constructor.\n * @internal This is for internal use only.\n */\nexport const fnSymbol = Symbol(\"fnSymbol\");\n"],"names":[],"mappings":";;;;;;AAMO,SAAS,eAAqB,QAAwB,EAAE,KAAQ;IACrE,MAAM,KAAK,AAAC,QAAwD,CAClE,SACD;IACD,IAAI,CAAC,IAAI;QACP,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,GAAG;AACZ;AAMO,MAAM,WAAW,OAAO"}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/resource-fiber.ts"],"sourcesContent":["import { ResourceFiber, RenderResult, Resource } from \"./types\";\nimport { commitRender, cleanupAllEffects } from \"./commit\";\nimport { getDevStrictMode, withResourceFiber } from \"./execution-context\";\nimport { callResourceFn } from \"./call-resource-fn\";\nimport { isDevelopment } from \"./env\";\n\nexport function createResourceFiber<R, P>(\n  type: Resource<R, P>,\n  dispatchUpdate: (callback: () => boolean) => void,\n  strictMode: \"root\" | \"child\" | null = getDevStrictMode(false),\n): ResourceFiber<R, P> {\n  return {\n    type,\n    dispatchUpdate,\n    devStrictMode: strictMode,\n    cells: [],\n    currentIndex: 0,\n    renderContext: undefined,\n    isFirstRender: true,\n    isMounted: false,\n    isNeverMounted: true,\n  };\n}\n\nexport function unmountResourceFiber<R, P>(fiber: ResourceFiber<R, P>): void {\n  if (!fiber.isMounted)\n    throw new Error(\"Tried to unmount a fiber that is already unmounted\");\n\n  fiber.isMounted = false;\n  cleanupAllEffects(fiber);\n}\n\nexport function renderResourceFiber<R, P>(\n  fiber: ResourceFiber<R, P>,\n  props: P,\n): RenderResult {\n  const result = {\n    commitTasks: [],\n    props,\n    output: undefined as R | undefined,\n  };\n\n  withResourceFiber(fiber, () => {\n    fiber.renderContext = result;\n    try {\n      result.output = callResourceFn(fiber.type, props);\n    } finally {\n      fiber.renderContext = undefined;\n    }\n  });\n\n  return result;\n}\n\nexport function commitResourceFiber<R, P>(\n  fiber: ResourceFiber<R, P>,\n  result: RenderResult,\n): void {\n  fiber.isMounted = true;\n\n  if (isDevelopment && fiber.isNeverMounted && fiber.devStrictMode === \"root\") {\n    commitRender(result);\n    cleanupAllEffects(fiber);\n  }\n\n  fiber.isNeverMounted = false;\n  commitRender(result);\n}\n"],"names":[],"mappings":";;;;;;;;;;AACA;AACA;AACA;AACA;;;;;AAEO,SAAS,oBACd,IAAoB,EACpB,cAAiD,EACjD,aAAsC,IAAA,0KAAgB,EAAC,MAAM;IAE7D,OAAO;QACL;QACA;QACA,eAAe;QACf,OAAO,EAAE;QACT,cAAc;QACd,eAAe;QACf,eAAe;QACf,WAAW;QACX,gBAAgB;IAClB;AACF;AAEO,SAAS,qBAA2B,KAA0B;IACnE,IAAI,CAAC,MAAM,SAAS,EAClB,MAAM,IAAI,MAAM;IAElB,MAAM,SAAS,GAAG;IAClB,IAAA,6JAAiB,EAAC;AACpB;AAEO,SAAS,oBACd,KAA0B,EAC1B,KAAQ;IAER,MAAM,SAAS;QACb,aAAa,EAAE;QACf;QACA,QAAQ;IACV;IAEA,IAAA,2KAAiB,EAAC,OAAO;QACvB,MAAM,aAAa,GAAG;QACtB,IAAI;YACF,OAAO,MAAM,GAAG,IAAA,0KAAc,EAAC,MAAM,IAAI,EAAE;QAC7C,SAAU;YACR,MAAM,aAAa,GAAG;QACxB;IACF;IAEA,OAAO;AACT;AAEO,SAAS,oBACd,KAA0B,EAC1B,MAAoB;IAEpB,MAAM,SAAS,GAAG;IAElB,IAAI,sJAAa,IAAI,MAAM,cAAc,IAAI,MAAM,aAAa,KAAK,QAAQ;QAC3E,IAAA,wJAAY,EAAC;QACb,IAAA,6JAAiB,EAAC;IACpB;IAEA,MAAM,cAAc,GAAG;IACvB,IAAA,wJAAY,EAAC;AACf"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/react/use-resource.ts"],"sourcesContent":["import { useLayoutEffect, useMemo, useReducer, useRef, useState } from \"react\";\nimport type { ExtractResourceReturnType, ResourceElement } from \"../core/types\";\nimport {\n  createResourceFiber,\n  unmountResourceFiber,\n  renderResourceFiber,\n  commitResourceFiber,\n} from \"../core/resource-fiber\";\nimport { isDevelopment } from \"../core/env\";\n\nconst useDevStrictMode = () => {\n  if (!isDevelopment) return null;\n\n  const count = useRef(0);\n  const isFirstRender = count.current === 0;\n  useState(() => count.current++);\n  if (count.current !== 2) return null;\n  return isFirstRender ? (\"child\" as const) : (\"root\" as const);\n};\n\nconst resourceReducer = (version: number, callback: () => boolean) => {\n  return version + (callback() ? 1 : 0);\n};\n\nexport function useResource<E extends ResourceElement<any, any>>(\n  element: E,\n): ExtractResourceReturnType<E> {\n  const [, dispatch] = useReducer(resourceReducer, 0);\n\n  const devStrictMode = useDevStrictMode();\n\n  // biome-ignore lint/correctness/useExhaustiveDependencies: user provided deps instead of prop identity\n  const fiber = useMemo(() => {\n    return createResourceFiber(element.type, dispatch, devStrictMode);\n  }, [element.type, element.key]);\n\n  const result = renderResourceFiber(fiber, element.props);\n  useLayoutEffect(() => {\n    return () => unmountResourceFiber(fiber);\n  }, [fiber]);\n  useLayoutEffect(() => {\n    commitResourceFiber(fiber, result);\n  });\n\n  return result.output;\n}\n"],"names":[],"mappings":";;;;AAAA;AAEA;AAMA;;;;AAEA,MAAM,mBAAmB;IACvB,IAAI,CAAC,sJAAa,EAAE,OAAO;IAE3B,MAAM,QAAQ,IAAA,wZAAM,EAAC;IACrB,MAAM,gBAAgB,MAAM,OAAO,KAAK;IACxC,IAAA,0ZAAQ,EAAC,IAAM,MAAM,OAAO;IAC5B,IAAI,MAAM,OAAO,KAAK,GAAG,OAAO;IAChC,OAAO,gBAAiB,UAAqB;AAC/C;AAEA,MAAM,kBAAkB,CAAC,SAAiB;IACxC,OAAO,UAAU,CAAC,aAAa,IAAI,CAAC;AACtC;AAEO,SAAS,YACd,OAAU;IAEV,MAAM,GAAG,SAAS,GAAG,IAAA,4ZAAU,EAAC,iBAAiB;IAEjD,MAAM,gBAAgB;IAEtB,uGAAuG;IACvG,MAAM,QAAQ,IAAA,yZAAO,EAAC;QACpB,OAAO,IAAA,0KAAmB,EAAC,QAAQ,IAAI,EAAE,UAAU;IACrD,GAAG;QAAC,QAAQ,IAAI;QAAE,QAAQ,GAAG;KAAC;IAE9B,MAAM,SAAS,IAAA,0KAAmB,EAAC,OAAO,QAAQ,KAAK;IACvD,IAAA,iaAAe,EAAC;QACd,OAAO,IAAM,IAAA,2KAAoB,EAAC;IACpC,GAAG;QAAC;KAAM;IACV,IAAA,iaAAe,EAAC;QACd,IAAA,0KAAmB,EAAC,OAAO;IAC7B;IAEA,OAAO,OAAO,MAAM;AACtB"}},
    {"offset": {"line": 240, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/resource.ts"],"sourcesContent":["import { ResourceElement } from \"./types\";\nimport { fnSymbol } from \"./call-resource-fn\";\n\nexport function resource<R>(fn: () => R): () => ResourceElement<R, undefined>;\nexport function resource<R, P>(\n  fn: (props: P) => R,\n): (props: P) => ResourceElement<R, P>;\nexport function resource<R, P>(\n  fn: (props?: P) => R,\n): (props?: P) => ResourceElement<R, P | undefined>;\nexport function resource<R, P = undefined>(fn: (props: P) => R) {\n  const type = (props?: P) => {\n    return {\n      type,\n      props: props!,\n    } satisfies ResourceElement<R, P>;\n  };\n\n  type[fnSymbol] = fn;\n\n  return type;\n}\n"],"names":[],"mappings":";;;;AACA;;AASO,SAAS,SAA2B,EAAmB;IAC5D,MAAM,OAAO,CAAC;QACZ,OAAO;YACL;YACA,OAAO;QACT;IACF;IAEA,IAAI,CAAC,oKAAQ,CAAC,GAAG;IAEjB,OAAO;AACT"}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-state.ts"],"sourcesContent":["import { isDevelopment } from \"../core/env\";\nimport { getCurrentResourceFiber } from \"../core/execution-context\";\nimport { Cell, ResourceFiber } from \"../core/types\";\n\nexport namespace tapState {\n  export type StateUpdater<S> = S | ((prev: S) => S);\n}\n\nconst dispatchOnFiber = (\n  fiber: ResourceFiber<any, any>,\n  callback: () => boolean,\n) => {\n  if (fiber.renderContext) {\n    throw new Error(\"Resource updated during render\");\n  }\n\n  if (fiber.isMounted) {\n    // Only schedule rerender if currently mounted\n    fiber.dispatchUpdate(callback);\n  } else if (fiber.isNeverMounted) {\n    throw new Error(\"Resource updated before mount\");\n  }\n\n  // TODO mark dirty\n};\n\nfunction getStateCell<T>(\n  initialValue: T | (() => T),\n): Cell & { type: \"state\" } {\n  const fiber = getCurrentResourceFiber();\n  const index = fiber.currentIndex++;\n\n  // Check if we're trying to use more hooks than in previous renders\n  if (!fiber.isFirstRender && index >= fiber.cells.length) {\n    throw new Error(\n      \"Rendered more hooks than during the previous render. \" +\n        \"Hooks must be called in the exact same order in every render.\",\n    );\n  }\n\n  const cell = fiber.cells[index];\n  if (cell) {\n    if (cell.type !== \"state\")\n      throw new Error(\"Hook order changed between renders\");\n\n    return cell as Cell & { type: \"state\" };\n  }\n\n  const value =\n    typeof initialValue === \"function\"\n      ? (initialValue as () => T)()\n      : initialValue;\n\n  if (\n    isDevelopment &&\n    fiber.devStrictMode &&\n    typeof initialValue === \"function\"\n  ) {\n    void (initialValue as () => T)();\n  }\n\n  const newCell: Cell & { type: \"state\" } = {\n    type: \"state\",\n    value,\n    set: (updater: tapState.StateUpdater<T>) => {\n      dispatchOnFiber(fiber, () => {\n        const currentValue = newCell.value;\n        const nextValue =\n          typeof updater === \"function\"\n            ? (updater as (prev: T) => T)(currentValue)\n            : updater;\n\n        if (\n          isDevelopment &&\n          fiber.devStrictMode &&\n          typeof updater === \"function\"\n        ) {\n          void (updater as (prev: T) => T)(currentValue);\n        }\n\n        if (Object.is(currentValue, nextValue)) return false;\n\n        newCell.value = nextValue;\n        return true;\n      });\n    },\n  };\n\n  fiber.cells[index] = newCell;\n  return newCell;\n}\n\nexport function tapState<S = undefined>(): [\n  S | undefined,\n  (updater: tapState.StateUpdater<S>) => void,\n];\nexport function tapState<S>(\n  initial: S | (() => S),\n): [S, (updater: tapState.StateUpdater<S>) => void];\nexport function tapState<S>(\n  initial?: S | (() => S),\n): [S | undefined, (updater: tapState.StateUpdater<S>) => void] {\n  const cell = getStateCell(initial as S | (() => S));\n\n  return [cell.value, cell.set];\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAOA,MAAM,kBAAkB,CACtB,OACA;IAEA,IAAI,MAAM,aAAa,EAAE;QACvB,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,MAAM,SAAS,EAAE;QACnB,8CAA8C;QAC9C,MAAM,cAAc,CAAC;IACvB,OAAO,IAAI,MAAM,cAAc,EAAE;QAC/B,MAAM,IAAI,MAAM;IAClB;AAEA,kBAAkB;AACpB;AAEA,SAAS,aACP,YAA2B;IAE3B,MAAM,QAAQ,IAAA,iLAAuB;IACrC,MAAM,QAAQ,MAAM,YAAY;IAEhC,mEAAmE;IACnE,IAAI,CAAC,MAAM,aAAa,IAAI,SAAS,MAAM,KAAK,CAAC,MAAM,EAAE;QACvD,MAAM,IAAI,MACR,0DACE;IAEN;IAEA,MAAM,OAAO,MAAM,KAAK,CAAC,MAAM;IAC/B,IAAI,MAAM;QACR,IAAI,KAAK,IAAI,KAAK,SAChB,MAAM,IAAI,MAAM;QAElB,OAAO;IACT;IAEA,MAAM,QACJ,OAAO,iBAAiB,aACpB,AAAC,iBACD;IAEN,IACE,sJAAa,IACb,MAAM,aAAa,IACnB,OAAO,iBAAiB,YACxB;QACA,KAAK,AAAC;IACR;IAEA,MAAM,UAAoC;QACxC,MAAM;QACN;QACA,KAAK,CAAC;YACJ,gBAAgB,OAAO;gBACrB,MAAM,eAAe,QAAQ,KAAK;gBAClC,MAAM,YACJ,OAAO,YAAY,aACf,AAAC,QAA2B,gBAC5B;gBAEN,IACE,sJAAa,IACb,MAAM,aAAa,IACnB,OAAO,YAAY,YACnB;oBACA,KAAK,AAAC,QAA2B;gBACnC;gBAEA,IAAI,OAAO,EAAE,CAAC,cAAc,YAAY,OAAO;gBAE/C,QAAQ,KAAK,GAAG;gBAChB,OAAO;YACT;QACF;IACF;IAEA,MAAM,KAAK,CAAC,MAAM,GAAG;IACrB,OAAO;AACT;AASO,SAAS,SACd,OAAuB;IAEvB,MAAM,OAAO,aAAa;IAE1B,OAAO;QAAC,KAAK,KAAK;QAAE,KAAK,GAAG;KAAC;AAC/B"}},
    {"offset": {"line": 326, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-ref.ts"],"sourcesContent":["import { tapState } from \"./tap-state\";\n\nexport namespace tapRef {\n  export interface RefObject<T> {\n    current: T;\n  }\n}\n\nexport function tapRef<T>(initialValue: T): tapRef.RefObject<T>;\nexport function tapRef<T = undefined>(): tapRef.RefObject<T | undefined>;\nexport function tapRef<T>(initialValue?: T): tapRef.RefObject<T | undefined> {\n  const [state] = tapState(() => ({\n    current: initialValue,\n  }));\n  return state;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAUO,SAAS,OAAU,YAAgB;IACxC,MAAM,CAAC,MAAM,GAAG,IAAA,2JAAQ,EAAC,IAAM,CAAC;YAC9B,SAAS;QACX,CAAC;IACD,OAAO;AACT"}},
    {"offset": {"line": 342, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/utils/deps-shallow-equal.ts"],"sourcesContent":["export const depsShallowEqual = (\n  a: readonly unknown[],\n  b: readonly unknown[],\n) => {\n  if (a.length !== b.length) return false;\n  for (let i = 0; i < a.length; i++) {\n    if (!Object.is(a[i], b[i])) return false;\n  }\n  return true;\n};\n"],"names":[],"mappings":";;;;AAAO,MAAM,mBAAmB,CAC9B,GACA;IAEA,IAAI,EAAE,MAAM,KAAK,EAAE,MAAM,EAAE,OAAO;IAClC,IAAK,IAAI,IAAI,GAAG,IAAI,EAAE,MAAM,EAAE,IAAK;QACjC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,EAAE,GAAG,OAAO;IACrC;IACA,OAAO;AACT"}},
    {"offset": {"line": 357, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-memo.ts"],"sourcesContent":["import { isDevelopment } from \"../core/env\";\nimport { getCurrentResourceFiber } from \"../core/execution-context\";\nimport { tapRef } from \"./tap-ref\";\nimport { depsShallowEqual } from \"./utils/deps-shallow-equal\";\n\nexport const tapMemo = <T>(fn: () => T, deps: readonly unknown[]) => {\n  const dataRef = tapRef<{ value: T; deps: readonly unknown[] }>();\n  if (!dataRef.current) {\n    if (isDevelopment) {\n      const fiber = getCurrentResourceFiber();\n      if (fiber.devStrictMode) {\n        void fn();\n      }\n    }\n\n    dataRef.current = { value: fn(), deps };\n  }\n\n  if (!depsShallowEqual(dataRef.current.deps, deps)) {\n    dataRef.current.value = fn();\n    dataRef.current.deps = deps;\n  }\n\n  return dataRef.current.value;\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,MAAM,UAAU,CAAI,IAAa;IACtC,MAAM,UAAU,IAAA,uJAAM;IACtB,IAAI,CAAC,QAAQ,OAAO,EAAE;QACpB,IAAI,sJAAa,EAAE;YACjB,MAAM,QAAQ,IAAA,iLAAuB;YACrC,IAAI,MAAM,aAAa,EAAE;gBACvB,KAAK;YACP;QACF;QAEA,QAAQ,OAAO,GAAG;YAAE,OAAO;YAAM;QAAK;IACxC;IAEA,IAAI,CAAC,IAAA,wLAAgB,EAAC,QAAQ,OAAO,CAAC,IAAI,EAAE,OAAO;QACjD,QAAQ,OAAO,CAAC,KAAK,GAAG;QACxB,QAAQ,OAAO,CAAC,IAAI,GAAG;IACzB;IAEA,OAAO,QAAQ,OAAO,CAAC,KAAK;AAC9B"}},
    {"offset": {"line": 393, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/utils/tap-hook.ts"],"sourcesContent":["import { getCurrentResourceFiber } from \"../../core/execution-context\";\nimport { Cell } from \"../../core/types\";\n\nexport const tapHook = <T extends \"effect\" | \"memo\">(\n  type: T,\n  init: () => Cell,\n): Cell & { type: T } => {\n  const fiber = getCurrentResourceFiber();\n  const index = fiber.currentIndex++;\n\n  if (!fiber.isFirstRender && index >= fiber.cells.length) {\n    // Check if we're trying to use more hooks than in previous renders\n    throw new Error(\n      \"Rendered more hooks than during the previous render. \" +\n        \"Hooks must be called in the exact same order in every render.\",\n    );\n  }\n\n  let cell = fiber.cells[index];\n  if (!cell) {\n    cell = init();\n    fiber.cells[index] = cell;\n  }\n\n  if (cell.type !== type) {\n    throw new Error(\"Hook order changed between renders\");\n  }\n\n  return cell as Cell & { type: T };\n};\n\nexport const registerRenderMountTask = (task: () => void) => {\n  const fiber = getCurrentResourceFiber();\n  fiber.renderContext!.commitTasks.push(task);\n};\n"],"names":[],"mappings":";;;;;;AAAA;;AAGO,MAAM,UAAU,CACrB,MACA;IAEA,MAAM,QAAQ,IAAA,iLAAuB;IACrC,MAAM,QAAQ,MAAM,YAAY;IAEhC,IAAI,CAAC,MAAM,aAAa,IAAI,SAAS,MAAM,KAAK,CAAC,MAAM,EAAE;QACvD,mEAAmE;QACnE,MAAM,IAAI,MACR,0DACE;IAEN;IAEA,IAAI,OAAO,MAAM,KAAK,CAAC,MAAM;IAC7B,IAAI,CAAC,MAAM;QACT,OAAO;QACP,MAAM,KAAK,CAAC,MAAM,GAAG;IACvB;IAEA,IAAI,KAAK,IAAI,KAAK,MAAM;QACtB,MAAM,IAAI,MAAM;IAClB;IAEA,OAAO;AACT;AAEO,MAAM,0BAA0B,CAAC;IACtC,MAAM,QAAQ,IAAA,iLAAuB;IACrC,MAAM,aAAa,CAAE,WAAW,CAAC,IAAI,CAAC;AACxC"}},
    {"offset": {"line": 426, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-effect.ts"],"sourcesContent":["import { Cell } from \"../core/types\";\nimport { depsShallowEqual } from \"./utils/deps-shallow-equal\";\nimport { tapHook, registerRenderMountTask } from \"./utils/tap-hook\";\n\nconst newEffect = (): Cell & { type: \"effect\" } => ({\n  type: \"effect\",\n  cleanup: undefined,\n  deps: null, // null means the effect has never been run\n});\n\nexport namespace tapEffect {\n  export type Destructor = () => void;\n  export type EffectCallback = () => void | Destructor;\n}\n\nexport function tapEffect(effect: tapEffect.EffectCallback): void;\nexport function tapEffect(\n  effect: tapEffect.EffectCallback,\n  deps: readonly unknown[],\n): void;\nexport function tapEffect(\n  effect: tapEffect.EffectCallback,\n  deps?: readonly unknown[],\n): void {\n  const cell = tapHook(\"effect\", newEffect);\n\n  if (deps && cell.deps && depsShallowEqual(cell.deps, deps)) return;\n  if (cell.deps !== null && !!deps !== !!cell.deps)\n    throw new Error(\n      \"tapEffect called with and without dependencies across re-renders\",\n    );\n\n  registerRenderMountTask(() => {\n    const errors: unknown[] = [];\n\n    try {\n      cell.cleanup?.();\n    } catch (error) {\n      errors.push(error);\n    } finally {\n      cell.cleanup = undefined;\n    }\n\n    try {\n      const cleanup = effect();\n\n      if (cleanup !== undefined && typeof cleanup !== \"function\") {\n        throw new Error(\n          \"An effect function must either return a cleanup function or nothing. \" +\n            `Received: ${typeof cleanup}`,\n        );\n      }\n\n      cell.cleanup = cleanup;\n    } catch (error) {\n      errors.push(error);\n    }\n\n    cell.deps = deps;\n\n    if (errors.length > 0) {\n      if (errors.length === 1) {\n        throw errors[0];\n      } else {\n        for (const error of errors) {\n          console.error(error);\n        }\n        throw new AggregateError(errors, \"Errors during commit\");\n      }\n    }\n  });\n}\n"],"names":[],"mappings":";;;;AACA;AACA;;;AAEA,MAAM,YAAY,IAAiC,CAAC;QAClD,MAAM;QACN,SAAS;QACT,MAAM;IACR,CAAC;AAYM,SAAS,UACd,MAAgC,EAChC,IAAyB;IAEzB,MAAM,OAAO,IAAA,kKAAO,EAAC,UAAU;IAE/B,IAAI,QAAQ,KAAK,IAAI,IAAI,IAAA,wLAAgB,EAAC,KAAK,IAAI,EAAE,OAAO;IAC5D,IAAI,KAAK,IAAI,KAAK,QAAQ,CAAC,CAAC,SAAS,CAAC,CAAC,KAAK,IAAI,EAC9C,MAAM,IAAI,MACR;IAGJ,IAAA,kLAAuB,EAAC;QACtB,MAAM,SAAoB,EAAE;QAE5B,IAAI;YACF,KAAK,OAAO;QACd,EAAE,OAAO,OAAO;YACd,OAAO,IAAI,CAAC;QACd,SAAU;YACR,KAAK,OAAO,GAAG;QACjB;QAEA,IAAI;YACF,MAAM,UAAU;YAEhB,IAAI,YAAY,aAAa,OAAO,YAAY,YAAY;gBAC1D,MAAM,IAAI,MACR,0EACE,CAAC,UAAU,EAAE,OAAO,SAAS;YAEnC;YAEA,KAAK,OAAO,GAAG;QACjB,EAAE,OAAO,OAAO;YACd,OAAO,IAAI,CAAC;QACd;QAEA,KAAK,IAAI,GAAG;QAEZ,IAAI,OAAO,MAAM,GAAG,GAAG;YACrB,IAAI,OAAO,MAAM,KAAK,GAAG;gBACvB,MAAM,MAAM,CAAC,EAAE;YACjB,OAAO;gBACL,KAAK,MAAM,SAAS,OAAQ;oBAC1B,QAAQ,KAAK,CAAC;gBAChB;gBACA,MAAM,IAAI,eAAe,QAAQ;YACnC;QACF;IACF;AACF"}},
    {"offset": {"line": 478, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-callback.ts"],"sourcesContent":["import { tapMemo } from \"./tap-memo\";\n\nexport const tapCallback = <T extends (...args: any[]) => any>(\n  fn: T,\n  deps: readonly unknown[],\n): T => {\n  // biome-ignore lint/correctness/useExhaustiveDependencies: user provided deps instead of callback identity\n  return tapMemo(() => fn, deps);\n};\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,cAAc,CACzB,IACA;IAEA,2GAA2G;IAC3G,OAAO,IAAA,yJAAO,EAAC,IAAM,IAAI;AAC3B"}},
    {"offset": {"line": 492, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-const.ts"],"sourcesContent":["import { tapState } from \"./tap-state\";\n\nexport function tapConst<T>(getValue: () => T, _deps: readonly never[]): T {\n  const [state] = tapState(getValue);\n  return state;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,SAAS,SAAY,QAAiB,EAAE,KAAuB;IACpE,MAAM,CAAC,MAAM,GAAG,IAAA,2JAAQ,EAAC;IACzB,OAAO;AACT"}},
    {"offset": {"line": 506, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-resources.ts"],"sourcesContent":["import {\n  ExtractResourceReturnType,\n  RenderResult,\n  ResourceElement,\n  ResourceFiber,\n} from \"../core/types\";\nimport { tapEffect } from \"./tap-effect\";\nimport { tapMemo } from \"./tap-memo\";\nimport { tapState } from \"./tap-state\";\nimport { tapCallback } from \"./tap-callback\";\nimport {\n  createResourceFiber,\n  unmountResourceFiber,\n  renderResourceFiber,\n  commitResourceFiber,\n} from \"../core/resource-fiber\";\nimport { tapConst } from \"./tap-const\";\n\ntype FiberState = {\n  fiber: ResourceFiber<unknown, unknown>;\n  next:\n    | RenderResult\n    | [ResourceFiber<unknown, unknown>, RenderResult]\n    | \"delete\";\n};\n\nexport function tapResources<E extends ResourceElement<any, any>>(\n  getElements: () => readonly E[],\n  getElementsDeps?: readonly unknown[],\n): ExtractResourceReturnType<E>[] {\n  const [version, setVersion] = tapState(0);\n  const rerender = tapConst(() => () => setVersion((v) => v + 1), []);\n\n  const fibers = tapConst(() => new Map<string | number, FiberState>(), []);\n\n  const getElementsMemo = getElementsDeps\n    ? // biome-ignore lint/correctness/useExhaustiveDependencies: library code\n      tapCallback(getElements, getElementsDeps)\n    : getElements;\n\n  // Process each element\n\n  const res = tapMemo(() => {\n    void version;\n\n    const elementsArray = getElementsMemo();\n    const seenKeys = new Set<string | number>();\n    const results: any[] = [];\n    let newCount = 0;\n\n    // Create/update fibers and render\n    for (let i = 0; i < elementsArray.length; i++) {\n      const element = elementsArray[i]!;\n\n      const elementKey = element.key;\n      if (elementKey === undefined) {\n        throw new Error(\n          `tapResources did not provide a key for array at index ${i}`,\n        );\n      }\n\n      if (seenKeys.has(elementKey))\n        throw new Error(`Duplicate key ${elementKey} in tapResources`);\n      seenKeys.add(elementKey);\n\n      let state = fibers.get(elementKey);\n      if (!state) {\n        const fiber = createResourceFiber(element.type, (callback) => {\n          if (callback()) rerender();\n        });\n        const result = renderResourceFiber(fiber, element.props);\n        state = {\n          fiber,\n          next: result,\n        };\n        newCount++;\n        fibers.set(elementKey, state);\n        results.push(result.output);\n      } else if (state.fiber.type !== element.type) {\n        const fiber = createResourceFiber(element.type, (callback) => {\n          if (callback()) rerender();\n        });\n        const result = renderResourceFiber(fiber, element.props);\n        state.next = [fiber, result];\n        results.push(result.output);\n      } else {\n        state.next = renderResourceFiber(state.fiber, element.props);\n        results.push(state.next.output);\n      }\n    }\n\n    // Clean up removed fibers (only if there might be stale ones)\n    if (fibers.size > results.length - newCount) {\n      for (const key of fibers.keys()) {\n        if (!seenKeys.has(key)) {\n          fibers.get(key)!.next = \"delete\";\n        }\n      }\n    }\n\n    return results;\n  }, [getElementsMemo, version]);\n\n  // Cleanup on unmount\n  tapEffect(() => {\n    return () => {\n      for (const key of fibers.keys()) {\n        const fiber = fibers.get(key)!.fiber;\n        unmountResourceFiber(fiber);\n      }\n    };\n  }, []);\n\n  tapEffect(() => {\n    res; // as a performance optimization, we only run if the results have changed\n\n    for (const [key, state] of fibers.entries()) {\n      if (state.next === \"delete\") {\n        if (state.fiber.isMounted) {\n          unmountResourceFiber(state.fiber);\n        }\n\n        fibers.delete(key);\n      } else if (Array.isArray(state.next)) {\n        unmountResourceFiber(state.fiber);\n        state.fiber = state.next[0];\n        commitResourceFiber(state.fiber, state.next[1]);\n      } else {\n        commitResourceFiber(state.fiber, state.next);\n      }\n    }\n  }, [res]);\n\n  return res;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 618, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-effect-event.ts"],"sourcesContent":["import { tapRef } from \"./tap-ref\";\nimport { tapEffect } from \"./tap-effect\";\nimport { isDevelopment } from \"../core/env\";\nimport { tapCallback } from \"./tap-callback\";\nimport { getCurrentResourceFiber } from \"../core/execution-context\";\n\n/**\n * Creates a stable function reference that always calls the most recent version of the callback.\n * Similar to React's useEffectEvent hook.\n *\n * @param callback - The callback function to wrap\n * @returns A stable function reference that always calls the latest callback\n *\n * @example\n * ```typescript\n * const handleClick = tapEffectEvent((value: string) => {\n *   console.log(value);\n * });\n * // handleClick reference is stable, but always calls the latest version\n * ```\n */\nexport function tapEffectEvent<T extends (...args: any[]) => any>(\n  callback: T,\n): T {\n  const callbackRef = tapRef(callback);\n\n  tapEffect(() => {\n    callbackRef.current = callback;\n  });\n\n  if (isDevelopment) {\n    const fiber = getCurrentResourceFiber();\n    return tapCallback(\n      ((...args: Parameters<T>) => {\n        if (fiber.renderContext)\n          throw new Error(\"tapEffectEvent cannot be called during render\");\n        return callbackRef.current(...args);\n      }) as T,\n      [fiber],\n    );\n  }\n\n  return callbackRef.current;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAiBO,SAAS,eACd,QAAW;IAEX,MAAM,cAAc,IAAA,uJAAM,EAAC;IAE3B,IAAA,6JAAS,EAAC;QACR,YAAY,OAAO,GAAG;IACxB;IAEA,IAAI,sJAAa,EAAE;QACjB,MAAM,QAAQ,IAAA,iLAAuB;QACrC,OAAO,IAAA,iKAAW,EACf,CAAC,GAAG;YACH,IAAI,MAAM,aAAa,EACrB,MAAM,IAAI,MAAM;YAClB,OAAO,YAAY,OAAO,IAAI;QAChC,GACA;YAAC;SAAM;IAEX;IAEA,OAAO,YAAY,OAAO;AAC5B"}},
    {"offset": {"line": 652, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-inline-resource.ts"],"sourcesContent":["import { ExtractResourceReturnType, ResourceElement } from \"../core/types\";\nimport { callResourceFn } from \"../core/call-resource-fn\";\n\nexport function tapInlineResource<E extends ResourceElement<any, any>>(\n  element: E,\n): ExtractResourceReturnType<E> {\n  return callResourceFn(element.type, element.props);\n}\n"],"names":[],"mappings":";;;;AACA;;AAEO,SAAS,kBACd,OAAU;IAEV,OAAO,IAAA,0KAAc,EAAC,QAAQ,IAAI,EAAE,QAAQ,KAAK;AACnD"}},
    {"offset": {"line": 665, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/hooks/tap-resource.ts"],"sourcesContent":["import { ExtractResourceReturnType, ResourceElement } from \"../core/types\";\nimport { tapEffect } from \"./tap-effect\";\nimport {\n  createResourceFiber,\n  unmountResourceFiber,\n  renderResourceFiber,\n  commitResourceFiber,\n} from \"../core/resource-fiber\";\nimport { tapMemo } from \"./tap-memo\";\nimport { tapState } from \"./tap-state\";\nimport { tapConst } from \"./tap-const\";\n\nexport function tapResource<E extends ResourceElement<any, any>>(\n  element: E,\n): ExtractResourceReturnType<E>;\nexport function tapResource<E extends ResourceElement<any, any>>(\n  element: E,\n  propsDeps: readonly unknown[],\n): ExtractResourceReturnType<E>;\nexport function tapResource<E extends ResourceElement<any, any>>(\n  element: E,\n  propsDeps?: readonly unknown[],\n): ExtractResourceReturnType<E> {\n  const [version, setVersion] = tapState(0);\n  const rerender = tapConst(() => () => setVersion((v) => v + 1), []);\n\n  const fiber = tapMemo(() => {\n    void element.key;\n    return createResourceFiber(element.type, (callback) => {\n      if (callback()) rerender();\n    });\n  }, [element.type, element.key]);\n\n  const result = propsDeps\n    ? // biome-ignore lint/correctness/useExhaustiveDependencies: user provided deps instead of prop identity\n      tapMemo(\n        () => renderResourceFiber(fiber, element.props),\n        [fiber, ...propsDeps, version],\n      )\n    : renderResourceFiber(fiber, element.props);\n\n  tapEffect(() => () => unmountResourceFiber(fiber), [fiber]);\n  tapEffect(() => {\n    commitResourceFiber(fiber, result);\n  }, [fiber, result]);\n\n  return result.output;\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AAMA;AACA;AACA;;;;;;AASO,SAAS,YACd,OAAU,EACV,SAA8B;IAE9B,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,2JAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,2JAAQ,EAAC,IAAM,IAAM,WAAW,CAAC,IAAM,IAAI,IAAI,EAAE;IAElE,MAAM,QAAQ,IAAA,yJAAO,EAAC;QACpB,KAAK,QAAQ,GAAG;QAChB,OAAO,IAAA,0KAAmB,EAAC,QAAQ,IAAI,EAAE,CAAC;YACxC,IAAI,YAAY;QAClB;IACF,GAAG;QAAC,QAAQ,IAAI;QAAE,QAAQ,GAAG;KAAC;IAE9B,MAAM,SAAS,YAEX,IAAA,yJAAO,EACL,IAAM,IAAA,0KAAmB,EAAC,OAAO,QAAQ,KAAK,GAC9C;QAAC;WAAU;QAAW;KAAQ,IAEhC,IAAA,0KAAmB,EAAC,OAAO,QAAQ,KAAK;IAE5C,IAAA,6JAAS,EAAC,IAAM,IAAM,IAAA,2KAAoB,EAAC,QAAQ;QAAC;KAAM;IAC1D,IAAA,6JAAS,EAAC;QACR,IAAA,0KAAmB,EAAC,OAAO;IAC7B,GAAG;QAAC;QAAO;KAAO;IAElB,OAAO,OAAO,MAAM;AACtB"}},
    {"offset": {"line": 711, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/with-key.ts"],"sourcesContent":["import { ResourceElement } from \"./types\";\n\nexport function withKey<E extends ResourceElement<any, any>>(\n  key: string | number,\n  element: E,\n): E {\n  return { ...element, key };\n}\n"],"names":[],"mappings":";;;;AAEO,SAAS,QACd,GAAoB,EACpB,OAAU;IAEV,OAAO;QAAE,GAAG,OAAO;QAAE;IAAI;AAC3B"}},
    {"offset": {"line": 725, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/scheduler.ts"],"sourcesContent":["type Task = () => void;\n\ntype GlobalFlushState = {\n  schedulers: Set<UpdateScheduler>;\n  isScheduled: boolean;\n};\n\nconst MAX_FLUSH_LIMIT = 50;\nlet flushState: GlobalFlushState = {\n  schedulers: new Set([]),\n  isScheduled: false,\n};\n\nexport class UpdateScheduler {\n  private _isDirty = false;\n\n  constructor(private readonly _task: Task) {}\n\n  get isDirty() {\n    return this._isDirty;\n  }\n\n  markDirty() {\n    this._isDirty = true;\n\n    flushState.schedulers.add(this);\n    scheduleFlush();\n  }\n\n  runTask() {\n    this._isDirty = false;\n    this._task();\n  }\n}\n\nconst scheduleFlush = () => {\n  if (flushState.isScheduled) return;\n  flushState.isScheduled = true;\n  queueMicrotask(flushScheduled);\n};\n\nconst flushScheduled = () => {\n  try {\n    const errors = [];\n    let flushDepth = 0;\n\n    for (const scheduler of flushState.schedulers) {\n      flushState.schedulers.delete(scheduler);\n      if (!scheduler.isDirty) continue;\n\n      flushDepth++;\n\n      if (flushDepth > MAX_FLUSH_LIMIT) {\n        throw new Error(\n          `Maximum update depth exceeded. This can happen when a resource ` +\n            `repeatedly calls setState inside tapEffect.`,\n        );\n      }\n\n      try {\n        scheduler.runTask();\n      } catch (error) {\n        errors.push(error);\n      }\n    }\n\n    if (errors.length > 0) {\n      if (errors.length === 1) {\n        throw errors[0];\n      } else {\n        for (const error of errors) {\n          console.error(error);\n        }\n        throw new AggregateError(errors, \"Errors occurred during flushSync\");\n      }\n    }\n  } finally {\n    flushState.schedulers.clear();\n    flushState.isScheduled = false;\n  }\n};\n\nexport const flushResourcesSync = <T>(callback: () => T): T => {\n  const prev = flushState;\n  flushState = {\n    schedulers: new Set([]),\n    isScheduled: true,\n  };\n\n  try {\n    const result = callback();\n    flushScheduled();\n\n    return result;\n  } finally {\n    flushState = prev;\n  }\n};\n"],"names":[],"mappings":";;;;;;AAOA,MAAM,kBAAkB;AACxB,IAAI,aAA+B;IACjC,YAAY,IAAI,IAAI,EAAE;IACtB,aAAa;AACf;AAEO,MAAM;;IACH,SAAiB;IAEzB,YAAY,AAAiB,KAAW,CAAE;aAAb,QAAA;aAFrB,WAAW;IAEwB;IAE3C,IAAI,UAAU;QACZ,OAAO,IAAI,CAAC,QAAQ;IACtB;IAEA,YAAY;QACV,IAAI,CAAC,QAAQ,GAAG;QAEhB,WAAW,UAAU,CAAC,GAAG,CAAC,IAAI;QAC9B;IACF;IAEA,UAAU;QACR,IAAI,CAAC,QAAQ,GAAG;QAChB,IAAI,CAAC,KAAK;IACZ;AACF;AAEA,MAAM,gBAAgB;IACpB,IAAI,WAAW,WAAW,EAAE;IAC5B,WAAW,WAAW,GAAG;IACzB,eAAe;AACjB;AAEA,MAAM,iBAAiB;IACrB,IAAI;QACF,MAAM,SAAS,EAAE;QACjB,IAAI,aAAa;QAEjB,KAAK,MAAM,aAAa,WAAW,UAAU,CAAE;YAC7C,WAAW,UAAU,CAAC,MAAM,CAAC;YAC7B,IAAI,CAAC,UAAU,OAAO,EAAE;YAExB;YAEA,IAAI,aAAa,iBAAiB;gBAChC,MAAM,IAAI,MACR,CAAC,+DAA+D,CAAC,GAC/D,CAAC,2CAA2C,CAAC;YAEnD;YAEA,IAAI;gBACF,UAAU,OAAO;YACnB,EAAE,OAAO,OAAO;gBACd,OAAO,IAAI,CAAC;YACd;QACF;QAEA,IAAI,OAAO,MAAM,GAAG,GAAG;YACrB,IAAI,OAAO,MAAM,KAAK,GAAG;gBACvB,MAAM,MAAM,CAAC,EAAE;YACjB,OAAO;gBACL,KAAK,MAAM,SAAS,OAAQ;oBAC1B,QAAQ,KAAK,CAAC;gBAChB;gBACA,MAAM,IAAI,eAAe,QAAQ;YACnC;QACF;IACF,SAAU;QACR,WAAW,UAAU,CAAC,KAAK;QAC3B,WAAW,WAAW,GAAG;IAC3B;AACF;AAEO,MAAM,qBAAqB,CAAI;IACpC,MAAM,OAAO;IACb,aAAa;QACX,YAAY,IAAI,IAAI,EAAE;QACtB,aAAa;IACf;IAEA,IAAI;QACF,MAAM,SAAS;QACf;QAEA,OAAO;IACT,SAAU;QACR,aAAa;IACf;AACF"}},
    {"offset": {"line": 811, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/create-resource.ts"],"sourcesContent":["import { RenderResult, ResourceElement } from \"./types\";\nimport {\n  createResourceFiber,\n  unmountResourceFiber,\n  renderResourceFiber,\n  commitResourceFiber,\n} from \"./resource-fiber\";\nimport { flushResourcesSync, UpdateScheduler } from \"./scheduler\";\nimport { tapRef } from \"../hooks/tap-ref\";\nimport { tapState } from \"../hooks/tap-state\";\nimport { tapMemo } from \"../hooks/tap-memo\";\nimport { tapEffect } from \"../hooks/tap-effect\";\nimport { resource } from \"./resource\";\nimport { tapResource } from \"../hooks/tap-resource\";\nimport { tapConst } from \"../hooks/tap-const\";\nimport { getDevStrictMode } from \"./execution-context\";\nimport { isDevelopment } from \"./env\";\n\nexport namespace createResource {\n  export type Unsubscribe = () => void;\n\n  export interface Handle<R, P> {\n    getValue(): R;\n    subscribe(callback: () => void): Unsubscribe;\n    render(element: ResourceElement<R, P>): void;\n    unmount(): void;\n  }\n}\n\nconst HandleWrapperResource = resource(\n  <R, P>(state: {\n    elementRef: {\n      current: ResourceElement<R, P>;\n    };\n    onRender: (changed: boolean) => boolean;\n    onUnmount: () => void;\n  }): createResource.Handle<R, P> => {\n    const [, setElement] = tapState(state.elementRef.current);\n    const output = tapResource(state.elementRef.current);\n\n    const subscribers = tapConst(() => new Set<() => void>(), []);\n    const valueRef = tapRef(output);\n\n    tapEffect(() => {\n      if (output !== valueRef.current) {\n        valueRef.current = output;\n        subscribers.forEach((callback) => callback());\n      }\n    });\n\n    const handle = tapMemo(\n      () => ({\n        getValue: () => valueRef.current,\n        subscribe: (callback: () => void) => {\n          subscribers.add(callback);\n          return () => subscribers.delete(callback);\n        },\n\n        render: (el: ResourceElement<R, P>) => {\n          const changed = state.elementRef.current !== el;\n          state.elementRef.current = el;\n\n          if (state.onRender(changed)) {\n            setElement(el);\n          }\n        },\n        unmount: state.onUnmount,\n      }),\n      [state],\n    );\n\n    return handle;\n  },\n);\n\nexport const createResource = <R, P>(\n  element: ResourceElement<R, P>,\n  {\n    mount = true,\n    devStrictMode = false,\n  }: { mount?: boolean; devStrictMode?: boolean } = {},\n): createResource.Handle<R, P> => {\n  let isMounted = mount;\n  let render: RenderResult;\n  const props = {\n    elementRef: { current: element },\n    onRender: (changed: boolean) => {\n      if (isMounted) return changed;\n      isMounted = true;\n\n      if (\n        isDevelopment &&\n        fiber.isNeverMounted &&\n        fiber.devStrictMode === \"child\"\n      ) {\n        if (changed) {\n          render = renderResourceFiber(fiber, props);\n        }\n        commitResourceFiber(fiber, render);\n      } else {\n        flushResourcesSync(() => {\n          if (changed) {\n            // In strict mode, render twice to detect side effects\n            if (isDevelopment && fiber.devStrictMode === \"root\") {\n              void renderResourceFiber(fiber, props);\n            }\n\n            render = renderResourceFiber(fiber, props);\n          }\n\n          if (scheduler.isDirty) return;\n          commitResourceFiber(fiber, render!);\n        });\n      }\n\n      return false;\n    },\n    onUnmount: () => {\n      if (!isMounted) throw new Error(\"Resource not mounted\");\n      isMounted = false;\n\n      unmountResourceFiber(fiber);\n    },\n  };\n\n  const scheduler = new UpdateScheduler(() => {\n    // In strict mode, render twice to detect side effects\n    if (\n      isDevelopment &&\n      (fiber.devStrictMode === \"root\" ||\n        (fiber.devStrictMode && !fiber.isFirstRender))\n    ) {\n      void renderResourceFiber(fiber, props);\n    }\n\n    render = renderResourceFiber(fiber, props);\n\n    if (scheduler.isDirty || !isMounted) return;\n    commitResourceFiber(fiber, render);\n  });\n\n  const fiber = createResourceFiber(\n    HandleWrapperResource<R, P>,\n    (callback) => {\n      if (callback()) scheduler.markDirty();\n    },\n    getDevStrictMode(devStrictMode),\n  );\n\n  flushResourcesSync(() => {\n    scheduler.markDirty();\n  });\n\n  return render!.output;\n};\n"],"names":[],"mappings":";;;;AACA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AAaA,MAAM,wBAAwB,IAAA,sJAAQ,EACpC,CAAO;IAOL,MAAM,GAAG,WAAW,GAAG,IAAA,2JAAQ,EAAC,MAAM,UAAU,CAAC,OAAO;IACxD,MAAM,SAAS,IAAA,iKAAW,EAAC,MAAM,UAAU,CAAC,OAAO;IAEnD,MAAM,cAAc,IAAA,2JAAQ,EAAC,IAAM,IAAI,OAAmB,EAAE;IAC5D,MAAM,WAAW,IAAA,uJAAM,EAAC;IAExB,IAAA,6JAAS,EAAC;QACR,IAAI,WAAW,SAAS,OAAO,EAAE;YAC/B,SAAS,OAAO,GAAG;YACnB,YAAY,OAAO,CAAC,CAAC,WAAa;QACpC;IACF;IAEA,MAAM,SAAS,IAAA,yJAAO,EACpB,IAAM,CAAC;YACL,UAAU,IAAM,SAAS,OAAO;YAChC,WAAW,CAAC;gBACV,YAAY,GAAG,CAAC;gBAChB,OAAO,IAAM,YAAY,MAAM,CAAC;YAClC;YAEA,QAAQ,CAAC;gBACP,MAAM,UAAU,MAAM,UAAU,CAAC,OAAO,KAAK;gBAC7C,MAAM,UAAU,CAAC,OAAO,GAAG;gBAE3B,IAAI,MAAM,QAAQ,CAAC,UAAU;oBAC3B,WAAW;gBACb;YACF;YACA,SAAS,MAAM,SAAS;QAC1B,CAAC,GACD;QAAC;KAAM;IAGT,OAAO;AACT;AAGK,MAAM,iBAAiB,CAC5B,SACA,EACE,QAAQ,IAAI,EACZ,gBAAgB,KAAK,EACwB,GAAG,CAAC,CAAC;IAEpD,IAAI,YAAY;IAChB,IAAI;IACJ,MAAM,QAAQ;QACZ,YAAY;YAAE,SAAS;QAAQ;QAC/B,UAAU,CAAC;YACT,IAAI,WAAW,OAAO;YACtB,YAAY;YAEZ,IACE,sJAAa,IACb,MAAM,cAAc,IACpB,MAAM,aAAa,KAAK,SACxB;gBACA,IAAI,SAAS;oBACX,SAAS,IAAA,0KAAmB,EAAC,OAAO;gBACtC;gBACA,IAAA,0KAAmB,EAAC,OAAO;YAC7B,OAAO;gBACL,IAAA,iKAAkB,EAAC;oBACjB,IAAI,SAAS;wBACX,sDAAsD;wBACtD,IAAI,sJAAa,IAAI,MAAM,aAAa,KAAK,QAAQ;4BACnD,KAAK,IAAA,0KAAmB,EAAC,OAAO;wBAClC;wBAEA,SAAS,IAAA,0KAAmB,EAAC,OAAO;oBACtC;oBAEA,IAAI,UAAU,OAAO,EAAE;oBACvB,IAAA,0KAAmB,EAAC,OAAO;gBAC7B;YACF;YAEA,OAAO;QACT;QACA,WAAW;YACT,IAAI,CAAC,WAAW,MAAM,IAAI,MAAM;YAChC,YAAY;YAEZ,IAAA,2KAAoB,EAAC;QACvB;IACF;IAEA,MAAM,YAAY,IAAI,8JAAe,CAAC;QACpC,sDAAsD;QACtD,IACE,sJAAa,IACb,CAAC,MAAM,aAAa,KAAK,UACtB,MAAM,aAAa,IAAI,CAAC,MAAM,aAAa,AAAC,GAC/C;YACA,KAAK,IAAA,0KAAmB,EAAC,OAAO;QAClC;QAEA,SAAS,IAAA,0KAAmB,EAAC,OAAO;QAEpC,IAAI,UAAU,OAAO,IAAI,CAAC,WAAW;QACrC,IAAA,0KAAmB,EAAC,OAAO;IAC7B;IAEA,MAAM,QAAQ,IAAA,0KAAmB,EAC/B,uBACA,CAAC;QACC,IAAI,YAAY,UAAU,SAAS;IACrC,GACA,IAAA,0KAAgB,EAAC;IAGnB,IAAA,iKAAkB,EAAC;QACjB,UAAU,SAAS;IACrB;IAEA,OAAO,OAAQ,MAAM;AACvB"}},
    {"offset": {"line": 924, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/utils/store-resource.ts"],"sourcesContent":["import {\n  tapEffect,\n  ResourceElement,\n  resource,\n  createResource,\n  tapState,\n} from \"@creatorem/ai-tap\";\nimport { Unsubscribe } from \"../types/client\";\n\nexport interface Store<TState> {\n  /**\n   * Get the current state of the store.\n   */\n  getValue(): TState;\n\n  /**\n   * Subscribe to the store.\n   */\n  subscribe(listener: () => void): Unsubscribe;\n}\n\nexport const StoreResource = resource(\n  <TState>(element: ResourceElement<TState>): Store<TState> => {\n    const [handle] = tapState(() => createResource(element, { mount: false }));\n\n    tapEffect(() => handle.unmount, [handle]);\n\n    tapEffect(() => {\n      handle.render(element);\n    });\n\n    return handle;\n  },\n);\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAAA;;AAqBO,MAAM,gBAAgB,IAAA,sJAAQ,EACnC,CAAS;IACP,MAAM,CAAC,OAAO,GAAG,IAAA,2JAAQ,EAAC,IAAM,IAAA,sKAAc,EAAC,SAAS;YAAE,OAAO;QAAM;IAEvE,IAAA,6JAAS,EAAC,IAAM,OAAO,OAAO,EAAE;QAAC;KAAO;IAExC,IAAA,6JAAS,EAAC;QACR,OAAO,MAAM,CAAC;IAChB;IAEA,OAAO;AACT"}},
    {"offset": {"line": 949, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/tap/src/core/context.ts"],"sourcesContent":["const contextValue: unique symbol = Symbol(\"tap.Context\");\ntype Context<T> = {\n  [contextValue]: T;\n};\n\nexport const createResourceContext = <T>(defaultValue: T): Context<T> => {\n  return {\n    [contextValue]: defaultValue,\n  };\n};\n\nexport const withContextProvider = <T, TResult>(\n  context: Context<T>,\n  value: T,\n  fn: () => TResult,\n) => {\n  const previousValue = context[contextValue];\n  context[contextValue] = value;\n  try {\n    return fn();\n  } finally {\n    context[contextValue] = previousValue;\n  }\n};\n\nexport const tap = <T>(context: Context<T>) => {\n  return context[contextValue];\n};\n"],"names":[],"mappings":";;;;;;;;AAAA,MAAM,eAA8B,OAAO;AAKpC,MAAM,wBAAwB,CAAI;IACvC,OAAO;QACL,CAAC,aAAa,EAAE;IAClB;AACF;AAEO,MAAM,sBAAsB,CACjC,SACA,OACA;IAEA,MAAM,gBAAgB,OAAO,CAAC,aAAa;IAC3C,OAAO,CAAC,aAAa,GAAG;IACxB,IAAI;QACF,OAAO;IACT,SAAU;QACR,OAAO,CAAC,aAAa,GAAG;IAC1B;AACF;AAEO,MAAM,MAAM,CAAI;IACrB,OAAO,OAAO,CAAC,aAAa;AAC9B"}},
    {"offset": {"line": 979, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/utils/tap-client-stack-context.ts"],"sourcesContent":["import {\n  createResourceContext,\n  tap,\n  withContextProvider,\n  tapMemo,\n} from \"@creatorem/ai-tap\";\nimport type { ClientMethods } from \"../types/client\";\n\n/**\n * Symbol used to get the client index from a ClientProxy.\n */\nexport const SYMBOL_CLIENT_INDEX = Symbol(\"assistant-ui.store.clientIndex\");\n\n/**\n * Get the index of a client (its position in the client stack when created).\n */\nexport const getClientIndex = (client: ClientMethods): number => {\n  return (client as unknown as { [SYMBOL_CLIENT_INDEX]: number })[\n    SYMBOL_CLIENT_INDEX\n  ];\n};\n\n/**\n * The client stack - an array of clients representing the current hierarchy.\n */\nexport type ClientStack = readonly ClientMethods[];\n\nconst ClientStackContext = createResourceContext<ClientStack>([]);\n\n/**\n * Get the current client stack inside a tap resource.\n */\nexport const tapClientStack = (): ClientStack => {\n  return tap(ClientStackContext);\n};\n\n/**\n * Execute a callback with a client pushed onto the stack.\n * The stack is duplicated, not mutated.\n */\nexport const tapWithClientStack = <T>(\n  client: ClientMethods,\n  callback: () => T,\n): T => {\n  const currentStack = tapClientStack();\n  const newStack = tapMemo(\n    () => [...currentStack, client],\n    [currentStack, client],\n  );\n  return withContextProvider(ClientStackContext, newStack, callback);\n};\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;;AAWO,MAAM,sBAAsB,OAAO;AAKnC,MAAM,iBAAiB,CAAC;IAC7B,OAAO,AAAC,MAAuD,CAC7D,oBACD;AACH;AAOA,MAAM,qBAAqB,IAAA,kKAAqB,EAAc,EAAE;AAKzD,MAAM,iBAAiB;IAC5B,OAAO,IAAA,gJAAG,EAAC;AACb;AAMO,MAAM,qBAAqB,CAChC,QACA;IAEA,MAAM,eAAe;IACrB,MAAM,WAAW,IAAA,yJAAO,EACtB,IAAM;eAAI;YAAc;SAAO,EAC/B;QAAC;QAAc;KAAO;IAExB,OAAO,IAAA,gKAAmB,EAAC,oBAAoB,UAAU;AAC3D"}},
    {"offset": {"line": 1015, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/utils/base-proxy-handler.ts"],"sourcesContent":["const INTROSPECTION_PROPS = new Set([\"$$typeof\", \"nodeType\", \"then\"]);\n\n/**\n * Handles common proxy introspection properties.\n * Returns the appropriate value for toStringTag, toJSON, and props that should return undefined.\n * Returns `false` if the prop should be handled by the subclass.\n */\nexport const handleIntrospectionProp = (\n  prop: string | symbol,\n  name: string,\n): unknown | false => {\n  if (prop === Symbol.toStringTag) return name;\n  if (typeof prop === \"symbol\") return undefined;\n  if (prop === \"toJSON\") return () => name;\n  if (INTROSPECTION_PROPS.has(prop)) return undefined;\n  return false;\n};\n\nexport abstract class BaseProxyHandler implements ProxyHandler<object> {\n  abstract get(_: unknown, prop: string | symbol, receiver?: unknown): unknown;\n  abstract ownKeys(): ArrayLike<string | symbol>;\n  abstract has(_: unknown, prop: string | symbol): boolean;\n\n  getOwnPropertyDescriptor(_: unknown, prop: string | symbol) {\n    const value = this.get(_, prop);\n    if (value === undefined) return undefined;\n    return {\n      value,\n      writable: false,\n      enumerable: true,\n      configurable: false,\n    };\n  }\n\n  set() {\n    return false;\n  }\n  setPrototypeOf() {\n    return false;\n  }\n  defineProperty() {\n    return false;\n  }\n  deleteProperty() {\n    return false;\n  }\n  preventExtensions(): boolean {\n    return false;\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA,MAAM,sBAAsB,IAAI,IAAI;IAAC;IAAY;IAAY;CAAO;AAO7D,MAAM,0BAA0B,CACrC,MACA;IAEA,IAAI,SAAS,OAAO,WAAW,EAAE,OAAO;IACxC,IAAI,OAAO,SAAS,UAAU,OAAO;IACrC,IAAI,SAAS,UAAU,OAAO,IAAM;IACpC,IAAI,oBAAoB,GAAG,CAAC,OAAO,OAAO;IAC1C,OAAO;AACT;AAEO,MAAe;IAKpB,yBAAyB,CAAU,EAAE,IAAqB,EAAE;QAC1D,MAAM,QAAQ,IAAI,CAAC,GAAG,CAAC,GAAG;QAC1B,IAAI,UAAU,WAAW,OAAO;QAChC,OAAO;YACL;YACA,UAAU;YACV,YAAY;YACZ,cAAc;QAChB;IACF;IAEA,MAAM;QACJ,OAAO;IACT;IACA,iBAAiB;QACf,OAAO;IACT;IACA,iBAAiB;QACf,OAAO;IACT;IACA,iBAAiB;QACf,OAAO;IACT;IACA,oBAA6B;QAC3B,OAAO;IACT;AACF"}},
    {"offset": {"line": 1064, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/wrapper-resource.ts"],"sourcesContent":["import {\n  type ResourceElement,\n  Resource,\n  resource,\n  withKey,\n} from \"@creatorem/ai-tap\";\n\nexport const wrapperResource = <R, P>(\n  fn: (props: ResourceElement<P>) => R,\n): Resource<R, ResourceElement<P>> => {\n  const res = resource(fn);\n  return (props: ResourceElement<P>) => {\n    const el = res(props);\n    if (props.key === undefined) return el;\n    return withKey(props.key, el);\n  };\n};\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAOO,MAAM,kBAAkB,CAC7B;IAEA,MAAM,MAAM,IAAA,sJAAQ,EAAC;IACrB,OAAO,CAAC;QACN,MAAM,KAAK,IAAI;QACf,IAAI,MAAM,GAAG,KAAK,WAAW,OAAO;QACpC,OAAO,IAAA,wJAAO,EAAC,MAAM,GAAG,EAAE;IAC5B;AACF"}},
    {"offset": {"line": 1083, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/tap-client-resource.ts"],"sourcesContent":["import {\n  tapEffect,\n  tapMemo,\n  tapRef,\n  type ResourceElement,\n  tapResource,\n  tapInlineResource,\n} from \"@creatorem/ai-tap\";\nimport type { ClientMethods, ClientOutputOf } from \"./types/client\";\nimport {\n  tapClientStack,\n  tapWithClientStack,\n  SYMBOL_CLIENT_INDEX,\n} from \"./utils/tap-client-stack-context\";\nimport {\n  BaseProxyHandler,\n  handleIntrospectionProp,\n} from \"./utils/base-proxy-handler\";\nimport { wrapperResource } from \"./wrapper-resource\";\n\n/**\n * Symbol used internally to get state from ClientProxy.\n * This allows getState() to be optional in the user-facing client.\n */\nconst SYMBOL_GET_OUTPUT = Symbol(\"assistant-ui.store.getValue\");\n\ntype ClientInternal = {\n  [SYMBOL_GET_OUTPUT]: ClientOutputOf<unknown, ClientMethods>;\n};\n\nexport const getClientState = (client: ClientMethods) => {\n  const output = (client as unknown as ClientInternal)[SYMBOL_GET_OUTPUT];\n  if (!output) {\n    throw new Error(\n      \"Client scope contains a non-client resource. \" +\n        \"Ensure your Derived get() returns a client created with tapClientResource(), not a plain resource.\",\n    );\n  }\n  return output.state;\n};\n\n// Global cache for function templates by field name\nconst fieldAccessFns = new Map<\n  string | symbol,\n  (this: unknown, ...args: unknown[]) => unknown\n>();\n\nfunction getOrCreateProxyFn(prop: string | symbol) {\n  let template = fieldAccessFns.get(prop);\n  if (!template) {\n    template = function (this: unknown, ...args: unknown[]) {\n      if (!this || typeof this !== \"object\") {\n        throw new Error(\n          `Method \"${String(prop)}\" called without proper context. ` +\n            `This may indicate the function was called incorrectly.`,\n        );\n      }\n\n      const output = (this as ClientInternal)[SYMBOL_GET_OUTPUT];\n      if (!output) {\n        throw new Error(\n          `Method \"${String(prop)}\" called on invalid client proxy. ` +\n            `Ensure you are calling this method on a valid client instance.`,\n        );\n      }\n\n      const method = output.methods[prop];\n      if (!method)\n        throw new Error(`Method \"${String(prop)}\" is not implemented.`);\n      if (typeof method !== \"function\")\n        throw new Error(`\"${String(prop)}\" is not a function.`);\n      return method(...args);\n    };\n    fieldAccessFns.set(prop, template);\n  }\n  return template;\n}\n\nclass ClientProxyHandler\n  extends BaseProxyHandler\n  implements ProxyHandler<object>\n{\n  private boundFns: Map<string | symbol, Function> | undefined;\n  private cachedReceiver: unknown;\n\n  constructor(\n    private readonly outputRef: {\n      current: ClientOutputOf<unknown, ClientMethods>;\n    },\n    private readonly index: number,\n  ) {\n    super();\n  }\n\n  get(_: unknown, prop: string | symbol, receiver: unknown) {\n    if (prop === SYMBOL_GET_OUTPUT) return this.outputRef.current;\n    if (prop === SYMBOL_CLIENT_INDEX) return this.index;\n    const introspection = handleIntrospectionProp(prop, \"ClientProxy\");\n    if (introspection !== false) return introspection;\n    const value = this.outputRef.current.methods[prop];\n    if (typeof value === \"function\") {\n      if (this.cachedReceiver !== receiver) {\n        this.boundFns = new Map();\n        this.cachedReceiver = receiver;\n      }\n      let bound = this.boundFns!.get(prop);\n      if (!bound) {\n        bound = getOrCreateProxyFn(prop).bind(receiver);\n        this.boundFns!.set(prop, bound);\n      }\n      return bound;\n    }\n    return value;\n  }\n\n  ownKeys(): ArrayLike<string | symbol> {\n    return Object.keys(this.outputRef.current.methods);\n  }\n\n  has(_: unknown, prop: string | symbol) {\n    if (prop === SYMBOL_GET_OUTPUT) return true;\n    if (prop === SYMBOL_CLIENT_INDEX) return true;\n    return prop in this.outputRef.current.methods;\n  }\n}\n\n/**\n * Resource that wraps a plain resource element to create a stable client proxy.\n *\n * Takes a ResourceElement that returns { state, methods } and\n * wraps it to produce a stable client proxy. This adds the client to the\n * client stack, enabling event scoping.\n *\n * Use this for 1:1 client mappings where you want event scoping to work correctly.\n *\n * @example\n * ```typescript\n * const MessageResource = resource(({ messageId }: { messageId: string }) => {\n *   return tapInlineResource(\n *     tapClientResource(InnerMessageResource({ messageId }))\n *   );\n * });\n * ```\n */\nexport const ClientResource = wrapperResource(\n  <TState, TMethods extends ClientMethods>(\n    element: ResourceElement<ClientOutputOf<TState, TMethods>>,\n  ): ClientOutputOf<TState, TMethods> & {\n    key: string | number | undefined;\n  } => {\n    const valueRef = tapRef(\n      null as unknown as ClientOutputOf<TState, TMethods>,\n    );\n\n    const index = tapClientStack().length;\n    const methods = tapMemo(\n      () =>\n        new Proxy<TMethods>(\n          {} as TMethods,\n          new ClientProxyHandler(valueRef, index),\n        ),\n      [index],\n    );\n\n    const value = tapWithClientStack(methods, () => tapResource(element));\n    if (!valueRef.current) {\n      valueRef.current = value;\n    }\n\n    tapEffect(() => {\n      valueRef.current = value;\n    });\n\n    return { methods, state: value.state, key: element.key };\n  },\n);\n\nexport const tapClientResource = <TState, TMethods extends ClientMethods>(\n  element: ResourceElement<ClientOutputOf<TState, TMethods>>,\n) => {\n  return tapInlineResource(ClientResource(element));\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1199, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/utils/proxied-assistant-state.tsx"],"sourcesContent":["\"use client\";\nimport { getClientState } from \"../tap-client-resource\";\nimport type { AssistantClient, AssistantState } from \"../types/client\";\nimport { BaseProxyHandler, handleIntrospectionProp } from \"./base-proxy-handler\";\n\nexport const PROXIED_ASSISTANT_STATE_SYMBOL = Symbol(\n  \"assistant-ui.store.proxiedAssistantState\",\n);\n\nconst isIgnoredKey = (key: string | symbol): key is \"on\" | \"subscribe\" => {\n  return key === \"on\" || key === \"subscribe\" || typeof key === \"symbol\";\n};\n\n/**\n * Proxied state that lazily accesses scope states\n */\nexport const createProxiedAssistantState = (\n  client: AssistantClient,\n): AssistantState => {\n  class ProxiedAssistantStateProxyHandler\n    extends BaseProxyHandler\n    implements ProxyHandler<AssistantState>\n  {\n    get(_: unknown, prop: string | symbol) {\n      const introspection = handleIntrospectionProp(prop, \"AssistantState\");\n      if (introspection !== false) return introspection;\n      const scope = prop as keyof AssistantClient;\n      if (isIgnoredKey(scope)) return undefined;\n      return getClientState(client[scope]());\n    }\n\n    ownKeys(): ArrayLike<string | symbol> {\n      return Object.keys(client).filter((key) => !isIgnoredKey(key));\n    }\n\n    has(_: unknown, prop: string | symbol): boolean {\n      return !isIgnoredKey(prop) && prop in client;\n    }\n  }\n\n  return new Proxy<AssistantState>(\n    {} as AssistantState,\n    new ProxiedAssistantStateProxyHandler(),\n  );\n};\n\nexport const getProxiedAssistantState = (\n  client: AssistantClient,\n): AssistantState => {\n  return (\n    client as unknown as { [PROXIED_ASSISTANT_STATE_SYMBOL]: AssistantState }\n  )[PROXIED_ASSISTANT_STATE_SYMBOL];\n};\n"],"names":[],"mappings":";;;;;;;;AACA;AAEA;AAHA;;;AAKO,MAAM,iCAAiC,OAC5C;AAGF,MAAM,eAAe,CAAC;IACpB,OAAO,QAAQ,QAAQ,QAAQ,eAAe,OAAO,QAAQ;AAC/D;AAKO,MAAM,8BAA8B,CACzC;IAEA,MAAM,0CACI,iLAAgB;QAGxB,IAAI,CAAU,EAAE,IAAqB,EAAE;YACrC,MAAM,gBAAgB,IAAA,wLAAuB,EAAC,MAAM;YACpD,IAAI,kBAAkB,OAAO,OAAO;YACpC,MAAM,QAAQ;YACd,IAAI,aAAa,QAAQ,OAAO;YAChC,OAAO,IAAA,uKAAc,EAAC,MAAM,CAAC,MAAM;QACrC;QAEA,UAAsC;YACpC,OAAO,OAAO,IAAI,CAAC,QAAQ,MAAM,CAAC,CAAC,MAAQ,CAAC,aAAa;QAC3D;QAEA,IAAI,CAAU,EAAE,IAAqB,EAAW;YAC9C,OAAO,CAAC,aAAa,SAAS,QAAQ;QACxC;IACF;IAEA,OAAO,IAAI,MACT,CAAC,GACD,IAAI;AAER;AAEO,MAAM,2BAA2B,CACtC;IAEA,OAAO,AACL,MACD,CAAC,+BAA+B;AACnC"}},
    {"offset": {"line": 1241, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/utils/react-assistant-context.tsx"],"sourcesContent":["import React, { createContext, useContext } from \"react\";\nimport type { AssistantClient, AssistantClientAccessor } from \"../types/client\";\nimport {\n  createProxiedAssistantState,\n  PROXIED_ASSISTANT_STATE_SYMBOL,\n} from \"./proxied-assistant-state\";\nimport { BaseProxyHandler, handleIntrospectionProp } from \"./base-proxy-handler\";\n\nconst NO_OP_SUBSCRIBE = () => () => {};\n\nconst createErrorClientField = (\n  message: string,\n): AssistantClientAccessor<never> => {\n  const fn = (() => {\n    throw new Error(message);\n  }) as AssistantClientAccessor<never>;\n  fn.source = null;\n  fn.query = null;\n  return fn;\n};\n\nclass DefaultAssistantClientProxyHandler\n  extends BaseProxyHandler\n  implements ProxyHandler<AssistantClient>\n{\n  get(_: unknown, prop: string | symbol) {\n    if (prop === \"subscribe\") return NO_OP_SUBSCRIBE;\n    if (prop === \"on\") return NO_OP_SUBSCRIBE;\n    if (prop === PROXIED_ASSISTANT_STATE_SYMBOL)\n      return DefaultAssistantClientProxiedAssistantState;\n    const introspection = handleIntrospectionProp(\n      prop,\n      \"DefaultAssistantClient\",\n    );\n    if (introspection !== false) return introspection;\n    return createErrorClientField(\n      \"You are using a component or hook that requires an AuiProvider. Wrap your component in an <AuiProvider> component.\",\n    );\n  }\n\n  ownKeys(): ArrayLike<string | symbol> {\n    return [\"subscribe\", \"on\", PROXIED_ASSISTANT_STATE_SYMBOL];\n  }\n\n  has(_: unknown, prop: string | symbol): boolean {\n    return (\n      prop === \"subscribe\" ||\n      prop === \"on\" ||\n      prop === PROXIED_ASSISTANT_STATE_SYMBOL\n    );\n  }\n}\n/** Default context value - throws \"wrap in AuiProvider\" error */\nexport const DefaultAssistantClient: AssistantClient =\n  new Proxy<AssistantClient>(\n    {} as AssistantClient,\n    new DefaultAssistantClientProxyHandler(),\n  );\n\nconst DefaultAssistantClientProxiedAssistantState = createProxiedAssistantState(\n  DefaultAssistantClient,\n);\n\n/** Root prototype for created clients - throws \"scope not defined\" error */\nexport const createRootAssistantClient = (): AssistantClient =>\n  new Proxy<AssistantClient>({} as AssistantClient, {\n    get(_: AssistantClient, prop: string | symbol) {\n      const introspection = handleIntrospectionProp(prop, \"AssistantClient\");\n      if (introspection !== false) return introspection;\n\n      return createErrorClientField(\n        `The current scope does not have a \"${String(prop)}\" property.`,\n      );\n    },\n  });\n\n/**\n * React Context for the AssistantClient\n */\nconst AssistantContext = createContext<AssistantClient>(DefaultAssistantClient);\n\nexport const useAssistantContextValue = (): AssistantClient => {\n  return useContext(AssistantContext);\n};\n\n/**\n * Provider component for AssistantClient\n *\n * @example\n * ```typescript\n * <AuiProvider value={aui}>\n *   <YourApp />\n * </AuiProvider>\n * ```\n */\nexport const AuiProvider = ({\n  value,\n  children,\n}: {\n  value: AssistantClient;\n  children: React.ReactNode;\n}): React.ReactElement => {\n  return (\n    <AssistantContext.Provider value={value}>\n      {children}\n    </AssistantContext.Provider>\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AAEA;AAIA;;;;;AAEA,MAAM,kBAAkB,IAAM,KAAO;AAErC,MAAM,yBAAyB,CAC7B;IAEA,MAAM,KAAM;QACV,MAAM,IAAI,MAAM;IAClB;IACA,GAAG,MAAM,GAAG;IACZ,GAAG,KAAK,GAAG;IACX,OAAO;AACT;AAEA,MAAM,2CACI,iLAAgB;IAGxB,IAAI,CAAU,EAAE,IAAqB,EAAE;QACrC,IAAI,SAAS,aAAa,OAAO;QACjC,IAAI,SAAS,MAAM,OAAO;QAC1B,IAAI,SAAS,qMAA8B,EACzC,OAAO;QACT,MAAM,gBAAgB,IAAA,wLAAuB,EAC3C,MACA;QAEF,IAAI,kBAAkB,OAAO,OAAO;QACpC,OAAO,uBACL;IAEJ;IAEA,UAAsC;QACpC,OAAO;YAAC;YAAa;YAAM,qMAA8B;SAAC;IAC5D;IAEA,IAAI,CAAU,EAAE,IAAqB,EAAW;QAC9C,OACE,SAAS,eACT,SAAS,QACT,SAAS,qMAA8B;IAE3C;AACF;AAEO,MAAM,yBACX,IAAI,MACF,CAAC,GACD,IAAI;AAGR,MAAM,8CAA8C,IAAA,kMAA2B,EAC7E;AAIK,MAAM,4BAA4B,IACvC,IAAI,MAAuB,CAAC,GAAsB;QAChD,KAAI,CAAkB,EAAE,IAAqB;YAC3C,MAAM,gBAAgB,IAAA,wLAAuB,EAAC,MAAM;YACpD,IAAI,kBAAkB,OAAO,OAAO;YAEpC,OAAO,uBACL,CAAC,mCAAmC,EAAE,OAAO,MAAM,WAAW,CAAC;QAEnE;IACF;AAEF;;CAEC,GACD,MAAM,iCAAmB,IAAA,+ZAAa,EAAkB;AAEjD,MAAM,2BAA2B;IACtC,OAAO,IAAA,4ZAAU,EAAC;AACpB;AAYO,MAAM,cAAc,CAAC,EAC1B,KAAK,EACL,QAAQ,EAIT;IACC,qBACE,ubAAC,iBAAiB,QAAQ;QAAC,OAAO;kBAC/B;;;;;;AAGP"}},
    {"offset": {"line": 1317, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/derived.ts"],"sourcesContent":["import { resource, ResourceElement } from \"@creatorem/ai-tap\";\nimport type {\n  AssistantClient,\n  ClientNames,\n  AssistantClientAccessor,\n  ClientMeta,\n} from \"./types/client\";\n\n/**\n * Creates a derived client field that references a client from a parent scope.\n * The get callback always calls the most recent version (useEffectEvent pattern).\n *\n * IMPORTANT: The `get` callback must return a client that was created via\n * `tapClientResource` (or `tapClientLookup`/`tapClientList` which use it internally).\n * This is required for event scoping to work correctly.\n *\n * @example\n * ```typescript\n * const aui = useAui({\n *   message: Derived({\n *     source: \"thread\",\n *     query: { index: 0 },\n *     get: (aui) => aui.thread().message({ index: 0 }),\n *   }),\n * });\n * ```\n */\nexport const Derived = resource(\n  <K extends ClientNames>(_config: Derived.Props<K>): null => {\n    return null;\n  },\n);\n\nexport type DerivedElement<K extends ClientNames> = ResourceElement<\n  null,\n  Derived.Props<K>\n>;\n\nexport namespace Derived {\n  /**\n   * Props passed to a derived client resource element.\n   */\n  export type Props<K extends ClientNames> = {\n    get: (client: AssistantClient) => ReturnType<AssistantClientAccessor<K>>;\n  } & (ClientMeta<K> | { getMeta: (client: AssistantClient) => ClientMeta<K> });\n}\n"],"names":[],"mappings":";;;;AAAA;;AA2BO,MAAM,UAAU,IAAA,sJAAQ,EAC7B,CAAwB;IACtB,OAAO;AACT"}},
    {"offset": {"line": 1330, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/attach-default-peers.ts"],"sourcesContent":["import type { ResourceElement } from \"@creatorem/ai-tap\";\nimport type { ClientElement, ClientNames } from \"./types/client\";\nimport type { DerivedElement } from \"./derived\";\n\n/**\n * Symbol used to store default peer clients on a resource.\n */\nconst DEFAULT_PEERS = Symbol(\"assistant-ui.default-peers\");\n\n/**\n * Type for resources that have default peers attached.\n */\nexport type ResourceWithDefaultPeers = {\n  [DEFAULT_PEERS]?: DefaultPeers;\n};\n\n/**\n * Default peers configuration - can be either root clients or derived clients.\n */\nexport type DefaultPeers = {\n  [K in ClientNames]?: ClientElement<K> | DerivedElement<K>;\n};\n\n/**\n * Attaches default peer clients to a resource.\n *\n * Default peers are only applied if the scope doesn't exist:\n * - Not defined in parent context\n * - Not provided by user\n * - Not already defined by a previous resource's default peers\n *\n * First definition wins - no overriding is permitted.\n *\n * @param resource - The resource to attach default peers to\n * @param peers - The default peer clients to attach\n * @throws Error if a peer key already exists in the resource's default peers\n *\n * @example\n * ```typescript\n * const ThreadListClient = resource(({ ... }) => { ... });\n *\n * attachDefaultPeers(ThreadListClient, {\n *   // Derived default peers\n *   thread: Derived({ source: \"threads\", query: { type: \"main\" }, get: ... }),\n *   threadListItem: Derived({ ... }),\n *   composer: Derived({ getMeta: ..., get: ... }),\n *\n *   // Root default peers\n *   tools: Tools({}),\n *   modelContext: ModelContext({}),\n * });\n * ```\n */\nexport function attachDefaultPeers<\n  T extends (...args: any[]) => ResourceElement<any>,\n>(resource: T, peers: DefaultPeers): void {\n  const resourceWithPeers = resource as T & ResourceWithDefaultPeers;\n  const existing = resourceWithPeers[DEFAULT_PEERS] ?? {};\n\n  for (const key of Object.keys(peers)) {\n    if (key in existing) {\n      throw new Error(\n        `Default peer \"${key}\" is already attached to this resource`,\n      );\n    }\n  }\n\n  resourceWithPeers[DEFAULT_PEERS] = { ...existing, ...peers };\n}\n\n/**\n * Gets the default peers attached to a resource, if any.\n */\nexport function getDefaultPeers<\n  T extends (...args: any[]) => ResourceElement<any>,\n>(resource: T): DefaultPeers | undefined {\n  return (resource as T & ResourceWithDefaultPeers)[DEFAULT_PEERS];\n}\n"],"names":[],"mappings":";;;;;;AAIA;;CAEC,GACD,MAAM,gBAAgB,OAAO;AA8CtB,SAAS,mBAEd,QAAW,EAAE,KAAmB;IAChC,MAAM,oBAAoB;IAC1B,MAAM,WAAW,iBAAiB,CAAC,cAAc,IAAI,CAAC;IAEtD,KAAK,MAAM,OAAO,OAAO,IAAI,CAAC,OAAQ;QACpC,IAAI,OAAO,UAAU;YACnB,MAAM,IAAI,MACR,CAAC,cAAc,EAAE,IAAI,sCAAsC,CAAC;QAEhE;IACF;IAEA,iBAAiB,CAAC,cAAc,GAAG;QAAE,GAAG,QAAQ;QAAE,GAAG,KAAK;IAAC;AAC7D;AAKO,SAAS,gBAEd,QAAW;IACX,OAAO,AAAC,QAAyC,CAAC,cAAc;AAClE"}},
    {"offset": {"line": 1359, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/utils/split-clients.ts"],"sourcesContent":["import { Derived, DerivedElement } from \"../derived\";\nimport type {\n  AssistantClient,\n  ClientElement,\n  ClientNames,\n} from \"../types/client\";\nimport { getDefaultPeers } from \"../attach-default-peers\";\nimport type { useAui } from \"../use-aui\";\nimport { tapMemo } from \"@creatorem/ai-tap\";\n\nexport type RootClients = Partial<\n  Record<ClientNames, ClientElement<ClientNames>>\n>;\nexport type DerivedClients = Partial<\n  Record<ClientNames, DerivedElement<ClientNames>>\n>;\n\n/**\n * Splits a clients object into root clients and derived clients.\n *\n * @param clients - The clients input object to split\n * @returns An object with { rootClients, derivedClients }\n *\n * @example\n * ```typescript\n * const clients = {\n *   foo: RootClient({ ... }),\n *   bar: Derived({ ... }),\n * };\n *\n * const { rootClients, derivedClients } = splitClients(clients);\n * // rootClients = { foo: ... }\n * // derivedClients = { bar: ... }\n * ```\n */\nfunction splitClients(clients: useAui.Props, baseClient: AssistantClient) {\n  const rootClients: RootClients = {};\n  const derivedClients: DerivedClients = {};\n\n  for (const [key, clientElement] of Object.entries(clients) as [\n    keyof useAui.Props,\n    NonNullable<useAui.Props[keyof useAui.Props]>,\n  ][]) {\n    if (clientElement.type === Derived) {\n      derivedClients[key] = clientElement as DerivedElement<ClientNames>;\n    } else {\n      rootClients[key] = clientElement as ClientElement<ClientNames>;\n    }\n  }\n\n  // Recursively gather all default peers, flattening nested ones\n  const gatherDefaultPeers = (\n    clientElement: ClientElement<ClientNames>,\n    visited = new Set<ClientElement<ClientNames>>(),\n  ): Array<\n    [ClientNames, ClientElement<ClientNames> | DerivedElement<ClientNames>]\n  > => {\n    // Prevent infinite loops\n    if (visited.has(clientElement)) return [];\n    visited.add(clientElement);\n\n    const defaultPeers = getDefaultPeers(clientElement.type);\n    if (!defaultPeers) return [];\n\n    const result: Array<\n      [ClientNames, ClientElement<ClientNames> | DerivedElement<ClientNames>]\n    > = [];\n\n    for (const [key, peerElement] of Object.entries(defaultPeers) as [\n      ClientNames,\n      ClientElement<ClientNames> | DerivedElement<ClientNames>,\n    ][]) {\n      result.push([key, peerElement]);\n\n      // If this peer is a root client with its own default peers, recursively gather them\n      if (peerElement.type !== Derived<ClientNames>) {\n        const nestedPeers = gatherDefaultPeers(\n          peerElement as ClientElement<ClientNames>,\n          visited,\n        );\n        result.push(...nestedPeers);\n      }\n    }\n\n    return result;\n  };\n\n  // Apply flattened default peers for each root client\n  for (const [_clientKey, clientElement] of Object.entries(rootClients) as [\n    ClientNames,\n    ClientElement<ClientNames>,\n  ][]) {\n    const allPeers = gatherDefaultPeers(clientElement);\n\n    for (const [key, peerElement] of allPeers) {\n      // Skip if already exists (first wins)\n      if (\n        key in rootClients ||\n        key in derivedClients ||\n        baseClient[key].source !== null\n      )\n        continue;\n\n      if (peerElement.type === Derived<ClientNames>) {\n        derivedClients[key] = peerElement as DerivedElement<ClientNames>;\n      } else {\n        rootClients[key] = peerElement as ClientElement<ClientNames>;\n      }\n    }\n  }\n\n  return { rootClients, derivedClients };\n}\n\nconst tapShallowMemoObject = <T extends object>(object: T) => {\n  // biome-ignore lint/correctness/useExhaustiveDependencies: shallow memo\n  return tapMemo(() => object, [...Object.entries(object).flat()]);\n};\n\nexport const tapSplitClients = (\n  clients: useAui.Props,\n  baseClient: AssistantClient,\n) => {\n  const { rootClients, derivedClients } = splitClients(clients, baseClient);\n\n  return {\n    rootClients: tapShallowMemoObject(rootClients),\n    derivedClients: tapShallowMemoObject(derivedClients),\n  };\n};\n"],"names":[],"mappings":";;;;AAAA;AAMA;AAEA;;;;AASA;;;;;;;;;;;;;;;;;CAiBC,GACD,SAAS,aAAa,OAAqB,EAAE,UAA2B;IACtE,MAAM,cAA2B,CAAC;IAClC,MAAM,iBAAiC,CAAC;IAExC,KAAK,MAAM,CAAC,KAAK,cAAc,IAAI,OAAO,OAAO,CAAC,SAG7C;QACH,IAAI,cAAc,IAAI,KAAK,8IAAO,EAAE;YAClC,cAAc,CAAC,IAAI,GAAG;QACxB,OAAO;YACL,WAAW,CAAC,IAAI,GAAG;QACrB;IACF;IAEA,+DAA+D;IAC/D,MAAM,qBAAqB,CACzB,eACA,UAAU,IAAI,KAAiC;QAI/C,yBAAyB;QACzB,IAAI,QAAQ,GAAG,CAAC,gBAAgB,OAAO,EAAE;QACzC,QAAQ,GAAG,CAAC;QAEZ,MAAM,eAAe,IAAA,yKAAe,EAAC,cAAc,IAAI;QACvD,IAAI,CAAC,cAAc,OAAO,EAAE;QAE5B,MAAM,SAEF,EAAE;QAEN,KAAK,MAAM,CAAC,KAAK,YAAY,IAAI,OAAO,OAAO,CAAC,cAG3C;YACH,OAAO,IAAI,CAAC;gBAAC;gBAAK;aAAY;YAE9B,oFAAoF;YACpF,IAAI,YAAY,IAAI,KAAK,8IAAO,EAAe;gBAC7C,MAAM,cAAc,mBAClB,aACA;gBAEF,OAAO,IAAI,IAAI;YACjB;QACF;QAEA,OAAO;IACT;IAEA,qDAAqD;IACrD,KAAK,MAAM,CAAC,YAAY,cAAc,IAAI,OAAO,OAAO,CAAC,aAGpD;QACH,MAAM,WAAW,mBAAmB;QAEpC,KAAK,MAAM,CAAC,KAAK,YAAY,IAAI,SAAU;YACzC,sCAAsC;YACtC,IACE,OAAO,eACP,OAAO,kBACP,UAAU,CAAC,IAAI,CAAC,MAAM,KAAK,MAE3B;YAEF,IAAI,YAAY,IAAI,KAAK,8IAAO,EAAe;gBAC7C,cAAc,CAAC,IAAI,GAAG;YACxB,OAAO;gBACL,WAAW,CAAC,IAAI,GAAG;YACrB;QACF;IACF;IAEA,OAAO;QAAE;QAAa;IAAe;AACvC;AAEA,MAAM,uBAAuB,CAAmB;IAC9C,wEAAwE;IACxE,OAAO,IAAA,yJAAO,EAAC,IAAM,QAAQ;WAAI,OAAO,OAAO,CAAC,QAAQ,IAAI;KAAG;AACjE;AAEO,MAAM,kBAAkB,CAC7B,SACA;IAEA,MAAM,EAAE,WAAW,EAAE,cAAc,EAAE,GAAG,aAAa,SAAS;IAE9D,OAAO;QACL,aAAa,qBAAqB;QAClC,gBAAgB,qBAAqB;IACvC;AACF"}},
    {"offset": {"line": 1452, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/types/events.ts"],"sourcesContent":["import type {\n  AssistantClientAccessor,\n  ClientEvents,\n  ClientNames,\n} from \"./client\";\n\n// --- Event Map Construction ---\ntype UnionToIntersection<U> = (\n  U extends unknown\n    ? (x: U) => void\n    : never\n) extends (x: infer I) => void\n  ? I\n  : never;\n\ntype ClientEventMap = UnionToIntersection<\n  { [K in ClientNames]: ClientEvents<K> }[ClientNames]\n>;\n\n// --- Core Types ---\n\ntype WildcardPayload = {\n  [K in keyof ClientEventMap]: { event: K; payload: ClientEventMap[K] };\n}[keyof ClientEventMap];\n\nexport type AssistantEventPayload = ClientEventMap & { \"*\": WildcardPayload };\n\nexport type AssistantEventName = keyof AssistantEventPayload;\n\ntype EventSource<T extends AssistantEventName> =\n  T extends `${infer Source}.${string}` ? Source : never;\n\n// --- Scoping ---\n\ntype ParentOf<K extends ClientNames> =\n  AssistantClientAccessor<K> extends { source: infer S }\n    ? S extends ClientNames\n      ? S\n      : never\n    : never;\n\ntype AncestorsOf<\n  K extends ClientNames,\n  Seen extends ClientNames = never,\n> = K extends Seen\n  ? never\n  : ParentOf<K> extends never\n    ? never\n    : ParentOf<K> | AncestorsOf<ParentOf<K>, Seen | K>;\n\n/** Valid scopes: `\"*\"` | event source | ancestors of event source */\nexport type AssistantEventScope<TEvent extends AssistantEventName> =\n  | \"*\"\n  | EventSource<TEvent>\n  | (EventSource<TEvent> extends ClientNames\n      ? AncestorsOf<EventSource<TEvent>>\n      : never);\n\n// --- Selection & Callbacks ---\n\nexport type AssistantEventSelector<TEvent extends AssistantEventName> =\n  | TEvent\n  | { scope: AssistantEventScope<TEvent>; event: TEvent };\n\nexport const normalizeEventSelector = <TEvent extends AssistantEventName>(\n  selector: AssistantEventSelector<TEvent>,\n) => {\n  if (typeof selector === \"string\") {\n    const source = selector.split(\".\")[0] as AssistantEventScope<TEvent>;\n    return { scope: source, event: selector };\n  }\n  return { scope: selector.scope, event: selector.event };\n};\n\nexport type AssistantEventCallback<TEvent extends AssistantEventName> = (\n  payload: AssistantEventPayload[TEvent],\n) => void;\n"],"names":[],"mappings":";;;;AAgEO,MAAM,yBAAyB,CACpC;IAEA,IAAI,OAAO,aAAa,UAAU;QAChC,MAAM,SAAS,SAAS,KAAK,CAAC,IAAI,CAAC,EAAE;QACrC,OAAO;YAAE,OAAO;YAAQ,OAAO;QAAS;IAC1C;IACA,OAAO;QAAE,OAAO,SAAS,KAAK;QAAE,OAAO,SAAS,KAAK;IAAC;AACxD"}},
    {"offset": {"line": 1473, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/utils/notification-manager.ts"],"sourcesContent":["import { resource } from \"@creatorem/ai-tap\";\nimport type { ClientStack } from \"./tap-client-stack-context\";\nimport type {\n  AssistantEventName,\n  AssistantEventPayload,\n} from \"../types/events\";\nimport { Unsubscribe } from \"../types/client\";\nimport { tapConst } from \"@creatorem/ai-tap\";\n\ntype InternalCallback = (payload: unknown, clientStack: ClientStack) => void;\n\nexport type NotificationManager = {\n  on<TEvent extends AssistantEventName>(\n    event: TEvent,\n    callback: (\n      payload: AssistantEventPayload[TEvent],\n      clientStack: ClientStack,\n    ) => void,\n  ): Unsubscribe;\n  emit<TEvent extends Exclude<AssistantEventName, \"*\">>(\n    event: TEvent,\n    payload: AssistantEventPayload[TEvent],\n    clientStack: ClientStack,\n  ): void;\n  subscribe(callback: () => void): Unsubscribe;\n  notifySubscribers(): void;\n};\n\nexport const NotificationManager = resource((): NotificationManager => {\n  return tapConst(() => {\n    const listeners = new Map<string, Set<InternalCallback>>();\n    const wildcardListeners = new Set<InternalCallback>();\n    const subscribers = new Set<() => void>();\n\n    return {\n      on(event, callback) {\n        const cb = callback as InternalCallback;\n        if (event === \"*\") {\n          wildcardListeners.add(cb);\n          return () => wildcardListeners.delete(cb);\n        }\n\n        let set = listeners.get(event);\n        if (!set) {\n          set = new Set();\n          listeners.set(event, set);\n        }\n        set.add(cb);\n\n        return () => {\n          set!.delete(cb);\n          if (set!.size === 0) listeners.delete(event);\n        };\n      },\n\n      emit(event, payload, clientStack) {\n        const eventListeners = listeners.get(event);\n        if (!eventListeners && wildcardListeners.size === 0) return;\n\n        queueMicrotask(() => {\n          const errors = [];\n          if (eventListeners) {\n            for (const cb of eventListeners) {\n              try {\n                cb(payload, clientStack);\n              } catch (e) {\n                errors.push(e);\n              }\n            }\n          }\n          if (wildcardListeners.size > 0) {\n            const wrapped = { event, payload };\n            for (const cb of wildcardListeners) {\n              try {\n                cb(wrapped, clientStack);\n              } catch (e) {\n                errors.push(e);\n              }\n            }\n          }\n\n          if (errors.length > 0) {\n            if (errors.length === 1) {\n              throw errors[0];\n            } else {\n              for (const error of errors) {\n                console.error(error);\n              }\n              throw new AggregateError(\n                errors,\n                \"Errors occurred during event emission\",\n              );\n            }\n          }\n        });\n      },\n\n      subscribe(callback) {\n        subscribers.add(callback);\n        return () => subscribers.delete(callback);\n      },\n\n      notifySubscribers() {\n        for (const cb of subscribers) {\n          try {\n            cb();\n          } catch (e) {\n            console.error(\"NotificationManager: subscriber callback error\", e);\n          }\n        }\n      },\n    };\n  }, []);\n});\n"],"names":[],"mappings":";;;;AAAA;AAOA;;;AAqBO,MAAM,sBAAsB,IAAA,sJAAQ,EAAC;IAC1C,OAAO,IAAA,2JAAQ,EAAC;QACd,MAAM,YAAY,IAAI;QACtB,MAAM,oBAAoB,IAAI;QAC9B,MAAM,cAAc,IAAI;QAExB,OAAO;YACL,IAAG,KAAK,EAAE,QAAQ;gBAChB,MAAM,KAAK;gBACX,IAAI,UAAU,KAAK;oBACjB,kBAAkB,GAAG,CAAC;oBACtB,OAAO,IAAM,kBAAkB,MAAM,CAAC;gBACxC;gBAEA,IAAI,MAAM,UAAU,GAAG,CAAC;gBACxB,IAAI,CAAC,KAAK;oBACR,MAAM,IAAI;oBACV,UAAU,GAAG,CAAC,OAAO;gBACvB;gBACA,IAAI,GAAG,CAAC;gBAER,OAAO;oBACL,IAAK,MAAM,CAAC;oBACZ,IAAI,IAAK,IAAI,KAAK,GAAG,UAAU,MAAM,CAAC;gBACxC;YACF;YAEA,MAAK,KAAK,EAAE,OAAO,EAAE,WAAW;gBAC9B,MAAM,iBAAiB,UAAU,GAAG,CAAC;gBACrC,IAAI,CAAC,kBAAkB,kBAAkB,IAAI,KAAK,GAAG;gBAErD,eAAe;oBACb,MAAM,SAAS,EAAE;oBACjB,IAAI,gBAAgB;wBAClB,KAAK,MAAM,MAAM,eAAgB;4BAC/B,IAAI;gCACF,GAAG,SAAS;4BACd,EAAE,OAAO,GAAG;gCACV,OAAO,IAAI,CAAC;4BACd;wBACF;oBACF;oBACA,IAAI,kBAAkB,IAAI,GAAG,GAAG;wBAC9B,MAAM,UAAU;4BAAE;4BAAO;wBAAQ;wBACjC,KAAK,MAAM,MAAM,kBAAmB;4BAClC,IAAI;gCACF,GAAG,SAAS;4BACd,EAAE,OAAO,GAAG;gCACV,OAAO,IAAI,CAAC;4BACd;wBACF;oBACF;oBAEA,IAAI,OAAO,MAAM,GAAG,GAAG;wBACrB,IAAI,OAAO,MAAM,KAAK,GAAG;4BACvB,MAAM,MAAM,CAAC,EAAE;wBACjB,OAAO;4BACL,KAAK,MAAM,SAAS,OAAQ;gCAC1B,QAAQ,KAAK,CAAC;4BAChB;4BACA,MAAM,IAAI,eACR,QACA;wBAEJ;oBACF;gBACF;YACF;YAEA,WAAU,QAAQ;gBAChB,YAAY,GAAG,CAAC;gBAChB,OAAO,IAAM,YAAY,MAAM,CAAC;YAClC;YAEA;gBACE,KAAK,MAAM,MAAM,YAAa;oBAC5B,IAAI;wBACF;oBACF,EAAE,OAAO,GAAG;wBACV,QAAQ,KAAK,CAAC,kDAAkD;oBAClE;gBACF;YACF;QACF;IACF,GAAG,EAAE;AACP"}},
    {"offset": {"line": 1563, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/utils/tap-assistant-context.ts"],"sourcesContent":["import {\n  createResourceContext,\n  tap,\n  withContextProvider,\n  tapEffectEvent,\n} from \"@creatorem/ai-tap\";\nimport type {\n  AssistantEventName,\n  AssistantEventPayload,\n} from \"../types/events\";\nimport type { AssistantClient } from \"../types/client\";\nimport { tapClientStack, type ClientStack } from \"./tap-client-stack-context\";\n\ntype EmitFn = <TEvent extends Exclude<AssistantEventName, \"*\">>(\n  event: TEvent,\n  payload: AssistantEventPayload[TEvent],\n  clientStack: ClientStack,\n) => void;\n\nexport type AssistantTapContextValue = {\n  clientRef: { parent: AssistantClient; current: AssistantClient | null };\n  emit: EmitFn;\n};\n\nconst AssistantTapContext =\n  createResourceContext<AssistantTapContextValue | null>(null);\n\nexport const withAssistantTapContextProvider = <TResult>(\n  value: AssistantTapContextValue,\n  fn: () => TResult,\n) => {\n  return withContextProvider(AssistantTapContext, value, fn);\n};\n\nconst tapAssistantTapContext = () => {\n  const ctx = tap(AssistantTapContext);\n  if (!ctx) throw new Error(\"AssistantTapContext is not available\");\n\n  return ctx;\n};\n\nexport const tapAssistantClientRef = () => {\n  return tapAssistantTapContext().clientRef;\n};\n\nexport const tapAssistantEmit = () => {\n  const { emit } = tapAssistantTapContext();\n  const clientStack = tapClientStack();\n\n  return tapEffectEvent(\n    <TEvent extends Exclude<AssistantEventName, \"*\">>(\n      event: TEvent,\n      payload: AssistantEventPayload[TEvent],\n    ) => {\n      emit(event, payload, clientStack);\n    },\n  );\n};\n"],"names":[],"mappings":";;;;;;;;AAAA;AAAA;AAWA;;;AAaA,MAAM,sBACJ,IAAA,kKAAqB,EAAkC;AAElD,MAAM,kCAAkC,CAC7C,OACA;IAEA,OAAO,IAAA,gKAAmB,EAAC,qBAAqB,OAAO;AACzD;AAEA,MAAM,yBAAyB;IAC7B,MAAM,MAAM,IAAA,gJAAG,EAAC;IAChB,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAE1B,OAAO;AACT;AAEO,MAAM,wBAAwB;IACnC,OAAO,yBAAyB,SAAS;AAC3C;AAEO,MAAM,mBAAmB;IAC9B,MAAM,EAAE,IAAI,EAAE,GAAG;IACjB,MAAM,cAAc,IAAA,wLAAc;IAElC,OAAO,IAAA,2KAAc,EACnB,CACE,OACA;QAEA,KAAK,OAAO,SAAS;IACvB;AAEJ"}},
    {"offset": {"line": 1599, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/use-aui.tsx"],"sourcesContent":["\"use client\";\n\nimport { useResource } from \"@creatorem/ai-tap/react\";\nimport {\n  resource,\n  tapMemo,\n  tapResources,\n  tapEffectEvent,\n  tapInlineResource,\n  tapEffect,\n  tapRef,\n  tapResource,\n  withKey,\n} from \"@creatorem/ai-tap\";\nimport type {\n  AssistantClient,\n  AssistantClientAccessor,\n  ClientNames,\n  ClientElement,\n  ClientMeta,\n} from \"./types/client\";\nimport { Derived, DerivedElement } from \"./derived\";\nimport { StoreResource } from \"./utils/store-resource\";\nimport {\n  useAssistantContextValue,\n  DefaultAssistantClient,\n  createRootAssistantClient,\n} from \"./utils/react-assistant-context\";\nimport {\n  DerivedClients,\n  RootClients,\n  tapSplitClients,\n} from \"./utils/split-clients\";\nimport {\n  normalizeEventSelector,\n  type AssistantEventName,\n  type AssistantEventCallback,\n  type AssistantEventSelector,\n} from \"./types/events\";\nimport { NotificationManager } from \"./utils/notification-manager\";\nimport { withAssistantTapContextProvider } from \"./utils/tap-assistant-context\";\nimport { tapClientResource } from \"./tap-client-resource\";\nimport { getClientIndex } from \"./utils/tap-client-stack-context\";\nimport {\n  PROXIED_ASSISTANT_STATE_SYMBOL,\n  createProxiedAssistantState,\n} from \"./utils/proxied-assistant-state\";\n\nconst RootClientResource = resource(\n  <K extends ClientNames>({\n    element,\n    emit,\n    clientRef,\n  }: {\n    element: ClientElement<K>;\n    emit: NotificationManager[\"emit\"];\n    clientRef: { parent: AssistantClient; current: AssistantClient | null };\n  }) => {\n    const { methods, state } = withAssistantTapContextProvider(\n      { clientRef, emit },\n      () => tapClientResource(element),\n    );\n    return tapMemo(() => ({ state, methods }), [methods, state]);\n  },\n);\n\nconst RootClientAccessorResource = resource(\n  <K extends ClientNames>({\n    element,\n    notifications,\n    clientRef,\n    name,\n  }: {\n    element: ClientElement<K>;\n    notifications: NotificationManager;\n    clientRef: { parent: AssistantClient; current: AssistantClient | null };\n    name: K;\n  }): AssistantClientAccessor<K> => {\n    const store = tapInlineResource(\n      StoreResource(\n        RootClientResource({ element, emit: notifications.emit, clientRef }),\n      ),\n    );\n\n    tapEffect(() => {\n      return store.subscribe(notifications.notifySubscribers);\n    }, [store, notifications]);\n\n    return tapMemo(() => {\n      const clientFunction = () => store.getValue().methods;\n      Object.defineProperties(clientFunction, {\n        source: {\n          value: \"root\" as const,\n          writable: false,\n        },\n        query: {\n          value: {} as Record<string, never>,\n          writable: false,\n        },\n        name: {\n          value: name,\n          configurable: true,\n        },\n      });\n      return clientFunction as AssistantClientAccessor<K>;\n    }, [store, name]);\n  },\n);\n\nconst NoOpRootClientsAccessorsResource = resource(() => {\n  return tapMemo(\n    () => ({\n      clients: [] as AssistantClientAccessor<ClientNames>[],\n      subscribe: undefined,\n      on: undefined,\n    }),\n    [],\n  );\n});\n\nconst RootClientsAccessorsResource = resource(\n  ({\n    clients: inputClients,\n    clientRef,\n  }: {\n    clients: RootClients;\n    clientRef: { parent: AssistantClient; current: AssistantClient | null };\n  }) => {\n    const notifications = tapInlineResource(NotificationManager());\n\n    tapEffect(\n      () => clientRef.parent.subscribe(notifications.notifySubscribers),\n      [clientRef, notifications],\n    );\n\n    const results = tapResources(\n      () =>\n        Object.keys(inputClients).map((key) =>\n          withKey(\n            key,\n            RootClientAccessorResource({\n              element: inputClients[key as keyof typeof inputClients]!,\n              notifications,\n              clientRef,\n              name: key as keyof typeof inputClients,\n            }),\n          ),\n        ),\n      [inputClients, notifications, clientRef],\n    );\n\n    return tapMemo(() => {\n      return {\n        clients: results,\n        subscribe: notifications.subscribe,\n        on: function <TEvent extends AssistantEventName>(\n          this: AssistantClient,\n          selector: AssistantEventSelector<TEvent>,\n          callback: AssistantEventCallback<TEvent>,\n        ) {\n          if (!this) {\n            throw new Error(\n              \"const { on } = useAui() is not supported. Use aui.on() instead.\",\n            );\n          }\n\n          const { scope, event } = normalizeEventSelector(selector);\n\n          if (scope !== \"*\") {\n            const source = this[scope as ClientNames].source;\n            if (source === null) {\n              throw new Error(\n                `Scope \"${scope}\" is not available. Use { scope: \"*\", event: \"${event}\" } to listen globally.`,\n              );\n            }\n          }\n\n          const localUnsub = notifications.on(event, (payload, clientStack) => {\n            if (scope === \"*\") {\n              callback(payload);\n              return;\n            }\n\n            const scopeClient = this[scope as ClientNames]();\n            const index = getClientIndex(scopeClient);\n            if (scopeClient === clientStack[index]) {\n              callback(payload);\n            }\n          });\n          if (\n            scope !== \"*\" &&\n            clientRef.parent[scope as ClientNames].source === null\n          )\n            return localUnsub;\n\n          const parentUnsub = clientRef.parent.on(selector, callback);\n\n          return () => {\n            localUnsub();\n            parentUnsub();\n          };\n        },\n      };\n    }, [results, notifications, clientRef]);\n  },\n);\n\ntype MetaMemo<K extends ClientNames> = {\n  meta?: ClientMeta<K>;\n  dep?: unknown;\n};\n\nconst getMeta = <K extends ClientNames>(\n  props: Derived.Props<K>,\n  clientRef: { parent: AssistantClient; current: AssistantClient | null },\n  memo: MetaMemo<K>,\n): ClientMeta<K> => {\n  if (\"source\" in props && \"query\" in props) return props;\n  if (memo.dep === props) return memo.meta!;\n  const meta = props.getMeta(clientRef.current!);\n  memo.meta = meta;\n  memo.dep = props;\n  return meta;\n};\n\nconst DerivedClientAccessorResource = resource(\n  <K extends ClientNames>({\n    element,\n    clientRef,\n    name,\n  }: {\n    element: DerivedElement<K>;\n    clientRef: { parent: AssistantClient; current: AssistantClient | null };\n    name: K;\n  }) => {\n    const get = tapEffectEvent(() => element.props);\n\n    return tapMemo(() => {\n      const clientFunction = () => get().get(clientRef.current!);\n      const metaMemo = {};\n      Object.defineProperties(clientFunction, {\n        source: {\n          get: () => getMeta(get(), clientRef, metaMemo).source,\n        },\n        query: {\n          get: () => getMeta(get(), clientRef, metaMemo).query,\n        },\n        name: {\n          value: name,\n          configurable: true,\n        },\n      });\n      return clientFunction as AssistantClientAccessor<K>;\n    }, [clientRef, name]);\n  },\n);\n\nconst DerivedClientsAccessorsResource = resource(\n  ({\n    clients,\n    clientRef,\n  }: {\n    clients: DerivedClients;\n    clientRef: { parent: AssistantClient; current: AssistantClient | null };\n  }) => {\n    return tapResources(\n      () =>\n        Object.keys(clients).map((key) =>\n          withKey(\n            key,\n            DerivedClientAccessorResource({\n              element: clients[key as keyof typeof clients]!,\n              clientRef,\n              name: key as keyof typeof clients,\n            }),\n          ),\n        ),\n      [clients, clientRef],\n    );\n  },\n);\n\n/**\n * Resource that creates an extended AssistantClient.\n */\nexport const AssistantClientResource = resource(\n  ({\n    parent,\n    clients,\n  }: {\n    parent: AssistantClient;\n    clients: useAui.Props;\n  }): AssistantClient => {\n    const { rootClients, derivedClients } = tapSplitClients(clients, parent);\n\n    const clientRef = tapRef({\n      parent: parent,\n      current: null as AssistantClient | null,\n    }).current;\n\n    tapEffect(() => {\n      // if (clientRef.current && clientRef.current !== client)\n      //   throw new Error(\"clientRef.current !== client\");\n\n      clientRef.current = client;\n    });\n\n    const rootFields = tapResource(\n      Object.keys(rootClients).length > 0\n        ? RootClientsAccessorsResource({ clients: rootClients, clientRef })\n        : NoOpRootClientsAccessorsResource(),\n    );\n\n    const derivedFields = tapInlineResource(\n      DerivedClientsAccessorsResource({ clients: derivedClients, clientRef }),\n    );\n\n    const client = tapMemo(() => {\n      // Swap DefaultAssistantClient -> createRootAssistantClient at root to change error message\n      const proto =\n        parent === DefaultAssistantClient\n          ? createRootAssistantClient()\n          : parent;\n\n      const client = Object.create(proto) as AssistantClient;\n      Object.assign(client, {\n        subscribe: rootFields.subscribe ?? parent.subscribe,\n        on: rootFields.on ?? parent.on,\n        [PROXIED_ASSISTANT_STATE_SYMBOL]: createProxiedAssistantState(client),\n      });\n\n      for (const field of rootFields.clients) {\n        (client as any)[field.name] = field;\n      }\n      for (const field of derivedFields) {\n        (client as any)[field.name] = field;\n      }\n\n      return client;\n    }, [parent, rootFields, derivedFields]);\n\n    if (clientRef.current === null) {\n      clientRef.current = client;\n    }\n\n    return client;\n  },\n);\n\nexport namespace useAui {\n  export type Props = {\n    [K in ClientNames]?: ClientElement<K> | DerivedElement<K>;\n  };\n}\n\nexport function useAui(): AssistantClient;\nexport function useAui(clients: useAui.Props): AssistantClient;\nexport function useAui(\n  clients: useAui.Props,\n  config: { parent: null | AssistantClient },\n): AssistantClient;\n/** @deprecated This API is highly experimental and may be changed in a minor release */\nexport function useAui(\n  clients?: useAui.Props,\n  { parent }: { parent: null | AssistantClient } = {\n    parent: useAssistantContextValue(),\n  },\n): AssistantClient {\n  if (clients) {\n    return useResource(\n      AssistantClientResource({\n        parent: parent ?? DefaultAssistantClient,\n        clients,\n      }),\n    );\n  }\n  if (parent === null)\n    throw new Error(\"received null parent, this usage is not allowed\");\n  return parent;\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1848, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/tap-client-lookup.ts"],"sourcesContent":["import {\n  tapInlineResource,\n  tapMemo,\n  tapResources,\n  type ResourceElement,\n} from \"@creatorem/ai-tap\";\nimport type { ClientMethods, ClientOutputOf } from \"./types/client\";\nimport { ClientResource } from \"./tap-client-resource\";\nimport { wrapperResource } from \"./wrapper-resource\";\n\nconst ClientResourceWithKey = wrapperResource(\n  <TState, TMethods extends ClientMethods>(\n    el: ResourceElement<ClientOutputOf<TState, TMethods>>,\n  ) => {\n    if (el.key === undefined) {\n      throw new Error(\"tapClientResource: Element has no key\");\n    }\n    return tapInlineResource(ClientResource(el)) as ClientOutputOf<\n      TState,\n      TMethods\n    > & { key: string | number };\n  },\n);\n\nexport function tapClientLookup<TState, TMethods extends ClientMethods>(\n  getElements: () => readonly ResourceElement<\n    ClientOutputOf<TState, TMethods>\n  >[],\n  getElementsDeps: readonly unknown[],\n): {\n  state: TState[];\n  get: (lookup: { index: number } | { key: string }) => TMethods;\n} {\n  const resources = tapResources(\n    () => getElements().map((el) => ClientResourceWithKey(el)),\n    // biome-ignore lint/correctness/useExhaustiveDependencies: getElementsDeps is passed through from caller\n    getElementsDeps,\n  );\n\n  const keys = tapMemo(() => Object.keys(resources), [resources]);\n\n  // For arrays, track element key -> index mapping\n  const keyToIndex = tapMemo(() => {\n    return resources.reduce(\n      (acc, resource, index) => {\n        acc[resource.key] = index;\n        return acc;\n      },\n      {} as Record<string, number>,\n    );\n  }, [resources]);\n\n  const state = tapMemo(() => {\n    return resources.map((r) => r.state);\n  }, [resources]);\n\n  return {\n    state,\n    get: (lookup: { index: number } | { key: string }) => {\n      if (\"index\" in lookup) {\n        if (lookup.index < 0 || lookup.index >= keys.length) {\n          throw new Error(\n            `tapClientLookup: Index ${lookup.index} out of bounds (length: ${keys.length})`,\n          );\n        }\n        return resources[lookup.index]!.methods;\n      }\n\n      const index = keyToIndex[lookup.key];\n      if (index === undefined) {\n        throw new Error(`tapClientLookup: Key \"${lookup.key}\" not found`);\n      }\n      return resources[index]!.methods;\n    },\n  };\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAOA;AACA;;;;AAEA,MAAM,wBAAwB,IAAA,kKAAe,EAC3C,CACE;IAEA,IAAI,GAAG,GAAG,KAAK,WAAW;QACxB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO,IAAA,iLAAiB,EAAC,IAAA,uKAAc,EAAC;AAI1C;AAGK,SAAS,gBACd,WAEG,EACH,eAAmC;IAKnC,MAAM,YAAY,IAAA,mKAAY,EAC5B,IAAM,cAAc,GAAG,CAAC,CAAC,KAAO,sBAAsB,MACtD,yGAAyG;IACzG;IAGF,MAAM,OAAO,IAAA,yJAAO,EAAC,IAAM,OAAO,IAAI,CAAC,YAAY;QAAC;KAAU;IAE9D,iDAAiD;IACjD,MAAM,aAAa,IAAA,yJAAO,EAAC;QACzB,OAAO,UAAU,MAAM,CACrB,CAAC,KAAK,UAAU;YACd,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG;YACpB,OAAO;QACT,GACA,CAAC;IAEL,GAAG;QAAC;KAAU;IAEd,MAAM,QAAQ,IAAA,yJAAO,EAAC;QACpB,OAAO,UAAU,GAAG,CAAC,CAAC,IAAM,EAAE,KAAK;IACrC,GAAG;QAAC;KAAU;IAEd,OAAO;QACL;QACA,KAAK,CAAC;YACJ,IAAI,WAAW,QAAQ;gBACrB,IAAI,OAAO,KAAK,GAAG,KAAK,OAAO,KAAK,IAAI,KAAK,MAAM,EAAE;oBACnD,MAAM,IAAI,MACR,CAAC,uBAAuB,EAAE,OAAO,KAAK,CAAC,wBAAwB,EAAE,KAAK,MAAM,CAAC,CAAC,CAAC;gBAEnF;gBACA,OAAO,SAAS,CAAC,OAAO,KAAK,CAAC,CAAE,OAAO;YACzC;YAEA,MAAM,QAAQ,UAAU,CAAC,OAAO,GAAG,CAAC;YACpC,IAAI,UAAU,WAAW;gBACvB,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAE,OAAO,GAAG,CAAC,WAAW,CAAC;YAClE;YACA,OAAO,SAAS,CAAC,MAAM,CAAE,OAAO;QAClC;IACF;AACF"}},
    {"offset": {"line": 1907, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/util-hooks/tap-subscribable.ts"],"sourcesContent":["import { tapState, tapEffect } from \"@creatorem/ai-tap\";\nimport { SubscribableWithState } from \"../runtime/subscribable/subscribable\";\n\nexport const tapSubscribable = <T>(\n  subscribable: Omit<SubscribableWithState<T, any>, \"path\">,\n) => {\n  const [, setState] = tapState(subscribable.getState);\n  tapEffect(() => {\n    setState(subscribable.getState());\n    return subscribable.subscribe(() => {\n      setState(subscribable.getState());\n    });\n  }, [subscribable]);\n\n  return subscribable.getState();\n};\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAGO,MAAM,kBAAkB,CAC7B;IAEA,MAAM,GAAG,SAAS,GAAG,IAAA,2JAAQ,EAAC,aAAa,QAAQ;IACnD,IAAA,6JAAS,EAAC;QACR,SAAS,aAAa,QAAQ;QAC9B,OAAO,aAAa,SAAS,CAAC;YAC5B,SAAS,aAAa,QAAQ;QAChC;IACF,GAAG;QAAC;KAAa;IAEjB,OAAO,aAAa,QAAQ;AAC9B"}},
    {"offset": {"line": 1930, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/client/thread-list-item-runtime-client.ts"],"sourcesContent":["import { resource, tapEffect } from \"@creatorem/ai-tap\";\nimport { type ClientOutput, tapAssistantEmit } from \"@creatorem/ai-store\";\nimport {\n  ThreadListItemEventType,\n  ThreadListItemRuntime,\n} from \"../runtime/thread-list-item-runtime\";\nimport { Unsubscribe } from \"../../types\";\nimport { tapSubscribable } from \"../util-hooks/tap-subscribable\";\n\nexport const ThreadListItemClient = resource(\n  ({\n    runtime,\n  }: {\n    runtime: ThreadListItemRuntime;\n  }): ClientOutput<\"threadListItem\"> => {\n    const state = tapSubscribable(runtime);\n    const emit = tapAssistantEmit();\n\n    // Bind thread list item events to event manager\n    tapEffect(() => {\n      const unsubscribers: Unsubscribe[] = [];\n\n      // Subscribe to thread list item events\n      const threadListItemEvents: ThreadListItemEventType[] = [\n        \"switchedTo\",\n        \"switchedAway\",\n      ];\n\n      for (const event of threadListItemEvents) {\n        const unsubscribe = runtime.unstable_on(event, () => {\n          emit(`threadListItem.${event}`, {\n            threadId: runtime.getState()!.id,\n          });\n        });\n        unsubscribers.push(unsubscribe);\n      }\n\n      return () => {\n        for (const unsub of unsubscribers) unsub();\n      };\n    }, [runtime, emit]);\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        switchTo: runtime.switchTo,\n        rename: runtime.rename,\n        archive: runtime.archive,\n        unarchive: runtime.unarchive,\n        delete: runtime.delete,\n        generateTitle: runtime.generateTitle,\n        initialize: runtime.initialize,\n        detach: runtime.detach,\n        __internal_getRuntime: () => runtime,\n      },\n    };\n  },\n);\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAMA;;;;AAEO,MAAM,uBAAuB,IAAA,sJAAQ,EAC1C,CAAC,EACC,OAAO,EAGR;IACC,MAAM,QAAQ,IAAA,wMAAe,EAAC;IAC9B,MAAM,OAAO,IAAA,oLAAgB;IAE7B,gDAAgD;IAChD,IAAA,6JAAS,EAAC;QACR,MAAM,gBAA+B,EAAE;QAEvC,uCAAuC;QACvC,MAAM,uBAAkD;YACtD;YACA;SACD;QAED,KAAK,MAAM,SAAS,qBAAsB;YACxC,MAAM,cAAc,QAAQ,WAAW,CAAC,OAAO;gBAC7C,KAAK,CAAC,eAAe,EAAE,OAAO,EAAE;oBAC9B,UAAU,QAAQ,QAAQ,GAAI,EAAE;gBAClC;YACF;YACA,cAAc,IAAI,CAAC;QACrB;QAEA,OAAO;YACL,KAAK,MAAM,SAAS,cAAe;QACrC;IACF,GAAG;QAAC;QAAS;KAAK;IAElB,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,UAAU,QAAQ,QAAQ;YAC1B,QAAQ,QAAQ,MAAM;YACtB,SAAS,QAAQ,OAAO;YACxB,WAAW,QAAQ,SAAS;YAC5B,QAAQ,QAAQ,MAAM;YACtB,eAAe,QAAQ,aAAa;YACpC,YAAY,QAAQ,UAAU;YAC9B,QAAQ,QAAQ,MAAM;YACtB,uBAAuB,IAAM;QAC/B;IACF;AACF"}},
    {"offset": {"line": 1987, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/client/attachment-runtime-client.ts"],"sourcesContent":["import { resource } from \"@creatorem/ai-tap\";\nimport { type ClientOutput } from \"@creatorem/ai-store\";\nimport { AttachmentRuntime } from \"../runtime\";\nimport { tapSubscribable } from \"../util-hooks/tap-subscribable\";\n\nexport const AttachmentRuntimeClient = resource(\n  ({ runtime }: { runtime: AttachmentRuntime }): ClientOutput<\"attachment\"> => {\n    const state = tapSubscribable(runtime);\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        remove: runtime.remove,\n        __internal_getRuntime: () => runtime,\n      },\n    };\n  },\n);\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEO,MAAM,0BAA0B,IAAA,sJAAQ,EAC7C,CAAC,EAAE,OAAO,EAAkC;IAC1C,MAAM,QAAQ,IAAA,wMAAe,EAAC;IAE9B,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,QAAQ,QAAQ,MAAM;YACtB,uBAAuB,IAAM;QAC/B;IACF;AACF"}},
    {"offset": {"line": 2010, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/client/composer-runtime-client.ts"],"sourcesContent":["import {\n  resource,\n  tapMemo,\n  tapEffect,\n  tapInlineResource,\n  type tapRef,\n  withKey,\n} from \"@creatorem/ai-tap\";\nimport {\n  type ClientOutput,\n  tapAssistantEmit,\n  tapClientLookup,\n} from \"@creatorem/ai-store\";\nimport {\n  ComposerRuntime,\n  EditComposerRuntime,\n} from \"../runtime/composer-runtime\";\nimport { Unsubscribe } from \"../../types\";\nimport { ComposerRuntimeEventType } from \"../runtime-cores/core/composer-runtime-core\";\nimport { ComposerState } from \"../../types/scopes\";\nimport { AttachmentRuntimeClient } from \"./attachment-runtime-client\";\nimport { tapSubscribable } from \"../util-hooks/tap-subscribable\";\n\nconst ComposerAttachmentClientByIndex = resource(\n  ({ runtime, index }: { runtime: ComposerRuntime; index: number }) => {\n    const attachmentRuntime = tapMemo(\n      () => runtime.getAttachmentByIndex(index),\n      [runtime, index],\n    );\n\n    return tapInlineResource(\n      AttachmentRuntimeClient({\n        runtime: attachmentRuntime,\n      }),\n    );\n  },\n);\n\nexport const ComposerClient = resource(\n  ({\n    threadIdRef,\n    messageIdRef,\n    runtime,\n  }: {\n    threadIdRef: tapRef.RefObject<string>;\n    messageIdRef?: tapRef.RefObject<string>;\n    runtime: ComposerRuntime;\n  }): ClientOutput<\"composer\"> => {\n    const runtimeState = tapSubscribable(runtime);\n    const emit = tapAssistantEmit();\n\n    // Bind composer events to event manager\n    tapEffect(() => {\n      const unsubscribers: Unsubscribe[] = [];\n\n      // Subscribe to composer events\n      const composerEvents: ComposerRuntimeEventType[] = [\n        \"send\",\n        \"attachmentAdd\",\n      ];\n\n      for (const event of composerEvents) {\n        const unsubscribe = runtime.unstable_on(event, () => {\n          emit(`composer.${event}`, {\n            threadId: threadIdRef.current,\n            ...(messageIdRef && { messageId: messageIdRef.current }),\n          });\n        });\n        unsubscribers.push(unsubscribe);\n      }\n\n      return () => {\n        for (const unsub of unsubscribers) unsub();\n      };\n    }, [runtime, emit, threadIdRef, messageIdRef]);\n\n    const attachments = tapClientLookup(\n      () =>\n        runtimeState.attachments.map((attachment, idx) =>\n          withKey(\n            attachment.id,\n            ComposerAttachmentClientByIndex({\n              runtime,\n              index: idx,\n            }),\n          ),\n        ),\n      [runtimeState.attachments, runtime],\n    );\n\n    const state = tapMemo<ComposerState>(() => {\n      return {\n        text: runtimeState.text,\n        role: runtimeState.role,\n        attachments: attachments.state,\n        runConfig: runtimeState.runConfig,\n        isEditing: runtimeState.isEditing,\n        canCancel: runtimeState.canCancel,\n        attachmentAccept: runtimeState.attachmentAccept,\n        isEmpty: runtimeState.isEmpty,\n        type: runtimeState.type ?? \"thread\",\n        dictation: runtimeState.dictation,\n      };\n    }, [runtimeState, attachments.state]);\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        setText: runtime.setText,\n        setRole: runtime.setRole,\n        setRunConfig: runtime.setRunConfig,\n        addAttachment: runtime.addAttachment,\n        reset: runtime.reset,\n        clearAttachments: runtime.clearAttachments,\n        send: runtime.send,\n        cancel: runtime.cancel,\n        beginEdit:\n          (runtime as EditComposerRuntime).beginEdit ??\n          (() => {\n            throw new Error(\"beginEdit is not supported in this runtime\");\n          }),\n        startDictation: runtime.startDictation,\n        stopDictation: runtime.stopDictation,\n        attachment: (selector) => {\n          if (\"id\" in selector) {\n            return attachments.get({ key: selector.id });\n          } else {\n            return attachments.get(selector);\n          }\n        },\n        __internal_getRuntime: () => runtime,\n      },\n    };\n  },\n);\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAYA;AACA;;;;;AAEA,MAAM,kCAAkC,IAAA,sJAAQ,EAC9C,CAAC,EAAE,OAAO,EAAE,KAAK,EAA+C;IAC9D,MAAM,oBAAoB,IAAA,yJAAO,EAC/B,IAAM,QAAQ,oBAAoB,CAAC,QACnC;QAAC;QAAS;KAAM;IAGlB,OAAO,IAAA,iLAAiB,EACtB,IAAA,qNAAuB,EAAC;QACtB,SAAS;IACX;AAEJ;AAGK,MAAM,iBAAiB,IAAA,sJAAQ,EACpC,CAAC,EACC,WAAW,EACX,YAAY,EACZ,OAAO,EAKR;IACC,MAAM,eAAe,IAAA,wMAAe,EAAC;IACrC,MAAM,OAAO,IAAA,oLAAgB;IAE7B,wCAAwC;IACxC,IAAA,6JAAS,EAAC;QACR,MAAM,gBAA+B,EAAE;QAEvC,+BAA+B;QAC/B,MAAM,iBAA6C;YACjD;YACA;SACD;QAED,KAAK,MAAM,SAAS,eAAgB;YAClC,MAAM,cAAc,QAAQ,WAAW,CAAC,OAAO;gBAC7C,KAAK,CAAC,SAAS,EAAE,OAAO,EAAE;oBACxB,UAAU,YAAY,OAAO;oBAC7B,GAAI,gBAAgB;wBAAE,WAAW,aAAa,OAAO;oBAAC,CAAC;gBACzD;YACF;YACA,cAAc,IAAI,CAAC;QACrB;QAEA,OAAO;YACL,KAAK,MAAM,SAAS,cAAe;QACrC;IACF,GAAG;QAAC;QAAS;QAAM;QAAa;KAAa;IAE7C,MAAM,cAAc,IAAA,sKAAe,EACjC,IACE,aAAa,WAAW,CAAC,GAAG,CAAC,CAAC,YAAY,MACxC,IAAA,wJAAO,EACL,WAAW,EAAE,EACb,gCAAgC;gBAC9B;gBACA,OAAO;YACT,MAGN;QAAC,aAAa,WAAW;QAAE;KAAQ;IAGrC,MAAM,QAAQ,IAAA,yJAAO,EAAgB;QACnC,OAAO;YACL,MAAM,aAAa,IAAI;YACvB,MAAM,aAAa,IAAI;YACvB,aAAa,YAAY,KAAK;YAC9B,WAAW,aAAa,SAAS;YACjC,WAAW,aAAa,SAAS;YACjC,WAAW,aAAa,SAAS;YACjC,kBAAkB,aAAa,gBAAgB;YAC/C,SAAS,aAAa,OAAO;YAC7B,MAAM,aAAa,IAAI,IAAI;YAC3B,WAAW,aAAa,SAAS;QACnC;IACF,GAAG;QAAC;QAAc,YAAY,KAAK;KAAC;IAEpC,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,SAAS,QAAQ,OAAO;YACxB,SAAS,QAAQ,OAAO;YACxB,cAAc,QAAQ,YAAY;YAClC,eAAe,QAAQ,aAAa;YACpC,OAAO,QAAQ,KAAK;YACpB,kBAAkB,QAAQ,gBAAgB;YAC1C,MAAM,QAAQ,IAAI;YAClB,QAAQ,QAAQ,MAAM;YACtB,WACE,AAAC,QAAgC,SAAS,IAC1C,CAAC;gBACC,MAAM,IAAI,MAAM;YAClB,CAAC;YACH,gBAAgB,QAAQ,cAAc;YACtC,eAAe,QAAQ,aAAa;YACpC,YAAY,CAAC;gBACX,IAAI,QAAQ,UAAU;oBACpB,OAAO,YAAY,GAAG,CAAC;wBAAE,KAAK,SAAS,EAAE;oBAAC;gBAC5C,OAAO;oBACL,OAAO,YAAY,GAAG,CAAC;gBACzB;YACF;YACA,uBAAuB,IAAM;QAC/B;IACF;AACF"}},
    {"offset": {"line": 2125, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/client/message-part-runtime-client.ts"],"sourcesContent":["import { resource } from \"@creatorem/ai-tap\";\nimport { type ClientOutput } from \"@creatorem/ai-store\";\nimport { MessagePartRuntime } from \"../runtime/message-part-runtime\";\nimport { tapSubscribable } from \"../util-hooks/tap-subscribable\";\n\nexport const MessagePartClient = resource(\n  ({ runtime }: { runtime: MessagePartRuntime }): ClientOutput<\"part\"> => {\n    const state = tapSubscribable(runtime);\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        addToolResult: (result) => runtime.addToolResult(result),\n        resumeToolCall: (payload) => runtime.resumeToolCall(payload),\n        __internal_getRuntime: () => runtime,\n      },\n    };\n  },\n);\n"],"names":[],"mappings":";;;;AAAA;AAGA;;;AAEO,MAAM,oBAAoB,IAAA,sJAAQ,EACvC,CAAC,EAAE,OAAO,EAAmC;IAC3C,MAAM,QAAQ,IAAA,wMAAe,EAAC;IAE9B,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,eAAe,CAAC,SAAW,QAAQ,aAAa,CAAC;YACjD,gBAAgB,CAAC,UAAY,QAAQ,cAAc,CAAC;YACpD,uBAAuB,IAAM;QAC/B;IACF;AACF"}},
    {"offset": {"line": 2149, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/client/message-runtime-client.ts"],"sourcesContent":["import {\n  withKey,\n  resource,\n  tapInlineResource,\n  tapMemo,\n  tapState,\n} from \"@creatorem/ai-tap\";\nimport {\n  type ClientOutput,\n  tapClientLookup,\n  tapClientResource,\n} from \"@creatorem/ai-store\";\nimport { MessageRuntime } from \"../runtime/message-runtime\";\nimport { tapSubscribable } from \"../util-hooks/tap-subscribable\";\nimport { ComposerClient } from \"./composer-runtime-client\";\nimport { MessagePartClient } from \"./message-part-runtime-client\";\nimport { RefObject } from \"react\";\nimport { MessageState } from \"../../types/scopes\";\nimport { AttachmentRuntimeClient } from \"./attachment-runtime-client\";\n\nconst MessageAttachmentClientByIndex = resource(\n  ({ runtime, index }: { runtime: MessageRuntime; index: number }) => {\n    const attachmentRuntime = tapMemo(\n      () => runtime.getAttachmentByIndex(index),\n      [runtime, index],\n    );\n    return tapInlineResource(\n      AttachmentRuntimeClient({ runtime: attachmentRuntime }),\n    );\n  },\n);\n\nconst MessagePartByIndex = resource(\n  ({ runtime, index }: { runtime: MessageRuntime; index: number }) => {\n    const partRuntime = tapMemo(\n      () => runtime.getMessagePartByIndex(index),\n      [runtime, index],\n    );\n    return tapInlineResource(MessagePartClient({ runtime: partRuntime }));\n  },\n);\n\nexport const MessageClient = resource(\n  ({\n    runtime,\n    threadIdRef,\n  }: {\n    runtime: MessageRuntime;\n    threadIdRef: RefObject<string>;\n  }): ClientOutput<\"message\"> => {\n    const runtimeState = tapSubscribable(runtime);\n\n    const [isCopiedState, setIsCopied] = tapState(false);\n    const [isHoveringState, setIsHovering] = tapState(false);\n\n    const messageIdRef = tapMemo(\n      () => ({\n        get current() {\n          return runtime.getState().id;\n        },\n      }),\n      [runtime],\n    );\n\n    const composer = tapClientResource(\n      ComposerClient({\n        runtime: runtime.composer,\n        threadIdRef,\n        messageIdRef,\n      }),\n    );\n\n    const parts = tapClientLookup(\n      () =>\n        runtimeState.content.map((part, idx) =>\n          withKey(\n            \"toolCallId\" in part && part.toolCallId != null\n              ? `toolCallId-${part.toolCallId}`\n              : `index-${idx}`,\n            MessagePartByIndex({ runtime, index: idx }),\n          ),\n        ),\n      [runtimeState.content, runtime],\n    );\n\n    const attachments = tapClientLookup(\n      () =>\n        (runtimeState.attachments ?? []).map((attachment, idx) =>\n          withKey(\n            attachment.id,\n            MessageAttachmentClientByIndex({ runtime, index: idx }),\n          ),\n        ),\n      [runtimeState.attachments, runtime],\n    );\n\n    const state = tapMemo<MessageState>(() => {\n      return {\n        ...(runtimeState as MessageState),\n\n        parts: parts.state,\n        composer: composer.state,\n\n        isCopied: isCopiedState,\n        isHovering: isHoveringState,\n      };\n    }, [\n      runtimeState,\n      parts.state,\n      composer.state,\n      isCopiedState,\n      isHoveringState,\n    ]);\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n\n        composer: composer.methods,\n\n        reload: (config) => runtime.reload(config),\n        speak: () => runtime.speak(),\n        stopSpeaking: () => runtime.stopSpeaking(),\n        submitFeedback: (feedback) => runtime.submitFeedback(feedback),\n        switchToBranch: (options) => runtime.switchToBranch(options),\n        getCopyText: () => runtime.unstable_getCopyText(),\n        part: (selector) => {\n          if (\"index\" in selector) {\n            return parts.get({ index: selector.index });\n          } else {\n            return parts.get({ key: `toolCallId-${selector.toolCallId}` });\n          }\n        },\n\n        attachment: (selector) => {\n          if (\"id\" in selector) {\n            return attachments.get({ key: selector.id });\n          } else {\n            return attachments.get(selector);\n          }\n        },\n\n        setIsCopied,\n        setIsHovering,\n\n        __internal_getRuntime: () => runtime,\n      },\n    };\n  },\n);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2274, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/client/thread-runtime-client.ts"],"sourcesContent":["import { ThreadRuntimeEventType } from \"../runtime-cores/core/thread-runtime-core\";\nimport { ThreadRuntime } from \"../runtime/thread-runtime\";\nimport {\n  resource,\n  tapInlineResource,\n  tapMemo,\n  tapEffect,\n  type tapRef,\n  withKey,\n} from \"@creatorem/ai-tap\";\nimport {\n  type ClientOutput,\n  tapAssistantEmit,\n  tapClientLookup,\n  tapClientResource,\n} from \"@creatorem/ai-store\";\nimport { ComposerClient } from \"./composer-runtime-client\";\nimport { MessageClient } from \"./message-runtime-client\";\nimport { tapSubscribable } from \"../util-hooks/tap-subscribable\";\nimport { Unsubscribe } from \"../../types\";\nimport { ThreadState } from \"../../types/scopes\";\n\nconst MessageClientById = resource(\n  ({\n    runtime,\n    id,\n    threadIdRef,\n  }: {\n    runtime: ThreadRuntime;\n    id: string;\n    threadIdRef: tapRef.RefObject<string>;\n  }) => {\n    const messageRuntime = tapMemo(\n      () => runtime.getMessageById(id),\n      [runtime, id],\n    );\n\n    return tapInlineResource(\n      MessageClient({ runtime: messageRuntime, threadIdRef }),\n    );\n  },\n);\n\nexport const ThreadClient = resource(\n  ({ runtime }: { runtime: ThreadRuntime }): ClientOutput<\"thread\"> => {\n    const runtimeState = tapSubscribable(runtime);\n    const emit = tapAssistantEmit();\n\n    // Bind thread events to event manager\n    tapEffect(() => {\n      const unsubscribers: Unsubscribe[] = [];\n\n      // Subscribe to thread events\n      const threadEvents: ThreadRuntimeEventType[] = [\n        \"runStart\",\n        \"runEnd\",\n        \"initialize\",\n        \"modelContextUpdate\",\n      ];\n\n      for (const event of threadEvents) {\n        const unsubscribe = runtime.unstable_on(event, () => {\n          const threadId = runtime.getState()?.threadId || \"unknown\";\n          emit(`thread.${event}`, {\n            threadId,\n          });\n        });\n        unsubscribers.push(unsubscribe);\n      }\n\n      return () => {\n        for (const unsub of unsubscribers) unsub();\n      };\n    }, [runtime, emit]);\n\n    const threadIdRef = tapMemo(\n      () => ({\n        get current() {\n          return runtime.getState()!.threadId;\n        },\n      }),\n      [runtime],\n    );\n\n    const composer = tapClientResource(\n      ComposerClient({\n        runtime: runtime.composer,\n        threadIdRef,\n      }),\n    );\n\n    const messages = tapClientLookup(\n      () =>\n        runtimeState.messages.map((m) =>\n          withKey(m.id, MessageClientById({ runtime, id: m.id, threadIdRef })),\n        ),\n      [runtimeState.messages, runtime, threadIdRef],\n    );\n\n    const state = tapMemo<ThreadState>(() => {\n      return {\n        isEmpty: messages.state.length === 0 && !runtimeState.isLoading,\n        isDisabled: runtimeState.isDisabled,\n        isLoading: runtimeState.isLoading,\n        isRunning: runtimeState.isRunning,\n        capabilities: runtimeState.capabilities,\n        state: runtimeState.state,\n        suggestions: runtimeState.suggestions,\n        extras: runtimeState.extras,\n        speech: runtimeState.speech,\n\n        composer: composer.state,\n        messages: messages.state,\n      };\n    }, [runtimeState, messages, composer.state]);\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        composer: composer.methods,\n        append: runtime.append,\n        startRun: runtime.startRun,\n        unstable_resumeRun: runtime.unstable_resumeRun,\n        cancelRun: runtime.cancelRun,\n        getModelContext: runtime.getModelContext,\n        export: runtime.export,\n        import: runtime.import,\n        reset: runtime.reset,\n        stopSpeaking: runtime.stopSpeaking,\n        startVoice: async () => {\n          throw new Error(\"startVoice is not supported in this runtime\");\n        },\n        stopVoice: async () => {\n          throw new Error(\"stopVoice is not supported in this runtime\");\n        },\n        message: (selector) => {\n          if (\"id\" in selector) {\n            return messages.get({ key: selector.id });\n          } else {\n            return messages.get(selector);\n          }\n        },\n        __internal_getRuntime: () => runtime,\n      },\n    };\n  },\n);\n"],"names":[],"mappings":";;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAMA;AACA;AACA;;;;;;AAIA,MAAM,oBAAoB,IAAA,sJAAQ,EAChC,CAAC,EACC,OAAO,EACP,EAAE,EACF,WAAW,EAKZ;IACC,MAAM,iBAAiB,IAAA,yJAAO,EAC5B,IAAM,QAAQ,cAAc,CAAC,KAC7B;QAAC;QAAS;KAAG;IAGf,OAAO,IAAA,iLAAiB,EACtB,IAAA,wMAAa,EAAC;QAAE,SAAS;QAAgB;IAAY;AAEzD;AAGK,MAAM,eAAe,IAAA,sJAAQ,EAClC,CAAC,EAAE,OAAO,EAA8B;IACtC,MAAM,eAAe,IAAA,wMAAe,EAAC;IACrC,MAAM,OAAO,IAAA,oLAAgB;IAE7B,sCAAsC;IACtC,IAAA,6JAAS,EAAC;QACR,MAAM,gBAA+B,EAAE;QAEvC,6BAA6B;QAC7B,MAAM,eAAyC;YAC7C;YACA;YACA;YACA;SACD;QAED,KAAK,MAAM,SAAS,aAAc;YAChC,MAAM,cAAc,QAAQ,WAAW,CAAC,OAAO;gBAC7C,MAAM,WAAW,QAAQ,QAAQ,IAAI,YAAY;gBACjD,KAAK,CAAC,OAAO,EAAE,OAAO,EAAE;oBACtB;gBACF;YACF;YACA,cAAc,IAAI,CAAC;QACrB;QAEA,OAAO;YACL,KAAK,MAAM,SAAS,cAAe;QACrC;IACF,GAAG;QAAC;QAAS;KAAK;IAElB,MAAM,cAAc,IAAA,yJAAO,EACzB,IAAM,CAAC;YACL,IAAI,WAAU;gBACZ,OAAO,QAAQ,QAAQ,GAAI,QAAQ;YACrC;QACF,CAAC,GACD;QAAC;KAAQ;IAGX,MAAM,WAAW,IAAA,0KAAiB,EAChC,IAAA,0MAAc,EAAC;QACb,SAAS,QAAQ,QAAQ;QACzB;IACF;IAGF,MAAM,WAAW,IAAA,sKAAe,EAC9B,IACE,aAAa,QAAQ,CAAC,GAAG,CAAC,CAAC,IACzB,IAAA,wJAAO,EAAC,EAAE,EAAE,EAAE,kBAAkB;gBAAE;gBAAS,IAAI,EAAE,EAAE;gBAAE;YAAY,MAErE;QAAC,aAAa,QAAQ;QAAE;QAAS;KAAY;IAG/C,MAAM,QAAQ,IAAA,yJAAO,EAAc;QACjC,OAAO;YACL,SAAS,SAAS,KAAK,CAAC,MAAM,KAAK,KAAK,CAAC,aAAa,SAAS;YAC/D,YAAY,aAAa,UAAU;YACnC,WAAW,aAAa,SAAS;YACjC,WAAW,aAAa,SAAS;YACjC,cAAc,aAAa,YAAY;YACvC,OAAO,aAAa,KAAK;YACzB,aAAa,aAAa,WAAW;YACrC,QAAQ,aAAa,MAAM;YAC3B,QAAQ,aAAa,MAAM;YAE3B,UAAU,SAAS,KAAK;YACxB,UAAU,SAAS,KAAK;QAC1B;IACF,GAAG;QAAC;QAAc;QAAU,SAAS,KAAK;KAAC;IAE3C,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,UAAU,SAAS,OAAO;YAC1B,QAAQ,QAAQ,MAAM;YACtB,UAAU,QAAQ,QAAQ;YAC1B,oBAAoB,QAAQ,kBAAkB;YAC9C,WAAW,QAAQ,SAAS;YAC5B,iBAAiB,QAAQ,eAAe;YACxC,QAAQ,QAAQ,MAAM;YACtB,QAAQ,QAAQ,MAAM;YACtB,OAAO,QAAQ,KAAK;YACpB,cAAc,QAAQ,YAAY;YAClC,YAAY;gBACV,MAAM,IAAI,MAAM;YAClB;YACA,WAAW;gBACT,MAAM,IAAI,MAAM;YAClB;YACA,SAAS,CAAC;gBACR,IAAI,QAAQ,UAAU;oBACpB,OAAO,SAAS,GAAG,CAAC;wBAAE,KAAK,SAAS,EAAE;oBAAC;gBACzC,OAAO;oBACL,OAAO,SAAS,GAAG,CAAC;gBACtB;YACF;YACA,uBAAuB,IAAM;QAC/B;IACF;AACF"}},
    {"offset": {"line": 2409, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/client/thread-list-runtime-client.ts"],"sourcesContent":["import {\n  withKey,\n  resource,\n  tapInlineResource,\n  tapMemo,\n} from \"@creatorem/ai-tap\";\nimport {\n  type ClientOutput,\n  tapClientLookup,\n  tapClientResource,\n} from \"@creatorem/ai-store\";\nimport { ThreadListRuntime } from \"../runtime/thread-list-runtime\";\nimport { tapSubscribable } from \"../util-hooks/tap-subscribable\";\nimport { ThreadListItemClient } from \"./thread-list-item-runtime-client\";\nimport { ThreadClient } from \"./thread-runtime-client\";\nimport { ThreadsState } from \"../../types/scopes\";\nimport type { AssistantRuntime } from \"../runtime/assistant-runtime\";\n\nconst ThreadListItemClientById = resource(\n  ({ runtime, id }: { runtime: ThreadListRuntime; id: string }) => {\n    const threadListItemRuntime = tapMemo(\n      () => runtime.getItemById(id),\n      [runtime, id],\n    );\n    return tapInlineResource(\n      ThreadListItemClient({\n        runtime: threadListItemRuntime,\n      }),\n    );\n  },\n);\n\nexport const ThreadListClient = resource(\n  ({\n    runtime,\n    __internal_assistantRuntime,\n  }: {\n    runtime: ThreadListRuntime;\n    __internal_assistantRuntime: AssistantRuntime;\n  }): ClientOutput<\"threads\"> => {\n    const runtimeState = tapSubscribable(runtime);\n\n    const main = tapClientResource(\n      ThreadClient({\n        runtime: runtime.main,\n      }),\n    );\n\n    const threadItems = tapClientLookup(\n      () =>\n        Object.keys(runtimeState.threadItems).map((id) =>\n          withKey(id, ThreadListItemClientById({ runtime, id })),\n        ),\n      [runtimeState.threadItems, runtime],\n    );\n\n    const state = tapMemo<ThreadsState>(() => {\n      return {\n        mainThreadId: runtimeState.mainThreadId,\n        newThreadId: runtimeState.newThreadId ?? null,\n        isLoading: runtimeState.isLoading,\n        threadIds: runtimeState.threadIds,\n        archivedThreadIds: runtimeState.archivedThreadIds,\n        threadItems: threadItems.state,\n\n        main: main.state,\n      };\n    }, [runtimeState, threadItems.state, main.state]);\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        thread: () => main.methods,\n        item: (threadIdOrOptions) => {\n          if (threadIdOrOptions === \"main\") {\n            return threadItems.get({ key: state.mainThreadId });\n          }\n\n          if (\"id\" in threadIdOrOptions) {\n            return threadItems.get({ key: threadIdOrOptions.id });\n          }\n\n          const { index, archived = false } = threadIdOrOptions;\n          const id = archived\n            ? state.archivedThreadIds[index]!\n            : state.threadIds[index]!;\n          return threadItems.get({ key: id });\n        },\n        switchToThread: async (threadId) => {\n          await runtime.switchToThread(threadId);\n        },\n        switchToNewThread: async () => {\n          await runtime.switchToNewThread();\n        },\n        __internal_getAssistantRuntime: () => __internal_assistantRuntime,\n      },\n    };\n  },\n);\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAMA;AACA;AACA;;;;;;AAIA,MAAM,2BAA2B,IAAA,sJAAQ,EACvC,CAAC,EAAE,OAAO,EAAE,EAAE,EAA8C;IAC1D,MAAM,wBAAwB,IAAA,yJAAO,EACnC,IAAM,QAAQ,WAAW,CAAC,KAC1B;QAAC;QAAS;KAAG;IAEf,OAAO,IAAA,iLAAiB,EACtB,IAAA,8NAAoB,EAAC;QACnB,SAAS;IACX;AAEJ;AAGK,MAAM,mBAAmB,IAAA,sJAAQ,EACtC,CAAC,EACC,OAAO,EACP,2BAA2B,EAI5B;IACC,MAAM,eAAe,IAAA,wMAAe,EAAC;IAErC,MAAM,OAAO,IAAA,0KAAiB,EAC5B,IAAA,sMAAY,EAAC;QACX,SAAS,QAAQ,IAAI;IACvB;IAGF,MAAM,cAAc,IAAA,sKAAe,EACjC,IACE,OAAO,IAAI,CAAC,aAAa,WAAW,EAAE,GAAG,CAAC,CAAC,KACzC,IAAA,wJAAO,EAAC,IAAI,yBAAyB;gBAAE;gBAAS;YAAG,MAEvD;QAAC,aAAa,WAAW;QAAE;KAAQ;IAGrC,MAAM,QAAQ,IAAA,yJAAO,EAAe;QAClC,OAAO;YACL,cAAc,aAAa,YAAY;YACvC,aAAa,aAAa,WAAW,IAAI;YACzC,WAAW,aAAa,SAAS;YACjC,WAAW,aAAa,SAAS;YACjC,mBAAmB,aAAa,iBAAiB;YACjD,aAAa,YAAY,KAAK;YAE9B,MAAM,KAAK,KAAK;QAClB;IACF,GAAG;QAAC;QAAc,YAAY,KAAK;QAAE,KAAK,KAAK;KAAC;IAEhD,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,QAAQ,IAAM,KAAK,OAAO;YAC1B,MAAM,CAAC;gBACL,IAAI,sBAAsB,QAAQ;oBAChC,OAAO,YAAY,GAAG,CAAC;wBAAE,KAAK,MAAM,YAAY;oBAAC;gBACnD;gBAEA,IAAI,QAAQ,mBAAmB;oBAC7B,OAAO,YAAY,GAAG,CAAC;wBAAE,KAAK,kBAAkB,EAAE;oBAAC;gBACrD;gBAEA,MAAM,EAAE,KAAK,EAAE,WAAW,KAAK,EAAE,GAAG;gBACpC,MAAM,KAAK,WACP,MAAM,iBAAiB,CAAC,MAAM,GAC9B,MAAM,SAAS,CAAC,MAAM;gBAC1B,OAAO,YAAY,GAAG,CAAC;oBAAE,KAAK;gBAAG;YACnC;YACA,gBAAgB,OAAO;gBACrB,MAAM,QAAQ,cAAc,CAAC;YAC/B;YACA,mBAAmB;gBACjB,MAAM,QAAQ,iBAAiB;YACjC;YACA,gCAAgC,IAAM;QACxC;IACF;AACF"}},
    {"offset": {"line": 2499, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/model-context/model-context-types.ts"],"sourcesContent":["import { Unsubscribe } from \"../types/unsubscribe\";\nimport { Tool } from \"assistant-stream\";\n\nexport type LanguageModelV1CallSettings = {\n  maxTokens?: number;\n  temperature?: number;\n  topP?: number;\n  presencePenalty?: number;\n  frequencyPenalty?: number;\n  seed?: number;\n  headers?: Record<string, string | undefined>;\n};\n\nexport type LanguageModelConfig = {\n  apiKey?: string;\n  baseUrl?: string;\n  modelName?: string;\n};\n\nexport type ModelContext = {\n  priority?: number | undefined;\n  system?: string | undefined;\n  tools?: Record<string, Tool<any, any>> | undefined;\n  callSettings?: LanguageModelV1CallSettings | undefined;\n  config?: LanguageModelConfig | undefined;\n};\n\nexport type ModelContextProvider = {\n  getModelContext: () => ModelContext;\n  subscribe?: (callback: () => void) => Unsubscribe;\n};\n\nexport const mergeModelContexts = (\n  configSet: Set<ModelContextProvider>,\n): ModelContext => {\n  const configs = Array.from(configSet)\n    .map((c) => c.getModelContext())\n    .sort((a, b) => (b.priority ?? 0) - (a.priority ?? 0));\n\n  return configs.reduce((acc, config) => {\n    if (config.system) {\n      if (acc.system) {\n        // TODO should the separator be configurable?\n        acc.system += `\\n\\n${config.system}`;\n      } else {\n        acc.system = config.system;\n      }\n    }\n    if (config.tools) {\n      for (const [name, tool] of Object.entries(config.tools)) {\n        const existing = acc.tools?.[name];\n        if (existing && existing !== tool) {\n          throw new Error(\n            `You tried to define a tool with the name ${name}, but it already exists.`,\n          );\n        }\n\n        if (!acc.tools) acc.tools = {};\n        acc.tools[name] = tool;\n      }\n    }\n    if (config.config) {\n      acc.config = {\n        ...acc.config,\n        ...config.config,\n      };\n    }\n    if (config.callSettings) {\n      acc.callSettings = {\n        ...acc.callSettings,\n        ...config.callSettings,\n      };\n    }\n    return acc;\n  }, {} as ModelContext);\n};\n"],"names":[],"mappings":";;;;AAgCO,MAAM,qBAAqB,CAChC;IAEA,MAAM,UAAU,MAAM,IAAI,CAAC,WACxB,GAAG,CAAC,CAAC,IAAM,EAAE,eAAe,IAC5B,IAAI,CAAC,CAAC,GAAG,IAAM,CAAC,EAAE,QAAQ,IAAI,CAAC,IAAI,CAAC,EAAE,QAAQ,IAAI,CAAC;IAEtD,OAAO,QAAQ,MAAM,CAAC,CAAC,KAAK;QAC1B,IAAI,OAAO,MAAM,EAAE;YACjB,IAAI,IAAI,MAAM,EAAE;gBACd,6CAA6C;gBAC7C,IAAI,MAAM,IAAI,CAAC,IAAI,EAAE,OAAO,MAAM,EAAE;YACtC,OAAO;gBACL,IAAI,MAAM,GAAG,OAAO,MAAM;YAC5B;QACF;QACA,IAAI,OAAO,KAAK,EAAE;YAChB,KAAK,MAAM,CAAC,MAAM,KAAK,IAAI,OAAO,OAAO,CAAC,OAAO,KAAK,EAAG;gBACvD,MAAM,WAAW,IAAI,KAAK,EAAE,CAAC,KAAK;gBAClC,IAAI,YAAY,aAAa,MAAM;oBACjC,MAAM,IAAI,MACR,CAAC,yCAAyC,EAAE,KAAK,wBAAwB,CAAC;gBAE9E;gBAEA,IAAI,CAAC,IAAI,KAAK,EAAE,IAAI,KAAK,GAAG,CAAC;gBAC7B,IAAI,KAAK,CAAC,KAAK,GAAG;YACpB;QACF;QACA,IAAI,OAAO,MAAM,EAAE;YACjB,IAAI,MAAM,GAAG;gBACX,GAAG,IAAI,MAAM;gBACb,GAAG,OAAO,MAAM;YAClB;QACF;QACA,IAAI,OAAO,YAAY,EAAE;YACvB,IAAI,YAAY,GAAG;gBACjB,GAAG,IAAI,YAAY;gBACnB,GAAG,OAAO,YAAY;YACxB;QACF;QACA,OAAO;IACT,GAAG,CAAC;AACN"}},
    {"offset": {"line": 2543, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/composite-context-provider.ts"],"sourcesContent":["import {\n  type ModelContextProvider,\n  mergeModelContexts,\n} from \"../model-context/model-context-types\";\n\nexport class CompositeContextProvider implements ModelContextProvider {\n  private _providers = new Set<ModelContextProvider>();\n\n  getModelContext() {\n    return mergeModelContexts(this._providers);\n  }\n\n  registerModelContextProvider(provider: ModelContextProvider) {\n    this._providers.add(provider);\n    const unsubscribe = provider.subscribe?.(() => {\n      this.notifySubscribers();\n    });\n    this.notifySubscribers();\n    return () => {\n      this._providers.delete(provider);\n      unsubscribe?.();\n      this.notifySubscribers();\n    };\n  }\n\n  private _subscribers = new Set<() => void>();\n\n  notifySubscribers() {\n    for (const callback of this._subscribers) callback();\n  }\n\n  subscribe(callback: () => void) {\n    this._subscribers.add(callback);\n    return () => this._subscribers.delete(callback);\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAKO,MAAM;IACH,aAAa,IAAI,MAA4B;IAErD,kBAAkB;QAChB,OAAO,IAAA,+LAAkB,EAAC,IAAI,CAAC,UAAU;IAC3C;IAEA,6BAA6B,QAA8B,EAAE;QAC3D,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC;QACpB,MAAM,cAAc,SAAS,SAAS,GAAG;YACvC,IAAI,CAAC,iBAAiB;QACxB;QACA,IAAI,CAAC,iBAAiB;QACtB,OAAO;YACL,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC;YACvB;YACA,IAAI,CAAC,iBAAiB;QACxB;IACF;IAEQ,eAAe,IAAI,MAAkB;IAE7C,oBAAoB;QAClB,KAAK,MAAM,YAAY,IAAI,CAAC,YAAY,CAAE;IAC5C;IAEA,UAAU,QAAoB,EAAE;QAC9B,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC;QACtB,OAAO,IAAM,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;IACxC;AACF"}},
    {"offset": {"line": 2579, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/client/model-context-client.ts"],"sourcesContent":["import { resource, tapMemo, tapState } from \"@creatorem/ai-tap\";\nimport { type ClientOutput } from \"@creatorem/ai-store\";\nimport { CompositeContextProvider } from \"../utils/composite-context-provider\";\nimport type { ModelContextState } from \"../types/scopes\";\n\nconst version = 1;\n\nexport const ModelContext = resource((): ClientOutput<\"modelContext\"> => {\n  const [state] = tapState<ModelContextState>(\n    () => ({ version: version + 1 }) as unknown as ModelContextState,\n  );\n  const composite = tapMemo(() => new CompositeContextProvider(), []);\n\n  return {\n    state,\n    methods: {\n      getState: () => state,\n      getModelContext: () => composite.getModelContext(),\n      subscribe: (callback) => composite.subscribe(callback),\n      register: (provider) => composite.registerModelContextProvider(provider),\n    },\n  };\n});\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAEA;;;AAGA,MAAM,UAAU;AAET,MAAM,eAAe,IAAA,sJAAQ,EAAC;IACnC,MAAM,CAAC,MAAM,GAAG,IAAA,2JAAQ,EACtB,IAAM,CAAC;YAAE,SAAS,UAAU;QAAE,CAAC;IAEjC,MAAM,YAAY,IAAA,yJAAO,EAAC,IAAM,IAAI,iMAAwB,IAAI,EAAE;IAElE,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,iBAAiB,IAAM,UAAU,eAAe;YAChD,WAAW,CAAC,WAAa,UAAU,SAAS,CAAC;YAC7C,UAAU,CAAC,WAAa,UAAU,4BAA4B,CAAC;QACjE;IACF;AACF"}},
    {"offset": {"line": 2609, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/client/tools.ts"],"sourcesContent":["import { resource, tapState, tapEffect, tapCallback } from \"@creatorem/ai-tap\";\nimport {\n  tapAssistantClientRef,\n  type ClientOutput,\n  attachDefaultPeers,\n} from \"@creatorem/ai-store\";\nimport { ToolsState } from \"../types/scopes\";\nimport type { Tool } from \"assistant-stream\";\nimport { type Toolkit } from \"../model-context/toolbox\";\nimport { ToolCallMessagePartComponent } from \"../types\";\nimport { ModelContext } from \"./model-context-client\";\n\nexport const Tools = resource(\n  ({ toolkit }: { toolkit?: Toolkit }): ClientOutput<\"tools\"> => {\n    const [state, setState] = tapState<ToolsState>(() => ({\n      tools: {},\n    }));\n\n    const clientRef = tapAssistantClientRef();\n\n    const setToolUI = tapCallback(\n      (toolName: string, render: ToolCallMessagePartComponent) => {\n        setState((prev) => {\n          return {\n            ...prev,\n            tools: {\n              ...prev.tools,\n              [toolName]: [...(prev.tools[toolName] ?? []), render],\n            },\n          };\n        });\n\n        return () => {\n          setState((prev) => {\n            return {\n              ...prev,\n              tools: {\n                ...prev.tools,\n                [toolName]:\n                  prev.tools[toolName]?.filter((r) => r !== render) ?? [],\n              },\n            };\n          });\n        };\n      },\n      [],\n    );\n\n    tapEffect(() => {\n      if (!toolkit) return;\n      const unsubscribes: (() => void)[] = [];\n\n      // Register tool UIs (exclude symbols)\n      for (const [toolName, tool] of Object.entries(toolkit)) {\n        if (tool.render) {\n          unsubscribes.push(setToolUI(toolName, tool.render));\n        }\n      }\n\n      // Register tools with model context (exclude symbols)\n      const toolsWithoutRender = Object.entries(toolkit).reduce(\n        (acc, [name, tool]) => {\n          const { render, ...rest } = tool;\n          acc[name] = rest;\n          return acc;\n        },\n        {} as Record<string, Tool<any, any>>,\n      );\n\n      const modelContextProvider = {\n        getModelContext: () => ({\n          tools: toolsWithoutRender,\n        }),\n      };\n\n      unsubscribes.push(\n        clientRef.current!.modelContext().register(modelContextProvider),\n      );\n\n      return () => {\n        unsubscribes.forEach((fn) => fn());\n      };\n    }, [toolkit, setToolUI, clientRef]);\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        setToolUI,\n      },\n    };\n  },\n);\n\nattachDefaultPeers(Tools, {\n  modelContext: ModelContext(),\n});\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AASA;;;;AAEO,MAAM,QAAQ,IAAA,sJAAQ,EAC3B,CAAC,EAAE,OAAO,EAAyB;IACjC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,2JAAQ,EAAa,IAAM,CAAC;YACpD,OAAO,CAAC;QACV,CAAC;IAED,MAAM,YAAY,IAAA,yLAAqB;IAEvC,MAAM,YAAY,IAAA,iKAAW,EAC3B,CAAC,UAAkB;QACjB,SAAS,CAAC;YACR,OAAO;gBACL,GAAG,IAAI;gBACP,OAAO;oBACL,GAAG,KAAK,KAAK;oBACb,CAAC,SAAS,EAAE;2BAAK,KAAK,KAAK,CAAC,SAAS,IAAI,EAAE;wBAAG;qBAAO;gBACvD;YACF;QACF;QAEA,OAAO;YACL,SAAS,CAAC;gBACR,OAAO;oBACL,GAAG,IAAI;oBACP,OAAO;wBACL,GAAG,KAAK,KAAK;wBACb,CAAC,SAAS,EACR,KAAK,KAAK,CAAC,SAAS,EAAE,OAAO,CAAC,IAAM,MAAM,WAAW,EAAE;oBAC3D;gBACF;YACF;QACF;IACF,GACA,EAAE;IAGJ,IAAA,6JAAS,EAAC;QACR,IAAI,CAAC,SAAS;QACd,MAAM,eAA+B,EAAE;QAEvC,sCAAsC;QACtC,KAAK,MAAM,CAAC,UAAU,KAAK,IAAI,OAAO,OAAO,CAAC,SAAU;YACtD,IAAI,KAAK,MAAM,EAAE;gBACf,aAAa,IAAI,CAAC,UAAU,UAAU,KAAK,MAAM;YACnD;QACF;QAEA,sDAAsD;QACtD,MAAM,qBAAqB,OAAO,OAAO,CAAC,SAAS,MAAM,CACvD,CAAC,KAAK,CAAC,MAAM,KAAK;YAChB,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,GAAG;YAC5B,GAAG,CAAC,KAAK,GAAG;YACZ,OAAO;QACT,GACA,CAAC;QAGH,MAAM,uBAAuB;YAC3B,iBAAiB,IAAM,CAAC;oBACtB,OAAO;gBACT,CAAC;QACH;QAEA,aAAa,IAAI,CACf,UAAU,OAAO,CAAE,YAAY,GAAG,QAAQ,CAAC;QAG7C,OAAO;YACL,aAAa,OAAO,CAAC,CAAC,KAAO;QAC/B;IACF,GAAG;QAAC;QAAS;QAAW;KAAU;IAElC,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB;QACF;IACF;AACF;AAGF,IAAA,4KAAkB,EAAC,OAAO;IACxB,cAAc,IAAA,gLAAY;AAC5B"}},
    {"offset": {"line": 2697, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/client/suggestions.ts"],"sourcesContent":["import { resource, tapState, withKey } from \"@creatorem/ai-tap\";\nimport { type ClientOutput, tapClientLookup } from \"@creatorem/ai-store\";\nimport type { SuggestionsState, SuggestionState } from \"../types/scopes\";\n\nexport type SuggestionConfig =\n  | string\n  | { title: string; label: string; prompt: string };\n\nconst SuggestionClient = resource(\n  (state: SuggestionState): ClientOutput<\"suggestion\"> => {\n    return {\n      state,\n      methods: {\n        getState: () => state,\n      },\n    };\n  },\n);\n\nconst SuggestionsResource = resource(\n  (suggestions?: SuggestionConfig[]): ClientOutput<\"suggestions\"> => {\n    const [state] = tapState<SuggestionsState>(() => {\n      const normalizedSuggestions = (suggestions ?? []).map((s) => {\n        if (typeof s === \"string\") {\n          return {\n            title: s,\n            label: \"\",\n            prompt: s,\n          };\n        }\n        return {\n          title: s.title,\n          label: s.label,\n          prompt: s.prompt,\n        };\n      });\n\n      return {\n        suggestions: normalizedSuggestions,\n      };\n    });\n\n    const suggestionClients = tapClientLookup(\n      () =>\n        state.suggestions.map((suggestion, index) =>\n          withKey(index, SuggestionClient(suggestion)),\n        ),\n      [state.suggestions],\n    );\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        suggestion: ({ index }: { index: number }) => {\n          return suggestionClients.get({ index });\n        },\n      },\n    };\n  },\n);\n\nexport const Suggestions: {\n  (): import(\"@creatorem/ai-tap\").ResourceElement<\n    ClientOutput<\"suggestions\">,\n    undefined\n  >;\n  (\n    suggestions: SuggestionConfig[],\n  ): import(\"@creatorem/ai-tap\").ResourceElement<\n    ClientOutput<\"suggestions\">,\n    SuggestionConfig[]\n  >;\n} = SuggestionsResource as any;\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AACA;;;AAOA,MAAM,mBAAmB,IAAA,sJAAQ,EAC/B,CAAC;IACC,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;QAClB;IACF;AACF;AAGF,MAAM,sBAAsB,IAAA,sJAAQ,EAClC,CAAC;IACC,MAAM,CAAC,MAAM,GAAG,IAAA,2JAAQ,EAAmB;QACzC,MAAM,wBAAwB,CAAC,eAAe,EAAE,EAAE,GAAG,CAAC,CAAC;YACrD,IAAI,OAAO,MAAM,UAAU;gBACzB,OAAO;oBACL,OAAO;oBACP,OAAO;oBACP,QAAQ;gBACV;YACF;YACA,OAAO;gBACL,OAAO,EAAE,KAAK;gBACd,OAAO,EAAE,KAAK;gBACd,QAAQ,EAAE,MAAM;YAClB;QACF;QAEA,OAAO;YACL,aAAa;QACf;IACF;IAEA,MAAM,oBAAoB,IAAA,sKAAe,EACvC,IACE,MAAM,WAAW,CAAC,GAAG,CAAC,CAAC,YAAY,QACjC,IAAA,wJAAO,EAAC,OAAO,iBAAiB,eAEpC;QAAC,MAAM,WAAW;KAAC;IAGrB,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,YAAY,CAAC,EAAE,KAAK,EAAqB;gBACvC,OAAO,kBAAkB,GAAG,CAAC;oBAAE;gBAAM;YACvC;QACF;IACF;AACF;AAGK,MAAM,cAWT"}},
    {"offset": {"line": 2755, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-adapter.ts"],"sourcesContent":["import { resource, tapEffect, tapInlineResource } from \"@creatorem/ai-tap\";\nimport type { AssistantRuntime } from \"./runtime/assistant-runtime\";\nimport { ThreadListClient } from \"./client/thread-list-runtime-client\";\nimport {\n  tapAssistantClientRef,\n  Derived,\n  attachDefaultPeers,\n} from \"@creatorem/ai-store\";\nimport { ModelContext } from \"../client/model-context-client\";\nimport { Tools, Suggestions } from \"../model-context\";\n\nexport const RuntimeAdapter = resource((runtime: AssistantRuntime) => {\n  const clientRef = tapAssistantClientRef();\n\n  tapEffect(() => {\n    return runtime.registerModelContextProvider(\n      clientRef.current!.modelContext(),\n    );\n  }, [runtime, clientRef]);\n\n  return tapInlineResource(\n    ThreadListClient({\n      runtime: runtime.threads,\n      __internal_assistantRuntime: runtime,\n    }),\n  );\n});\n\nattachDefaultPeers(RuntimeAdapter, {\n  modelContext: ModelContext(),\n  tools: Tools({}),\n  suggestions: Suggestions(),\n  threadListItem: Derived({\n    source: \"threads\",\n    query: { type: \"main\" },\n    get: (aui) => aui.threads().item(\"main\"),\n  }),\n  thread: Derived({\n    source: \"threads\",\n    query: { type: \"main\" },\n    get: (aui) => aui.threads().thread(\"main\"),\n  }),\n  composer: Derived({\n    source: \"thread\",\n    query: {},\n    get: (aui) => aui.threads().thread(\"main\").composer,\n  }),\n});\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAKA;AACA;AAAA;;;;;;AAEO,MAAM,iBAAiB,IAAA,sJAAQ,EAAC,CAAC;IACtC,MAAM,YAAY,IAAA,yLAAqB;IAEvC,IAAA,6JAAS,EAAC;QACR,OAAO,QAAQ,4BAA4B,CACzC,UAAU,OAAO,CAAE,YAAY;IAEnC,GAAG;QAAC;QAAS;KAAU;IAEvB,OAAO,IAAA,iLAAiB,EACtB,IAAA,kNAAgB,EAAC;QACf,SAAS,QAAQ,OAAO;QACxB,6BAA6B;IAC/B;AAEJ;AAEA,IAAA,4KAAkB,EAAC,gBAAgB;IACjC,cAAc,IAAA,gLAAY;IAC1B,OAAO,IAAA,oJAAK,EAAC,CAAC;IACd,aAAa,IAAA,gKAAW;IACxB,gBAAgB,IAAA,8IAAO,EAAC;QACtB,QAAQ;QACR,OAAO;YAAE,MAAM;QAAO;QACtB,KAAK,CAAC,MAAQ,IAAI,OAAO,GAAG,IAAI,CAAC;IACnC;IACA,QAAQ,IAAA,8IAAO,EAAC;QACd,QAAQ;QACR,OAAO;YAAE,MAAM;QAAO;QACtB,KAAK,CAAC,MAAQ,IAAI,OAAO,GAAG,MAAM,CAAC;IACrC;IACA,UAAU,IAAA,8IAAO,EAAC;QAChB,QAAQ;QACR,OAAO,CAAC;QACR,KAAK,CAAC,MAAQ,IAAI,OAAO,GAAG,MAAM,CAAC,QAAQ,QAAQ;IACrD;AACF"}},
    {"offset": {"line": 2815, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/stores/thread-viewport.tsx"],"sourcesContent":["\"use client\";\n\nimport { create } from \"zustand\";\nimport type { Unsubscribe } from \"../../types/unsubscribe\";\n\nexport type SizeHandle = {\n  /** Update the height */\n  setHeight: (height: number) => void;\n  /** Unregister this handle */\n  unregister: Unsubscribe;\n};\n\ntype SizeRegistry = {\n  register: () => SizeHandle;\n};\n\nconst createSizeRegistry = (\n  onChange: (total: number) => void,\n): SizeRegistry => {\n  const entries = new Map<symbol, number>();\n\n  const recalculate = () => {\n    let total = 0;\n    for (const height of entries.values()) {\n      total += height;\n    }\n    onChange(total);\n  };\n\n  return {\n    register: () => {\n      const id = Symbol();\n      entries.set(id, 0);\n\n      return {\n        setHeight: (height: number) => {\n          if (entries.get(id) !== height) {\n            entries.set(id, height);\n            recalculate();\n          }\n        },\n        unregister: () => {\n          entries.delete(id);\n          recalculate();\n        },\n      };\n    },\n  };\n};\n\nexport type ThreadViewportState = {\n  readonly isAtBottom: boolean;\n  readonly scrollToBottom: (config?: {\n    behavior?: ScrollBehavior | undefined;\n  }) => void;\n  readonly onScrollToBottom: (\n    callback: ({ behavior }: { behavior: ScrollBehavior }) => void,\n  ) => Unsubscribe;\n\n  /** Controls scroll anchoring: \"top\" anchors user messages at top, \"bottom\" is classic behavior */\n  readonly turnAnchor: \"top\" | \"bottom\";\n\n  /** Raw height values from registered elements */\n  readonly height: {\n    /** Total viewport height */\n    readonly viewport: number;\n    /** Total content inset height (footer, anchor message, etc.) */\n    readonly inset: number;\n    /** Height of the anchor user message (full height) */\n    readonly userMessage: number;\n  };\n\n  /** Register a viewport and get a handle to update its height */\n  readonly registerViewport: () => SizeHandle;\n\n  /** Register a content inset (footer, anchor message, etc.) and get a handle to update its height */\n  readonly registerContentInset: () => SizeHandle;\n\n  /** Register the anchor user message height */\n  readonly registerUserMessageHeight: () => SizeHandle;\n};\n\nexport type ThreadViewportStoreOptions = {\n  turnAnchor?: \"top\" | \"bottom\" | undefined;\n};\n\nexport const makeThreadViewportStore = (\n  options: ThreadViewportStoreOptions = {},\n) => {\n  const scrollToBottomListeners = new Set<\n    (config: { behavior: ScrollBehavior }) => void\n  >();\n\n  const viewportRegistry = createSizeRegistry((total) => {\n    store.setState({\n      height: {\n        ...store.getState().height,\n        viewport: total,\n      },\n    });\n  });\n  const insetRegistry = createSizeRegistry((total) => {\n    store.setState({\n      height: {\n        ...store.getState().height,\n        inset: total,\n      },\n    });\n  });\n  const userMessageRegistry = createSizeRegistry((total) => {\n    store.setState({\n      height: {\n        ...store.getState().height,\n        userMessage: total,\n      },\n    });\n  });\n\n  const store = create<ThreadViewportState>(() => ({\n    isAtBottom: true,\n    scrollToBottom: ({ behavior = \"auto\" } = {}) => {\n      for (const listener of scrollToBottomListeners) {\n        listener({ behavior });\n      }\n    },\n    onScrollToBottom: (callback) => {\n      scrollToBottomListeners.add(callback);\n      return () => {\n        scrollToBottomListeners.delete(callback);\n      };\n    },\n\n    turnAnchor: options.turnAnchor ?? \"bottom\",\n\n    height: {\n      viewport: 0,\n      inset: 0,\n      userMessage: 0,\n    },\n\n    registerViewport: viewportRegistry.register,\n    registerContentInset: insetRegistry.register,\n    registerUserMessageHeight: userMessageRegistry.register,\n  }));\n\n  return store;\n};\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAgBA,MAAM,qBAAqB,CACzB;IAEA,MAAM,UAAU,IAAI;IAEpB,MAAM,cAAc;QAClB,IAAI,QAAQ;QACZ,KAAK,MAAM,UAAU,QAAQ,MAAM,GAAI;YACrC,SAAS;QACX;QACA,SAAS;IACX;IAEA,OAAO;QACL,UAAU;YACR,MAAM,KAAK;YACX,QAAQ,GAAG,CAAC,IAAI;YAEhB,OAAO;gBACL,WAAW,CAAC;oBACV,IAAI,QAAQ,GAAG,CAAC,QAAQ,QAAQ;wBAC9B,QAAQ,GAAG,CAAC,IAAI;wBAChB;oBACF;gBACF;gBACA,YAAY;oBACV,QAAQ,MAAM,CAAC;oBACf;gBACF;YACF;QACF;IACF;AACF;AAsCO,MAAM,0BAA0B,CACrC,UAAsC,CAAC,CAAC;IAExC,MAAM,0BAA0B,IAAI;IAIpC,MAAM,mBAAmB,mBAAmB,CAAC;QAC3C,MAAM,QAAQ,CAAC;YACb,QAAQ;gBACN,GAAG,MAAM,QAAQ,GAAG,MAAM;gBAC1B,UAAU;YACZ;QACF;IACF;IACA,MAAM,gBAAgB,mBAAmB,CAAC;QACxC,MAAM,QAAQ,CAAC;YACb,QAAQ;gBACN,GAAG,MAAM,QAAQ,GAAG,MAAM;gBAC1B,OAAO;YACT;QACF;IACF;IACA,MAAM,sBAAsB,mBAAmB,CAAC;QAC9C,MAAM,QAAQ,CAAC;YACb,QAAQ;gBACN,GAAG,MAAM,QAAQ,GAAG,MAAM;gBAC1B,aAAa;YACf;QACF;IACF;IAEA,MAAM,QAAQ,IAAA,8VAAM,EAAsB,IAAM,CAAC;YAC/C,YAAY;YACZ,gBAAgB,CAAC,EAAE,WAAW,MAAM,EAAE,GAAG,CAAC,CAAC;gBACzC,KAAK,MAAM,YAAY,wBAAyB;oBAC9C,SAAS;wBAAE;oBAAS;gBACtB;YACF;YACA,kBAAkB,CAAC;gBACjB,wBAAwB,GAAG,CAAC;gBAC5B,OAAO;oBACL,wBAAwB,MAAM,CAAC;gBACjC;YACF;YAEA,YAAY,QAAQ,UAAU,IAAI;YAElC,QAAQ;gBACN,UAAU;gBACV,OAAO;gBACP,aAAa;YACf;YAEA,kBAAkB,iBAAiB,QAAQ;YAC3C,sBAAsB,cAAc,QAAQ;YAC5C,2BAA2B,oBAAoB,QAAQ;QACzD,CAAC;IAED,OAAO;AACT"}},
    {"offset": {"line": 2907, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/react/utils/create-context-hook.ts"],"sourcesContent":["\"use client\";\n\nimport { useContext, Context } from \"react\";\n\n/**\n * Creates a context hook with optional support.\n * @param context - The React context to consume.\n * @param providerName - The name of the provider for error messages.\n * @returns A hook function that provides the context value.\n */\nexport function createContextHook<T>(\n  context: Context<T | null>,\n  providerName: string,\n) {\n  function useContextHook(options?: {\n    optional?: boolean | undefined;\n  }): T | null {\n    const contextValue = useContext(context);\n    if (!options?.optional && !contextValue) {\n      throw new Error(`This component must be used within ${providerName}.`);\n    }\n    return contextValue;\n  }\n\n  return useContextHook;\n}\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAUO,SAAS,kBACd,OAA0B,EAC1B,YAAoB;IAEpB,SAAS,eAAe,OAEvB;QACC,MAAM,eAAe,IAAA,4ZAAU,EAAC;QAChC,IAAI,CAAC,SAAS,YAAY,CAAC,cAAc;YACvC,MAAM,IAAI,MAAM,CAAC,mCAAmC,EAAE,aAAa,CAAC,CAAC;QACvE;QACA,OAAO;IACT;IAEA,OAAO;AACT"}},
    {"offset": {"line": 2928, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/react/utils/create-context-store-hook.ts"],"sourcesContent":["import { UseBoundStore } from \"zustand\";\nimport { ReadonlyStore } from \"../../readonly-store\";\n\n/**\n * Creates hooks for accessing a store within a context.\n * @param contextHook - The hook to access the context.\n * @param contextKey - The key of the store in the context.\n * @returns An object containing the hooks: `use...` and `use...Store`.\n */\nexport function createContextStoreHook<T, K extends keyof T & string>(\n  contextHook: (options?: { optional?: boolean }) => T | null,\n  contextKey: K,\n) {\n  type StoreType = T[K];\n  type StateType = StoreType extends ReadonlyStore<infer S> ? S : never;\n\n  // Define useStoreStoreHook with overloads\n  function useStoreStoreHook(): ReadonlyStore<StateType>;\n  function useStoreStoreHook(options: {\n    optional: true;\n  }): ReadonlyStore<StateType> | null;\n  function useStoreStoreHook(options?: {\n    optional?: boolean;\n  }): ReadonlyStore<StateType> | null {\n    const context = contextHook(options);\n    if (!context) return null;\n    return context[contextKey] as ReadonlyStore<StateType>;\n  }\n\n  // Define useStoreHook with overloads\n  function useStoreHook(): StateType;\n  function useStoreHook<TSelected>(\n    selector: (state: StateType) => TSelected,\n  ): TSelected;\n  function useStoreHook(options: { optional: true }): StateType | null;\n  function useStoreHook<TSelected>(options: {\n    optional: true;\n    selector?: (state: StateType) => TSelected;\n  }): TSelected | null;\n  function useStoreHook<TSelected>(\n    param?:\n      | ((state: StateType) => TSelected)\n      | {\n          optional?: boolean;\n          selector?: (state: StateType) => TSelected;\n        },\n  ): TSelected | StateType | null {\n    let optional = false;\n    let selector: ((state: StateType) => TSelected) | undefined;\n\n    if (typeof param === \"function\") {\n      selector = param;\n    } else if (param && typeof param === \"object\") {\n      optional = !!param.optional;\n      selector = param.selector;\n    }\n\n    const store = useStoreStoreHook({\n      optional,\n    } as any) as UseBoundStore<ReadonlyStore<StateType>>;\n    if (!store) return null;\n    return selector ? store(selector) : store();\n  }\n\n  // Return an object with keys based on contextKey\n  return {\n    [contextKey]: useStoreHook,\n    [`${contextKey}Store`]: useStoreStoreHook,\n  } as {\n    [P in K]: typeof useStoreHook;\n  } & {\n    [P in `${K}Store`]: typeof useStoreStoreHook;\n  };\n}\n"],"names":[],"mappings":";;;;AASO,SAAS,uBACd,WAA2D,EAC3D,UAAa;IAUb,SAAS,kBAAkB,OAE1B;QACC,MAAM,UAAU,YAAY;QAC5B,IAAI,CAAC,SAAS,OAAO;QACrB,OAAO,OAAO,CAAC,WAAW;IAC5B;IAYA,SAAS,aACP,KAKK;QAEL,IAAI,WAAW;QACf,IAAI;QAEJ,IAAI,OAAO,UAAU,YAAY;YAC/B,WAAW;QACb,OAAO,IAAI,SAAS,OAAO,UAAU,UAAU;YAC7C,WAAW,CAAC,CAAC,MAAM,QAAQ;YAC3B,WAAW,MAAM,QAAQ;QAC3B;QAEA,MAAM,QAAQ,kBAAkB;YAC9B;QACF;QACA,IAAI,CAAC,OAAO,OAAO;QACnB,OAAO,WAAW,MAAM,YAAY;IACtC;IAEA,iDAAiD;IACjD,OAAO;QACL,CAAC,WAAW,EAAE;QACd,CAAC,GAAG,WAAW,KAAK,CAAC,CAAC,EAAE;IAC1B;AAKF"}},
    {"offset": {"line": 2963, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/react/thread-viewport-context.ts"],"sourcesContent":["\"use client\";\n\nimport { createContext } from \"react\";\nimport { ReadonlyStore } from \"../readonly-store\";\nimport { UseBoundStore } from \"zustand\";\nimport { createContextHook } from \"./utils/create-context-hook\";\nimport { createContextStoreHook } from \"./utils/create-context-store-hook\";\nimport { ThreadViewportState } from \"../stores\";\n\nexport type ThreadViewportContextValue = {\n  useThreadViewport: UseBoundStore<ReadonlyStore<ThreadViewportState>>;\n};\n\nexport const ThreadViewportContext =\n  createContext<ThreadViewportContextValue | null>(null);\n\nconst useThreadViewportContext = createContextHook(\n  ThreadViewportContext,\n  \"ThreadPrimitive.Viewport\",\n);\n\nexport const { useThreadViewport, useThreadViewportStore } =\n  createContextStoreHook(useThreadViewportContext, \"useThreadViewport\");\n"],"names":[],"mappings":";;;;;;;;AAEA;AAGA;AACA;AANA;;;;AAaO,MAAM,sCACX,IAAA,+ZAAa,EAAoC;AAEnD,MAAM,2BAA2B,IAAA,uMAAiB,EAChD,uBACA;AAGK,MAAM,EAAE,iBAAiB,EAAE,sBAAsB,EAAE,GACxD,IAAA,qNAAsB,EAAC,0BAA0B"}},
    {"offset": {"line": 2985, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/readonly-store.ts"],"sourcesContent":["import type { StoreApi } from \"zustand\";\n\nexport type ReadonlyStore<T> = Omit<StoreApi<T>, \"setState\" | \"destroy\">;\n\nexport const writableStore = <T>(store: ReadonlyStore<T> | undefined) => {\n  return store as unknown as StoreApi<T>;\n};\n"],"names":[],"mappings":";;;;AAIO,MAAM,gBAAgB,CAAI;IAC/B,OAAO;AACT"}},
    {"offset": {"line": 2996, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/providers/thread-viewport-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC, PropsWithChildren } from \"react\";\nimport { useEffect, useState } from \"react\";\nimport {\n  makeThreadViewportStore,\n  type ThreadViewportStoreOptions,\n} from \"../stores/thread-viewport\";\nimport {\n  ThreadViewportContext,\n  ThreadViewportContextValue,\n  useThreadViewportStore,\n} from \"../react/thread-viewport-context\";\nimport { writableStore } from \"../readonly-store\";\n\nexport type ThreadViewportProviderProps = PropsWithChildren<{\n  options?: ThreadViewportStoreOptions;\n}>;\n\nconst useThreadViewportStoreValue = (options: ThreadViewportStoreOptions) => {\n  const outerViewport = useThreadViewportStore({ optional: true });\n  const [store] = useState(() => makeThreadViewportStore(options));\n\n  // Forward scrollToBottom from outer viewport to inner viewport\n  useEffect(() => {\n    return outerViewport?.getState().onScrollToBottom(() => {\n      store.getState().scrollToBottom();\n    });\n  }, [outerViewport, store]);\n\n  useEffect(() => {\n    if (!outerViewport) return;\n    return store.subscribe((state) => {\n      if (outerViewport.getState().isAtBottom !== state.isAtBottom) {\n        writableStore(outerViewport).setState({ isAtBottom: state.isAtBottom });\n      }\n    });\n  }, [store, outerViewport]);\n\n  // Sync options to store when they change\n  useEffect(() => {\n    const nextState = {\n      turnAnchor: options.turnAnchor ?? \"bottom\",\n    };\n\n    const currentState = store.getState();\n    if (currentState.turnAnchor !== nextState.turnAnchor) {\n      writableStore(store).setState(nextState);\n    }\n  }, [store, options.turnAnchor]);\n\n  return store;\n};\n\nexport const ThreadPrimitiveViewportProvider: FC<\n  ThreadViewportProviderProps\n> = ({ children, options = {} }) => {\n  const useThreadViewport = useThreadViewportStoreValue(options);\n\n  const [context] = useState<ThreadViewportContextValue>(() => {\n    return {\n      useThreadViewport,\n    };\n  });\n\n  return (\n    <ThreadViewportContext.Provider value={context}>\n      {children}\n    </ThreadViewportContext.Provider>\n  );\n};\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAIA;AAKA;AAbA;;;;;;AAmBA,MAAM,8BAA8B,CAAC;IACnC,MAAM,gBAAgB,IAAA,uMAAsB,EAAC;QAAE,UAAU;IAAK;IAC9D,MAAM,CAAC,MAAM,GAAG,IAAA,0ZAAQ,EAAC,IAAM,IAAA,+LAAuB,EAAC;IAEvD,+DAA+D;IAC/D,IAAA,2ZAAS,EAAC;QACR,OAAO,eAAe,WAAW,iBAAiB;YAChD,MAAM,QAAQ,GAAG,cAAc;QACjC;IACF,GAAG;QAAC;QAAe;KAAM;IAEzB,IAAA,2ZAAS,EAAC;QACR,IAAI,CAAC,eAAe;QACpB,OAAO,MAAM,SAAS,CAAC,CAAC;YACtB,IAAI,cAAc,QAAQ,GAAG,UAAU,KAAK,MAAM,UAAU,EAAE;gBAC5D,IAAA,yKAAa,EAAC,eAAe,QAAQ,CAAC;oBAAE,YAAY,MAAM,UAAU;gBAAC;YACvE;QACF;IACF,GAAG;QAAC;QAAO;KAAc;IAEzB,yCAAyC;IACzC,IAAA,2ZAAS,EAAC;QACR,MAAM,YAAY;YAChB,YAAY,QAAQ,UAAU,IAAI;QACpC;QAEA,MAAM,eAAe,MAAM,QAAQ;QACnC,IAAI,aAAa,UAAU,KAAK,UAAU,UAAU,EAAE;YACpD,IAAA,yKAAa,EAAC,OAAO,QAAQ,CAAC;QAChC;IACF,GAAG;QAAC;QAAO,QAAQ,UAAU;KAAC;IAE9B,OAAO;AACT;AAEO,MAAM,kCAET,CAAC,EAAE,QAAQ,EAAE,UAAU,CAAC,CAAC,EAAE;IAC7B,MAAM,oBAAoB,4BAA4B;IAEtD,MAAM,CAAC,QAAQ,GAAG,IAAA,0ZAAQ,EAA6B;QACrD,OAAO;YACL;QACF;IACF;IAEA,qBACE,ubAAC,sMAAqB,CAAC,QAAQ;QAAC,OAAO;kBACpC;;;;;;AAGP"}},
    {"offset": {"line": 3073, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/assistant-runtime-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { FC, memo, PropsWithChildren, useEffect } from \"react\";\nimport { useAui, AuiProvider, AssistantClient } from \"@creatorem/ai-store\";\nimport { AssistantRuntime } from \"./runtime/assistant-runtime\";\nimport { AssistantRuntimeCore } from \"./runtime-cores/core/assistant-runtime-core\";\nimport { RuntimeAdapter } from \"./runtime-adapter\";\nimport { ThreadPrimitiveViewportProvider } from \"../context/providers/thread-viewport-provider\";\n// import { DevToolsProviderApi } from \"../devtools\";\n\nexport namespace AssistantRuntimeProvider {\n  export type Props = PropsWithChildren<{\n    /**\n     * The runtime to provide to the rest of your app.\n     */\n    runtime: AssistantRuntime;\n\n    /**\n     * The aui instance to extend. If not provided, a new aui instance will be created.\n     */\n    aui?: AssistantClient;\n  }>;\n}\n\nconst getRenderComponent = (runtime: AssistantRuntime) => {\n  return (runtime as { _core?: AssistantRuntimeCore })._core?.RenderComponent;\n};\n\nexport const AssistantRuntimeProviderImpl: FC<\n  AssistantRuntimeProvider.Props\n> = ({ children, aui: parent = null, runtime }) => {\n  const aui = useAui({ threads: RuntimeAdapter(runtime) }, { parent: parent });\n\n  // useEffect(() => {\n  //   if (process.env[\"NODE_ENV\"] === \"production\") return;\n  //   return DevToolsProviderApi.register(aui);\n  // }, [aui]);\n\n  const RenderComponent = getRenderComponent(runtime);\n\n  return (\n    <AuiProvider value={aui}>\n      {RenderComponent && <RenderComponent />}\n\n      {/* TODO temporarily allow accessing viewport state from outside the viewport */}\n      {/* TODO figure out if this behavior should be deprecated, since it is quite hacky */}\n      <ThreadPrimitiveViewportProvider>\n        {children}\n      </ThreadPrimitiveViewportProvider>\n    </AuiProvider>\n  );\n};\n\nexport const AssistantRuntimeProvider = memo(AssistantRuntimeProviderImpl);\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;AAGA;AACA;AAPA;;;;;;AAwBA,MAAM,qBAAqB,CAAC;IAC1B,OAAO,AAAC,QAA6C,KAAK,EAAE;AAC9D;AAEO,MAAM,+BAET,CAAC,EAAE,QAAQ,EAAE,KAAK,SAAS,IAAI,EAAE,OAAO,EAAE;IAC5C,MAAM,MAAM,IAAA,iJAAM,EAAC;QAAE,SAAS,IAAA,qLAAc,EAAC;IAAS,GAAG;QAAE,QAAQ;IAAO;IAE1E,oBAAoB;IACpB,0DAA0D;IAC1D,8CAA8C;IAC9C,aAAa;IAEb,MAAM,kBAAkB,mBAAmB;IAE3C,qBACE,ubAAC,kLAAW;QAAC,OAAO;;YACjB,iCAAmB,ubAAC;;;;;0BAIrB,ubAAC,sNAA+B;0BAC7B;;;;;;;;;;;;AAIT;AAEO,MAAM,yCAA2B,IAAA,sZAAI,EAAC"}},
    {"offset": {"line": 3132, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 3141, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/attachment/attachment-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\n\ntype PrimitiveDivProps = ComponentPropsWithoutRef<typeof Primitive.div>;\n\nexport namespace AttachmentPrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  /**\n   * Props for the AttachmentPrimitive.Root component.\n   * Accepts all standard div element props.\n   */\n  export type Props = PrimitiveDivProps;\n}\n\n/**\n * The root container component for an attachment.\n *\n * This component provides the foundational wrapper for attachment-related components\n * and content. It serves as the context provider for attachment state and actions.\n *\n * @example\n * ```tsx\n * <AttachmentPrimitive.Root>\n *   <AttachmentPrimitive.Name />\n *   <AttachmentPrimitive.Remove />\n * </AttachmentPrimitive.Root>\n * ```\n */\nexport const AttachmentPrimitiveRoot = forwardRef<\n  AttachmentPrimitiveRoot.Element,\n  AttachmentPrimitiveRoot.Props\n>((props, ref) => {\n  return <Primitive.div {...props} ref={ref} />;\n});\n\nAttachmentPrimitiveRoot.displayName = \"AttachmentPrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AA8BO,MAAM,wCAA0B,IAAA,4ZAAU,EAG/C,CAAC,OAAO;IACR,qBAAO,ubAAC,mYAAS,CAAC,GAAG;QAAE,GAAG,KAAK;QAAE,KAAK;;;;;;AACxC;AAEA,wBAAwB,WAAW,GAAG"}},
    {"offset": {"line": 3167, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/use-aui-state.tsx"],"sourcesContent":["import { useSyncExternalStore, useDebugValue } from \"react\";\nimport type { AssistantState } from \"./types/client\";\nimport { useAui } from \"./use-aui\";\nimport { getProxiedAssistantState } from \"./utils/proxied-assistant-state\";\n\n/**\n * Hook to access a slice of the assistant state with automatic subscription\n *\n * @param selector - Function to select a slice of the state\n * @returns The selected state slice\n *\n * @example\n * ```typescript\n * const aui = useAui({\n *   foo: RootScope({ ... }),\n * });\n *\n * const bar = useAuiState((state) => state.foo.bar);\n * ```\n */\nexport const useAuiState = <T,>(selector: (state: AssistantState) => T): T => {\n  const aui = useAui();\n  const proxiedState = getProxiedAssistantState(aui);\n\n  const slice = useSyncExternalStore(\n    aui.subscribe,\n    () => selector(proxiedState),\n    () => selector(proxiedState),\n  );\n\n  if (slice === proxiedState) {\n    throw new Error(\n      \"You tried to return the entire AssistantState. This is not supported due to technical limitations.\",\n    );\n  }\n\n  useDebugValue(slice);\n\n  return slice;\n};\n"],"names":[],"mappings":";;;;AAAA;AAEA;AACA;;;;AAiBO,MAAM,cAAc,CAAK;IAC9B,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,eAAe,IAAA,+LAAwB,EAAC;IAE9C,MAAM,QAAQ,IAAA,saAAoB,EAChC,IAAI,SAAS,EACb,IAAM,SAAS,eACf,IAAM,SAAS;IAGjB,IAAI,UAAU,cAAc;QAC1B,MAAM,IAAI,MACR;IAEJ;IAEA,IAAA,+ZAAa,EAAC;IAEd,OAAO;AACT"}},
    {"offset": {"line": 3191, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/attachment/attachment-thumb.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, forwardRef, type ComponentRef } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\n\ntype PrimitiveDivProps = ComponentPropsWithoutRef<typeof Primitive.div>;\n\nexport namespace AttachmentPrimitiveThumb {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  export type Props = PrimitiveDivProps;\n}\n\nexport const AttachmentPrimitiveThumb = forwardRef<\n  AttachmentPrimitiveThumb.Element,\n  AttachmentPrimitiveThumb.Props\n>((props, ref) => {\n  const ext = useAuiState(({ attachment }) => {\n    const parts = attachment.name.split(\".\");\n    return parts.length > 1 ? parts.pop()! : \"\";\n  });\n  return (\n    <Primitive.div {...props} ref={ref}>\n      .{ext}\n    </Primitive.div>\n  );\n});\n\nAttachmentPrimitiveThumb.displayName = \"AttachmentPrimitive.Thumb\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,MAAM,yCAA2B,IAAA,4ZAAU,EAGhD,CAAC,OAAO;IACR,MAAM,MAAM,IAAA,+JAAW,EAAC,CAAC,EAAE,UAAU,EAAE;QACrC,MAAM,QAAQ,WAAW,IAAI,CAAC,KAAK,CAAC;QACpC,OAAO,MAAM,MAAM,GAAG,IAAI,MAAM,GAAG,KAAM;IAC3C;IACA,qBACE,ubAAC,mYAAS,CAAC,GAAG;QAAE,GAAG,KAAK;QAAE,KAAK;;YAAK;YAChC;;;;;;;AAGR;AAEA,yBAAyB,WAAW,GAAG"}},
    {"offset": {"line": 3227, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/attachment/attachment-name.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nexport namespace AttachmentPrimitiveName {\n  export type Props = Record<string, never>;\n}\n\nexport const AttachmentPrimitiveName: FC<\n  AttachmentPrimitiveName.Props\n> = () => {\n  const name = useAuiState(({ attachment }) => attachment.name);\n  return <>{name}</>;\n};\n\nAttachmentPrimitiveName.displayName = \"AttachmentPrimitive.Name\";\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AASO,MAAM,0BAET;IACF,MAAM,OAAO,IAAA,+JAAW,EAAC,CAAC,EAAE,UAAU,EAAE,GAAK,WAAW,IAAI;IAC5D,qBAAO;kBAAG;;AACZ;AAEA,wBAAwB,WAAW,GAAG"}},
    {"offset": {"line": 3247, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/create-action-button.tsx"],"sourcesContent":["import {\n  ComponentRef,\n  forwardRef,\n  ComponentPropsWithoutRef,\n  MouseEventHandler,\n} from \"react\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\n\ntype ActionButtonCallback<TProps> = (\n  props: TProps,\n) => MouseEventHandler<HTMLButtonElement> | null;\n\ntype PrimitiveButtonProps = ComponentPropsWithoutRef<typeof Primitive.button>;\n\nexport type ActionButtonProps<THook> = PrimitiveButtonProps &\n  (THook extends (props: infer TProps) => unknown ? TProps : never);\n\nexport type ActionButtonElement = ComponentRef<typeof Primitive.button>;\n\nexport const createActionButton = <TProps,>(\n  displayName: string,\n  useActionButton: ActionButtonCallback<TProps>,\n  forwardProps: (keyof NonNullable<TProps>)[] = [],\n) => {\n  const ActionButton = forwardRef<\n    ActionButtonElement,\n    PrimitiveButtonProps & TProps\n  >((props, forwardedRef) => {\n    const forwardedProps = {} as TProps;\n    const primitiveProps = {} as PrimitiveButtonProps;\n\n    (Object.keys(props) as Array<keyof typeof props>).forEach((key) => {\n      if (forwardProps.includes(key as keyof TProps)) {\n        (forwardedProps as any)[key] = props[key];\n      } else {\n        (primitiveProps as any)[key] = props[key];\n      }\n    });\n\n    const callback = useActionButton(forwardedProps as TProps) ?? undefined;\n    return (\n      <Primitive.button\n        type=\"button\"\n        {...primitiveProps}\n        ref={forwardedRef}\n        disabled={primitiveProps.disabled || !callback}\n        onClick={composeEventHandlers(primitiveProps.onClick, callback)}\n      />\n    );\n  });\n\n  ActionButton.displayName = displayName;\n\n  return ActionButton;\n};\n"],"names":[],"mappings":";;;;;AAAA;AAMA;AACA;;;;;AAaO,MAAM,qBAAqB,CAChC,aACA,iBACA,eAA8C,EAAE;IAEhD,MAAM,6BAAe,IAAA,4ZAAU,EAG7B,CAAC,OAAO;QACR,MAAM,iBAAiB,CAAC;QACxB,MAAM,iBAAiB,CAAC;QAEvB,OAAO,IAAI,CAAC,OAAqC,OAAO,CAAC,CAAC;YACzD,IAAI,aAAa,QAAQ,CAAC,MAAsB;gBAC7C,cAAsB,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI;YAC3C,OAAO;gBACJ,cAAsB,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI;YAC3C;QACF;QAEA,MAAM,WAAW,gBAAgB,mBAA6B;QAC9D,qBACE,ubAAC,mYAAS,CAAC,MAAM;YACf,MAAK;YACJ,GAAG,cAAc;YAClB,KAAK;YACL,UAAU,eAAe,QAAQ,IAAI,CAAC;YACtC,SAAS,IAAA,2PAAoB,EAAC,eAAe,OAAO,EAAE;;;;;;IAG5D;IAEA,aAAa,WAAW,GAAG;IAE3B,OAAO;AACT"}},
    {"offset": {"line": 3290, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/attachment/attachment-remove.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAui } from \"@creatorem/ai-store\";\n\nconst useAttachmentRemove = () => {\n  const aui = useAui();\n\n  const handleRemoveAttachment = useCallback(() => {\n    aui.attachment().remove();\n  }, [aui]);\n\n  return handleRemoveAttachment;\n};\n\nexport namespace AttachmentPrimitiveRemove {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useAttachmentRemove>;\n}\n\nexport const AttachmentPrimitiveRemove = createActionButton(\n  \"AttachmentPrimitive.Remove\",\n  useAttachmentRemove,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AARA;;;;AAUA,MAAM,sBAAsB;IAC1B,MAAM,MAAM,IAAA,iJAAM;IAElB,MAAM,yBAAyB,IAAA,6ZAAW,EAAC;QACzC,IAAI,UAAU,GAAG,MAAM;IACzB,GAAG;QAAC;KAAI;IAER,OAAO;AACT;AAOO,MAAM,4BAA4B,IAAA,sLAAkB,EACzD,8BACA"}},
    {"offset": {"line": 3343, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 3360, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-send.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nexport const useComposerSend = () => {\n  const aui = useAui();\n\n  const disabled = useAuiState(\n    (s) => s.thread.isRunning || !s.composer.isEditing || s.composer.isEmpty,\n  );\n\n  const callback = useCallback(() => {\n    aui.composer().send();\n  }, [aui]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace ComposerPrimitiveSend {\n  export type Element = ActionButtonElement;\n  /**\n   * Props for the ComposerPrimitive.Send component.\n   * Inherits all button element props and action button functionality.\n   */\n  export type Props = ActionButtonProps<typeof useComposerSend>;\n}\n\n/**\n * A button component that sends the current message in the composer.\n *\n * This component automatically handles the send functionality and is disabled\n * when sending is not available (e.g., when the thread is running, the composer\n * is empty, or not in editing mode).\n *\n * @example\n * ```tsx\n * <ComposerPrimitive.Send>\n *   Send Message\n * </ComposerPrimitive.Send>\n * ```\n */\nexport const ComposerPrimitiveSend = createActionButton(\n  \"ComposerPrimitive.Send\",\n  useComposerSend,\n);\n"],"names":[],"mappings":";;;;;;AAEA;AAKA;AACA;AAAA;AARA;;;;AAUO,MAAM,kBAAkB;IAC7B,MAAM,MAAM,IAAA,iJAAM;IAElB,MAAM,WAAW,IAAA,+JAAW,EAC1B,CAAC,IAAM,EAAE,MAAM,CAAC,SAAS,IAAI,CAAC,EAAE,QAAQ,CAAC,SAAS,IAAI,EAAE,QAAQ,CAAC,OAAO;IAG1E,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,QAAQ,GAAG,IAAI;IACrB,GAAG;QAAC;KAAI;IAER,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAyBO,MAAM,wBAAwB,IAAA,sLAAkB,EACrD,0BACA"}},
    {"offset": {"line": 3390, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport {\n  type ComponentRef,\n  type FormEvent,\n  forwardRef,\n  ComponentPropsWithoutRef,\n} from \"react\";\nimport { useComposerSend } from \"./composer-send\";\n\nexport namespace ComposerPrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.form>;\n  /**\n   * Props for the ComposerPrimitive.Root component.\n   * Accepts all standard form element props.\n   */\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.form>;\n}\n\n/**\n * The root form container for message composition.\n *\n * This component provides a form wrapper that handles message submission when the form\n * is submitted (e.g., via Enter key or submit button). It automatically prevents the\n * default form submission and triggers the composer's send functionality.\n *\n * @example\n * ```tsx\n * <ComposerPrimitive.Root>\n *   <ComposerPrimitive.Input placeholder=\"Type your message...\" />\n *   <ComposerPrimitive.Send>Send</ComposerPrimitive.Send>\n * </ComposerPrimitive.Root>\n * ```\n */\nexport const ComposerPrimitiveRoot = forwardRef<\n  ComposerPrimitiveRoot.Element,\n  ComposerPrimitiveRoot.Props\n>(({ onSubmit, ...rest }, forwardedRef) => {\n  const send = useComposerSend();\n\n  const handleSubmit = (e: FormEvent) => {\n    e.preventDefault();\n\n    if (!send) return;\n    send();\n  };\n\n  return (\n    <Primitive.form\n      {...rest}\n      ref={forwardedRef}\n      onSubmit={composeEventHandlers(onSubmit, handleSubmit)}\n    />\n  );\n});\n\nComposerPrimitiveRoot.displayName = \"ComposerPrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAMA;AAVA;;;;;;AAoCO,MAAM,sCAAwB,IAAA,4ZAAU,EAG7C,CAAC,EAAE,QAAQ,EAAE,GAAG,MAAM,EAAE;IACxB,MAAM,OAAO,IAAA,0LAAe;IAE5B,MAAM,eAAe,CAAC;QACpB,EAAE,cAAc;QAEhB,IAAI,CAAC,MAAM;QACX;IACF;IAEA,qBACE,ubAAC,mYAAS,CAAC,IAAI;QACZ,GAAG,IAAI;QACR,KAAK;QACL,UAAU,IAAA,2PAAoB,EAAC,UAAU;;;;;;AAG/C;AAEA,sBAAsB,WAAW,GAAG"}},
    {"offset": {"line": 3427, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/hooks/use-on-scroll-to-bottom.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { useEffect } from \"react\";\nimport { useThreadViewport } from \"../../context/react/thread-viewport-context\";\n\nexport const useOnScrollToBottom = (\n  callback: (config: { behavior: ScrollBehavior }) => void,\n) => {\n  const callbackRef = useCallbackRef(callback);\n  const onScrollToBottom = useThreadViewport((vp) => vp.onScrollToBottom);\n\n  useEffect(() => {\n    return onScrollToBottom(callbackRef);\n  }, [onScrollToBottom, callbackRef]);\n};\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAJA;;;;AAMO,MAAM,sBAAsB,CACjC;IAEA,MAAM,cAAc,IAAA,2VAAc,EAAC;IACnC,MAAM,mBAAmB,IAAA,kMAAiB,EAAC,CAAC,KAAO,GAAG,gBAAgB;IAEtE,IAAA,2ZAAS,EAAC;QACR,OAAO,iBAAiB;IAC1B,GAAG;QAAC;QAAkB;KAAY;AACpC"}},
    {"offset": {"line": 3452, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-input.tsx"],"sourcesContent":["\"use client\";\n\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { Slot } from \"@radix-ui/react-slot\";\nimport {\n  ClipboardEvent,\n  type KeyboardEvent,\n  forwardRef,\n  useCallback,\n  useEffect,\n  useRef,\n} from \"react\";\nimport TextareaAutosize, {\n  type TextareaAutosizeProps,\n} from \"react-textarea-autosize\";\nimport { useEscapeKeydown } from \"@radix-ui/react-use-escape-keydown\";\nimport { useOnScrollToBottom } from \"../../utils/hooks/use-on-scroll-to-bottom\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\nimport { flushResourcesSync } from \"@creatorem/ai-tap\";\n\nexport namespace ComposerPrimitiveInput {\n  export type Element = HTMLTextAreaElement;\n  export type Props = TextareaAutosizeProps & {\n    /**\n     * Whether to render as a child component using Slot.\n     * When true, the component will merge its props with its child.\n     */\n    asChild?: boolean | undefined;\n    /**\n     * Whether to submit the message when Enter is pressed (without Shift).\n     * @default true\n     */\n    submitOnEnter?: boolean | undefined;\n    /**\n     * Whether to cancel message composition when Escape is pressed.\n     * @default true\n     */\n    cancelOnEscape?: boolean | undefined;\n    /**\n     * Whether to automatically focus the input when a new run starts.\n     * @default true\n     */\n    unstable_focusOnRunStart?: boolean | undefined;\n    /**\n     * Whether to automatically focus the input when scrolling to bottom.\n     * @default true\n     */\n    unstable_focusOnScrollToBottom?: boolean | undefined;\n    /**\n     * Whether to automatically focus the input when switching threads.\n     * @default true\n     */\n    unstable_focusOnThreadSwitched?: boolean | undefined;\n    /**\n     * Whether to automatically add pasted files as attachments.\n     * @default true\n     */\n    addAttachmentOnPaste?: boolean | undefined;\n  };\n}\n\n/**\n * A text input component for composing messages.\n *\n * This component provides a rich text input experience with automatic resizing,\n * keyboard shortcuts, file paste support, and intelligent focus management.\n * It integrates with the composer context to manage message state and submission.\n *\n * @example\n * ```tsx\n * <ComposerPrimitive.Input\n *   placeholder=\"Type your message...\"\n *   submitOnEnter={true}\n *   addAttachmentOnPaste={true}\n * />\n * ```\n */\nexport const ComposerPrimitiveInput = forwardRef<\n  ComposerPrimitiveInput.Element,\n  ComposerPrimitiveInput.Props\n>(\n  (\n    {\n      autoFocus = false,\n      asChild,\n      disabled: disabledProp,\n      onChange,\n      onKeyDown,\n      onPaste,\n      submitOnEnter = true,\n      cancelOnEscape = true,\n      unstable_focusOnRunStart = true,\n      unstable_focusOnScrollToBottom = true,\n      unstable_focusOnThreadSwitched = true,\n      addAttachmentOnPaste = true,\n      ...rest\n    },\n    forwardedRef,\n  ) => {\n    const aui = useAui();\n\n    const value = useAuiState(({ composer }) => {\n      if (!composer.isEditing) return \"\";\n      return composer.text;\n    });\n\n    const Component = asChild ? Slot : TextareaAutosize;\n\n    const isDisabled =\n      useAuiState(\n        ({ thread, composer }) =>\n          thread.isDisabled || composer.dictation?.inputDisabled,\n      ) || disabledProp;\n    const textareaRef = useRef<HTMLTextAreaElement>(null);\n    const ref = useComposedRefs(forwardedRef, textareaRef);\n\n    useEscapeKeydown((e) => {\n      if (!cancelOnEscape) return;\n\n      // Only handle ESC if it originated from within this input\n      if (!textareaRef.current?.contains(e.target as Node)) return;\n\n      const composer = aui.composer();\n      if (composer.getState().canCancel) {\n        composer.cancel();\n        e.preventDefault();\n      }\n    });\n\n    const handleKeyPress = (e: KeyboardEvent) => {\n      if (isDisabled || !submitOnEnter) return;\n\n      // ignore IME composition events\n      if (e.nativeEvent.isComposing) return;\n\n      if (e.key === \"Enter\" && e.shiftKey === false) {\n        const isRunning = aui.thread().getState().isRunning;\n\n        if (!isRunning) {\n          e.preventDefault();\n\n          textareaRef.current?.closest(\"form\")?.requestSubmit();\n        }\n      }\n    };\n\n    const handlePaste = async (e: ClipboardEvent<HTMLTextAreaElement>) => {\n      if (!addAttachmentOnPaste) return;\n      const threadCapabilities = aui.thread().getState().capabilities;\n      const files = Array.from(e.clipboardData?.files || []);\n\n      if (threadCapabilities.attachments && files.length > 0) {\n        try {\n          e.preventDefault();\n          await Promise.all(\n            files.map((file) => aui.composer().addAttachment(file)),\n          );\n        } catch (error) {\n          console.error(\"Error adding attachment:\", error);\n        }\n      }\n    };\n\n    const autoFocusEnabled = autoFocus && !isDisabled;\n    const focus = useCallback(() => {\n      const textarea = textareaRef.current;\n      if (!textarea || !autoFocusEnabled) return;\n\n      textarea.focus({ preventScroll: true });\n      textarea.setSelectionRange(textarea.value.length, textarea.value.length);\n    }, [autoFocusEnabled]);\n\n    useEffect(() => focus(), [focus]);\n\n    useOnScrollToBottom(() => {\n      if (\n        aui.composer().getState().type === \"thread\" &&\n        unstable_focusOnScrollToBottom\n      ) {\n        focus();\n      }\n    });\n\n    useEffect(() => {\n      if (\n        aui.composer().getState().type !== \"thread\" ||\n        !unstable_focusOnRunStart\n      )\n        return undefined;\n\n      return aui.on(\"thread.runStart\", focus);\n    }, [unstable_focusOnRunStart, focus, aui]);\n\n    useEffect(() => {\n      if (\n        aui.composer().getState().type !== \"thread\" ||\n        !unstable_focusOnThreadSwitched\n      )\n        return undefined;\n\n      return aui.on(\"threadListItem.switchedTo\", focus);\n    }, [unstable_focusOnThreadSwitched, focus, aui]);\n\n    return (\n      <Component\n        name=\"input\"\n        value={value}\n        {...rest}\n        ref={ref as React.ForwardedRef<HTMLTextAreaElement>}\n        disabled={isDisabled}\n        onChange={composeEventHandlers(onChange, (e) => {\n          if (!aui.composer().getState().isEditing) return;\n          flushResourcesSync(() => {\n            aui.composer().setText(e.target.value);\n          });\n        })}\n        onKeyDown={composeEventHandlers(onKeyDown, handleKeyPress)}\n        onPaste={composeEventHandlers(onPaste, handlePaste)}\n      />\n    );\n  },\n);\n\nComposerPrimitiveInput.displayName = \"ComposerPrimitive.Input\";\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3583, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-cancel.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nconst useComposerCancel = () => {\n  const aui = useAui();\n  const disabled = useAuiState(({ composer }) => !composer.canCancel);\n\n  const callback = useCallback(() => {\n    aui.composer().cancel();\n  }, [aui]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace ComposerPrimitiveCancel {\n  export type Element = ActionButtonElement;\n  /**\n   * Props for the ComposerPrimitive.Cancel component.\n   * Inherits all button element props and action button functionality.\n   */\n  export type Props = ActionButtonProps<typeof useComposerCancel>;\n}\n\n/**\n * A button component that cancels the current message composition.\n *\n * This component automatically handles the cancel functionality and is disabled\n * when canceling is not available.\n *\n * @example\n * ```tsx\n * <ComposerPrimitive.Cancel>\n *   Cancel\n * </ComposerPrimitive.Cancel>\n * ```\n */\nexport const ComposerPrimitiveCancel = createActionButton(\n  \"ComposerPrimitive.Cancel\",\n  useComposerCancel,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AAAA;AARA;;;;AAUA,MAAM,oBAAoB;IACxB,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,WAAW,IAAA,+JAAW,EAAC,CAAC,EAAE,QAAQ,EAAE,GAAK,CAAC,SAAS,SAAS;IAElE,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,QAAQ,GAAG,MAAM;IACvB,GAAG;QAAC;KAAI;IAER,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAwBO,MAAM,0BAA0B,IAAA,sLAAkB,EACvD,4BACA"}},
    {"offset": {"line": 3611, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-add-attachment.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nconst useComposerAddAttachment = ({\n  multiple = true,\n}: {\n  /** allow selecting multiple files */\n  multiple?: boolean | undefined;\n} = {}) => {\n  const disabled = useAuiState(({ composer }) => !composer.isEditing);\n  const aui = useAui();\n\n  const callback = useCallback(() => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.multiple = multiple;\n    input.hidden = true;\n\n    const attachmentAccept = aui.composer().getState().attachmentAccept;\n    if (attachmentAccept !== \"*\") {\n      input.accept = attachmentAccept;\n    }\n\n    document.body.appendChild(input);\n\n    input.onchange = (e) => {\n      const fileList = (e.target as HTMLInputElement).files;\n      if (!fileList) return;\n      for (const file of fileList) {\n        aui.composer().addAttachment(file);\n      }\n\n      document.body.removeChild(input);\n    };\n\n    input.oncancel = () => {\n      if (!input.files || input.files.length === 0) {\n        document.body.removeChild(input);\n      }\n    };\n\n    input.click();\n  }, [aui, multiple]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace ComposerPrimitiveAddAttachment {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useComposerAddAttachment>;\n}\n\nexport const ComposerPrimitiveAddAttachment = createActionButton(\n  \"ComposerPrimitive.AddAttachment\",\n  useComposerAddAttachment,\n  [\"multiple\"],\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AAAA;AARA;;;;AAUA,MAAM,2BAA2B,CAAC,EAChC,WAAW,IAAI,EAIhB,GAAG,CAAC,CAAC;IACJ,MAAM,WAAW,IAAA,+JAAW,EAAC,CAAC,EAAE,QAAQ,EAAE,GAAK,CAAC,SAAS,SAAS;IAClE,MAAM,MAAM,IAAA,iJAAM;IAElB,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,MAAM,QAAQ,SAAS,aAAa,CAAC;QACrC,MAAM,IAAI,GAAG;QACb,MAAM,QAAQ,GAAG;QACjB,MAAM,MAAM,GAAG;QAEf,MAAM,mBAAmB,IAAI,QAAQ,GAAG,QAAQ,GAAG,gBAAgB;QACnE,IAAI,qBAAqB,KAAK;YAC5B,MAAM,MAAM,GAAG;QACjB;QAEA,SAAS,IAAI,CAAC,WAAW,CAAC;QAE1B,MAAM,QAAQ,GAAG,CAAC;YAChB,MAAM,WAAW,AAAC,EAAE,MAAM,CAAsB,KAAK;YACrD,IAAI,CAAC,UAAU;YACf,KAAK,MAAM,QAAQ,SAAU;gBAC3B,IAAI,QAAQ,GAAG,aAAa,CAAC;YAC/B;YAEA,SAAS,IAAI,CAAC,WAAW,CAAC;QAC5B;QAEA,MAAM,QAAQ,GAAG;YACf,IAAI,CAAC,MAAM,KAAK,IAAI,MAAM,KAAK,CAAC,MAAM,KAAK,GAAG;gBAC5C,SAAS,IAAI,CAAC,WAAW,CAAC;YAC5B;QACF;QAEA,MAAM,KAAK;IACb,GAAG;QAAC;QAAK;KAAS;IAElB,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAOO,MAAM,iCAAiC,IAAA,sLAAkB,EAC9D,mCACA,0BACA;IAAC;CAAW"}},
    {"offset": {"line": 3664, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/providers/attachment-by-index-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { type FC, type PropsWithChildren } from \"react\";\nimport { useAui, AuiProvider, Derived } from \"@creatorem/ai-store\";\n\nexport const MessageAttachmentByIndexProvider: FC<\n  PropsWithChildren<{\n    index: number;\n  }>\n> = ({ index, children }) => {\n  const aui = useAui({\n    attachment: Derived({\n      source: \"message\",\n      query: { type: \"index\", index },\n      get: (aui) => aui.message().attachment({ index }),\n    }),\n  });\n\n  return <AuiProvider value={aui}>{children}</AuiProvider>;\n};\n\nexport const ComposerAttachmentByIndexProvider: FC<\n  PropsWithChildren<{\n    index: number;\n  }>\n> = ({ index, children }) => {\n  const aui = useAui({\n    attachment: Derived({\n      source: \"composer\",\n      query: { type: \"index\", index },\n      get: (aui) => aui.composer().attachment({ index }),\n    }),\n  });\n\n  return <AuiProvider value={aui}>{children}</AuiProvider>;\n};\n"],"names":[],"mappings":";;;;;;;AAGA;AAAA;AAAA;AAHA;;;AAKO,MAAM,mCAIT,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE;IACtB,MAAM,MAAM,IAAA,iJAAM,EAAC;QACjB,YAAY,IAAA,8IAAO,EAAC;YAClB,QAAQ;YACR,OAAO;gBAAE,MAAM;gBAAS;YAAM;YAC9B,KAAK,CAAC,MAAQ,IAAI,OAAO,GAAG,UAAU,CAAC;oBAAE;gBAAM;QACjD;IACF;IAEA,qBAAO,ubAAC,kLAAW;QAAC,OAAO;kBAAM;;;;;;AACnC;AAEO,MAAM,oCAIT,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE;IACtB,MAAM,MAAM,IAAA,iJAAM,EAAC;QACjB,YAAY,IAAA,8IAAO,EAAC;YAClB,QAAQ;YACR,OAAO;gBAAE,MAAM;gBAAS;YAAM;YAC9B,KAAK,CAAC,MAAQ,IAAI,QAAQ,GAAG,UAAU,CAAC;oBAAE;gBAAM;QAClD;IACF;IAEA,qBAAO,ubAAC,kLAAW;QAAC,OAAO;kBAAM;;;;;;AACnC"}},
    {"offset": {"line": 3725, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-attachments.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentType, type FC, memo, useMemo } from \"react\";\nimport { Attachment } from \"../../types\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { ComposerAttachmentByIndexProvider } from \"../../context/providers\";\n\nexport namespace ComposerPrimitiveAttachments {\n  export type Props = {\n    components:\n      | {\n          Image?: ComponentType | undefined;\n          Document?: ComponentType | undefined;\n          File?: ComponentType | undefined;\n          Attachment?: ComponentType | undefined;\n        }\n      | undefined;\n  };\n}\n\nconst getComponent = (\n  components: ComposerPrimitiveAttachments.Props[\"components\"],\n  attachment: Attachment,\n) => {\n  const type = attachment.type;\n  switch (type) {\n    case \"image\":\n      return components?.Image ?? components?.Attachment;\n    case \"document\":\n      return components?.Document ?? components?.Attachment;\n    case \"file\":\n      return components?.File ?? components?.Attachment;\n    default:\n      const _exhaustiveCheck: never = type;\n      throw new Error(`Unknown attachment type: ${_exhaustiveCheck}`);\n  }\n};\n\nconst AttachmentComponent: FC<{\n  components: ComposerPrimitiveAttachments.Props[\"components\"];\n}> = ({ components }) => {\n  const attachment = useAuiState(({ attachment }) => attachment);\n  if (!attachment) return null;\n\n  const Component = getComponent(components, attachment);\n  if (!Component) return null;\n  return <Component />;\n};\n\nexport namespace ComposerPrimitiveAttachmentByIndex {\n  export type Props = {\n    index: number;\n    components?: ComposerPrimitiveAttachments.Props[\"components\"];\n  };\n}\n\n/**\n * Renders a single attachment at the specified index within the composer.\n *\n * This component provides direct access to render a specific attachment\n * from the composer's attachment list using the provided component configuration.\n *\n * @example\n * ```tsx\n * <ComposerPrimitive.AttachmentByIndex\n *   index={0}\n *   components={{\n *     Image: MyImageAttachment,\n *     Document: MyDocumentAttachment\n *   }}\n * />\n * ```\n */\nexport const ComposerPrimitiveAttachmentByIndex: FC<ComposerPrimitiveAttachmentByIndex.Props> =\n  memo(\n    ({ index, components }) => {\n      return (\n        <ComposerAttachmentByIndexProvider index={index}>\n          <AttachmentComponent components={components} />\n        </ComposerAttachmentByIndexProvider>\n      );\n    },\n    (prev, next) =>\n      prev.index === next.index &&\n      prev.components?.Image === next.components?.Image &&\n      prev.components?.Document === next.components?.Document &&\n      prev.components?.File === next.components?.File &&\n      prev.components?.Attachment === next.components?.Attachment,\n  );\n\nComposerPrimitiveAttachmentByIndex.displayName =\n  \"ComposerPrimitive.AttachmentByIndex\";\n\nexport const ComposerPrimitiveAttachments: FC<\n  ComposerPrimitiveAttachments.Props\n> = ({ components }) => {\n  const attachmentsCount = useAuiState((s) => s.composer.attachments.length);\n\n  const attachmentElements = useMemo(() => {\n    return Array.from({ length: attachmentsCount }, (_, index) => (\n      <ComposerPrimitiveAttachmentByIndex\n        key={index}\n        index={index}\n        components={components}\n      />\n    ));\n  }, [attachmentsCount, components]);\n\n  return attachmentElements;\n};\n\nComposerPrimitiveAttachments.displayName = \"ComposerPrimitive.Attachments\";\n"],"names":[],"mappings":";;;;;;;AAEA;AAEA;AACA;AALA;;;;;AAoBA,MAAM,eAAe,CACnB,YACA;IAEA,MAAM,OAAO,WAAW,IAAI;IAC5B,OAAQ;QACN,KAAK;YACH,OAAO,YAAY,SAAS,YAAY;QAC1C,KAAK;YACH,OAAO,YAAY,YAAY,YAAY;QAC7C,KAAK;YACH,OAAO,YAAY,QAAQ,YAAY;QACzC;YACE,MAAM,mBAA0B;YAChC,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,kBAAkB;IAClE;AACF;AAEA,MAAM,sBAED,CAAC,EAAE,UAAU,EAAE;IAClB,MAAM,aAAa,IAAA,+JAAW,EAAC,CAAC,EAAE,UAAU,EAAE,GAAK;IACnD,IAAI,CAAC,YAAY,OAAO;IAExB,MAAM,YAAY,aAAa,YAAY;IAC3C,IAAI,CAAC,WAAW,OAAO;IACvB,qBAAO,ubAAC;;;;;AACV;AA0BO,MAAM,mDACX,IAAA,sZAAI,EACF,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE;IACpB,qBACE,ubAAC,+NAAiC;QAAC,OAAO;kBACxC,cAAA,ubAAC;YAAoB,YAAY;;;;;;;;;;;AAGvC,GACA,CAAC,MAAM,OACL,KAAK,KAAK,KAAK,KAAK,KAAK,IACzB,KAAK,UAAU,EAAE,UAAU,KAAK,UAAU,EAAE,SAC5C,KAAK,UAAU,EAAE,aAAa,KAAK,UAAU,EAAE,YAC/C,KAAK,UAAU,EAAE,SAAS,KAAK,UAAU,EAAE,QAC3C,KAAK,UAAU,EAAE,eAAe,KAAK,UAAU,EAAE;AAGvD,mCAAmC,WAAW,GAC5C;AAEK,MAAM,+BAET,CAAC,EAAE,UAAU,EAAE;IACjB,MAAM,mBAAmB,IAAA,+JAAW,EAAC,CAAC,IAAM,EAAE,QAAQ,CAAC,WAAW,CAAC,MAAM;IAEzE,MAAM,qBAAqB,IAAA,yZAAO,EAAC;QACjC,OAAO,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAiB,GAAG,CAAC,GAAG,sBAClD,ubAAC;gBAEC,OAAO;gBACP,YAAY;eAFP;;;;;IAKX,GAAG;QAAC;QAAkB;KAAW;IAEjC,OAAO;AACT;AAEA,6BAA6B,WAAW,GAAG"}},
    {"offset": {"line": 3806, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-attachment-dropzone.tsx"],"sourcesContent":["\"use client\";\n\nimport { forwardRef, useCallback, useState } from \"react\";\n\nimport { Slot } from \"@radix-ui/react-slot\";\nimport React from \"react\";\nimport { useAui } from \"@creatorem/ai-store\";\n\nexport namespace ComposerPrimitiveAttachmentDropzone {\n  export type Element = HTMLDivElement;\n  export type Props = React.HTMLAttributes<HTMLDivElement> & {\n    asChild?: boolean | undefined;\n    disabled?: boolean | undefined;\n  };\n}\n\nexport const ComposerPrimitiveAttachmentDropzone = forwardRef<\n  HTMLDivElement,\n  ComposerPrimitiveAttachmentDropzone.Props\n>(({ disabled, asChild = false, children, ...rest }, ref) => {\n  const [isDragging, setIsDragging] = useState(false);\n  const aui = useAui();\n\n  const handleDragEnterCapture = useCallback(\n    (e: React.DragEvent) => {\n      if (disabled) return;\n      e.preventDefault();\n      setIsDragging(true);\n    },\n    [disabled],\n  );\n\n  const handleDragOverCapture = useCallback(\n    (e: React.DragEvent) => {\n      if (disabled) return;\n      e.preventDefault();\n      if (!isDragging) setIsDragging(true);\n    },\n    [disabled, isDragging],\n  );\n\n  const handleDragLeaveCapture = useCallback(\n    (e: React.DragEvent) => {\n      if (disabled) return;\n      e.preventDefault();\n      const next = e.relatedTarget as Node | null;\n      if (next && e.currentTarget.contains(next)) {\n        return;\n      }\n      setIsDragging(false);\n    },\n    [disabled],\n  );\n\n  const handleDrop = useCallback(\n    async (e: React.DragEvent) => {\n      if (disabled) return;\n      e.preventDefault();\n      setIsDragging(false);\n      for (const file of e.dataTransfer.files) {\n        try {\n          await aui.composer().addAttachment(file);\n        } catch (error) {\n          console.error(\"Failed to add attachment:\", error);\n        }\n      }\n    },\n    [disabled, aui],\n  );\n\n  const dragProps = {\n    onDragEnterCapture: handleDragEnterCapture,\n    onDragOverCapture: handleDragOverCapture,\n    onDragLeaveCapture: handleDragLeaveCapture,\n    onDropCapture: handleDrop,\n  };\n\n  const Comp = asChild ? Slot : \"div\";\n\n  return (\n    <Comp\n      {...(isDragging ? { \"data-dragging\": \"true\" } : null)}\n      ref={ref}\n      {...dragProps}\n      {...rest}\n    >\n      {children}\n    </Comp>\n  );\n});\n\nComposerPrimitiveAttachmentDropzone.displayName =\n  \"ComposerPrimitive.AttachmentDropzone\";\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AAEA;AANA;;;;;AAgBO,MAAM,oDAAsC,IAAA,4ZAAU,EAG3D,CAAC,EAAE,QAAQ,EAAE,UAAU,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,EAAE;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,0ZAAQ,EAAC;IAC7C,MAAM,MAAM,IAAA,iJAAM;IAElB,MAAM,yBAAyB,IAAA,6ZAAW,EACxC,CAAC;QACC,IAAI,UAAU;QACd,EAAE,cAAc;QAChB,cAAc;IAChB,GACA;QAAC;KAAS;IAGZ,MAAM,wBAAwB,IAAA,6ZAAW,EACvC,CAAC;QACC,IAAI,UAAU;QACd,EAAE,cAAc;QAChB,IAAI,CAAC,YAAY,cAAc;IACjC,GACA;QAAC;QAAU;KAAW;IAGxB,MAAM,yBAAyB,IAAA,6ZAAW,EACxC,CAAC;QACC,IAAI,UAAU;QACd,EAAE,cAAc;QAChB,MAAM,OAAO,EAAE,aAAa;QAC5B,IAAI,QAAQ,EAAE,aAAa,CAAC,QAAQ,CAAC,OAAO;YAC1C;QACF;QACA,cAAc;IAChB,GACA;QAAC;KAAS;IAGZ,MAAM,aAAa,IAAA,6ZAAW,EAC5B,OAAO;QACL,IAAI,UAAU;QACd,EAAE,cAAc;QAChB,cAAc;QACd,KAAK,MAAM,QAAQ,EAAE,YAAY,CAAC,KAAK,CAAE;YACvC,IAAI;gBACF,MAAM,IAAI,QAAQ,GAAG,aAAa,CAAC;YACrC,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,6BAA6B;YAC7C;QACF;IACF,GACA;QAAC;QAAU;KAAI;IAGjB,MAAM,YAAY;QAChB,oBAAoB;QACpB,mBAAmB;QACnB,oBAAoB;QACpB,eAAe;IACjB;IAEA,MAAM,OAAO,UAAU,6SAAI,GAAG;IAE9B,qBACE,ubAAC;QACE,GAAI,aAAa;YAAE,iBAAiB;QAAO,IAAI,IAAI;QACpD,KAAK;QACJ,GAAG,SAAS;QACZ,GAAG,IAAI;kBAEP;;;;;;AAGP;AAEA,oCAAoC,WAAW,GAC7C"}},
    {"offset": {"line": 3889, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-dictate.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback } from \"react\";\nimport { useAui, useAuiState } from \"@creatorem/ai-store\";\nimport type {\n  ActionButtonElement,\n  ActionButtonProps,\n} from \"../../utils/create-action-button\";\nimport { createActionButton } from \"../../utils/create-action-button\";\n\nconst useComposerDictate = () => {\n  const aui = useAui();\n  const disabled = useAuiState(\n    ({ thread, composer }) =>\n      composer.dictation != null ||\n      !thread.capabilities.dictation ||\n      !composer.isEditing,\n  );\n\n  const callback = useCallback(() => {\n    aui.composer().startDictation();\n  }, [aui]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace ComposerPrimitiveDictate {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useComposerDictate>;\n}\n\n/**\n * A button that starts dictation to convert voice to text.\n *\n * Requires a DictationAdapter to be configured in the runtime.\n *\n * @example\n * ```tsx\n * <ComposerPrimitive.Dictate>\n *   <MicIcon />\n * </ComposerPrimitive.Dictate>\n * ```\n */\nexport const ComposerPrimitiveDictate = createActionButton(\n  \"ComposerPrimitive.Dictate\",\n  useComposerDictate,\n);\n"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AAKA;AARA;;;;AAUA,MAAM,qBAAqB;IACzB,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,WAAW,IAAA,+JAAW,EAC1B,CAAC,EAAE,MAAM,EAAE,QAAQ,EAAE,GACnB,SAAS,SAAS,IAAI,QACtB,CAAC,OAAO,YAAY,CAAC,SAAS,IAC9B,CAAC,SAAS,SAAS;IAGvB,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,QAAQ,GAAG,cAAc;IAC/B,GAAG;QAAC;KAAI;IAER,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAmBO,MAAM,2BAA2B,IAAA,sLAAkB,EACxD,6BACA"}},
    {"offset": {"line": 3917, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-stop-dictation.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback } from \"react\";\nimport { useAui } from \"@creatorem/ai-store\";\nimport type {\n  ActionButtonElement,\n  ActionButtonProps,\n} from \"../../utils/create-action-button\";\nimport { createActionButton } from \"../../utils/create-action-button\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nconst useComposerStopDictation = () => {\n  const aui = useAui();\n  const isDictating = useAuiState(({ composer }) => composer.dictation != null);\n\n  const callback = useCallback(() => {\n    aui.composer().stopDictation();\n  }, [aui]);\n\n  if (!isDictating) return null;\n  return callback;\n};\n\nexport namespace ComposerPrimitiveStopDictation {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useComposerStopDictation>;\n}\n\n/**\n * A button that stops the current dictation session.\n *\n * Only rendered when dictation is active.\n *\n * @example\n * ```tsx\n * <ComposerPrimitive.StopDictation>\n *   <StopIcon />\n * </ComposerPrimitive.StopDictation>\n * ```\n */\nexport const ComposerPrimitiveStopDictation = createActionButton(\n  \"ComposerPrimitive.StopDictation\",\n  useComposerStopDictation,\n);\n"],"names":[],"mappings":";;;;AAEA;AACA;AAKA;AACA;AATA;;;;;AAWA,MAAM,2BAA2B;IAC/B,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,cAAc,IAAA,+JAAW,EAAC,CAAC,EAAE,QAAQ,EAAE,GAAK,SAAS,SAAS,IAAI;IAExE,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,QAAQ,GAAG,aAAa;IAC9B,GAAG;QAAC;KAAI;IAER,IAAI,CAAC,aAAa,OAAO;IACzB,OAAO;AACT;AAmBO,MAAM,iCAAiC,IAAA,sLAAkB,EAC9D,mCACA"}},
    {"offset": {"line": 3946, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-dictation-transcript.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { type ComponentRef, forwardRef, ComponentPropsWithoutRef } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nexport namespace ComposerPrimitiveDictationTranscript {\n  export type Element = ComponentRef<typeof Primitive.span>;\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.span>;\n}\n\n/**\n * Renders the current interim (partial) transcript while dictation is active.\n *\n * This component displays real-time feedback of what the user is saying before\n * the transcription is finalized and committed to the composer input.\n *\n * @example\n * ```tsx\n * <ComposerPrimitive.If dictation>\n *   <div className=\"dictation-preview\">\n *     <ComposerPrimitive.DictationTranscript />\n *   </div>\n * </ComposerPrimitive.If>\n * ```\n */\nexport const ComposerPrimitiveDictationTranscript = forwardRef<\n  ComposerPrimitiveDictationTranscript.Element,\n  ComposerPrimitiveDictationTranscript.Props\n>(({ children, ...props }, forwardRef) => {\n  const transcript = useAuiState(\n    ({ composer }) => composer.dictation?.transcript,\n  );\n\n  if (!transcript) return null;\n\n  return (\n    <Primitive.span {...props} ref={forwardRef}>\n      {children ?? transcript}\n    </Primitive.span>\n  );\n});\n\nComposerPrimitiveDictationTranscript.displayName =\n  \"ComposerPrimitive.DictationTranscript\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AA0BO,MAAM,qDAAuC,IAAA,4ZAAU,EAG5D,CAAC,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IACzB,MAAM,aAAa,IAAA,+JAAW,EAC5B,CAAC,EAAE,QAAQ,EAAE,GAAK,SAAS,SAAS,EAAE;IAGxC,IAAI,CAAC,YAAY,OAAO;IAExB,qBACE,ubAAC,mYAAS,CAAC,IAAI;QAAE,GAAG,KAAK;QAAE,KAAK;kBAC7B,YAAY;;;;;;AAGnB;AAEA,qCAAqC,WAAW,GAC9C"}},
    {"offset": {"line": 3977, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/composer/composer-if.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC, PropsWithChildren } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport type { RequireAtLeastOne } from \"../../utils/require-at-least-one\";\n\ntype ComposerIfFilters = {\n  /** Whether the composer is in editing mode */\n  editing: boolean | undefined;\n  /** Whether dictation is currently active */\n  dictation: boolean | undefined;\n};\n\nexport type UseComposerIfProps = RequireAtLeastOne<ComposerIfFilters>;\n\nconst useComposerIf = (props: UseComposerIfProps) => {\n  return useAuiState(({ composer }) => {\n    if (props.editing === true && !composer.isEditing) return false;\n    if (props.editing === false && composer.isEditing) return false;\n\n    const isDictating = composer.dictation != null;\n    if (props.dictation === true && !isDictating) return false;\n    if (props.dictation === false && isDictating) return false;\n\n    return true;\n  });\n};\n\nexport namespace ComposerPrimitiveIf {\n  export type Props = PropsWithChildren<UseComposerIfProps>;\n}\n\n/**\n * @deprecated Use `<AuiIf condition={({ composer }) => ...} />` instead.\n */\nexport const ComposerPrimitiveIf: FC<ComposerPrimitiveIf.Props> = ({\n  children,\n  ...query\n}) => {\n  const result = useComposerIf(query);\n  return result ? children : null;\n};\n\nComposerPrimitiveIf.displayName = \"ComposerPrimitive.If\";\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AAeA,MAAM,gBAAgB,CAAC;IACrB,OAAO,IAAA,+JAAW,EAAC,CAAC,EAAE,QAAQ,EAAE;QAC9B,IAAI,MAAM,OAAO,KAAK,QAAQ,CAAC,SAAS,SAAS,EAAE,OAAO;QAC1D,IAAI,MAAM,OAAO,KAAK,SAAS,SAAS,SAAS,EAAE,OAAO;QAE1D,MAAM,cAAc,SAAS,SAAS,IAAI;QAC1C,IAAI,MAAM,SAAS,KAAK,QAAQ,CAAC,aAAa,OAAO;QACrD,IAAI,MAAM,SAAS,KAAK,SAAS,aAAa,OAAO;QAErD,OAAO;IACT;AACF;AASO,MAAM,sBAAqD,CAAC,EACjE,QAAQ,EACR,GAAG,OACJ;IACC,MAAM,SAAS,cAAc;IAC7B,OAAO,SAAS,WAAW;AAC7B;AAEA,oBAAoB,WAAW,GAAG"}},
    {"offset": {"line": 4054, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 4068, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/hooks/use-managed-ref.ts"],"sourcesContent":["import { useCallback, useRef } from \"react\";\n\nexport const useManagedRef = <TNode>(\n  callback: (node: TNode) => (() => void) | void,\n) => {\n  const cleanupRef = useRef<(() => void) | void>(undefined);\n\n  const ref = useCallback(\n    (el: TNode | null) => {\n      // Call the previous cleanup function\n      if (cleanupRef.current) {\n        cleanupRef.current();\n      }\n\n      // Call the new callback and store its cleanup function\n      if (el) {\n        cleanupRef.current = callback(el);\n      }\n    },\n    [callback],\n  );\n\n  return ref;\n};\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,gBAAgB,CAC3B;IAEA,MAAM,aAAa,IAAA,wZAAM,EAAsB;IAE/C,MAAM,MAAM,IAAA,6ZAAW,EACrB,CAAC;QACC,qCAAqC;QACrC,IAAI,WAAW,OAAO,EAAE;YACtB,WAAW,OAAO;QACpB;QAEA,uDAAuD;QACvD,IAAI,IAAI;YACN,WAAW,OAAO,GAAG,SAAS;QAChC;IACF,GACA;QAAC;KAAS;IAGZ,OAAO;AACT"}},
    {"offset": {"line": 4094, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/hooks/use-size-handle.ts"],"sourcesContent":["\"use client\";\n\nimport { useCallback } from \"react\";\nimport { useManagedRef } from \"./use-managed-ref\";\nimport type { SizeHandle } from \"../../context/stores/thread-viewport\";\n\n/**\n * Hook that creates a ref for tracking element size via a SizeHandle.\n * Automatically sets up ResizeObserver and reports height changes.\n *\n * @param register - Function that returns a SizeHandle (e.g., registerContentInset)\n * @param getHeight - Optional function to compute height (defaults to el.offsetHeight)\n * @returns A ref callback to attach to the element\n */\nexport const useSizeHandle = (\n  register: (() => SizeHandle) | null | undefined,\n  getHeight?: (el: HTMLElement) => number,\n) => {\n  const callbackRef = useCallback(\n    (el: HTMLElement) => {\n      if (!register) return;\n\n      const sizeHandle = register();\n\n      const updateHeight = () => {\n        const height = getHeight ? getHeight(el) : el.offsetHeight;\n        sizeHandle.setHeight(height);\n      };\n\n      const ro = new ResizeObserver(updateHeight);\n      ro.observe(el);\n      updateHeight();\n\n      return () => {\n        ro.disconnect();\n        sizeHandle.unregister();\n      };\n    },\n    [register, getHeight],\n  );\n\n  return useManagedRef(callbackRef);\n};\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAcO,MAAM,gBAAgB,CAC3B,UACA;IAEA,MAAM,cAAc,IAAA,6ZAAW,EAC7B,CAAC;QACC,IAAI,CAAC,UAAU;QAEf,MAAM,aAAa;QAEnB,MAAM,eAAe;YACnB,MAAM,SAAS,YAAY,UAAU,MAAM,GAAG,YAAY;YAC1D,WAAW,SAAS,CAAC;QACvB;QAEA,MAAM,KAAK,IAAI,eAAe;QAC9B,GAAG,OAAO,CAAC;QACX;QAEA,OAAO;YACL,GAAG,UAAU;YACb,WAAW,UAAU;QACvB;IACF,GACA;QAAC;QAAU;KAAU;IAGvB,OAAO,IAAA,oLAAa,EAAC;AACvB"}},
    {"offset": {"line": 4128, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-viewport-slack.tsx"],"sourcesContent":["\"use client\";\n\nimport { Slot } from \"@radix-ui/react-slot\";\nimport {\n  createContext,\n  type FC,\n  type ReactNode,\n  useCallback,\n  useContext,\n} from \"react\";\nimport { useThreadViewportStore } from \"../../context/react/thread-viewport-context\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { useManagedRef } from \"../../utils/hooks/use-managed-ref\";\n\nconst SlackNestingContext = createContext(false);\n\nconst parseCssLength = (value: string, element: HTMLElement): number => {\n  const match = value.match(/^([\\d.]+)(em|px|rem)$/);\n  if (!match) return 0;\n\n  const num = parseFloat(match[1]!);\n  const unit = match[2];\n\n  if (unit === \"px\") return num;\n  if (unit === \"em\") {\n    const fontSize = parseFloat(getComputedStyle(element).fontSize) || 16;\n    return num * fontSize;\n  }\n  if (unit === \"rem\") {\n    const rootFontSize =\n      parseFloat(getComputedStyle(document.documentElement).fontSize) || 16;\n    return num * rootFontSize;\n  }\n  return 0;\n};\n\nexport type ThreadViewportSlackProps = {\n  /** Threshold at which the user message height clamps to the offset */\n  fillClampThreshold?: string;\n  /** Offset used when clamping large user messages */\n  fillClampOffset?: string;\n  children: ReactNode;\n};\n\n/**\n * A slot component that provides minimum height to enable scroll anchoring.\n *\n * When using `turnAnchor=\"top\"`, this component ensures there is\n * enough scroll room below the anchor point (last user message) for it to scroll\n * to the top of the viewport. The min-height is applied only to the last\n * assistant message.\n *\n * This component is used internally by MessagePrimitive.Root.\n */\nexport const ThreadPrimitiveViewportSlack: FC<ThreadViewportSlackProps> = ({\n  children,\n  fillClampThreshold = \"10em\",\n  fillClampOffset = \"6em\",\n}) => {\n  const shouldApplySlack = useAuiState(\n    // only add slack to the last assistant message following a user message (valid turn)\n    ({ thread, message }) =>\n      message.isLast &&\n      message.role === \"assistant\" &&\n      message.index >= 1 &&\n      thread.messages.at(message.index - 1)?.role === \"user\",\n  );\n  const threadViewportStore = useThreadViewportStore({ optional: true });\n  const isNested = useContext(SlackNestingContext);\n\n  const callback = useCallback(\n    (el: HTMLElement) => {\n      if (!threadViewportStore || isNested) return;\n\n      const updateMinHeight = () => {\n        const state = threadViewportStore.getState();\n        if (state.turnAnchor === \"top\" && shouldApplySlack) {\n          const { viewport, inset, userMessage } = state.height;\n          const threshold = parseCssLength(fillClampThreshold, el);\n          const offset = parseCssLength(fillClampOffset, el);\n          const clampAdjustment =\n            userMessage <= threshold ? userMessage : offset;\n\n          const minHeight = Math.max(0, viewport - inset - clampAdjustment);\n          el.style.minHeight = `${minHeight}px`;\n          el.style.flexShrink = \"0\";\n          el.style.transition = \"min-height 0s\";\n        } else {\n          el.style.minHeight = \"\";\n          el.style.flexShrink = \"\";\n          el.style.transition = \"\";\n        }\n      };\n\n      updateMinHeight();\n      return threadViewportStore.subscribe(updateMinHeight);\n    },\n    [\n      threadViewportStore,\n      shouldApplySlack,\n      isNested,\n      fillClampThreshold,\n      fillClampOffset,\n    ],\n  );\n\n  const ref = useManagedRef<HTMLElement>(callback);\n\n  return (\n    <SlackNestingContext.Provider value={true}>\n      <Slot ref={ref}>{children}</Slot>\n    </SlackNestingContext.Provider>\n  );\n};\n\nThreadPrimitiveViewportSlack.displayName = \"ThreadPrimitive.ViewportSlack\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAOA;AACA;AACA;AAZA;;;;;;;AAcA,MAAM,oCAAsB,IAAA,+ZAAa,EAAC;AAE1C,MAAM,iBAAiB,CAAC,OAAe;IACrC,MAAM,QAAQ,MAAM,KAAK,CAAC;IAC1B,IAAI,CAAC,OAAO,OAAO;IAEnB,MAAM,MAAM,WAAW,KAAK,CAAC,EAAE;IAC/B,MAAM,OAAO,KAAK,CAAC,EAAE;IAErB,IAAI,SAAS,MAAM,OAAO;IAC1B,IAAI,SAAS,MAAM;QACjB,MAAM,WAAW,WAAW,iBAAiB,SAAS,QAAQ,KAAK;QACnE,OAAO,MAAM;IACf;IACA,IAAI,SAAS,OAAO;QAClB,MAAM,eACJ,WAAW,iBAAiB,SAAS,eAAe,EAAE,QAAQ,KAAK;QACrE,OAAO,MAAM;IACf;IACA,OAAO;AACT;AAoBO,MAAM,+BAA6D,CAAC,EACzE,QAAQ,EACR,qBAAqB,MAAM,EAC3B,kBAAkB,KAAK,EACxB;IACC,MAAM,mBAAmB,IAAA,+JAAW,EAClC,qFAAqF;IACrF,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,GAClB,QAAQ,MAAM,IACd,QAAQ,IAAI,KAAK,eACjB,QAAQ,KAAK,IAAI,KACjB,OAAO,QAAQ,CAAC,EAAE,CAAC,QAAQ,KAAK,GAAG,IAAI,SAAS;IAEpD,MAAM,sBAAsB,IAAA,uMAAsB,EAAC;QAAE,UAAU;IAAK;IACpE,MAAM,WAAW,IAAA,4ZAAU,EAAC;IAE5B,MAAM,WAAW,IAAA,6ZAAW,EAC1B,CAAC;QACC,IAAI,CAAC,uBAAuB,UAAU;QAEtC,MAAM,kBAAkB;YACtB,MAAM,QAAQ,oBAAoB,QAAQ;YAC1C,IAAI,MAAM,UAAU,KAAK,SAAS,kBAAkB;gBAClD,MAAM,EAAE,QAAQ,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,MAAM,MAAM;gBACrD,MAAM,YAAY,eAAe,oBAAoB;gBACrD,MAAM,SAAS,eAAe,iBAAiB;gBAC/C,MAAM,kBACJ,eAAe,YAAY,cAAc;gBAE3C,MAAM,YAAY,KAAK,GAAG,CAAC,GAAG,WAAW,QAAQ;gBACjD,GAAG,KAAK,CAAC,SAAS,GAAG,GAAG,UAAU,EAAE,CAAC;gBACrC,GAAG,KAAK,CAAC,UAAU,GAAG;gBACtB,GAAG,KAAK,CAAC,UAAU,GAAG;YACxB,OAAO;gBACL,GAAG,KAAK,CAAC,SAAS,GAAG;gBACrB,GAAG,KAAK,CAAC,UAAU,GAAG;gBACtB,GAAG,KAAK,CAAC,UAAU,GAAG;YACxB;QACF;QAEA;QACA,OAAO,oBAAoB,SAAS,CAAC;IACvC,GACA;QACE;QACA;QACA;QACA;QACA;KACD;IAGH,MAAM,MAAM,IAAA,oLAAa,EAAc;IAEvC,qBACE,ubAAC,oBAAoB,QAAQ;QAAC,OAAO;kBACnC,cAAA,ubAAC,6SAAI;YAAC,KAAK;sBAAM;;;;;;;;;;;AAGvB;AAEA,6BAA6B,WAAW,GAAG"}},
    {"offset": {"line": 4219, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message/message-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport {\n  type ComponentRef,\n  forwardRef,\n  ComponentPropsWithoutRef,\n  useCallback,\n} from \"react\";\nimport { useAui, useAuiState } from \"@creatorem/ai-store\";\nimport { useManagedRef } from \"../../utils/hooks/use-managed-ref\";\nimport { useSizeHandle } from \"../../utils/hooks/use-size-handle\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { useThreadViewport } from \"../../context/react/thread-viewport-context\";\nimport { ThreadPrimitiveViewportSlack } from \"../thread/thread-viewport-slack\";\n\nconst useIsHoveringRef = () => {\n  const aui = useAui();\n  const message = useAuiState(() => aui.message());\n\n  const callbackRef = useCallback(\n    (el: HTMLElement) => {\n      const handleMouseEnter = () => {\n        message.setIsHovering(true);\n      };\n      const handleMouseLeave = () => {\n        message.setIsHovering(false);\n      };\n\n      el.addEventListener(\"mouseenter\", handleMouseEnter);\n      el.addEventListener(\"mouseleave\", handleMouseLeave);\n\n      if (el.matches(\":hover\")) {\n        // TODO this is needed for SSR to work, figure out why\n        queueMicrotask(() => message.setIsHovering(true));\n      }\n\n      return () => {\n        el.removeEventListener(\"mouseenter\", handleMouseEnter);\n        el.removeEventListener(\"mouseleave\", handleMouseLeave);\n        message.setIsHovering(false);\n      };\n    },\n    [message],\n  );\n\n  return useManagedRef(callbackRef);\n};\n\n/**\n * Hook that registers the anchor user message as a content inset.\n * Only registers if: user message, at index messages.length-2, and last message is assistant.\n */\nconst useMessageViewportRef = () => {\n  const turnAnchor = useThreadViewport((s) => s.turnAnchor);\n  const registerUserHeight = useThreadViewport(\n    (s) => s.registerUserMessageHeight,\n  );\n\n  // inset rules:\n  // - the previous user message before the last assistant message registers its full height\n  const shouldRegisterAsInset = useAuiState(\n    ({ thread, message }) =>\n      turnAnchor === \"top\" &&\n      message.role === \"user\" &&\n      message.index === thread.messages.length - 2 &&\n      thread.messages.at(-1)?.role === \"assistant\",\n  );\n\n  const getHeight = useCallback((el: HTMLElement) => el.offsetHeight, []);\n\n  return useSizeHandle(\n    shouldRegisterAsInset ? registerUserHeight : null,\n    getHeight,\n  );\n};\n\nexport namespace MessagePrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  /**\n   * Props for the MessagePrimitive.Root component.\n   * Accepts all standard div element props.\n   */\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.div>;\n}\n\n/**\n * The root container component for a message.\n *\n * This component provides the foundational wrapper for message content and handles\n * hover state management for the message. It automatically tracks when the user\n * is hovering over the message, which can be used by child components like action bars.\n *\n * When `turnAnchor=\"top\"` is set on the viewport, this component\n * registers itself as the scroll anchor if it's the last user message.\n *\n * @example\n * ```tsx\n * <MessagePrimitive.Root>\n *   <MessagePrimitive.Content />\n *   <ActionBarPrimitive.Root>\n *     <ActionBarPrimitive.Copy />\n *     <ActionBarPrimitive.Edit />\n *   </ActionBarPrimitive.Root>\n * </MessagePrimitive.Root>\n * ```\n */\nexport const MessagePrimitiveRoot = forwardRef<\n  MessagePrimitiveRoot.Element,\n  MessagePrimitiveRoot.Props\n>((props, forwardRef) => {\n  const isHoveringRef = useIsHoveringRef();\n  const anchorUserMessageRef = useMessageViewportRef();\n  const ref = useComposedRefs<HTMLDivElement>(\n    forwardRef,\n    isHoveringRef,\n    anchorUserMessageRef,\n  );\n\n  return (\n    <ThreadPrimitiveViewportSlack>\n      <Primitive.div {...props} ref={ref} />\n    </ThreadPrimitiveViewportSlack>\n  );\n});\n\nMessagePrimitiveRoot.displayName = \"MessagePrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAMA;AAAA;AACA;AACA;AACA;AACA;AACA;AAdA;;;;;;;;;;AAgBA,MAAM,mBAAmB;IACvB,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,UAAU,IAAA,+JAAW,EAAC,IAAM,IAAI,OAAO;IAE7C,MAAM,cAAc,IAAA,6ZAAW,EAC7B,CAAC;QACC,MAAM,mBAAmB;YACvB,QAAQ,aAAa,CAAC;QACxB;QACA,MAAM,mBAAmB;YACvB,QAAQ,aAAa,CAAC;QACxB;QAEA,GAAG,gBAAgB,CAAC,cAAc;QAClC,GAAG,gBAAgB,CAAC,cAAc;QAElC,IAAI,GAAG,OAAO,CAAC,WAAW;YACxB,sDAAsD;YACtD,eAAe,IAAM,QAAQ,aAAa,CAAC;QAC7C;QAEA,OAAO;YACL,GAAG,mBAAmB,CAAC,cAAc;YACrC,GAAG,mBAAmB,CAAC,cAAc;YACrC,QAAQ,aAAa,CAAC;QACxB;IACF,GACA;QAAC;KAAQ;IAGX,OAAO,IAAA,oLAAa,EAAC;AACvB;AAEA;;;CAGC,GACD,MAAM,wBAAwB;IAC5B,MAAM,aAAa,IAAA,kMAAiB,EAAC,CAAC,IAAM,EAAE,UAAU;IACxD,MAAM,qBAAqB,IAAA,kMAAiB,EAC1C,CAAC,IAAM,EAAE,yBAAyB;IAGpC,eAAe;IACf,0FAA0F;IAC1F,MAAM,wBAAwB,IAAA,+JAAW,EACvC,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,GAClB,eAAe,SACf,QAAQ,IAAI,KAAK,UACjB,QAAQ,KAAK,KAAK,OAAO,QAAQ,CAAC,MAAM,GAAG,KAC3C,OAAO,QAAQ,CAAC,EAAE,CAAC,CAAC,IAAI,SAAS;IAGrC,MAAM,YAAY,IAAA,6ZAAW,EAAC,CAAC,KAAoB,GAAG,YAAY,EAAE,EAAE;IAEtE,OAAO,IAAA,oLAAa,EAClB,wBAAwB,qBAAqB,MAC7C;AAEJ;AAgCO,MAAM,qCAAuB,IAAA,4ZAAU,EAG5C,CAAC,OAAO;IACR,MAAM,gBAAgB;IACtB,MAAM,uBAAuB;IAC7B,MAAM,MAAM,IAAA,8UAAe,EACzB,YACA,eACA;IAGF,qBACE,ubAAC,gNAA4B;kBAC3B,cAAA,ubAAC,mYAAS,CAAC,GAAG;YAAE,GAAG,KAAK;YAAE,KAAK;;;;;;;;;;;AAGrC;AAEA,qBAAqB,WAAW,GAAG"}},
    {"offset": {"line": 4305, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/providers/part-by-index-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { type FC, type PropsWithChildren } from \"react\";\nimport { useAui, AuiProvider, Derived } from \"@creatorem/ai-store\";\n\nexport const PartByIndexProvider: FC<\n  PropsWithChildren<{\n    index: number;\n  }>\n> = ({ index, children }) => {\n  const aui = useAui({\n    part: Derived({\n      source: \"message\",\n      query: { type: \"index\", index },\n      get: (aui) => aui.message().part({ index }),\n    }),\n  });\n\n  return <AuiProvider value={aui}>{children}</AuiProvider>;\n};\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAAA;AAHA;;;AAKO,MAAM,sBAIT,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE;IACtB,MAAM,MAAM,IAAA,iJAAM,EAAC;QACjB,MAAM,IAAA,8IAAO,EAAC;YACZ,QAAQ;YACR,OAAO;gBAAE,MAAM;gBAAS;YAAM;YAC9B,KAAK,CAAC,MAAQ,IAAI,OAAO,GAAG,IAAI,CAAC;oBAAE;gBAAM;QAC3C;IACF;IAEA,qBAAO,ubAAC,kLAAW;QAAC,OAAO;kBAAM;;;;;;AACnC"}},
    {"offset": {"line": 4342, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/providers/text-message-part-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { type FC, type PropsWithChildren } from \"react\";\nimport { useAui, AuiProvider, type ClientOutput } from \"@creatorem/ai-store\";\nimport { PartState } from \"../../types/scopes\";\nimport { resource, tapMemo } from \"@creatorem/ai-tap\";\n\nconst TextMessagePartClient = resource(\n  ({\n    text,\n    isRunning,\n  }: {\n    text: string;\n    isRunning: boolean;\n  }): ClientOutput<\"part\"> => {\n    const state = tapMemo<PartState>(\n      () => ({\n        type: \"text\",\n        text,\n        status: isRunning ? { type: \"running\" } : { type: \"complete\" },\n      }),\n      [text, isRunning],\n    );\n\n    return {\n      state,\n      methods: {\n        getState: () => state,\n        addToolResult: () => {\n          throw new Error(\"Not supported\");\n        },\n        resumeToolCall: () => {\n          throw new Error(\"Not supported\");\n        },\n      },\n    };\n  },\n);\n\nexport const TextMessagePartProvider: FC<\n  PropsWithChildren<{\n    text: string;\n    isRunning?: boolean;\n  }>\n> = ({ text, isRunning = false, children }) => {\n  const aui = useAui({\n    part: TextMessagePartClient({ text, isRunning }),\n  });\n\n  return <AuiProvider value={aui}>{children}</AuiProvider>;\n};\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAEA;AAAA;AALA;;;;AAOA,MAAM,wBAAwB,IAAA,sJAAQ,EACpC,CAAC,EACC,IAAI,EACJ,SAAS,EAIV;IACC,MAAM,QAAQ,IAAA,yJAAO,EACnB,IAAM,CAAC;YACL,MAAM;YACN;YACA,QAAQ,YAAY;gBAAE,MAAM;YAAU,IAAI;gBAAE,MAAM;YAAW;QAC/D,CAAC,GACD;QAAC;QAAM;KAAU;IAGnB,OAAO;QACL;QACA,SAAS;YACP,UAAU,IAAM;YAChB,eAAe;gBACb,MAAM,IAAI,MAAM;YAClB;YACA,gBAAgB;gBACd,MAAM,IAAI,MAAM;YAClB;QACF;IACF;AACF;AAGK,MAAM,0BAKT,CAAC,EAAE,IAAI,EAAE,YAAY,KAAK,EAAE,QAAQ,EAAE;IACxC,MAAM,MAAM,IAAA,iJAAM,EAAC;QACjB,MAAM,sBAAsB;YAAE;YAAM;QAAU;IAChD;IAEA,qBAAO,ubAAC,kLAAW;QAAC,OAAO;kBAAM;;;;;;AACnC"}},
    {"offset": {"line": 4401, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message-part/use-message-part-text.tsx"],"sourcesContent":["\"use client\";\n\nimport { MessagePartState } from \"../../legacy-runtime/runtime/message-part-runtime\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { TextMessagePart, ReasoningMessagePart } from \"../../types\";\n\nexport const useMessagePartText = () => {\n  const text = useAuiState(({ part }) => {\n    if (part.type !== \"text\" && part.type !== \"reasoning\")\n      throw new Error(\n        \"MessagePartText can only be used inside text or reasoning message parts.\",\n      );\n\n    return part as MessagePartState & (TextMessagePart | ReasoningMessagePart);\n  });\n\n  return text;\n};\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AAMO,MAAM,qBAAqB;IAChC,MAAM,OAAO,IAAA,+JAAW,EAAC,CAAC,EAAE,IAAI,EAAE;QAChC,IAAI,KAAK,IAAI,KAAK,UAAU,KAAK,IAAI,KAAK,aACxC,MAAM,IAAI,MACR;QAGJ,OAAO;IACT;IAEA,OAAO;AACT"}},
    {"offset": {"line": 4419, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/smooth/smooth-context.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ComponentType,\n  createContext,\n  FC,\n  forwardRef,\n  PropsWithChildren,\n  useContext,\n  useState,\n} from \"react\";\nimport { ReadonlyStore } from \"../../context/readonly-store\";\nimport { create, UseBoundStore } from \"zustand\";\nimport {\n  MessagePartStatus,\n  ToolCallMessagePartStatus,\n} from \"../../types/assistant-types\";\nimport { useAui } from \"@creatorem/ai-store\";\nimport { createContextStoreHook } from \"../../context/react/utils/create-context-store-hook\";\n\ntype SmoothContextValue = {\n  useSmoothStatus: UseBoundStore<\n    ReadonlyStore<MessagePartStatus | ToolCallMessagePartStatus>\n  >;\n};\n\nconst SmoothContext = createContext<SmoothContextValue | null>(null);\n\nconst makeSmoothContext = (\n  initialState: MessagePartStatus | ToolCallMessagePartStatus,\n) => {\n  const useSmoothStatus = create(() => initialState);\n  return { useSmoothStatus };\n};\n\nexport const SmoothContextProvider: FC<PropsWithChildren> = ({ children }) => {\n  const outer = useSmoothContext({ optional: true });\n  const aui = useAui();\n\n  const [context] = useState(() =>\n    makeSmoothContext(aui.part().getState().status),\n  );\n\n  // do not wrap if there is an outer SmoothContextProvider\n  if (outer) return children;\n\n  return (\n    <SmoothContext.Provider value={context}>{children}</SmoothContext.Provider>\n  );\n};\n\nexport const withSmoothContextProvider = <C extends ComponentType<any>>(\n  Component: C,\n): C => {\n  const Wrapped = forwardRef((props, ref) => {\n    return (\n      <SmoothContextProvider>\n        <Component {...(props as any)} ref={ref} />\n      </SmoothContextProvider>\n    );\n  });\n  Wrapped.displayName = Component.displayName;\n  return Wrapped as any;\n};\n\nfunction useSmoothContext(options?: {\n  optional?: false | undefined;\n}): SmoothContextValue;\nfunction useSmoothContext(options?: {\n  optional?: boolean | undefined;\n}): SmoothContextValue | null;\nfunction useSmoothContext(options?: { optional?: boolean | undefined }) {\n  const context = useContext(SmoothContext);\n  if (!options?.optional && !context)\n    throw new Error(\n      \"This component must be used within a SmoothContextProvider.\",\n    );\n  return context;\n}\n\nexport const { useSmoothStatus, useSmoothStatusStore } = createContextStoreHook(\n  useSmoothContext,\n  \"useSmoothStatus\",\n);\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AAUA;AAKA;AACA;AAlBA;;;;;;AA0BA,MAAM,8BAAgB,IAAA,+ZAAa,EAA4B;AAE/D,MAAM,oBAAoB,CACxB;IAEA,MAAM,kBAAkB,IAAA,8VAAM,EAAC,IAAM;IACrC,OAAO;QAAE;IAAgB;AAC3B;AAEO,MAAM,wBAA+C,CAAC,EAAE,QAAQ,EAAE;IACvE,MAAM,QAAQ,iBAAiB;QAAE,UAAU;IAAK;IAChD,MAAM,MAAM,IAAA,iJAAM;IAElB,MAAM,CAAC,QAAQ,GAAG,IAAA,0ZAAQ,EAAC,IACzB,kBAAkB,IAAI,IAAI,GAAG,QAAQ,GAAG,MAAM;IAGhD,yDAAyD;IACzD,IAAI,OAAO,OAAO;IAElB,qBACE,ubAAC,cAAc,QAAQ;QAAC,OAAO;kBAAU;;;;;;AAE7C;AAEO,MAAM,4BAA4B,CACvC;IAEA,MAAM,wBAAU,IAAA,4ZAAU,EAAC,CAAC,OAAO;QACjC,qBACE,ubAAC;sBACC,cAAA,ubAAC;gBAAW,GAAI,KAAK;gBAAU,KAAK;;;;;;;;;;;IAG1C;IACA,QAAQ,WAAW,GAAG,UAAU,WAAW;IAC3C,OAAO;AACT;AAQA,SAAS,iBAAiB,OAA4C;IACpE,MAAM,UAAU,IAAA,4ZAAU,EAAC;IAC3B,IAAI,CAAC,SAAS,YAAY,CAAC,SACzB,MAAM,IAAI,MACR;IAEJ,OAAO;AACT;AAEO,MAAM,EAAE,eAAe,EAAE,oBAAoB,EAAE,GAAG,IAAA,qNAAsB,EAC7E,kBACA"}},
    {"offset": {"line": 4494, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/smooth/use-smooth.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useRef, useState } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport {\n  MessagePartStatus,\n  ReasoningMessagePart,\n  TextMessagePart,\n} from \"../../types/assistant-types\";\nimport { useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { useSmoothStatusStore } from \"./smooth-context\";\nimport { writableStore } from \"../../context/readonly-store\";\nimport { MessagePartState } from \"../../legacy-runtime/runtime/message-part-runtime\";\n\nclass TextStreamAnimator {\n  private animationFrameId: number | null = null;\n  private lastUpdateTime: number = Date.now();\n\n  public targetText: string = \"\";\n\n  constructor(\n    public currentText: string,\n    private setText: (newText: string) => void,\n  ) {}\n\n  start() {\n    if (this.animationFrameId !== null) return;\n    this.lastUpdateTime = Date.now();\n    this.animate();\n  }\n\n  stop() {\n    if (this.animationFrameId !== null) {\n      cancelAnimationFrame(this.animationFrameId);\n      this.animationFrameId = null;\n    }\n  }\n\n  private animate = () => {\n    const currentTime = Date.now();\n    const deltaTime = currentTime - this.lastUpdateTime;\n    let timeToConsume = deltaTime;\n\n    const remainingChars = this.targetText.length - this.currentText.length;\n    const baseTimePerChar = Math.min(5, 250 / remainingChars);\n\n    let charsToAdd = 0;\n    while (timeToConsume >= baseTimePerChar && charsToAdd < remainingChars) {\n      charsToAdd++;\n      timeToConsume -= baseTimePerChar;\n    }\n\n    if (charsToAdd !== remainingChars) {\n      this.animationFrameId = requestAnimationFrame(this.animate);\n    } else {\n      this.animationFrameId = null;\n    }\n    if (charsToAdd === 0) return;\n\n    this.currentText = this.targetText.slice(\n      0,\n      this.currentText.length + charsToAdd,\n    );\n    this.lastUpdateTime = currentTime - timeToConsume;\n    this.setText(this.currentText);\n  };\n}\n\nconst SMOOTH_STATUS: MessagePartStatus = Object.freeze({\n  type: \"running\",\n});\n\nexport const useSmooth = (\n  state: MessagePartState & (TextMessagePart | ReasoningMessagePart),\n  smooth: boolean = false,\n): MessagePartState & (TextMessagePart | ReasoningMessagePart) => {\n  const { text } = state;\n  const id = useAuiState(({ message }) => message.id);\n\n  const idRef = useRef(id);\n  const [displayedText, setDisplayedText] = useState(text);\n\n  const smoothStatusStore = useSmoothStatusStore({ optional: true });\n  const setText = useCallbackRef((text: string) => {\n    setDisplayedText(text);\n    if (smoothStatusStore) {\n      const target =\n        displayedText !== text || state.status.type === \"running\"\n          ? SMOOTH_STATUS\n          : state.status;\n      writableStore(smoothStatusStore).setState(target, true);\n    }\n  });\n\n  // TODO this is hacky\n  useEffect(() => {\n    if (smoothStatusStore) {\n      const target =\n        smooth && (displayedText !== text || state.status.type === \"running\")\n          ? SMOOTH_STATUS\n          : state.status;\n      writableStore(smoothStatusStore).setState(target, true);\n    }\n  }, [smoothStatusStore, smooth, text, displayedText, state.status]);\n\n  const [animatorRef] = useState<TextStreamAnimator>(\n    new TextStreamAnimator(text, setText),\n  );\n\n  useEffect(() => {\n    if (!smooth) {\n      animatorRef.stop();\n      return;\n    }\n\n    if (idRef.current !== id || !text.startsWith(animatorRef.targetText)) {\n      idRef.current = id;\n      setText(text);\n\n      animatorRef.currentText = text;\n      animatorRef.targetText = text;\n      animatorRef.stop();\n\n      return;\n    }\n\n    animatorRef.targetText = text;\n    animatorRef.start();\n  }, [setText, animatorRef, id, smooth, text]);\n\n  useEffect(() => {\n    return () => {\n      animatorRef.stop();\n    };\n  }, [animatorRef]);\n\n  return useMemo(\n    () =>\n      smooth\n        ? {\n            type: \"text\",\n            text: displayedText,\n            status: text === displayedText ? state.status : SMOOTH_STATUS,\n          }\n        : state,\n    [smooth, displayedText, state, text],\n  );\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4632, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message-part/message-part-text.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport {\n  type ComponentRef,\n  forwardRef,\n  ComponentPropsWithoutRef,\n  ElementType,\n} from \"react\";\nimport { useMessagePartText } from \"./use-message-part-text\";\nimport { useSmooth } from \"../../utils/smooth/use-smooth\";\n\nexport namespace MessagePartPrimitiveText {\n  export type Element = ComponentRef<typeof Primitive.span>;\n  export type Props = Omit<\n    ComponentPropsWithoutRef<typeof Primitive.span>,\n    \"children\" | \"asChild\"\n  > & {\n    /**\n     * Whether to enable smooth text streaming animation.\n     * When enabled, text appears with a typing effect as it streams in.\n     * @default true\n     */\n    smooth?: boolean;\n    /**\n     * The HTML element or React component to render as.\n     * @default \"span\"\n     */\n    component?: ElementType;\n  };\n}\n\n/**\n * Renders the text content of a message part with optional smooth streaming.\n *\n * This component displays text content from the current message part context,\n * with support for smooth streaming animation that shows text appearing\n * character by character as it's generated.\n *\n * @example\n * ```tsx\n * <MessagePartPrimitive.Text\n *   smooth={true}\n *   component=\"p\"\n *   className=\"message-text\"\n * />\n * ```\n */\nexport const MessagePartPrimitiveText = forwardRef<\n  MessagePartPrimitiveText.Element,\n  MessagePartPrimitiveText.Props\n>(({ smooth = true, component: Component = \"span\", ...rest }, forwardedRef) => {\n  const { text, status } = useSmooth(useMessagePartText(), smooth);\n\n  return (\n    <Component data-status={status.type} {...rest} ref={forwardedRef}>\n      {text}\n    </Component>\n  );\n});\n\nMessagePartPrimitiveText.displayName = \"MessagePartPrimitive.Text\";\n"],"names":[],"mappings":";;;;;AAGA;AAMA;AACA;AAVA;;;;;AAgDO,MAAM,yCAA2B,IAAA,4ZAAU,EAGhD,CAAC,EAAE,SAAS,IAAI,EAAE,WAAW,YAAY,MAAM,EAAE,GAAG,MAAM,EAAE;IAC5D,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,IAAA,0KAAS,EAAC,IAAA,kNAAkB,KAAI;IAEzD,qBACE,ubAAC;QAAU,eAAa,OAAO,IAAI;QAAG,GAAG,IAAI;QAAE,KAAK;kBACjD;;;;;;AAGP;AAEA,yBAAyB,WAAW,GAAG"}},
    {"offset": {"line": 4663, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message-part/use-message-part-image.tsx"],"sourcesContent":["\"use client\";\n\nimport { MessagePartState } from \"../../legacy-runtime/runtime/message-part-runtime\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { ImageMessagePart } from \"../../types\";\n\nexport const useMessagePartImage = () => {\n  const image = useAuiState(({ part }) => {\n    if (part.type !== \"image\")\n      throw new Error(\n        \"MessagePartImage can only be used inside image message parts.\",\n      );\n\n    return part as MessagePartState & ImageMessagePart;\n  });\n\n  return image;\n};\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AAMO,MAAM,sBAAsB;IACjC,MAAM,QAAQ,IAAA,+JAAW,EAAC,CAAC,EAAE,IAAI,EAAE;QACjC,IAAI,KAAK,IAAI,KAAK,SAChB,MAAM,IAAI,MACR;QAGJ,OAAO;IACT;IAEA,OAAO;AACT"}},
    {"offset": {"line": 4681, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message-part/message-part-image.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { type ComponentRef, forwardRef, ComponentPropsWithoutRef } from \"react\";\nimport { useMessagePartImage } from \"./use-message-part-image\";\n\nexport namespace MessagePartPrimitiveImage {\n  export type Element = ComponentRef<typeof Primitive.img>;\n  /**\n   * Props for the MessagePartPrimitive.Image component.\n   * Accepts all standard img element props.\n   */\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.img>;\n}\n\n/**\n * Renders an image from the current message part context.\n *\n * This component displays image content from the current message part,\n * automatically setting the src attribute from the message part's image data.\n *\n * @example\n * ```tsx\n * <MessagePartPrimitive.Image\n *   alt=\"Generated image\"\n *   className=\"message-image\"\n *   style={{ maxWidth: '100%' }}\n * />\n * ```\n */\nexport const MessagePartPrimitiveImage = forwardRef<\n  MessagePartPrimitiveImage.Element,\n  MessagePartPrimitiveImage.Props\n>((props, forwardedRef) => {\n  const { image } = useMessagePartImage();\n  return <Primitive.img src={image} {...props} ref={forwardedRef} />;\n});\n\nMessagePartPrimitiveImage.displayName = \"MessagePartPrimitive.Image\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AA8BO,MAAM,0CAA4B,IAAA,4ZAAU,EAGjD,CAAC,OAAO;IACR,MAAM,EAAE,KAAK,EAAE,GAAG,IAAA,oNAAmB;IACrC,qBAAO,ubAAC,mYAAS,CAAC,GAAG;QAAC,KAAK;QAAQ,GAAG,KAAK;QAAE,KAAK;;;;;;AACpD;AAEA,0BAA0B,WAAW,GAAG"}},
    {"offset": {"line": 4711, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message-part/message-part-in-progress.tsx"],"sourcesContent":["\"use client\";\n\nimport { FC, PropsWithChildren } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nexport namespace MessagePartPrimitiveInProgress {\n  export type Props = PropsWithChildren;\n}\n\n// TODO should this be renamed to IsRunning?\nexport const MessagePartPrimitiveInProgress: FC<\n  MessagePartPrimitiveInProgress.Props\n> = ({ children }) => {\n  const isInProgress = useAuiState(\n    ({ part }) => part.status.type === \"running\",\n  );\n\n  return isInProgress ? children : null;\n};\n\nMessagePartPrimitiveInProgress.displayName = \"MessagePartPrimitive.InProgress\";\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AAUO,MAAM,iCAET,CAAC,EAAE,QAAQ,EAAE;IACf,MAAM,eAAe,IAAA,+JAAW,EAC9B,CAAC,EAAE,IAAI,EAAE,GAAK,KAAK,MAAM,CAAC,IAAI,KAAK;IAGrC,OAAO,eAAe,WAAW;AACnC;AAEA,+BAA+B,WAAW,GAAG"}},
    {"offset": {"line": 4727, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message/message-parts.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  type ComponentType,\n  type FC,\n  memo,\n  PropsWithChildren,\n  useMemo,\n} from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\nimport {\n  PartByIndexProvider,\n  TextMessagePartProvider,\n} from \"../../context/providers\";\nimport { MessagePartPrimitiveText } from \"../message-part/message-part-text\";\nimport { MessagePartPrimitiveImage } from \"../message-part/message-part-image\";\nimport type {\n  Unstable_AudioMessagePartComponent,\n  EmptyMessagePartComponent,\n  TextMessagePartComponent,\n  ImageMessagePartComponent,\n  SourceMessagePartComponent,\n  ToolCallMessagePartComponent,\n  ToolCallMessagePartProps,\n  FileMessagePartComponent,\n  ReasoningMessagePartComponent,\n  ReasoningGroupComponent,\n} from \"../../types/message-part-component-types\";\nimport { MessagePartPrimitiveInProgress } from \"../message-part/message-part-in-progress\";\nimport { MessagePartStatus } from \"../../types/assistant-types\";\nimport { useShallow } from \"zustand/shallow\";\n\ntype MessagePartRange =\n  | { type: \"single\"; index: number }\n  | { type: \"toolGroup\"; startIndex: number; endIndex: number }\n  | { type: \"reasoningGroup\"; startIndex: number; endIndex: number };\n\n/**\n * Creates a group state manager for a specific part type.\n * Returns functions to start, end, and finalize groups.\n */\nconst createGroupState = <T extends \"toolGroup\" | \"reasoningGroup\">(\n  groupType: T,\n) => {\n  let start = -1;\n\n  return {\n    startGroup: (index: number) => {\n      if (start === -1) {\n        start = index;\n      }\n    },\n    endGroup: (endIndex: number, ranges: MessagePartRange[]) => {\n      if (start !== -1) {\n        ranges.push({\n          type: groupType,\n          startIndex: start,\n          endIndex,\n        } as MessagePartRange);\n        start = -1;\n      }\n    },\n    finalize: (endIndex: number, ranges: MessagePartRange[]) => {\n      if (start !== -1) {\n        ranges.push({\n          type: groupType,\n          startIndex: start,\n          endIndex,\n        } as MessagePartRange);\n      }\n    },\n  };\n};\n\n/**\n * Groups consecutive tool-call and reasoning message parts into ranges.\n * Always groups tool calls and reasoning parts, even if there's only one.\n */\nconst groupMessageParts = (\n  messageTypes: readonly string[],\n): MessagePartRange[] => {\n  const ranges: MessagePartRange[] = [];\n  const toolGroup = createGroupState(\"toolGroup\");\n  const reasoningGroup = createGroupState(\"reasoningGroup\");\n\n  for (let i = 0; i < messageTypes.length; i++) {\n    const type = messageTypes[i];\n\n    if (type === \"tool-call\") {\n      reasoningGroup.endGroup(i - 1, ranges);\n      toolGroup.startGroup(i);\n    } else if (type === \"reasoning\") {\n      toolGroup.endGroup(i - 1, ranges);\n      reasoningGroup.startGroup(i);\n    } else {\n      toolGroup.endGroup(i - 1, ranges);\n      reasoningGroup.endGroup(i - 1, ranges);\n      ranges.push({ type: \"single\", index: i });\n    }\n  }\n\n  toolGroup.finalize(messageTypes.length - 1, ranges);\n  reasoningGroup.finalize(messageTypes.length - 1, ranges);\n\n  return ranges;\n};\n\nconst useMessagePartsGroups = (): MessagePartRange[] => {\n  const messageTypes = useAuiState(\n    useShallow((s) => s.message.parts.map((c: any) => c.type)),\n  );\n\n  return useMemo(() => {\n    if (messageTypes.length === 0) {\n      return [];\n    }\n    return groupMessageParts(messageTypes);\n  }, [messageTypes]);\n};\n\nexport namespace MessagePrimitiveParts {\n  export type Props = {\n    /**\n     * Component configuration for rendering different types of message content.\n     *\n     * You can provide custom components for each content type (text, image, file, etc.)\n     * and configure tool rendering behavior. If not provided, default components will be used.\n     */\n    components?:\n      | {\n          /** Component for rendering empty messages */\n          Empty?: EmptyMessagePartComponent | undefined;\n          /** Component for rendering text content */\n          Text?: TextMessagePartComponent | undefined;\n          /** Component for rendering reasoning content (typically hidden) */\n          Reasoning?: ReasoningMessagePartComponent | undefined;\n          /** Component for rendering source content */\n          Source?: SourceMessagePartComponent | undefined;\n          /** Component for rendering image content */\n          Image?: ImageMessagePartComponent | undefined;\n          /** Component for rendering file content */\n          File?: FileMessagePartComponent | undefined;\n          /** Component for rendering audio content (experimental) */\n          Unstable_Audio?: Unstable_AudioMessagePartComponent | undefined;\n          /** Configuration for tool call rendering */\n          tools?:\n            | {\n                /** Map of tool names to their specific components */\n                by_name?:\n                  | Record<string, ToolCallMessagePartComponent | undefined>\n                  | undefined;\n                /** Fallback component for unregistered tools */\n                Fallback?: ComponentType<ToolCallMessagePartProps> | undefined;\n              }\n            | {\n                /** Override component that handles all tool calls */\n                Override: ComponentType<ToolCallMessagePartProps>;\n              }\n            | undefined;\n\n          /**\n           * Component for rendering grouped consecutive tool calls.\n           *\n           * When provided, this component will automatically wrap consecutive tool-call\n           * message parts, allowing you to create collapsible sections, custom styling,\n           * or other grouped presentations for multiple tool calls.\n           *\n           * The component receives:\n           * - `startIndex`: The index of the first tool call in the group\n           * - `endIndex`: The index of the last tool call in the group\n           * - `children`: The rendered tool call components\n           *\n           * @example\n           * ```tsx\n           * // Collapsible tool group\n           * ToolGroup: ({ startIndex, endIndex, children }) => (\n           *   <details className=\"tool-group\">\n           *     <summary>\n           *       {endIndex - startIndex + 1} tool calls\n           *     </summary>\n           *     <div className=\"tool-group-content\">\n           *       {children}\n           *     </div>\n           *   </details>\n           * )\n           * ```\n           *\n           * @example\n           * ```tsx\n           * // Custom styled tool group with header\n           * ToolGroup: ({ startIndex, endIndex, children }) => (\n           *   <div className=\"border rounded-lg p-4 my-2\">\n           *     <div className=\"text-sm text-gray-600 mb-2\">\n           *       Tool execution #{startIndex + 1}-{endIndex + 1}\n           *     </div>\n           *     <div className=\"space-y-2\">\n           *       {children}\n           *     </div>\n           *   </div>\n           * )\n           * ```\n           *\n           * @param startIndex - Index of the first tool call in the group\n           * @param endIndex - Index of the last tool call in the group\n           * @param children - Rendered tool call components to display within the group\n           *\n           * @deprecated This feature is still experimental and subject to change.\n           */\n          ToolGroup?: ComponentType<\n            PropsWithChildren<{ startIndex: number; endIndex: number }>\n          >;\n\n          /**\n           * Component for rendering grouped reasoning parts.\n           *\n           * When provided, this component will automatically wrap reasoning message parts\n           * (one or more consecutive) in a group container. Each reasoning part inside\n           * renders its own text independently - no text merging occurs.\n           *\n           * The component receives:\n           * - `startIndex`: The index of the first reasoning part in the group\n           * - `endIndex`: The index of the last reasoning part in the group\n           * - `children`: The rendered Reasoning components (one per part)\n           *\n           * @example\n           * ```tsx\n           * // Collapsible reasoning group\n           * ReasoningGroup: ({ children }) => (\n           *   <details className=\"reasoning-group\">\n           *     <summary>Reasoning</summary>\n           *     <div className=\"reasoning-content\">\n           *       {children}\n           *     </div>\n           *   </details>\n           * )\n           * ```\n           *\n           * @param startIndex - Index of the first reasoning part in the group\n           * @param endIndex - Index of the last reasoning part in the group\n           * @param children - Rendered reasoning part components\n           */\n          ReasoningGroup?: ReasoningGroupComponent;\n        }\n      | undefined;\n    /**\n     * When enabled, shows the Empty component if the last part in the message\n     * is anything other than Text or Reasoning.\n     *\n     * This can be useful to ensure there's always a visible element at the end\n     * of messages that end with non-text content like tool calls or images.\n     *\n     * @experimental This API is experimental and may change in future versions.\n     * @default true\n     */\n    unstable_showEmptyOnNonTextEnd?: boolean | undefined;\n  };\n}\n\nconst ToolUIDisplay = ({\n  Fallback,\n  ...props\n}: {\n  Fallback: ToolCallMessagePartComponent | undefined;\n} & ToolCallMessagePartProps) => {\n  const Render = useAuiState(({ tools }) => {\n    const Render = tools.tools[props.toolName] ?? Fallback;\n    if (Array.isArray(Render)) return Render[0] ?? Fallback;\n    return Render;\n  });\n  if (!Render) return null;\n  return <Render {...props} />;\n};\n\nconst defaultComponents = {\n  Text: () => (\n    <p style={{ whiteSpace: \"pre-line\" }}>\n      <MessagePartPrimitiveText />\n      <MessagePartPrimitiveInProgress>\n        <span style={{ fontFamily: \"revert\" }}>{\" \\u25CF\"}</span>\n      </MessagePartPrimitiveInProgress>\n    </p>\n  ),\n  Reasoning: () => null,\n  Source: () => null,\n  Image: () => <MessagePartPrimitiveImage />,\n  File: () => null,\n  Unstable_Audio: () => null,\n  ToolGroup: ({ children }) => children,\n  ReasoningGroup: ({ children }) => children,\n} satisfies MessagePrimitiveParts.Props[\"components\"];\n\ntype MessagePartComponentProps = {\n  components: MessagePrimitiveParts.Props[\"components\"];\n};\n\nconst MessagePartComponent: FC<MessagePartComponentProps> = ({\n  components: {\n    Text = defaultComponents.Text,\n    Reasoning = defaultComponents.Reasoning,\n    Image = defaultComponents.Image,\n    Source = defaultComponents.Source,\n    File = defaultComponents.File,\n    Unstable_Audio: Audio = defaultComponents.Unstable_Audio,\n    tools = {},\n  } = {},\n}) => {\n  const aui = useAui();\n  const part = useAuiState(({ part }) => part);\n\n  const type = part.type;\n  if (type === \"tool-call\") {\n    const addResult = aui.part().addToolResult;\n    const resume = aui.part().resumeToolCall;\n    if (\"Override\" in tools)\n      return <tools.Override {...part} addResult={addResult} resume={resume} />;\n    const Tool = tools.by_name?.[part.toolName] ?? tools.Fallback;\n    return (\n      <ToolUIDisplay\n        {...part}\n        Fallback={Tool}\n        addResult={addResult}\n        resume={resume}\n      />\n    );\n  }\n\n  if (part.status?.type === \"requires-action\")\n    throw new Error(\"Encountered unexpected requires-action status\");\n\n  switch (type) {\n    case \"text\":\n      return <Text {...part} />;\n\n    case \"reasoning\":\n      return <Reasoning {...part} />;\n\n    case \"source\":\n      return <Source {...part} />;\n\n    case \"image\":\n      return <Image {...part} />;\n\n    case \"file\":\n      return <File {...part} />;\n\n    case \"audio\":\n      return <Audio {...part} />;\n\n    case \"data\":\n      return null;\n\n    default:\n      const unhandledType: never = type;\n      throw new Error(`Unknown message part type: ${unhandledType}`);\n  }\n};\n\nexport namespace MessagePrimitivePartByIndex {\n  export type Props = {\n    index: number;\n    components: MessagePrimitiveParts.Props[\"components\"];\n  };\n}\n\n/**\n * Renders a single message part at the specified index.\n *\n * This component provides direct access to render a specific message part\n * within the current message context, using the provided component configuration.\n *\n * @example\n * ```tsx\n * <MessagePrimitive.PartByIndex\n *   index={0}\n *   components={{\n *     Text: MyTextComponent,\n *     Image: MyImageComponent\n *   }}\n * />\n * ```\n */\nexport const MessagePrimitivePartByIndex: FC<MessagePrimitivePartByIndex.Props> =\n  memo(\n    ({ index, components }) => {\n      return (\n        <PartByIndexProvider index={index}>\n          <MessagePartComponent components={components} />\n        </PartByIndexProvider>\n      );\n    },\n    (prev, next) =>\n      prev.index === next.index &&\n      prev.components?.Text === next.components?.Text &&\n      prev.components?.Reasoning === next.components?.Reasoning &&\n      prev.components?.Source === next.components?.Source &&\n      prev.components?.Image === next.components?.Image &&\n      prev.components?.File === next.components?.File &&\n      prev.components?.Unstable_Audio === next.components?.Unstable_Audio &&\n      prev.components?.tools === next.components?.tools &&\n      prev.components?.ToolGroup === next.components?.ToolGroup &&\n      prev.components?.ReasoningGroup === next.components?.ReasoningGroup,\n  );\n\nMessagePrimitivePartByIndex.displayName = \"MessagePrimitive.PartByIndex\";\n\nconst EmptyPartFallback: FC<{\n  status: MessagePartStatus;\n  component: TextMessagePartComponent;\n}> = ({ status, component: Component }) => {\n  return (\n    <TextMessagePartProvider text=\"\" isRunning={status.type === \"running\"}>\n      <Component type=\"text\" text=\"\" status={status} />\n    </TextMessagePartProvider>\n  );\n};\n\nconst COMPLETE_STATUS: MessagePartStatus = Object.freeze({\n  type: \"complete\",\n});\n\nconst EmptyPartsImpl: FC<MessagePartComponentProps> = ({ components }) => {\n  const status = useAuiState(\n    (s) => (s.message.status ?? COMPLETE_STATUS) as MessagePartStatus,\n  );\n\n  if (components?.Empty) return <components.Empty status={status} />;\n\n  return (\n    <EmptyPartFallback\n      status={status}\n      component={components?.Text ?? defaultComponents.Text}\n    />\n  );\n};\n\nconst EmptyParts = memo(\n  EmptyPartsImpl,\n  (prev, next) =>\n    prev.components?.Empty === next.components?.Empty &&\n    prev.components?.Text === next.components?.Text,\n);\n\nconst ConditionalEmptyImpl: FC<{\n  components: MessagePrimitiveParts.Props[\"components\"];\n  enabled: boolean;\n}> = ({ components, enabled }) => {\n  const shouldShowEmpty = useAuiState(({ message }) => {\n    if (!enabled) return false;\n    if (message.parts.length === 0) return false;\n\n    const lastPart = message.parts[message.parts.length - 1];\n    return lastPart?.type !== \"text\" && lastPart?.type !== \"reasoning\";\n  });\n\n  if (!shouldShowEmpty) return null;\n  return <EmptyParts components={components} />;\n};\n\nconst ConditionalEmpty = memo(\n  ConditionalEmptyImpl,\n  (prev, next) =>\n    prev.enabled === next.enabled &&\n    prev.components?.Empty === next.components?.Empty &&\n    prev.components?.Text === next.components?.Text,\n);\n\n/**\n * Renders the parts of a message with support for multiple content types.\n *\n * This component automatically handles different types of message content including\n * text, images, files, tool calls, and more. It provides a flexible component\n * system for customizing how each content type is rendered.\n *\n * @example\n * ```tsx\n * <MessagePrimitive.Parts\n *   components={{\n *     Text: ({ text }) => <p className=\"message-text\">{text}</p>,\n *     Image: ({ image }) => <img src={image} alt=\"Message image\" />,\n *     tools: {\n *       by_name: {\n *         calculator: CalculatorTool,\n *         weather: WeatherTool,\n *       },\n *       Fallback: DefaultToolComponent\n *     }\n *   }}\n * />\n * ```\n */\nexport const MessagePrimitiveParts: FC<MessagePrimitiveParts.Props> = ({\n  components,\n  unstable_showEmptyOnNonTextEnd = true,\n}) => {\n  const contentLength = useAuiState(({ message }) => message.parts.length);\n  const messageRanges = useMessagePartsGroups();\n\n  const partsElements = useMemo(() => {\n    if (contentLength === 0) {\n      return <EmptyParts components={components} />;\n    }\n\n    return messageRanges.map((range) => {\n      if (range.type === \"single\") {\n        return (\n          <MessagePrimitivePartByIndex\n            key={range.index}\n            index={range.index}\n            components={components}\n          />\n        );\n      } else if (range.type === \"toolGroup\") {\n        const ToolGroupComponent =\n          components?.ToolGroup ?? defaultComponents.ToolGroup;\n        return (\n          <ToolGroupComponent\n            key={`tool-${range.startIndex}`}\n            startIndex={range.startIndex}\n            endIndex={range.endIndex}\n          >\n            {Array.from(\n              { length: range.endIndex - range.startIndex + 1 },\n              (_, i) => (\n                <MessagePrimitivePartByIndex\n                  key={i}\n                  index={range.startIndex + i}\n                  components={components}\n                />\n              ),\n            )}\n          </ToolGroupComponent>\n        );\n      } else {\n        // reasoningGroup\n        const ReasoningGroupComponent =\n          components?.ReasoningGroup ?? defaultComponents.ReasoningGroup;\n        return (\n          <ReasoningGroupComponent\n            key={`reasoning-${range.startIndex}`}\n            startIndex={range.startIndex}\n            endIndex={range.endIndex}\n          >\n            {Array.from(\n              { length: range.endIndex - range.startIndex + 1 },\n              (_, i) => (\n                <MessagePrimitivePartByIndex\n                  key={i}\n                  index={range.startIndex + i}\n                  components={components}\n                />\n              ),\n            )}\n          </ReasoningGroupComponent>\n        );\n      }\n    });\n  }, [messageRanges, components, contentLength]);\n\n  return (\n    <>\n      {partsElements}\n      <ConditionalEmpty\n        components={components}\n        enabled={unstable_showEmptyOnNonTextEnd}\n      />\n    </>\n  );\n};\n\nMessagePrimitiveParts.displayName = \"MessagePrimitive.Parts\";\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5133, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message/message-if.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC, PropsWithChildren } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport type { RequireAtLeastOne } from \"../../utils/require-at-least-one\";\n\ntype MessageIfFilters = {\n  user: boolean | undefined;\n  assistant: boolean | undefined;\n  system: boolean | undefined;\n  hasBranches: boolean | undefined;\n  copied: boolean | undefined;\n  lastOrHover: boolean | undefined;\n  last: boolean | undefined;\n  speaking: boolean | undefined;\n  hasAttachments: boolean | undefined;\n  hasContent: boolean | undefined;\n  submittedFeedback: \"positive\" | \"negative\" | null | undefined;\n};\ntype UseMessageIfProps = RequireAtLeastOne<MessageIfFilters>;\n\nconst useMessageIf = (props: UseMessageIfProps) => {\n  return useAuiState(({ message }) => {\n    const {\n      role,\n      attachments,\n      parts,\n      branchCount,\n      isLast,\n      speech,\n      isCopied,\n      isHovering,\n    } = message;\n\n    if (props.hasBranches === true && branchCount < 2) return false;\n\n    if (props.user && role !== \"user\") return false;\n    if (props.assistant && role !== \"assistant\") return false;\n    if (props.system && role !== \"system\") return false;\n\n    if (props.lastOrHover === true && !isHovering && !isLast) return false;\n    if (props.last !== undefined && props.last !== isLast) return false;\n\n    if (props.copied === true && !isCopied) return false;\n    if (props.copied === false && isCopied) return false;\n\n    if (props.speaking === true && speech == null) return false;\n    if (props.speaking === false && speech != null) return false;\n\n    if (\n      props.hasAttachments === true &&\n      (role !== \"user\" || !attachments?.length)\n    )\n      return false;\n    if (\n      props.hasAttachments === false &&\n      role === \"user\" &&\n      !!attachments?.length\n    )\n      return false;\n\n    if (props.hasContent === true && parts.length === 0) return false;\n    if (props.hasContent === false && parts.length > 0) return false;\n\n    if (\n      props.submittedFeedback !== undefined &&\n      (message.metadata.submittedFeedback?.type ?? null) !==\n        props.submittedFeedback\n    )\n      return false;\n\n    return true;\n  });\n};\n\nexport namespace MessagePrimitiveIf {\n  export type Props = PropsWithChildren<UseMessageIfProps>;\n}\n\n/**\n * @deprecated Use `<AuiIf condition={({ message }) => ...} />` instead.\n */\nexport const MessagePrimitiveIf: FC<MessagePrimitiveIf.Props> = ({\n  children,\n  ...query\n}) => {\n  const result = useMessageIf(query);\n  return result ? children : null;\n};\n\nMessagePrimitiveIf.displayName = \"MessagePrimitive.If\";\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AAqBA,MAAM,eAAe,CAAC;IACpB,OAAO,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE;QAC7B,MAAM,EACJ,IAAI,EACJ,WAAW,EACX,KAAK,EACL,WAAW,EACX,MAAM,EACN,MAAM,EACN,QAAQ,EACR,UAAU,EACX,GAAG;QAEJ,IAAI,MAAM,WAAW,KAAK,QAAQ,cAAc,GAAG,OAAO;QAE1D,IAAI,MAAM,IAAI,IAAI,SAAS,QAAQ,OAAO;QAC1C,IAAI,MAAM,SAAS,IAAI,SAAS,aAAa,OAAO;QACpD,IAAI,MAAM,MAAM,IAAI,SAAS,UAAU,OAAO;QAE9C,IAAI,MAAM,WAAW,KAAK,QAAQ,CAAC,cAAc,CAAC,QAAQ,OAAO;QACjE,IAAI,MAAM,IAAI,KAAK,aAAa,MAAM,IAAI,KAAK,QAAQ,OAAO;QAE9D,IAAI,MAAM,MAAM,KAAK,QAAQ,CAAC,UAAU,OAAO;QAC/C,IAAI,MAAM,MAAM,KAAK,SAAS,UAAU,OAAO;QAE/C,IAAI,MAAM,QAAQ,KAAK,QAAQ,UAAU,MAAM,OAAO;QACtD,IAAI,MAAM,QAAQ,KAAK,SAAS,UAAU,MAAM,OAAO;QAEvD,IACE,MAAM,cAAc,KAAK,QACzB,CAAC,SAAS,UAAU,CAAC,aAAa,MAAM,GAExC,OAAO;QACT,IACE,MAAM,cAAc,KAAK,SACzB,SAAS,UACT,CAAC,CAAC,aAAa,QAEf,OAAO;QAET,IAAI,MAAM,UAAU,KAAK,QAAQ,MAAM,MAAM,KAAK,GAAG,OAAO;QAC5D,IAAI,MAAM,UAAU,KAAK,SAAS,MAAM,MAAM,GAAG,GAAG,OAAO;QAE3D,IACE,MAAM,iBAAiB,KAAK,aAC5B,CAAC,QAAQ,QAAQ,CAAC,iBAAiB,EAAE,QAAQ,IAAI,MAC/C,MAAM,iBAAiB,EAEzB,OAAO;QAET,OAAO;IACT;AACF;AASO,MAAM,qBAAmD,CAAC,EAC/D,QAAQ,EACR,GAAG,OACJ;IACC,MAAM,SAAS,aAAa;IAC5B,OAAO,SAAS,WAAW;AAC7B;AAEA,mBAAmB,WAAW,GAAG"}},
    {"offset": {"line": 5170, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message/message-attachments.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentType, type FC, memo, useMemo } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { MessageAttachmentByIndexProvider } from \"../../context/providers\";\nimport { CompleteAttachment } from \"../../types\";\n\nexport namespace MessagePrimitiveAttachments {\n  export type Props = {\n    components:\n      | {\n          Image?: ComponentType | undefined;\n          Document?: ComponentType | undefined;\n          File?: ComponentType | undefined;\n          Attachment?: ComponentType | undefined;\n        }\n      | undefined;\n  };\n}\n\nconst getComponent = (\n  components: MessagePrimitiveAttachments.Props[\"components\"],\n  attachment: CompleteAttachment,\n) => {\n  const type = attachment.type;\n  switch (type) {\n    case \"image\":\n      return components?.Image ?? components?.Attachment;\n    case \"document\":\n      return components?.Document ?? components?.Attachment;\n    case \"file\":\n      return components?.File ?? components?.Attachment;\n    default:\n      const _exhaustiveCheck: never = type;\n      throw new Error(`Unknown attachment type: ${_exhaustiveCheck}`);\n  }\n};\n\nconst AttachmentComponent: FC<{\n  components: MessagePrimitiveAttachments.Props[\"components\"];\n}> = ({ components }) => {\n  const attachment = useAuiState(({ attachment }) => attachment);\n  if (!attachment) return null;\n\n  const Component = getComponent(components, attachment as CompleteAttachment);\n  if (!Component) return null;\n  return <Component />;\n};\n\nexport namespace MessagePrimitiveAttachmentByIndex {\n  export type Props = {\n    index: number;\n    components?: MessagePrimitiveAttachments.Props[\"components\"];\n  };\n}\n\n/**\n * Renders a single attachment at the specified index within the current message.\n *\n * This component provides direct access to render a specific attachment\n * from the message's attachment list using the provided component configuration.\n *\n * @example\n * ```tsx\n * <MessagePrimitive.AttachmentByIndex\n *   index={0}\n *   components={{\n *     Image: MyImageAttachment,\n *     Document: MyDocumentAttachment\n *   }}\n * />\n * ```\n */\nexport const MessagePrimitiveAttachmentByIndex: FC<MessagePrimitiveAttachmentByIndex.Props> =\n  memo(\n    ({ index, components }) => {\n      return (\n        <MessageAttachmentByIndexProvider index={index}>\n          <AttachmentComponent components={components} />\n        </MessageAttachmentByIndexProvider>\n      );\n    },\n    (prev, next) =>\n      prev.index === next.index &&\n      prev.components?.Image === next.components?.Image &&\n      prev.components?.Document === next.components?.Document &&\n      prev.components?.File === next.components?.File &&\n      prev.components?.Attachment === next.components?.Attachment,\n  );\n\nMessagePrimitiveAttachmentByIndex.displayName =\n  \"MessagePrimitive.AttachmentByIndex\";\n\nexport const MessagePrimitiveAttachments: FC<\n  MessagePrimitiveAttachments.Props\n> = ({ components }) => {\n  const attachmentsCount = useAuiState(({ message }) => {\n    if (message.role !== \"user\") return 0;\n    return message.attachments.length;\n  });\n\n  const attachmentElements = useMemo(() => {\n    return Array.from({ length: attachmentsCount }, (_, index) => (\n      <MessagePrimitiveAttachmentByIndex\n        key={index}\n        index={index}\n        components={components}\n      />\n    ));\n  }, [attachmentsCount, components]);\n\n  return attachmentElements;\n};\n\nMessagePrimitiveAttachments.displayName = \"MessagePrimitive.Attachments\";\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAoBA,MAAM,eAAe,CACnB,YACA;IAEA,MAAM,OAAO,WAAW,IAAI;IAC5B,OAAQ;QACN,KAAK;YACH,OAAO,YAAY,SAAS,YAAY;QAC1C,KAAK;YACH,OAAO,YAAY,YAAY,YAAY;QAC7C,KAAK;YACH,OAAO,YAAY,QAAQ,YAAY;QACzC;YACE,MAAM,mBAA0B;YAChC,MAAM,IAAI,MAAM,CAAC,yBAAyB,EAAE,kBAAkB;IAClE;AACF;AAEA,MAAM,sBAED,CAAC,EAAE,UAAU,EAAE;IAClB,MAAM,aAAa,IAAA,+JAAW,EAAC,CAAC,EAAE,UAAU,EAAE,GAAK;IACnD,IAAI,CAAC,YAAY,OAAO;IAExB,MAAM,YAAY,aAAa,YAAY;IAC3C,IAAI,CAAC,WAAW,OAAO;IACvB,qBAAO,ubAAC;;;;;AACV;AA0BO,MAAM,kDACX,IAAA,sZAAI,EACF,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE;IACpB,qBACE,ubAAC,8NAAgC;QAAC,OAAO;kBACvC,cAAA,ubAAC;YAAoB,YAAY;;;;;;;;;;;AAGvC,GACA,CAAC,MAAM,OACL,KAAK,KAAK,KAAK,KAAK,KAAK,IACzB,KAAK,UAAU,EAAE,UAAU,KAAK,UAAU,EAAE,SAC5C,KAAK,UAAU,EAAE,aAAa,KAAK,UAAU,EAAE,YAC/C,KAAK,UAAU,EAAE,SAAS,KAAK,UAAU,EAAE,QAC3C,KAAK,UAAU,EAAE,eAAe,KAAK,UAAU,EAAE;AAGvD,kCAAkC,WAAW,GAC3C;AAEK,MAAM,8BAET,CAAC,EAAE,UAAU,EAAE;IACjB,MAAM,mBAAmB,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE;QAC/C,IAAI,QAAQ,IAAI,KAAK,QAAQ,OAAO;QACpC,OAAO,QAAQ,WAAW,CAAC,MAAM;IACnC;IAEA,MAAM,qBAAqB,IAAA,yZAAO,EAAC;QACjC,OAAO,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAiB,GAAG,CAAC,GAAG,sBAClD,ubAAC;gBAEC,OAAO;gBACP,YAAY;eAFP;;;;;IAKX,GAAG;QAAC;QAAkB;KAAW;IAEjC,OAAO;AACT;AAEA,4BAA4B,WAAW,GAAG"}},
    {"offset": {"line": 5254, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message/message-error.tsx"],"sourcesContent":["\"use client\";\n\nimport { FC, PropsWithChildren } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nexport const MessagePrimitiveError: FC<PropsWithChildren> = ({ children }) => {\n  const hasError = useAuiState(\n    ({ message }) =>\n      message.status?.type === \"incomplete\" &&\n      message.status.reason === \"error\",\n  );\n  return hasError ? children : null;\n};\n\nMessagePrimitiveError.displayName = \"MessagePrimitive.Error\";\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AAKO,MAAM,wBAA+C,CAAC,EAAE,QAAQ,EAAE;IACvE,MAAM,WAAW,IAAA,+JAAW,EAC1B,CAAC,EAAE,OAAO,EAAE,GACV,QAAQ,MAAM,EAAE,SAAS,gBACzB,QAAQ,MAAM,CAAC,MAAM,KAAK;IAE9B,OAAO,WAAW,WAAW;AAC/B;AAEA,sBAAsB,WAAW,GAAG"}},
    {"offset": {"line": 5270, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/message/message-parts-grouped.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  type ComponentType,\n  type FC,\n  memo,\n  PropsWithChildren,\n  useMemo,\n} from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\nimport {\n  PartByIndexProvider,\n  TextMessagePartProvider,\n} from \"../../context/providers\";\nimport { MessagePartPrimitiveText } from \"../message-part/message-part-text\";\nimport { MessagePartPrimitiveImage } from \"../message-part/message-part-image\";\nimport type {\n  Unstable_AudioMessagePartComponent,\n  EmptyMessagePartComponent,\n  TextMessagePartComponent,\n  ImageMessagePartComponent,\n  SourceMessagePartComponent,\n  ToolCallMessagePartComponent,\n  ToolCallMessagePartProps,\n  FileMessagePartComponent,\n  ReasoningMessagePartComponent,\n} from \"../../types/message-part-component-types\";\nimport { MessagePartPrimitiveInProgress } from \"../message-part/message-part-in-progress\";\nimport { MessagePartStatus } from \"../../types/assistant-types\";\n\ntype MessagePartGroup = {\n  groupKey: string | undefined;\n  indices: number[];\n};\n\nexport type GroupingFunction = (parts: readonly any[]) => MessagePartGroup[];\n\n/**\n * Groups message parts by their parent ID.\n * Parts without a parent ID appear in their chronological position as individual groups.\n * Parts with the same parent ID are grouped together at the position of their first occurrence.\n */\nconst groupMessagePartsByParentId: GroupingFunction = (\n  parts: readonly any[],\n): MessagePartGroup[] => {\n  // Map maintains insertion order, so groups appear in order of first occurrence\n  const groupMap = new Map<string, number[]>();\n\n  // Process each part in order\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    const parentId = part?.parentId as string | undefined;\n\n    // For parts without parentId, assign a unique group ID to maintain their position\n    const groupId = parentId ?? `__ungrouped_${i}`;\n\n    // Get or create the indices array for this group\n    const indices = groupMap.get(groupId) ?? [];\n    indices.push(i);\n    groupMap.set(groupId, indices);\n  }\n\n  // Convert map to array of groups\n  const groups: MessagePartGroup[] = [];\n  for (const [groupId, indices] of groupMap) {\n    // Extract parentId (undefined for ungrouped parts)\n    const groupKey = groupId.startsWith(\"__ungrouped_\") ? undefined : groupId;\n    groups.push({ groupKey, indices });\n  }\n\n  return groups;\n};\n\nconst useMessagePartsGrouped = (\n  groupingFunction: GroupingFunction,\n): MessagePartGroup[] => {\n  const parts = useAuiState(({ message }) => message.parts);\n\n  return useMemo(() => {\n    if (parts.length === 0) {\n      return [];\n    }\n    return groupingFunction(parts);\n  }, [parts, groupingFunction]);\n};\n\nexport namespace MessagePrimitiveUnstable_PartsGrouped {\n  export type Props = {\n    /**\n     * Function that takes an array of message parts and returns an array of groups.\n     * Each group contains a key (for identification) and an array of indices.\n     *\n     * @example\n     * ```tsx\n     * // Group by parent ID (default behavior)\n     * groupingFunction={(parts) => {\n     *   const groups = new Map<string, number[]>();\n     *   parts.forEach((part, i) => {\n     *     const key = part.parentId ?? `__ungrouped_${i}`;\n     *     const indices = groups.get(key) ?? [];\n     *     indices.push(i);\n     *     groups.set(key, indices);\n     *   });\n     *   return Array.from(groups.entries()).map(([key, indices]) => ({\n     *     key: key.startsWith(\"__ungrouped_\") ? undefined : key,\n     *     indices\n     *   }));\n     * }}\n     * ```\n     *\n     * @example\n     * ```tsx\n     * // Group by tool name\n     * import { groupMessagePartsByToolName } from \"@creatorem/ai-react\";\n     *\n     * <MessagePrimitive.Unstable_PartsGrouped\n     *   groupingFunction={groupMessagePartsByToolName}\n     *   components={{\n     *     Group: ({ key, indices, children }) => {\n     *       if (!key) return <>{children}</>;\n     *       return (\n     *         <div className=\"tool-group\">\n     *           <h4>Tool: {key}</h4>\n     *           {children}\n     *         </div>\n     *       );\n     *     }\n     *   }}\n     * />\n     * ```\n     */\n    groupingFunction: GroupingFunction;\n\n    /**\n     * Component configuration for rendering different types of message content.\n     *\n     * You can provide custom components for each content type (text, image, file, etc.)\n     * and configure tool rendering behavior. If not provided, default components will be used.\n     */\n    components:\n      | {\n          /** Component for rendering empty messages */\n          Empty?: EmptyMessagePartComponent | undefined;\n          /** Component for rendering text content */\n          Text?: TextMessagePartComponent | undefined;\n          /** Component for rendering reasoning content (typically hidden) */\n          Reasoning?: ReasoningMessagePartComponent | undefined;\n          /** Component for rendering source content */\n          Source?: SourceMessagePartComponent | undefined;\n          /** Component for rendering image content */\n          Image?: ImageMessagePartComponent | undefined;\n          /** Component for rendering file content */\n          File?: FileMessagePartComponent | undefined;\n          /** Component for rendering audio content (experimental) */\n          Unstable_Audio?: Unstable_AudioMessagePartComponent | undefined;\n          /** Configuration for tool call rendering */\n          tools?:\n            | {\n                /** Map of tool names to their specific components */\n                by_name?:\n                  | Record<string, ToolCallMessagePartComponent | undefined>\n                  | undefined;\n                /** Fallback component for unregistered tools */\n                Fallback?: ComponentType<ToolCallMessagePartProps> | undefined;\n              }\n            | {\n                /** Override component that handles all tool calls */\n                Override: ComponentType<ToolCallMessagePartProps>;\n              }\n            | undefined;\n\n          /**\n           * Component for rendering grouped message parts.\n           *\n           * When provided, this component will automatically wrap message parts that share\n           * the same group key as determined by the groupingFunction.\n           *\n           * The component receives:\n           * - `groupKey`: The group key (or undefined for ungrouped parts)\n           * - `indices`: Array of indices for the parts in this group\n           * - `children`: The rendered message part components\n           *\n           * @example\n           * ```tsx\n           * // Collapsible group\n           * Group: ({ groupKey, indices, children }) => {\n           *   if (!groupKey) return <>{children}</>;\n           *   return (\n           *     <details className=\"message-group\">\n           *       <summary>\n           *         Group {groupKey} ({indices.length} parts)\n           *       </summary>\n           *       <div className=\"group-content\">\n           *         {children}\n           *       </div>\n           *     </details>\n           *   );\n           * }\n           * ```\n           *\n           * @param groupKey - The group key (undefined for ungrouped parts)\n           * @param indices - Array of indices for the parts in this group\n           * @param children - Rendered message part components to display within the group\n           */\n          Group?: ComponentType<\n            PropsWithChildren<{\n              groupKey: string | undefined;\n              indices: number[];\n            }>\n          >;\n        }\n      | undefined;\n  };\n}\n\nconst ToolUIDisplay = ({\n  Fallback,\n  ...props\n}: {\n  Fallback: ToolCallMessagePartComponent | undefined;\n} & ToolCallMessagePartProps) => {\n  const Render = useAuiState(({ tools }) => {\n    const Render = tools.tools[props.toolName] ?? Fallback;\n    if (Array.isArray(Render)) return Render[0] ?? Fallback;\n    return Render;\n  });\n  if (!Render) return null;\n  return <Render {...props} />;\n};\n\nconst defaultComponents = {\n  Text: () => (\n    <p style={{ whiteSpace: \"pre-line\" }}>\n      <MessagePartPrimitiveText />\n      <MessagePartPrimitiveInProgress>\n        <span style={{ fontFamily: \"revert\" }}>{\" \\u25CF\"}</span>\n      </MessagePartPrimitiveInProgress>\n    </p>\n  ),\n  Reasoning: () => null,\n  Source: () => null,\n  Image: () => <MessagePartPrimitiveImage />,\n  File: () => null,\n  Unstable_Audio: () => null,\n  Group: ({ children }) => children,\n} satisfies MessagePrimitiveUnstable_PartsGrouped.Props[\"components\"];\n\ntype MessagePartComponentProps = {\n  components: MessagePrimitiveUnstable_PartsGrouped.Props[\"components\"];\n};\n\nconst MessagePartComponent: FC<MessagePartComponentProps> = ({\n  components: {\n    Text = defaultComponents.Text,\n    Reasoning = defaultComponents.Reasoning,\n    Image = defaultComponents.Image,\n    Source = defaultComponents.Source,\n    File = defaultComponents.File,\n    Unstable_Audio: Audio = defaultComponents.Unstable_Audio,\n    tools = {},\n  } = {},\n}) => {\n  const aui = useAui();\n  const part = useAuiState(({ part }) => part);\n\n  const type = part.type;\n  if (type === \"tool-call\") {\n    const addResult = aui.part().addToolResult;\n    const resume = aui.part().resumeToolCall;\n    if (\"Override\" in tools)\n      return <tools.Override {...part} addResult={addResult} resume={resume} />;\n    const Tool = tools.by_name?.[part.toolName] ?? tools.Fallback;\n    return (\n      <ToolUIDisplay\n        {...part}\n        Fallback={Tool}\n        addResult={addResult}\n        resume={resume}\n      />\n    );\n  }\n\n  if (part.status?.type === \"requires-action\")\n    throw new Error(\"Encountered unexpected requires-action status\");\n\n  switch (type) {\n    case \"text\":\n      return <Text {...part} />;\n\n    case \"reasoning\":\n      return <Reasoning {...part} />;\n\n    case \"source\":\n      return <Source {...part} />;\n\n    case \"image\":\n      return <Image {...part} />;\n\n    case \"file\":\n      return <File {...part} />;\n\n    case \"audio\":\n      return <Audio {...part} />;\n\n    case \"data\":\n      return null;\n\n    default:\n      const unhandledType: never = type;\n      throw new Error(`Unknown message part type: ${unhandledType}`);\n  }\n};\n\ntype MessagePartProps = {\n  partIndex: number;\n  components: MessagePrimitiveUnstable_PartsGrouped.Props[\"components\"];\n};\n\nconst MessagePartImpl: FC<MessagePartProps> = ({ partIndex, components }) => {\n  return (\n    <PartByIndexProvider index={partIndex}>\n      <MessagePartComponent components={components} />\n    </PartByIndexProvider>\n  );\n};\n\nconst MessagePart = memo(\n  MessagePartImpl,\n  (prev, next) =>\n    prev.partIndex === next.partIndex &&\n    prev.components?.Text === next.components?.Text &&\n    prev.components?.Reasoning === next.components?.Reasoning &&\n    prev.components?.Source === next.components?.Source &&\n    prev.components?.Image === next.components?.Image &&\n    prev.components?.File === next.components?.File &&\n    prev.components?.Unstable_Audio === next.components?.Unstable_Audio &&\n    prev.components?.tools === next.components?.tools &&\n    prev.components?.Group === next.components?.Group,\n);\n\nconst EmptyPartFallback: FC<{\n  status: MessagePartStatus;\n  component: TextMessagePartComponent;\n}> = ({ status, component: Component }) => {\n  return (\n    <TextMessagePartProvider text=\"\" isRunning={status.type === \"running\"}>\n      <Component type=\"text\" text=\"\" status={status} />\n    </TextMessagePartProvider>\n  );\n};\n\nconst COMPLETE_STATUS: MessagePartStatus = Object.freeze({\n  type: \"complete\",\n});\n\nconst EmptyPartsImpl: FC<MessagePartComponentProps> = ({ components }) => {\n  const status = useAuiState(\n    (s) => (s.message.status ?? COMPLETE_STATUS) as MessagePartStatus,\n  );\n\n  if (components?.Empty) return <components.Empty status={status} />;\n\n  return (\n    <EmptyPartFallback\n      status={status}\n      component={components?.Text ?? defaultComponents.Text}\n    />\n  );\n};\n\nconst EmptyParts = memo(\n  EmptyPartsImpl,\n  (prev, next) =>\n    prev.components?.Empty === next.components?.Empty &&\n    prev.components?.Text === next.components?.Text,\n);\n\n/**\n * Renders the parts of a message grouped by a custom grouping function.\n *\n * This component allows you to group message parts based on any criteria you define.\n * The grouping function receives all message parts and returns an array of groups,\n * where each group has a key and an array of part indices.\n *\n * @example\n * ```tsx\n * // Group by parent ID (default behavior)\n * <MessagePrimitive.Unstable_PartsGrouped\n *   components={{\n *     Text: ({ text }) => <p className=\"message-text\">{text}</p>,\n *     Image: ({ image }) => <img src={image} alt=\"Message image\" />,\n *     Group: ({ groupKey, indices, children }) => {\n *       if (!groupKey) return <>{children}</>;\n *       return (\n *         <div className=\"parent-group border rounded p-4\">\n *           <h4>Parent ID: {groupKey}</h4>\n *           {children}\n *         </div>\n *       );\n *     }\n *   }}\n * />\n * ```\n *\n * @example\n * ```tsx\n * // Group by tool name\n * import { groupMessagePartsByToolName } from \"@creatorem/ai-react\";\n *\n * <MessagePrimitive.Unstable_PartsGrouped\n *   groupingFunction={groupMessagePartsByToolName}\n *   components={{\n *     Group: ({ groupKey, indices, children }) => {\n *       if (!groupKey) return <>{children}</>;\n *       return (\n *         <div className=\"tool-group\">\n *           <h4>Tool: {groupKey}</h4>\n *           {children}\n *         </div>\n *       );\n *     }\n *   }}\n * />\n * ```\n */\nexport const MessagePrimitiveUnstable_PartsGrouped: FC<\n  MessagePrimitiveUnstable_PartsGrouped.Props\n> = ({ groupingFunction, components }) => {\n  const contentLength = useAuiState(({ message }) => message.parts.length);\n  const messageGroups = useMessagePartsGrouped(groupingFunction);\n\n  const partsElements = useMemo(() => {\n    if (contentLength === 0) {\n      return <EmptyParts components={components} />;\n    }\n\n    return messageGroups.map((group, groupIndex) => {\n      const GroupComponent = components?.Group ?? defaultComponents.Group;\n\n      return (\n        <GroupComponent\n          key={`group-${groupIndex}-${group.groupKey ?? \"ungrouped\"}`}\n          groupKey={group.groupKey}\n          indices={group.indices}\n        >\n          {group.indices.map((partIndex) => (\n            <MessagePart\n              key={partIndex}\n              partIndex={partIndex}\n              components={components}\n            />\n          ))}\n        </GroupComponent>\n      );\n    });\n  }, [messageGroups, components, contentLength]);\n\n  return <>{partsElements}</>;\n};\n\nMessagePrimitiveUnstable_PartsGrouped.displayName =\n  \"MessagePrimitive.Unstable_PartsGrouped\";\n\n/**\n * Renders the parts of a message grouped by their parent ID.\n * This is a convenience wrapper around Unstable_PartsGrouped with parent ID grouping.\n *\n * @deprecated Use MessagePrimitive.Unstable_PartsGrouped instead for more flexibility\n */\nexport const MessagePrimitiveUnstable_PartsGroupedByParentId: FC<\n  Omit<MessagePrimitiveUnstable_PartsGrouped.Props, \"groupingFunction\">\n> = ({ components, ...props }) => {\n  return (\n    <MessagePrimitiveUnstable_PartsGrouped\n      {...props}\n      components={components}\n      groupingFunction={groupMessagePartsByParentId}\n    />\n  );\n};\n\nMessagePrimitiveUnstable_PartsGroupedByParentId.displayName =\n  \"MessagePrimitive.Unstable_PartsGroupedByParentId\";\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5655, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 5672, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/remote-thread-list/base-subscribable.tsx"],"sourcesContent":["import { Unsubscribe } from \"../../../types\";\n\nexport class BaseSubscribable {\n  private _subscribers = new Set<() => void>();\n\n  public subscribe(callback: () => void): Unsubscribe {\n    this._subscribers.add(callback);\n    return () => this._subscribers.delete(callback);\n  }\n\n  public waitForUpdate() {\n    return new Promise<void>((resolve) => {\n      const unsubscribe = this.subscribe(() => {\n        unsubscribe();\n        resolve();\n      });\n    });\n  }\n\n  protected _notifySubscribers() {\n    const errors = [];\n    for (const callback of this._subscribers) {\n      try {\n        callback();\n      } catch (error) {\n        errors.push(error);\n      }\n    }\n\n    if (errors.length > 0) {\n      if (errors.length === 1) {\n        throw errors[0];\n      } else {\n        for (const error of errors) {\n          console.error(error);\n        }\n        throw new AggregateError(errors);\n      }\n    }\n  }\n}\n"],"names":[],"mappings":";;;;AAEO,MAAM;IACH,eAAe,IAAI,MAAkB;IAEtC,UAAU,QAAoB,EAAe;QAClD,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC;QACtB,OAAO,IAAM,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;IACxC;IAEO,gBAAgB;QACrB,OAAO,IAAI,QAAc,CAAC;YACxB,MAAM,cAAc,IAAI,CAAC,SAAS,CAAC;gBACjC;gBACA;YACF;QACF;IACF;IAEU,qBAAqB;QAC7B,MAAM,SAAS,EAAE;QACjB,KAAK,MAAM,YAAY,IAAI,CAAC,YAAY,CAAE;YACxC,IAAI;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,OAAO,IAAI,CAAC;YACd;QACF;QAEA,IAAI,OAAO,MAAM,GAAG,GAAG;YACrB,IAAI,OAAO,MAAM,KAAK,GAAG;gBACvB,MAAM,MAAM,CAAC,EAAE;YACjB,OAAO;gBACL,KAAK,MAAM,SAAS,OAAQ;oBAC1B,QAAQ,KAAK,CAAC;gBAChB;gBACA,MAAM,IAAI,eAAe;YAC3B;QACF;IACF;AACF"}},
    {"offset": {"line": 5715, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/composer/base-composer-runtime-core.tsx"],"sourcesContent":["import type {\n  Attachment,\n  CompleteAttachment,\n  PendingAttachment,\n} from \"../../../types/attachment-types\";\nimport type { AppendMessage, Unsubscribe } from \"../../../types\";\nimport type { AttachmentAdapter } from \"../adapters/attachment\";\nimport type {\n  ComposerRuntimeCore,\n  ComposerRuntimeEventType,\n  DictationState,\n} from \"../core/composer-runtime-core\";\nimport type { MessageRole, RunConfig } from \"../../../types/assistant-types\";\nimport { BaseSubscribable } from \"../remote-thread-list/base-subscribable\";\nimport type { DictationAdapter } from \"../adapters/speech/speech-adapter-types\";\n\nconst isAttachmentComplete = (a: Attachment): a is CompleteAttachment =>\n  a.status.type === \"complete\";\n\nexport abstract class BaseComposerRuntimeCore\n  extends BaseSubscribable\n  implements ComposerRuntimeCore\n{\n  public readonly isEditing = true;\n\n  protected abstract getAttachmentAdapter(): AttachmentAdapter | undefined;\n  protected abstract getDictationAdapter(): DictationAdapter | undefined;\n\n  public get attachmentAccept(): string {\n    return this.getAttachmentAdapter()?.accept ?? \"*\";\n  }\n\n  private _attachments: readonly Attachment[] = [];\n  public get attachments() {\n    return this._attachments;\n  }\n\n  protected setAttachments(value: readonly Attachment[]) {\n    this._attachments = value;\n    this._notifySubscribers();\n  }\n\n  public abstract get canCancel(): boolean;\n\n  public get isEmpty() {\n    return !this.text.trim() && !this.attachments.length;\n  }\n\n  private _text = \"\";\n\n  get text() {\n    return this._text;\n  }\n\n  private _role: MessageRole = \"user\";\n\n  get role() {\n    return this._role;\n  }\n\n  private _runConfig: RunConfig = {};\n\n  get runConfig() {\n    return this._runConfig;\n  }\n\n  public setText(value: string) {\n    if (this._text === value) return;\n\n    this._text = value;\n    // When dictation is active and the user manually edits the composer text,\n    // treat the new text as the updated base so speech results are appended\n    // instead of overwriting manual edits.\n    if (this._dictation) {\n      this._dictationBaseText = value;\n      this._currentInterimText = \"\";\n      const { status, inputDisabled } = this._dictation;\n      this._dictation = inputDisabled ? { status, inputDisabled } : { status };\n    }\n    this._notifySubscribers();\n  }\n\n  public setRole(role: MessageRole) {\n    if (this._role === role) return;\n\n    this._role = role;\n    this._notifySubscribers();\n  }\n\n  public setRunConfig(runConfig: RunConfig) {\n    if (this._runConfig === runConfig) return;\n\n    this._runConfig = runConfig;\n    this._notifySubscribers();\n  }\n\n  private _emptyTextAndAttachments() {\n    this._attachments = [];\n    this._text = \"\";\n    this._notifySubscribers();\n  }\n\n  private async _onClearAttachments() {\n    const adapter = this.getAttachmentAdapter();\n    if (adapter) {\n      await Promise.all(this._attachments.map((a) => adapter.remove(a)));\n    }\n  }\n\n  public async reset() {\n    if (\n      this._attachments.length === 0 &&\n      this._text === \"\" &&\n      this._role === \"user\" &&\n      Object.keys(this._runConfig).length === 0\n    ) {\n      return;\n    }\n\n    this._role = \"user\";\n    this._runConfig = {};\n\n    const task = this._onClearAttachments();\n    this._emptyTextAndAttachments();\n    await task;\n  }\n\n  public async clearAttachments() {\n    const task = this._onClearAttachments();\n    this.setAttachments([]);\n\n    await task;\n  }\n\n  public async send() {\n    if (this._dictationSession) {\n      this._dictationSession.cancel();\n      this._cleanupDictation();\n    }\n\n    const adapter = this.getAttachmentAdapter();\n    const attachments =\n      adapter && this.attachments.length > 0\n        ? Promise.all(\n            this.attachments.map(async (a) => {\n              if (isAttachmentComplete(a)) return a;\n              const result = await adapter.send(a);\n              return result as CompleteAttachment;\n            }),\n          )\n        : [];\n\n    const text = this.text;\n    this._emptyTextAndAttachments();\n    const message: Omit<AppendMessage, \"parentId\" | \"sourceId\"> = {\n      createdAt: new Date(),\n      role: this.role,\n      content: text ? [{ type: \"text\", text }] : [],\n      attachments: await attachments,\n      runConfig: this.runConfig,\n      metadata: { custom: {} },\n    };\n\n    this.handleSend(message);\n    this._notifyEventSubscribers(\"send\");\n  }\n\n  public cancel() {\n    this.handleCancel();\n  }\n\n  protected abstract handleSend(\n    message: Omit<AppendMessage, \"parentId\" | \"sourceId\">,\n  ): void;\n  protected abstract handleCancel(): void;\n\n  async addAttachment(file: File) {\n    const adapter = this.getAttachmentAdapter();\n    if (!adapter) throw new Error(\"Attachments are not supported\");\n\n    const upsertAttachment = (a: PendingAttachment) => {\n      const idx = this._attachments.findIndex(\n        (attachment) => attachment.id === a.id,\n      );\n      if (idx !== -1)\n        this._attachments = [\n          ...this._attachments.slice(0, idx),\n          a,\n          ...this._attachments.slice(idx + 1),\n        ];\n      else {\n        this._attachments = [...this._attachments, a];\n      }\n\n      this._notifySubscribers();\n    };\n\n    const promiseOrGenerator = adapter.add({ file });\n    if (Symbol.asyncIterator in promiseOrGenerator) {\n      for await (const r of promiseOrGenerator) {\n        upsertAttachment(r);\n      }\n    } else {\n      upsertAttachment(await promiseOrGenerator);\n    }\n\n    this._notifyEventSubscribers(\"attachmentAdd\");\n    this._notifySubscribers();\n  }\n\n  async removeAttachment(attachmentId: string) {\n    const adapter = this.getAttachmentAdapter();\n    if (!adapter) throw new Error(\"Attachments are not supported\");\n\n    const index = this._attachments.findIndex((a) => a.id === attachmentId);\n    if (index === -1) throw new Error(\"Attachment not found\");\n    const attachment = this._attachments[index]!;\n\n    await adapter.remove(attachment);\n\n    // this._attachments.toSpliced(index, 1); - not yet widely supported\n    this._attachments = [\n      ...this._attachments.slice(0, index),\n      ...this._attachments.slice(index + 1),\n    ];\n    this._notifySubscribers();\n  }\n\n  private _dictation: DictationState | undefined;\n  private _dictationSession: DictationAdapter.Session | undefined;\n  private _dictationUnsubscribes: Unsubscribe[] = [];\n  private _dictationBaseText = \"\";\n  private _currentInterimText = \"\";\n  private _dictationSessionIdCounter = 0;\n  private _activeDictationSessionId: number | undefined;\n  private _isCleaningDictation = false;\n\n  public get dictation(): DictationState | undefined {\n    return this._dictation;\n  }\n\n  private _isActiveSession(\n    sessionId: number,\n    session: DictationAdapter.Session,\n  ): boolean {\n    return (\n      this._activeDictationSessionId === sessionId &&\n      this._dictationSession === session\n    );\n  }\n\n  public startDictation(): void {\n    const adapter = this.getDictationAdapter();\n    if (!adapter) {\n      throw new Error(\"Dictation adapter not configured\");\n    }\n\n    if (this._dictationSession) {\n      for (const unsub of this._dictationUnsubscribes) {\n        unsub();\n      }\n      this._dictationUnsubscribes = [];\n      const oldSession = this._dictationSession;\n      oldSession.stop().catch(() => {});\n      this._dictationSession = undefined;\n    }\n\n    const inputDisabled = adapter.disableInputDuringDictation ?? false;\n\n    this._dictationBaseText = this._text;\n    this._currentInterimText = \"\";\n\n    const session = adapter.listen();\n    this._dictationSession = session;\n    const sessionId = ++this._dictationSessionIdCounter;\n    this._activeDictationSessionId = sessionId;\n    this._dictation = { status: session.status, inputDisabled };\n    this._notifySubscribers();\n\n    const unsubSpeech = session.onSpeech((result) => {\n      if (!this._isActiveSession(sessionId, session)) return;\n      const isFinal = result.isFinal !== false;\n\n      const needsSeparator =\n        this._dictationBaseText &&\n        !this._dictationBaseText.endsWith(\" \") &&\n        result.transcript;\n      const separator = needsSeparator ? \" \" : \"\";\n\n      if (isFinal) {\n        this._dictationBaseText =\n          this._dictationBaseText + separator + result.transcript;\n        this._currentInterimText = \"\";\n        this._text = this._dictationBaseText;\n\n        if (this._dictation) {\n          const { transcript: _, ...rest } = this._dictation;\n          this._dictation = rest;\n        }\n        this._notifySubscribers();\n      } else {\n        this._currentInterimText = separator + result.transcript;\n        this._text = this._dictationBaseText + this._currentInterimText;\n\n        if (this._dictation) {\n          this._dictation = {\n            ...this._dictation,\n            transcript: result.transcript,\n          };\n        }\n        this._notifySubscribers();\n      }\n    });\n    this._dictationUnsubscribes.push(unsubSpeech);\n\n    const unsubStart = session.onSpeechStart(() => {\n      if (!this._isActiveSession(sessionId, session)) return;\n\n      this._dictation = {\n        status: { type: \"running\" },\n        inputDisabled,\n        ...(this._dictation?.transcript && {\n          transcript: this._dictation.transcript,\n        }),\n      };\n      this._notifySubscribers();\n    });\n    this._dictationUnsubscribes.push(unsubStart);\n\n    const unsubEnd = session.onSpeechEnd(() => {\n      this._cleanupDictation({ sessionId });\n    });\n    this._dictationUnsubscribes.push(unsubEnd);\n\n    const statusInterval = setInterval(() => {\n      if (!this._isActiveSession(sessionId, session)) return;\n\n      if (session.status.type === \"ended\") {\n        this._cleanupDictation({ sessionId });\n      }\n    }, 100);\n    this._dictationUnsubscribes.push(() => clearInterval(statusInterval));\n  }\n\n  public stopDictation(): void {\n    if (!this._dictationSession) return;\n\n    const session = this._dictationSession;\n    const sessionId = this._activeDictationSessionId;\n    session.stop().finally(() => {\n      this._cleanupDictation({ sessionId });\n    });\n  }\n\n  private _cleanupDictation(options?: { sessionId: number | undefined }): void {\n    const isStaleSession =\n      options?.sessionId !== undefined &&\n      options.sessionId !== this._activeDictationSessionId;\n    if (isStaleSession || this._isCleaningDictation) return;\n\n    this._isCleaningDictation = true;\n    try {\n      for (const unsub of this._dictationUnsubscribes) {\n        unsub();\n      }\n      this._dictationUnsubscribes = [];\n      this._dictationSession = undefined;\n      this._activeDictationSessionId = undefined;\n      this._dictation = undefined;\n      this._dictationBaseText = \"\";\n      this._currentInterimText = \"\";\n      this._notifySubscribers();\n    } finally {\n      this._isCleaningDictation = false;\n    }\n  }\n\n  private _eventSubscribers = new Map<\n    ComposerRuntimeEventType,\n    Set<() => void>\n  >();\n\n  protected _notifyEventSubscribers(event: ComposerRuntimeEventType) {\n    const subscribers = this._eventSubscribers.get(event);\n    if (!subscribers) return;\n\n    for (const callback of subscribers) callback();\n  }\n\n  public unstable_on(event: ComposerRuntimeEventType, callback: () => void) {\n    const subscribers = this._eventSubscribers.get(event);\n    if (!subscribers) {\n      this._eventSubscribers.set(event, new Set([callback]));\n    } else {\n      subscribers.add(callback);\n    }\n\n    return () => {\n      const subscribers = this._eventSubscribers.get(event);\n      if (!subscribers) return;\n      subscribers.delete(callback);\n    };\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6036, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/composer/default-thread-composer-runtime-core.tsx"],"sourcesContent":["import type { AppendMessage, PendingAttachment } from \"../../../types\";\nimport type { AttachmentAdapter } from \"../adapters/attachment\";\nimport type { DictationAdapter } from \"../adapters/speech/speech-adapter-types\";\nimport type { ThreadComposerRuntimeCore } from \"../core/composer-runtime-core\";\nimport type { ThreadRuntimeCore } from \"../core/thread-runtime-core\";\nimport { BaseComposerRuntimeCore } from \"./base-composer-runtime-core\";\n\nexport class DefaultThreadComposerRuntimeCore\n  extends BaseComposerRuntimeCore\n  implements ThreadComposerRuntimeCore\n{\n  private _canCancel = false;\n  public get canCancel() {\n    return this._canCancel;\n  }\n\n  public override get attachments(): readonly PendingAttachment[] {\n    return super.attachments as readonly PendingAttachment[];\n  }\n\n  protected getAttachmentAdapter() {\n    return this.runtime.adapters?.attachments;\n  }\n\n  protected getDictationAdapter() {\n    return this.runtime.adapters?.dictation;\n  }\n\n  constructor(\n    private runtime: Omit<ThreadRuntimeCore, \"composer\"> & {\n      adapters?:\n        | {\n            attachments?: AttachmentAdapter | undefined;\n            dictation?: DictationAdapter | undefined;\n          }\n        | undefined;\n    },\n  ) {\n    super();\n    this.connect();\n  }\n\n  public connect() {\n    return this.runtime.subscribe(() => {\n      if (this.canCancel !== this.runtime.capabilities.cancel) {\n        this._canCancel = this.runtime.capabilities.cancel;\n        this._notifySubscribers();\n      }\n    });\n  }\n\n  public async handleSend(\n    message: Omit<AppendMessage, \"parentId\" | \"sourceId\">,\n  ) {\n    this.runtime.append({\n      ...(message as AppendMessage),\n      parentId: this.runtime.messages.at(-1)?.id ?? null,\n      sourceId: null,\n    });\n  }\n\n  public async handleCancel() {\n    this.runtime.cancelRun();\n  }\n}\n"],"names":[],"mappings":";;;;AAKA;;AAEO,MAAM,yCACH,gPAAuB;;IAGvB,WAAmB;IAC3B,IAAW,YAAY;QACrB,OAAO,IAAI,CAAC,UAAU;IACxB;IAEA,IAAoB,cAA4C;QAC9D,OAAO,KAAK,CAAC;IACf;IAEU,uBAAuB;QAC/B,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;IAChC;IAEU,sBAAsB;QAC9B,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;IAChC;IAEA,YACE,AAAQ,OAOP,CACD;QACA,KAAK,SATG,UAAA,cAlBF,aAAa;QA4BnB,IAAI,CAAC,OAAO;IACd;IAEO,UAAU;QACf,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;YAC5B,IAAI,IAAI,CAAC,SAAS,KAAK,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,MAAM,EAAE;gBACvD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,MAAM;gBAClD,IAAI,CAAC,kBAAkB;YACzB;QACF;IACF;IAEA,MAAa,WACX,OAAqD,EACrD;QACA,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;YAClB,GAAI,OAAO;YACX,UAAU,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,IAAI,MAAM;YAC9C,UAAU;QACZ;IACF;IAEA,MAAa,eAAe;QAC1B,IAAI,CAAC,OAAO,CAAC,SAAS;IACxB;AACF"}},
    {"offset": {"line": 6084, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/id-utils.tsx"],"sourcesContent":["import { customAlphabet } from \"nanoid/non-secure\";\n\nexport const generateId = customAlphabet(\n  \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\",\n  7,\n);\n\nconst optimisticPrefix = \"__optimistic__\";\nexport const generateOptimisticId = () => `${optimisticPrefix}${generateId()}`;\nexport const isOptimisticId = (id: string) => id.startsWith(optimisticPrefix);\n\nconst errorPrefix = \"__error__\";\nexport const generateErrorMessageId = () => `${errorPrefix}${generateId()}`;\nexport const isErrorMessageId = (id: string) => id.startsWith(errorPrefix);\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;;AAEO,MAAM,aAAa,IAAA,qNAAc,EACtC,kEACA;AAGF,MAAM,mBAAmB;AAClB,MAAM,uBAAuB,IAAM,GAAG,mBAAmB,cAAc;AACvE,MAAM,iBAAiB,CAAC,KAAe,GAAG,UAAU,CAAC;AAE5D,MAAM,cAAc;AACb,MAAM,yBAAyB,IAAM,GAAG,cAAc,cAAc;AACpE,MAAM,mBAAmB,CAAC,KAAe,GAAG,UAAU,CAAC"}},
    {"offset": {"line": 6109, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/external-store/auto-status.tsx"],"sourcesContent":["import { ReadonlyJSONValue } from \"assistant-stream/utils\";\nimport { MessageStatus } from \"../../../types\";\n\nconst symbolAutoStatus = Symbol(\"autoStatus\");\n\nconst AUTO_STATUS_RUNNING = Object.freeze(\n  Object.assign({ type: \"running\" as const }, { [symbolAutoStatus]: true }),\n);\nconst AUTO_STATUS_COMPLETE = Object.freeze(\n  Object.assign(\n    {\n      type: \"complete\" as const,\n      reason: \"unknown\" as const,\n    },\n    { [symbolAutoStatus]: true },\n  ),\n);\n\nconst AUTO_STATUS_PENDING = Object.freeze(\n  Object.assign(\n    {\n      type: \"requires-action\" as const,\n      reason: \"tool-calls\" as const,\n    },\n    { [symbolAutoStatus]: true },\n  ),\n);\n\nconst AUTO_STATUS_INTERRUPT = Object.freeze(\n  Object.assign(\n    {\n      type: \"requires-action\" as const,\n      reason: \"interrupt\" as const,\n    },\n    { [symbolAutoStatus]: true },\n  ),\n);\n\nexport const isAutoStatus = (status: MessageStatus) =>\n  (status as any)[symbolAutoStatus] === true;\n\nexport const getAutoStatus = (\n  isLast: boolean,\n  isRunning: boolean,\n  hasInterruptedToolCalls: boolean,\n  hasPendingToolCalls: boolean,\n  error?: ReadonlyJSONValue,\n): MessageStatus => {\n  if (isLast && error) {\n    return Object.assign(\n      {\n        type: \"incomplete\" as const,\n        reason: \"error\" as const,\n        error: error,\n      },\n      { [symbolAutoStatus]: true },\n    );\n  }\n\n  return isLast && isRunning\n    ? AUTO_STATUS_RUNNING\n    : hasInterruptedToolCalls\n      ? AUTO_STATUS_INTERRUPT\n      : hasPendingToolCalls\n        ? AUTO_STATUS_PENDING\n        : AUTO_STATUS_COMPLETE;\n};\n"],"names":[],"mappings":";;;;;;AAGA,MAAM,mBAAmB,OAAO;AAEhC,MAAM,sBAAsB,OAAO,MAAM,CACvC,OAAO,MAAM,CAAC;IAAE,MAAM;AAAmB,GAAG;IAAE,CAAC,iBAAiB,EAAE;AAAK;AAEzE,MAAM,uBAAuB,OAAO,MAAM,CACxC,OAAO,MAAM,CACX;IACE,MAAM;IACN,QAAQ;AACV,GACA;IAAE,CAAC,iBAAiB,EAAE;AAAK;AAI/B,MAAM,sBAAsB,OAAO,MAAM,CACvC,OAAO,MAAM,CACX;IACE,MAAM;IACN,QAAQ;AACV,GACA;IAAE,CAAC,iBAAiB,EAAE;AAAK;AAI/B,MAAM,wBAAwB,OAAO,MAAM,CACzC,OAAO,MAAM,CACX;IACE,MAAM;IACN,QAAQ;AACV,GACA;IAAE,CAAC,iBAAiB,EAAE;AAAK;AAIxB,MAAM,eAAe,CAAC,SAC3B,AAAC,MAAc,CAAC,iBAAiB,KAAK;AAEjC,MAAM,gBAAgB,CAC3B,QACA,WACA,yBACA,qBACA;IAEA,IAAI,UAAU,OAAO;QACnB,OAAO,OAAO,MAAM,CAClB;YACE,MAAM;YACN,QAAQ;YACR,OAAO;QACT,GACA;YAAE,CAAC,iBAAiB,EAAE;QAAK;IAE/B;IAEA,OAAO,UAAU,YACb,sBACA,0BACE,wBACA,sBACE,sBACA;AACV"}},
    {"offset": {"line": 6156, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/external-store/thread-message-like.tsx"],"sourcesContent":["import { parsePartialJsonObject } from \"assistant-stream/utils\";\nimport { generateId } from \"../../../utils/id-utils\";\nimport {\n  MessageStatus,\n  TextMessagePart,\n  ImageMessagePart,\n  ThreadMessage,\n  ThreadAssistantMessagePart,\n  ThreadAssistantMessage,\n  ThreadUserMessagePart,\n  ThreadUserMessage,\n  ThreadSystemMessage,\n  CompleteAttachment,\n  FileMessagePart,\n  DataMessagePart,\n  Unstable_AudioMessagePart,\n} from \"../../../types\";\nimport {\n  ReasoningMessagePart,\n  SourceMessagePart,\n  ThreadStep,\n} from \"../../../types/assistant-types\";\nimport { ReadonlyJSONObject, ReadonlyJSONValue } from \"assistant-stream/utils\";\n\nexport type ThreadMessageLike = {\n  readonly role: \"assistant\" | \"user\" | \"system\";\n  readonly content:\n    | string\n    | readonly (\n        | TextMessagePart\n        | ReasoningMessagePart\n        | SourceMessagePart\n        | ImageMessagePart\n        | FileMessagePart\n        | DataMessagePart\n        | Unstable_AudioMessagePart\n        | {\n            readonly type: \"tool-call\";\n            readonly toolCallId?: string;\n            readonly toolName: string;\n            readonly args?: ReadonlyJSONObject;\n            readonly argsText?: string;\n            readonly artifact?: any;\n            readonly result?: any | undefined;\n            readonly isError?: boolean | undefined;\n            readonly parentId?: string | undefined;\n            readonly messages?: readonly ThreadMessage[] | undefined;\n          }\n      )[];\n  readonly id?: string | undefined;\n  readonly createdAt?: Date | undefined;\n  readonly status?: MessageStatus | undefined;\n  readonly attachments?: readonly CompleteAttachment[] | undefined;\n  readonly metadata?:\n    | {\n        readonly unstable_state?: ReadonlyJSONValue;\n        readonly unstable_annotations?:\n          | readonly ReadonlyJSONValue[]\n          | undefined;\n        readonly unstable_data?: readonly ReadonlyJSONValue[] | undefined;\n        readonly steps?: readonly ThreadStep[] | undefined;\n        readonly submittedFeedback?: { readonly type: \"positive\" | \"negative\" };\n        readonly custom?: Record<string, unknown> | undefined;\n      }\n    | undefined;\n};\n\nexport const fromThreadMessageLike = (\n  like: ThreadMessageLike,\n  fallbackId: string,\n  fallbackStatus: MessageStatus,\n): ThreadMessage => {\n  const { role, id, createdAt, attachments, status, metadata } = like;\n  const common = {\n    id: id ?? fallbackId,\n    createdAt: createdAt ?? new Date(),\n  };\n\n  const content =\n    typeof like.content === \"string\"\n      ? [{ type: \"text\" as const, text: like.content }]\n      : like.content;\n\n  const sanitizeImageContent = ({\n    image,\n    ...rest\n  }: ImageMessagePart): ImageMessagePart | null => {\n    const match = image.match(\n      /^data:image\\/(png|jpeg|jpg|gif|webp);base64,(.*)$/,\n    );\n    if (match) {\n      return { ...rest, image };\n    }\n    console.warn(`Invalid image data format detected`);\n    return null;\n  };\n\n  if (role !== \"user\" && attachments?.length)\n    throw new Error(\"attachments are only supported for user messages\");\n\n  if (role !== \"assistant\" && status)\n    throw new Error(\"status is only supported for assistant messages\");\n\n  if (role !== \"assistant\" && metadata?.steps)\n    throw new Error(\"metadata.steps is only supported for assistant messages\");\n\n  switch (role) {\n    case \"assistant\":\n      return {\n        ...common,\n        role,\n        content: content\n          .map((part): ThreadAssistantMessagePart | null => {\n            const type = part.type;\n            switch (type) {\n              case \"text\":\n              case \"reasoning\":\n                if (part.text.trim().length === 0) return null;\n                return part;\n\n              case \"file\":\n              case \"source\":\n                return part;\n\n              case \"image\":\n                return sanitizeImageContent(part);\n\n              case \"data\":\n                return part;\n\n              case \"tool-call\": {\n                const { parentId, messages, ...basePart } = part;\n                const commonProps = {\n                  ...basePart,\n                  toolCallId: part.toolCallId ?? `tool-${generateId()}`,\n                  ...(parentId !== undefined && { parentId }),\n                  ...(messages !== undefined && { messages }),\n                };\n\n                if (part.args) {\n                  return {\n                    ...commonProps,\n                    args: part.args,\n                    argsText: part.argsText ?? JSON.stringify(part.args),\n                  };\n                }\n                return {\n                  ...commonProps,\n                  args: parsePartialJsonObject(part.argsText ?? \"\") ?? {},\n                  argsText: part.argsText ?? \"\",\n                };\n              }\n\n              default: {\n                const unhandledType: \"audio\" = type;\n                throw new Error(\n                  `Unsupported assistant message part type: ${unhandledType}`,\n                );\n              }\n            }\n          })\n          .filter((c) => !!c),\n        status: status ?? fallbackStatus,\n        metadata: {\n          unstable_state: metadata?.unstable_state ?? null,\n          unstable_annotations: metadata?.unstable_annotations ?? [],\n          unstable_data: metadata?.unstable_data ?? [],\n          custom: metadata?.custom ?? {},\n          steps: metadata?.steps ?? [],\n          ...(metadata?.submittedFeedback && {\n            submittedFeedback: metadata.submittedFeedback,\n          }),\n        },\n      } satisfies ThreadAssistantMessage;\n\n    case \"user\":\n      return {\n        ...common,\n        role,\n        content: content.map((part): ThreadUserMessagePart => {\n          const type = part.type;\n          switch (type) {\n            case \"text\":\n            case \"image\":\n            case \"audio\":\n            case \"file\":\n              return part;\n\n            default: {\n              const unhandledType:\n                | \"tool-call\"\n                | \"reasoning\"\n                | \"source\"\n                | \"data\" = type;\n              throw new Error(\n                `Unsupported user message part type: ${unhandledType}`,\n              );\n            }\n          }\n        }),\n        attachments: attachments ?? [],\n        metadata: {\n          custom: metadata?.custom ?? {},\n        },\n      } satisfies ThreadUserMessage;\n\n    case \"system\":\n      if (content.length !== 1 || content[0]!.type !== \"text\")\n        throw new Error(\n          \"System messages must have exactly one text message part.\",\n        );\n\n      return {\n        ...common,\n        role,\n        content: content as [TextMessagePart],\n        metadata: {\n          custom: metadata?.custom ?? {},\n        },\n      } satisfies ThreadSystemMessage;\n\n    default: {\n      const unsupportedRole: never = role;\n      throw new Error(`Unknown message role: ${unsupportedRole}`);\n    }\n  }\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6299, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/utils/message-repository.tsx"],"sourcesContent":["import type { ThreadMessage } from \"../../../types\";\nimport { RunConfig } from \"../../../types/assistant-types\";\nimport { generateId, generateOptimisticId } from \"../../../utils/id-utils\";\nimport { ThreadMessageLike } from \"../external-store\";\nimport { getAutoStatus } from \"../external-store/auto-status\";\nimport { fromThreadMessageLike } from \"../external-store/thread-message-like\";\n\n/**\n * Represents a parent node in the repository tree structure.\n */\ntype RepositoryParent = {\n  /** IDs of child messages */\n  children: string[];\n  /** Reference to the next message in the active branch */\n  next: RepositoryMessage | null;\n};\n\n/**\n * Represents a message node in the repository tree structure.\n */\ntype RepositoryMessage = RepositoryParent & {\n  /** Reference to the parent message */\n  prev: RepositoryMessage | null;\n  /** The actual message data */\n  current: ThreadMessage;\n  /** The depth level in the tree (0 for root messages) */\n  level: number;\n};\n\n/**\n * Represents a message item that can be exported from the repository.\n */\nexport type ExportedMessageRepositoryItem = {\n  /** The message data */\n  message: ThreadMessage;\n  /** ID of the parent message, or null for root messages */\n  parentId: string | null;\n  /** The run configuration for the message */\n  runConfig?: RunConfig;\n};\n\n/**\n * Represents the entire repository state for export/import.\n */\nexport type ExportedMessageRepository = {\n  /** ID of the head message, or null/undefined if no head */\n  headId?: string | null;\n  /** Array of all messages with their parent references */\n  messages: Array<{\n    message: ThreadMessage;\n    parentId: string | null;\n    runConfig?: RunConfig;\n  }>;\n};\n\n/**\n * Utility functions for working with exported message repositories.\n */\nexport const ExportedMessageRepository = {\n  /**\n   * Converts an array of messages to an ExportedMessageRepository format.\n   * Creates parent-child relationships based on the order of messages in the array.\n   *\n   * @param messages - Array of message-like objects to convert\n   * @returns ExportedMessageRepository with parent-child relationships established\n   */\n  fromArray: (\n    messages: readonly ThreadMessageLike[],\n  ): ExportedMessageRepository => {\n    const conv = messages.map((m) =>\n      fromThreadMessageLike(\n        m,\n        generateId(),\n        getAutoStatus(false, false, false, false, undefined),\n      ),\n    );\n\n    return {\n      messages: conv.map((m, idx) => ({\n        parentId: idx > 0 ? conv[idx - 1]!.id : null,\n        message: m,\n      })),\n    };\n  },\n};\n\n/**\n * Recursively finds the head (leaf) message in a branch.\n *\n * @param message - The starting message or parent node\n * @returns The leaf message of the branch, or null if not found\n */\nconst findHead = (\n  message: RepositoryMessage | RepositoryParent,\n): RepositoryMessage | null => {\n  if (message.next) return findHead(message.next);\n  if (\"current\" in message) return message;\n  return null;\n};\n\n/**\n * A utility class for caching computed values and invalidating the cache when needed.\n */\nclass CachedValue<T> {\n  private _value: T | null = null;\n\n  /**\n   * @param func - The function that computes the cached value\n   */\n  constructor(private func: () => T) {}\n\n  /**\n   * Gets the cached value, computing it if necessary.\n   */\n  get value() {\n    if (this._value === null) {\n      this._value = this.func();\n    }\n    return this._value;\n  }\n\n  /**\n   * Invalidates the cache, forcing recomputation on next access.\n   */\n  dirty() {\n    this._value = null;\n  }\n}\n\n/**\n * A repository that manages a tree of messages with branching capabilities.\n * Supports operations like adding, updating, and deleting messages, as well as\n * managing multiple conversation branches.\n */\nexport class MessageRepository {\n  /** Map of message IDs to repository message objects */\n  private messages = new Map<string, RepositoryMessage>();\n  /** Reference to the current head (most recent) message in the active branch */\n  private head: RepositoryMessage | null = null;\n  /** Root node of the tree structure */\n  private root: RepositoryParent = {\n    children: [],\n    next: null,\n  };\n\n  /**\n   * Recursively updates the level of a message and all its descendants.\n   *\n   * @param message - The message to update\n   * @param newLevel - The new level for the message\n   */\n  private updateLevels(message: RepositoryMessage, newLevel: number) {\n    message.level = newLevel;\n    for (const childId of message.children) {\n      const childMessage = this.messages.get(childId);\n      if (childMessage) {\n        this.updateLevels(childMessage, newLevel + 1);\n      }\n    }\n  }\n\n  /**\n   * Performs link/unlink operations between messages in the tree.\n   *\n   * @param newParent - The new parent message, or null\n   * @param child - The child message to operate on\n   * @param operation - The type of operation to perform:\n   *   - \"cut\": Remove the child from its current parent\n   *   - \"link\": Add the child to a new parent\n   *   - \"relink\": Both cut and link operations\n   */\n  private performOp(\n    newParent: RepositoryMessage | null,\n    child: RepositoryMessage,\n    operation: \"cut\" | \"link\" | \"relink\",\n  ) {\n    const parentOrRoot = child.prev ?? this.root;\n    const newParentOrRoot = newParent ?? this.root;\n\n    if (operation === \"relink\" && parentOrRoot === newParentOrRoot) return;\n\n    // cut\n    if (operation !== \"link\") {\n      // remove from parentOrRoot.children\n      parentOrRoot.children = parentOrRoot.children.filter(\n        (m) => m !== child.current.id,\n      );\n\n      // update parentOrRoot.next\n      if (parentOrRoot.next === child) {\n        const fallbackId = parentOrRoot.children.at(-1);\n        const fallback = fallbackId ? this.messages.get(fallbackId) : null;\n        if (fallback === undefined) {\n          throw new Error(\n            \"MessageRepository(performOp/cut): Fallback sibling message not found. This is likely an internal bug in assistant-ui.\",\n          );\n        }\n        parentOrRoot.next = fallback;\n      }\n    }\n\n    // link\n    if (operation !== \"cut\") {\n      // ensure the child is not part of parent tree\n      for (\n        let current: RepositoryMessage | null = newParent;\n        current;\n        current = current.prev\n      ) {\n        if (current.current.id === child.current.id) {\n          throw new Error(\n            \"MessageRepository(performOp/link): A message with the same id already exists in the parent tree. This error occurs if the same message id is found multiple times. This is likely an internal bug in assistant-ui.\",\n          );\n        }\n      }\n\n      // add to parentOrRoot.children\n      newParentOrRoot.children = [\n        ...newParentOrRoot.children,\n        child.current.id,\n      ];\n\n      // update parentOrRoot.next\n      if (findHead(child) === this.head || newParentOrRoot.next === null) {\n        newParentOrRoot.next = child;\n      }\n\n      child.prev = newParent;\n\n      // update levels when linking/relinking to a new parent\n      const newLevel = newParent ? newParent.level + 1 : 0;\n      this.updateLevels(child, newLevel);\n    }\n  }\n\n  /** Cached array of messages in the current active branch, from root to head */\n  private _messages = new CachedValue<readonly ThreadMessage[]>(() => {\n    const messages = new Array<ThreadMessage>((this.head?.level ?? -1) + 1);\n    for (let current = this.head; current; current = current.prev) {\n      messages[current.level] = current.current;\n    }\n    return messages;\n  });\n\n  /**\n   * Gets the ID of the current head message.\n   * @returns The ID of the head message, or null if no messages exist\n   */\n  get headId() {\n    return this.head?.current.id ?? null;\n  }\n\n  /**\n   * Gets all messages in the current active branch, from root to head.\n   * @param headId - Optional ID of the head message to get messages for. If not provided, uses the current head.\n   * @returns Array of messages in the specified branch\n   */\n  getMessages(headId?: string) {\n    if (headId === undefined || headId === this.head?.current.id) {\n      return this._messages.value;\n    }\n\n    const headMessage = this.messages.get(headId);\n    if (!headMessage) {\n      throw new Error(\n        \"MessageRepository(getMessages): Head message not found. This is likely an internal bug in assistant-ui.\",\n      );\n    }\n\n    const messages = new Array<ThreadMessage>(headMessage.level + 1);\n    for (\n      let current: RepositoryMessage | null = headMessage;\n      current;\n      current = current.prev\n    ) {\n      messages[current.level] = current.current;\n    }\n    return messages;\n  }\n\n  /**\n   * Adds a new message or updates an existing one in the repository.\n   * If the message ID already exists, the message is updated and potentially relinked to a new parent.\n   * If the message is new, it's added as a child of the specified parent.\n   *\n   * @param parentId - ID of the parent message, or null for root messages\n   * @param message - The message to add or update\n   * @throws Error if the parent message is not found\n   */\n  addOrUpdateMessage(parentId: string | null, message: ThreadMessage) {\n    const existingItem = this.messages.get(message.id);\n    const prev = parentId ? this.messages.get(parentId) : null;\n    if (prev === undefined)\n      throw new Error(\n        \"MessageRepository(addOrUpdateMessage): Parent message not found. This is likely an internal bug in assistant-ui.\",\n      );\n\n    // update existing message\n    if (existingItem) {\n      existingItem.current = message;\n      this.performOp(prev, existingItem, \"relink\");\n      this._messages.dirty();\n      return;\n    }\n\n    // create a new message\n    const newItem: RepositoryMessage = {\n      prev,\n      current: message,\n      next: null,\n      children: [],\n      level: prev ? prev.level + 1 : 0,\n    };\n\n    this.messages.set(message.id, newItem);\n    this.performOp(prev, newItem, \"link\");\n\n    if (this.head === prev) {\n      this.head = newItem;\n    }\n\n    this._messages.dirty();\n  }\n\n  /**\n   * Gets a message and its parent ID by message ID.\n   *\n   * @param messageId - ID of the message to retrieve\n   * @returns Object containing the message and its parent ID\n   * @throws Error if the message is not found\n   */\n  getMessage(messageId: string) {\n    const message = this.messages.get(messageId);\n    if (!message)\n      throw new Error(\n        \"MessageRepository(updateMessage): Message not found. This is likely an internal bug in assistant-ui.\",\n      );\n\n    return {\n      parentId: message.prev?.current.id ?? null,\n      message: message.current,\n      index: message.level,\n    };\n  }\n\n  /**\n   * Adds an optimistic message to the repository.\n   * An optimistic message is a temporary placeholder that will be replaced by a real message later.\n   *\n   * @param parentId - ID of the parent message, or null for root messages\n   * @param message - The core message to convert to an optimistic message\n   * @returns The generated optimistic ID\n   */\n  appendOptimisticMessage(parentId: string | null, message: ThreadMessageLike) {\n    let optimisticId: string;\n    do {\n      optimisticId = generateOptimisticId();\n    } while (this.messages.has(optimisticId));\n\n    this.addOrUpdateMessage(\n      parentId,\n      fromThreadMessageLike(message, optimisticId, { type: \"running\" }),\n    );\n\n    return optimisticId;\n  }\n\n  /**\n   * Deletes a message from the repository and relinks its children.\n   *\n   * @param messageId - ID of the message to delete\n   * @param replacementId - Optional ID of the message to become the new parent of the children,\n   *                       undefined means use the deleted message's parent,\n   *                       null means use the root\n   * @throws Error if the message or replacement is not found\n   */\n  deleteMessage(messageId: string, replacementId?: string | null | undefined) {\n    const message = this.messages.get(messageId);\n\n    if (!message)\n      throw new Error(\n        \"MessageRepository(deleteMessage): Message not found. This is likely an internal bug in assistant-ui.\",\n      );\n\n    const replacement =\n      replacementId === undefined\n        ? message.prev // if no replacementId is provided, use the parent\n        : replacementId === null\n          ? null\n          : this.messages.get(replacementId);\n    if (replacement === undefined)\n      throw new Error(\n        \"MessageRepository(deleteMessage): Replacement not found. This is likely an internal bug in assistant-ui.\",\n      );\n\n    for (const child of message.children) {\n      const childMessage = this.messages.get(child);\n      if (!childMessage)\n        throw new Error(\n          \"MessageRepository(deleteMessage): Child message not found. This is likely an internal bug in assistant-ui.\",\n        );\n      this.performOp(replacement, childMessage, \"relink\");\n    }\n\n    this.performOp(null, message, \"cut\");\n    this.messages.delete(messageId);\n\n    if (this.head === message) {\n      this.head = findHead(replacement ?? this.root);\n    }\n\n    this._messages.dirty();\n  }\n\n  /**\n   * Gets all branch IDs (sibling messages) at the level of a specified message.\n   *\n   * @param messageId - ID of the message to find branches for\n   * @returns Array of message IDs representing branches\n   * @throws Error if the message is not found\n   */\n  getBranches(messageId: string) {\n    const message = this.messages.get(messageId);\n    if (!message)\n      throw new Error(\n        \"MessageRepository(getBranches): Message not found. This is likely an internal bug in assistant-ui.\",\n      );\n\n    const { children } = message.prev ?? this.root;\n    return children;\n  }\n\n  /**\n   * Switches the active branch to the one containing the specified message.\n   *\n   * @param messageId - ID of the message in the branch to switch to\n   * @throws Error if the branch is not found\n   */\n  switchToBranch(messageId: string) {\n    const message = this.messages.get(messageId);\n    if (!message)\n      throw new Error(\n        \"MessageRepository(switchToBranch): Branch not found. This is likely an internal bug in assistant-ui.\",\n      );\n\n    const prevOrRoot = message.prev ?? this.root;\n    prevOrRoot.next = message;\n\n    this.head = findHead(message);\n\n    this._messages.dirty();\n  }\n\n  /**\n   * Resets the head to a specific message or null.\n   *\n   * @param messageId - ID of the message to set as head, or null to clear the head\n   * @throws Error if the message is not found\n   */\n  resetHead(messageId: string | null) {\n    if (messageId === null) {\n      this.clear();\n      return;\n    }\n\n    const message = this.messages.get(messageId);\n    if (!message)\n      throw new Error(\n        \"MessageRepository(resetHead): Branch not found. This is likely an internal bug in assistant-ui.\",\n      );\n\n    if (message.children.length > 0) {\n      const deleteDescendants = (msg: RepositoryMessage) => {\n        for (const childId of msg.children) {\n          const childMessage = this.messages.get(childId);\n          if (childMessage) {\n            deleteDescendants(childMessage);\n            this.messages.delete(childId);\n          }\n        }\n      };\n      deleteDescendants(message);\n\n      message.children = [];\n      message.next = null;\n    }\n\n    this.head = message;\n    for (\n      let current: RepositoryMessage | null = message;\n      current;\n      current = current.prev\n    ) {\n      if (current.prev) {\n        current.prev.next = current;\n      }\n    }\n\n    this._messages.dirty();\n  }\n\n  /**\n   * Clears all messages from the repository.\n   */\n  clear(): void {\n    this.messages.clear();\n    this.head = null;\n    this.root = {\n      children: [],\n      next: null,\n    };\n    this._messages.dirty();\n  }\n\n  /**\n   * Exports the repository state for persistence.\n   *\n   * @returns Exportable repository state\n   */\n  export(): ExportedMessageRepository {\n    const exportItems: ExportedMessageRepository[\"messages\"] = [];\n\n    // hint: we are relying on the insertion order of the messages\n    // this is important for the import function to properly link the messages\n    for (const [, message] of this.messages) {\n      exportItems.push({\n        message: message.current,\n        parentId: message.prev?.current.id ?? null,\n      });\n    }\n\n    return {\n      headId: this.head?.current.id ?? null,\n      messages: exportItems,\n    };\n  }\n\n  /**\n   * Imports repository state from an exported repository.\n   *\n   * @param repository - The exported repository state to import\n   */\n  import({ headId, messages }: ExportedMessageRepository) {\n    for (const { message, parentId } of messages) {\n      this.addOrUpdateMessage(parentId, message);\n    }\n\n    // switch to the saved head id if it is not the most recent message\n    this.resetHead(headId ?? messages.at(-1)?.message.id ?? null);\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6662, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/core/base-assistant-runtime-core.tsx"],"sourcesContent":["import { type ModelContextProvider } from \"../../../model-context/model-context-types\";\nimport type { Unsubscribe } from \"../../../types/unsubscribe\";\nimport type { AssistantRuntimeCore } from \"./assistant-runtime-core\";\nimport { CompositeContextProvider } from \"../../../utils/composite-context-provider\";\nimport { ThreadListRuntimeCore } from \"./thread-list-runtime-core\";\n\nexport abstract class BaseAssistantRuntimeCore implements AssistantRuntimeCore {\n  protected readonly _contextProvider = new CompositeContextProvider();\n  public abstract get threads(): ThreadListRuntimeCore;\n\n  public registerModelContextProvider(\n    provider: ModelContextProvider,\n  ): Unsubscribe {\n    return this._contextProvider.registerModelContextProvider(provider);\n  }\n\n  public getModelContextProvider(): ModelContextProvider {\n    return this._contextProvider;\n  }\n}\n"],"names":[],"mappings":";;;;AAGA;;AAGO,MAAe;IACD,mBAAmB,IAAI,iMAAwB,GAAG;IAG9D,6BACL,QAA8B,EACjB;QACb,OAAO,IAAI,CAAC,gBAAgB,CAAC,4BAA4B,CAAC;IAC5D;IAEO,0BAAgD;QACrD,OAAO,IAAI,CAAC,gBAAgB;IAC9B;AACF"}},
    {"offset": {"line": 6681, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/subscribable/base-subject.ts"],"sourcesContent":["import { Unsubscribe } from \"../../../types/unsubscribe\";\n\nexport abstract class BaseSubject {\n  private _subscriptions = new Set<() => void>();\n  private _connection: Unsubscribe | undefined;\n\n  protected get isConnected() {\n    return !!this._connection;\n  }\n\n  protected abstract _connect(): Unsubscribe;\n\n  protected notifySubscribers() {\n    for (const callback of this._subscriptions) callback();\n  }\n\n  private _updateConnection() {\n    if (this._subscriptions.size > 0) {\n      if (this._connection) return;\n      this._connection = this._connect();\n    } else {\n      this._connection?.();\n      this._connection = undefined;\n    }\n  }\n\n  public subscribe(callback: () => void) {\n    this._subscriptions.add(callback);\n    this._updateConnection();\n\n    return () => {\n      this._subscriptions.delete(callback);\n      this._updateConnection();\n    };\n  }\n}\n"],"names":[],"mappings":";;;;AAEO,MAAe;IACZ,iBAAiB,IAAI,MAAkB;IACvC,YAAqC;IAE7C,IAAc,cAAc;QAC1B,OAAO,CAAC,CAAC,IAAI,CAAC,WAAW;IAC3B;IAIU,oBAAoB;QAC5B,KAAK,MAAM,YAAY,IAAI,CAAC,cAAc,CAAE;IAC9C;IAEQ,oBAAoB;QAC1B,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,GAAG,GAAG;YAChC,IAAI,IAAI,CAAC,WAAW,EAAE;YACtB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,QAAQ;QAClC,OAAO;YACL,IAAI,CAAC,WAAW;YAChB,IAAI,CAAC,WAAW,GAAG;QACrB;IACF;IAEO,UAAU,QAAoB,EAAE;QACrC,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC;QACxB,IAAI,CAAC,iBAAiB;QAEtB,OAAO;YACL,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC;YAC3B,IAAI,CAAC,iBAAiB;QACxB;IACF;AACF"}},
    {"offset": {"line": 6716, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/subscribable/skip-update.ts"],"sourcesContent":["export const SKIP_UPDATE = Symbol(\"skip-update\");\nexport type SKIP_UPDATE = typeof SKIP_UPDATE;\n"],"names":[],"mappings":";;;;AAAO,MAAM,cAAc,OAAO"}},
    {"offset": {"line": 6725, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/subscribable/lazy-memoize-subject.ts"],"sourcesContent":["import { BaseSubject } from \"./base-subject\";\nimport { SKIP_UPDATE } from \"./skip-update\";\nimport { SubscribableWithState } from \"./subscribable\";\n\nexport class LazyMemoizeSubject<TState extends object, TPath>\n  extends BaseSubject\n  implements SubscribableWithState<TState, TPath>\n{\n  public get path() {\n    return this.binding.path;\n  }\n\n  constructor(\n    private binding: SubscribableWithState<TState | SKIP_UPDATE, TPath>,\n  ) {\n    super();\n  }\n\n  private _previousStateDirty = true;\n  private _previousState: TState | undefined;\n  public getState = () => {\n    if (!this.isConnected || this._previousStateDirty) {\n      const newState = this.binding.getState();\n      if (newState !== SKIP_UPDATE) {\n        this._previousState = newState;\n      }\n      this._previousStateDirty = false;\n    }\n    if (this._previousState === undefined)\n      throw new Error(\"Entry not available in the store\");\n    return this._previousState;\n  };\n\n  protected _connect() {\n    const callback = () => {\n      this._previousStateDirty = true;\n      this.notifySubscribers();\n    };\n\n    return this.binding.subscribe(callback);\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAGO,MAAM,2BACH,0MAAW;;IAGnB,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI;IAC1B;IAEA,YACE,AAAQ,OAA2D,CACnE;QACA,KAAK,SAFG,UAAA,cAKF,sBAAsB,WAEvB,WAAW;YAChB,IAAI,CAAC,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,mBAAmB,EAAE;gBACjD,MAAM,WAAW,IAAI,CAAC,OAAO,CAAC,QAAQ;gBACtC,IAAI,aAAa,yMAAW,EAAE;oBAC5B,IAAI,CAAC,cAAc,GAAG;gBACxB;gBACA,IAAI,CAAC,mBAAmB,GAAG;YAC7B;YACA,IAAI,IAAI,CAAC,cAAc,KAAK,WAC1B,MAAM,IAAI,MAAM;YAClB,OAAO,IAAI,CAAC,cAAc;QAC5B;IAfA;IAEQ,oBAA2B;IAC3B,eAAmC;IACpC,SAWL;IAEQ,WAAW;QACnB,MAAM,WAAW;YACf,IAAI,CAAC,mBAAmB,GAAG;YAC3B,IAAI,CAAC,iBAAiB;QACxB;QAEA,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;IAChC;AACF"}},
    {"offset": {"line": 6766, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/thread-list-item-runtime.ts"],"sourcesContent":["import { Unsubscribe } from \"../../types\";\nimport { ThreadListItemRuntimePath } from \"./runtime-path-types\";\nimport { SubscribableWithState } from \"./subscribable/subscribable\";\nimport { ThreadListRuntimeCoreBinding } from \"./thread-list-runtime\";\n\nexport type ThreadListItemEventType = \"switchedTo\" | \"switchedAway\";\n\nimport type {\n  ThreadListItemState,\n  ThreadListItemStatus,\n} from \"./runtime-bindings\";\n\nexport type { ThreadListItemState, ThreadListItemStatus };\n\nexport type ThreadListItemRuntime = {\n  readonly path: ThreadListItemRuntimePath;\n  getState(): ThreadListItemState;\n\n  initialize(): Promise<{ remoteId: string; externalId: string | undefined }>;\n  generateTitle(): Promise<void>;\n\n  switchTo(): Promise<void>;\n  rename(newTitle: string): Promise<void>;\n  archive(): Promise<void>;\n  unarchive(): Promise<void>;\n  delete(): Promise<void>;\n\n  /**\n   * Detaches the ThreadListItem instance, unmounting the ThreadRuntime hook.\n   */\n  detach(): void;\n\n  subscribe(callback: () => void): Unsubscribe;\n\n  unstable_on(\n    event: ThreadListItemEventType,\n    callback: () => void,\n  ): Unsubscribe;\n\n  /** @internal */\n  __internal_getRuntime(): ThreadListItemRuntime;\n};\n\nexport type ThreadListItemStateBinding = SubscribableWithState<\n  ThreadListItemState,\n  ThreadListItemRuntimePath\n>;\n\nexport class ThreadListItemRuntimeImpl implements ThreadListItemRuntime {\n  public get path() {\n    return this._core.path;\n  }\n\n  constructor(\n    private _core: ThreadListItemStateBinding,\n    private _threadListBinding: ThreadListRuntimeCoreBinding,\n  ) {\n    this.__internal_bindMethods();\n  }\n\n  protected __internal_bindMethods() {\n    this.switchTo = this.switchTo.bind(this);\n    this.rename = this.rename.bind(this);\n    this.archive = this.archive.bind(this);\n    this.unarchive = this.unarchive.bind(this);\n    this.delete = this.delete.bind(this);\n    this.initialize = this.initialize.bind(this);\n    this.generateTitle = this.generateTitle.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n    this.unstable_on = this.unstable_on.bind(this);\n    this.getState = this.getState.bind(this);\n    this.detach = this.detach.bind(this);\n  }\n\n  public getState(): ThreadListItemState {\n    return this._core.getState();\n  }\n\n  public switchTo(): Promise<void> {\n    const state = this._core.getState();\n    return this._threadListBinding.switchToThread(state.id);\n  }\n\n  public rename(newTitle: string): Promise<void> {\n    const state = this._core.getState();\n\n    return this._threadListBinding.rename(state.id, newTitle);\n  }\n\n  public archive(): Promise<void> {\n    const state = this._core.getState();\n\n    return this._threadListBinding.archive(state.id);\n  }\n\n  public unarchive(): Promise<void> {\n    const state = this._core.getState();\n\n    return this._threadListBinding.unarchive(state.id);\n  }\n\n  public delete(): Promise<void> {\n    const state = this._core.getState();\n\n    return this._threadListBinding.delete(state.id);\n  }\n\n  public initialize(): Promise<{\n    remoteId: string;\n    externalId: string | undefined;\n  }> {\n    const state = this._core.getState();\n    return this._threadListBinding.initialize(state.id);\n  }\n\n  public generateTitle(): Promise<void> {\n    const state = this._core.getState();\n    return this._threadListBinding.generateTitle(state.id);\n  }\n\n  public unstable_on(event: ThreadListItemEventType, callback: () => void) {\n    // if the runtime is bound to a specific thread, trigger if isMain is toggled\n    // if the runtime is bound to the main thread, trigger switchedTo if threadId changes\n\n    let prevIsMain = this._core.getState().isMain;\n    let prevThreadId = this._core.getState().id;\n    return this.subscribe(() => {\n      const currentState = this._core.getState();\n      const newIsMain = currentState.isMain;\n      const newThreadId = currentState.id;\n      if (prevIsMain === newIsMain && prevThreadId === newThreadId) return;\n      prevIsMain = newIsMain;\n      prevThreadId = newThreadId;\n\n      if (event === \"switchedTo\" && !newIsMain) return;\n      if (event === \"switchedAway\" && newIsMain) return;\n      callback();\n    });\n  }\n\n  public subscribe(callback: () => void): Unsubscribe {\n    return this._core.subscribe(callback);\n  }\n\n  public detach(): void {\n    const state = this._core.getState();\n\n    this._threadListBinding.detach(state.id);\n  }\n\n  /** @internal */\n  public __internal_getRuntime(): ThreadListItemRuntime {\n    return this;\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6857, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/subscribable/shallow-equal.ts"],"sourcesContent":["export function shallowEqual<T extends object>(\n  objA: T | undefined,\n  objB: T | undefined,\n) {\n  if (objA === undefined && objB === undefined) return true;\n  if (objA === undefined) return false;\n  if (objB === undefined) return false;\n\n  for (const key of Object.keys(objA)) {\n    const valueA = objA[key as keyof T];\n    const valueB = objB[key as keyof T];\n    if (!Object.is(valueA, valueB)) return false;\n  }\n\n  return true;\n}\n"],"names":[],"mappings":";;;;AAAO,SAAS,aACd,IAAmB,EACnB,IAAmB;IAEnB,IAAI,SAAS,aAAa,SAAS,WAAW,OAAO;IACrD,IAAI,SAAS,WAAW,OAAO;IAC/B,IAAI,SAAS,WAAW,OAAO;IAE/B,KAAK,MAAM,OAAO,OAAO,IAAI,CAAC,MAAO;QACnC,MAAM,SAAS,IAAI,CAAC,IAAe;QACnC,MAAM,SAAS,IAAI,CAAC,IAAe;QACnC,IAAI,CAAC,OAAO,EAAE,CAAC,QAAQ,SAAS,OAAO;IACzC;IAEA,OAAO;AACT"}},
    {"offset": {"line": 6876, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/subscribable/shallow-memoize-subject.ts"],"sourcesContent":["import { shallowEqual } from \"./shallow-equal\";\nimport { BaseSubject } from \"./base-subject\";\nimport { SubscribableWithState } from \"./subscribable\";\nimport { SKIP_UPDATE } from \"./skip-update\";\n\nexport class ShallowMemoizeSubject<TState extends object, TPath>\n  extends BaseSubject\n  implements SubscribableWithState<TState, TPath>\n{\n  public get path() {\n    return this.binding.path;\n  }\n\n  constructor(\n    private binding: SubscribableWithState<TState | SKIP_UPDATE, TPath>,\n  ) {\n    super();\n    const state = binding.getState();\n    if (state === SKIP_UPDATE)\n      throw new Error(\"Entry not available in the store\");\n    this._previousState = state;\n  }\n\n  private _previousState: TState;\n  public getState = () => {\n    if (!this.isConnected) this._syncState();\n    return this._previousState;\n  };\n\n  private _syncState() {\n    const state = this.binding.getState();\n    if (state === SKIP_UPDATE) return false;\n    if (shallowEqual(state, this._previousState)) return false;\n    this._previousState = state;\n    return true;\n  }\n\n  protected _connect() {\n    const callback = () => {\n      if (this._syncState()) {\n        this.notifySubscribers();\n      }\n    };\n\n    return this.binding.subscribe(callback);\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;;;;AAEO,MAAM,8BACH,0MAAW;;IAGnB,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI;IAC1B;IAEA,YACE,AAAQ,OAA2D,CACnE;QACA,KAAK,SAFG,UAAA,cAUH,WAAW;YAChB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,UAAU;YACtC,OAAO,IAAI,CAAC,cAAc;QAC5B;QAVE,MAAM,QAAQ,QAAQ,QAAQ;QAC9B,IAAI,UAAU,yMAAW,EACvB,MAAM,IAAI,MAAM;QAClB,IAAI,CAAC,cAAc,GAAG;IACxB;IAEQ,eAAuB;IACxB,SAGL;IAEM,aAAa;QACnB,MAAM,QAAQ,IAAI,CAAC,OAAO,CAAC,QAAQ;QACnC,IAAI,UAAU,yMAAW,EAAE,OAAO;QAClC,IAAI,IAAA,4MAAY,EAAC,OAAO,IAAI,CAAC,cAAc,GAAG,OAAO;QACrD,IAAI,CAAC,cAAc,GAAG;QACtB,OAAO;IACT;IAEU,WAAW;QACnB,MAAM,WAAW;YACf,IAAI,IAAI,CAAC,UAAU,IAAI;gBACrB,IAAI,CAAC,iBAAiB;YACxB;QACF;QAEA,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;IAChC;AACF"}},
    {"offset": {"line": 6922, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/external-store/get-external-store-message.tsx"],"sourcesContent":["import { ThreadState } from \"../../runtime\";\nimport { ThreadMessage } from \"../../../types\";\n\nexport const symbolInnerMessage = Symbol(\"innerMessage\");\nconst symbolInnerMessages = Symbol(\"innerMessages\");\n\ntype WithInnerMessages<T> = {\n  [symbolInnerMessage]?: T | T[];\n  [symbolInnerMessages]?: T[];\n};\n\n/**\n * @deprecated Use `getExternalStoreMessages` (plural) instead. This function will be removed in 0.12.0.\n */\nexport const getExternalStoreMessage = <T,>(input: ThreadMessage) => {\n  const withInnerMessages = input as WithInnerMessages<T>;\n  return withInnerMessages[symbolInnerMessage];\n};\n\nconst EMPTY_ARRAY: never[] = [];\n\nexport const getExternalStoreMessages = <T,>(\n  input: ThreadState | ThreadMessage | ThreadMessage[\"content\"][number],\n) => {\n  // TODO temp until 0.12.0 (migrate useExternalStoreRuntime to always set an array)\n\n  const container = (\n    \"messages\" in input ? input.messages : input\n  ) as WithInnerMessages<T>;\n  const value = container[symbolInnerMessages] || container[symbolInnerMessage];\n  if (!value) return EMPTY_ARRAY;\n  if (Array.isArray(value)) {\n    return value;\n  }\n  container[symbolInnerMessages] = [value];\n  return container[symbolInnerMessages];\n};\n"],"names":[],"mappings":";;;;;;;;AAGO,MAAM,qBAAqB,OAAO;AACzC,MAAM,sBAAsB,OAAO;AAU5B,MAAM,0BAA0B,CAAK;IAC1C,MAAM,oBAAoB;IAC1B,OAAO,iBAAiB,CAAC,mBAAmB;AAC9C;AAEA,MAAM,cAAuB,EAAE;AAExB,MAAM,2BAA2B,CACtC;IAEA,kFAAkF;IAElF,MAAM,YACJ,cAAc,QAAQ,MAAM,QAAQ,GAAG;IAEzC,MAAM,QAAQ,SAAS,CAAC,oBAAoB,IAAI,SAAS,CAAC,mBAAmB;IAC7E,IAAI,CAAC,OAAO,OAAO;IACnB,IAAI,MAAM,OAAO,CAAC,QAAQ;QACxB,OAAO;IACT;IACA,SAAS,CAAC,oBAAoB,GAAG;QAAC;KAAM;IACxC,OAAO,SAAS,CAAC,oBAAoB;AACvC"}},
    {"offset": {"line": 6954, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/get-thread-message-text.tsx"],"sourcesContent":["import type {\n  AppendMessage,\n  TextMessagePart,\n  ThreadMessage,\n} from \"../types/assistant-types\";\n\nexport const getThreadMessageText = (\n  message: ThreadMessage | AppendMessage,\n) => {\n  const textParts = message.content.filter(\n    (part) => part.type === \"text\",\n  ) as TextMessagePart[];\n\n  return textParts.map((part) => part.text).join(\"\\n\\n\");\n};\n"],"names":[],"mappings":";;;;AAMO,MAAM,uBAAuB,CAClC;IAEA,MAAM,YAAY,QAAQ,OAAO,CAAC,MAAM,CACtC,CAAC,OAAS,KAAK,IAAI,KAAK;IAG1B,OAAO,UAAU,GAAG,CAAC,CAAC,OAAS,KAAK,IAAI,EAAE,IAAI,CAAC;AACjD"}},
    {"offset": {"line": 6966, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/attachment-runtime.ts"],"sourcesContent":["import { SubscribableWithState } from \"./subscribable/subscribable\";\n\nimport type { ComposerRuntimeCoreBinding } from \"./runtime-bindings\";\nimport {\n  Attachment,\n  CompleteAttachment,\n  PendingAttachment,\n  Unsubscribe,\n} from \"../../types\";\nimport { AttachmentRuntimePath } from \"./runtime-path-types\";\n\ntype MessageAttachmentState = CompleteAttachment & {\n  readonly source: \"message\";\n};\n\ntype ThreadComposerAttachmentState = PendingAttachment & {\n  readonly source: \"thread-composer\";\n};\n\ntype EditComposerAttachmentState = Attachment & {\n  readonly source: \"edit-composer\";\n};\n\nexport type AttachmentState =\n  | ThreadComposerAttachmentState\n  | EditComposerAttachmentState\n  | MessageAttachmentState;\n\ntype AttachmentSnapshotBinding<Source extends AttachmentRuntimeSource> =\n  SubscribableWithState<\n    AttachmentState & { source: Source },\n    AttachmentRuntimePath & { attachmentSource: Source }\n  >;\n\ntype AttachmentRuntimeSource = AttachmentState[\"source\"];\n\nexport type AttachmentRuntime<\n  TSource extends AttachmentRuntimeSource = AttachmentRuntimeSource,\n> = {\n  readonly path: AttachmentRuntimePath & { attachmentSource: TSource };\n  readonly source: TSource;\n  getState(): AttachmentState & { source: TSource };\n  remove(): Promise<void>;\n  subscribe(callback: () => void): Unsubscribe;\n};\n\nexport abstract class AttachmentRuntimeImpl<\n  Source extends AttachmentRuntimeSource = AttachmentRuntimeSource,\n> implements AttachmentRuntime\n{\n  public get path() {\n    return this._core.path;\n  }\n\n  public abstract get source(): Source;\n\n  constructor(private _core: AttachmentSnapshotBinding<Source>) {\n    this.__internal_bindMethods();\n  }\n\n  protected __internal_bindMethods() {\n    this.getState = this.getState.bind(this);\n    this.remove = this.remove.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n  }\n\n  public getState(): AttachmentState & { source: Source } {\n    return this._core.getState();\n  }\n\n  public abstract remove(): Promise<void>;\n\n  public subscribe(callback: () => void) {\n    return this._core.subscribe(callback);\n  }\n}\n\nabstract class ComposerAttachmentRuntime<\n  Source extends \"thread-composer\" | \"edit-composer\",\n> extends AttachmentRuntimeImpl<Source> {\n  constructor(\n    core: AttachmentSnapshotBinding<Source>,\n    private _composerApi: ComposerRuntimeCoreBinding,\n  ) {\n    super(core);\n  }\n\n  public remove() {\n    const core = this._composerApi.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    return core.removeAttachment(this.getState().id);\n  }\n}\n\nexport class ThreadComposerAttachmentRuntimeImpl extends ComposerAttachmentRuntime<\"thread-composer\"> {\n  public get source(): \"thread-composer\" {\n    return \"thread-composer\";\n  }\n}\n\nexport class EditComposerAttachmentRuntimeImpl extends ComposerAttachmentRuntime<\"edit-composer\"> {\n  public get source(): \"edit-composer\" {\n    return \"edit-composer\";\n  }\n}\n\nexport class MessageAttachmentRuntimeImpl extends AttachmentRuntimeImpl<\"message\"> {\n  public get source(): \"message\" {\n    return \"message\";\n  }\n\n  constructor(core: AttachmentSnapshotBinding<\"message\">) {\n    super(core);\n  }\n\n  public remove(): never {\n    throw new Error(\"Message attachments cannot be removed\");\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AA8CO,MAAe;;IAIpB,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI;IACxB;IAIA,YAAY,AAAQ,KAAwC,CAAE;aAA1C,QAAA;QAClB,IAAI,CAAC,sBAAsB;IAC7B;IAEU,yBAAyB;QACjC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI;QACvC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI;QACnC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI;IAC3C;IAEO,WAAiD;QACtD,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ;IAC5B;IAIO,UAAU,QAAoB,EAAE;QACrC,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;IAC9B;AACF;AAEA,MAAe,kCAEL;;IACR,YACE,IAAuC,EACvC,AAAQ,YAAwC,CAChD;QACA,KAAK,CAAC,YAFE,eAAA;IAGV;IAEO,SAAS;QACd,MAAM,OAAO,IAAI,CAAC,YAAY,CAAC,QAAQ;QACvC,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;QAC3B,OAAO,KAAK,gBAAgB,CAAC,IAAI,CAAC,QAAQ,GAAG,EAAE;IACjD;AACF;AAEO,MAAM,4CAA4C;IACvD,IAAW,SAA4B;QACrC,OAAO;IACT;AACF;AAEO,MAAM,0CAA0C;IACrD,IAAW,SAA0B;QACnC,OAAO;IACT;AACF;AAEO,MAAM,qCAAqC;IAChD,IAAW,SAAoB;QAC7B,OAAO;IACT;IAEA,YAAY,IAA0C,CAAE;QACtD,KAAK,CAAC;IACR;IAEO,SAAgB;QACrB,MAAM,IAAI,MAAM;IAClB;AACF"}},
    {"offset": {"line": 7033, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/subscribable/event-subscription-subject.ts"],"sourcesContent":["import { Unsubscribe } from \"../../../types\";\nimport { BaseSubject } from \"./base-subject\";\nimport { EventSubscribable } from \"./subscribable\";\n\nexport class EventSubscriptionSubject<\n  TEvent extends string,\n> extends BaseSubject {\n  constructor(private config: EventSubscribable<TEvent>) {\n    super();\n  }\n\n  public getState() {\n    return this.config.binding.getState();\n  }\n\n  public outerSubscribe(callback: () => void) {\n    return this.config.binding.subscribe(callback);\n  }\n\n  protected _connect(): Unsubscribe {\n    const callback = () => {\n      this.notifySubscribers();\n    };\n\n    let lastState = this.config.binding.getState();\n    let innerUnsubscribe = lastState?.unstable_on(this.config.event, callback);\n    const onRuntimeUpdate = () => {\n      const newState = this.config.binding.getState();\n      if (newState === lastState) return;\n      lastState = newState;\n\n      innerUnsubscribe?.();\n      innerUnsubscribe = this.config.binding\n        .getState()\n        ?.unstable_on(this.config.event, callback);\n    };\n\n    const outerUnsubscribe = this.outerSubscribe(onRuntimeUpdate);\n    return () => {\n      outerUnsubscribe?.();\n      innerUnsubscribe?.();\n    };\n  }\n}\n"],"names":[],"mappings":";;;;AACA;;AAGO,MAAM,iCAEH,0MAAW;;IACnB,YAAY,AAAQ,MAAiC,CAAE;QACrD,KAAK,SADa,SAAA;IAEpB;IAEO,WAAW;QAChB,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ;IACrC;IAEO,eAAe,QAAoB,EAAE;QAC1C,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC;IACvC;IAEU,WAAwB;QAChC,MAAM,WAAW;YACf,IAAI,CAAC,iBAAiB;QACxB;QAEA,IAAI,YAAY,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ;QAC5C,IAAI,mBAAmB,WAAW,YAAY,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;QACjE,MAAM,kBAAkB;YACtB,MAAM,WAAW,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,QAAQ;YAC7C,IAAI,aAAa,WAAW;YAC5B,YAAY;YAEZ;YACA,mBAAmB,IAAI,CAAC,MAAM,CAAC,OAAO,CACnC,QAAQ,IACP,YAAY,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE;QACrC;QAEA,MAAM,mBAAmB,IAAI,CAAC,cAAc,CAAC;QAC7C,OAAO;YACL;YACA;QACF;IACF;AACF"}},
    {"offset": {"line": 7074, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/composer-runtime.ts"],"sourcesContent":["import type {\n  Attachment,\n  PendingAttachment,\n} from \"../../types/attachment-types\";\nimport type {\n  ComposerRuntimeCore,\n  ComposerRuntimeEventType,\n  DictationState,\n  ThreadComposerRuntimeCore,\n} from \"../runtime-cores/core/composer-runtime-core\";\nimport type { Unsubscribe } from \"../../types\";\nimport type { MessageRole, RunConfig } from \"../../types/assistant-types\";\nimport type {\n  ThreadComposerRuntimeCoreBinding,\n  EditComposerRuntimeCoreBinding,\n  ComposerRuntimeCoreBinding,\n} from \"./runtime-bindings\";\nimport type { ComposerRuntimePath } from \"./runtime-path-types\";\n\nimport { LazyMemoizeSubject } from \"./subscribable/lazy-memoize-subject\";\nimport {\n  type AttachmentRuntime,\n  type AttachmentState,\n  EditComposerAttachmentRuntimeImpl,\n  ThreadComposerAttachmentRuntimeImpl,\n} from \"./attachment-runtime\";\nimport { ShallowMemoizeSubject } from \"./subscribable/shallow-memoize-subject\";\nimport { SKIP_UPDATE } from \"./subscribable/skip-update\";\nimport { EventSubscriptionSubject } from \"./subscribable/event-subscription-subject\";\n\nexport type {\n  ThreadComposerRuntimeCoreBinding,\n  EditComposerRuntimeCoreBinding,\n  ComposerRuntimeCoreBinding,\n};\n\ntype BaseComposerState = {\n  readonly canCancel: boolean;\n  readonly isEditing: boolean;\n  readonly isEmpty: boolean;\n\n  readonly text: string;\n  readonly role: MessageRole;\n  readonly attachments: readonly Attachment[];\n  readonly runConfig: RunConfig;\n\n  readonly attachmentAccept: string;\n\n  /**\n   * The current state of dictation.\n   * Undefined when dictation is not active.\n   */\n  readonly dictation: DictationState | undefined;\n};\n\nexport type ThreadComposerState = BaseComposerState & {\n  readonly type: \"thread\";\n\n  readonly attachments: readonly PendingAttachment[];\n};\n\nexport type EditComposerState = BaseComposerState & {\n  readonly type: \"edit\";\n};\n\nexport type ComposerState = ThreadComposerState | EditComposerState;\n\nconst EMPTY_ARRAY = Object.freeze([]);\nconst EMPTY_OBJECT = Object.freeze({});\nconst getThreadComposerState = (\n  runtime: ThreadComposerRuntimeCore | undefined,\n): ThreadComposerState => {\n  return Object.freeze({\n    type: \"thread\",\n\n    isEditing: runtime?.isEditing ?? false,\n    canCancel: runtime?.canCancel ?? false,\n    isEmpty: runtime?.isEmpty ?? true,\n\n    attachments: runtime?.attachments ?? EMPTY_ARRAY,\n    text: runtime?.text ?? \"\",\n    role: runtime?.role ?? \"user\",\n    runConfig: runtime?.runConfig ?? EMPTY_OBJECT,\n    attachmentAccept: runtime?.attachmentAccept ?? \"\",\n    dictation: runtime?.dictation,\n\n    value: runtime?.text ?? \"\",\n  });\n};\n\nconst getEditComposerState = (\n  runtime: ComposerRuntimeCore | undefined,\n): EditComposerState => {\n  return Object.freeze({\n    type: \"edit\",\n\n    isEditing: runtime?.isEditing ?? false,\n    canCancel: runtime?.canCancel ?? false,\n    isEmpty: runtime?.isEmpty ?? true,\n\n    text: runtime?.text ?? \"\",\n    role: runtime?.role ?? \"user\",\n    attachments: runtime?.attachments ?? EMPTY_ARRAY,\n    runConfig: runtime?.runConfig ?? EMPTY_OBJECT,\n    attachmentAccept: runtime?.attachmentAccept ?? \"\",\n    dictation: runtime?.dictation,\n\n    value: runtime?.text ?? \"\",\n  });\n};\n\nexport type ComposerRuntime = {\n  readonly path: ComposerRuntimePath;\n  readonly type: \"edit\" | \"thread\";\n\n  /**\n   * Get the current state of the composer. Includes any data that has been added to the composer.\n   */\n  getState(): ComposerState;\n\n  /**\n   * Given a standard js File object, add it to the composer. A composer can have multiple attachments.\n   * @param file The file to add to the composer.\n   */\n  addAttachment(file: File): Promise<void>;\n\n  /**\n   * Set the text of the composer.\n   * @param text The text to set in the composer.\n   */\n  setText(text: string): void;\n\n  /**\n   * Set the role of the composer. For instance, if you'd like a specific message to have the 'assistant' role, you can do so here.\n   * @param role The role to set in the composer.\n   */\n  setRole(role: MessageRole): void;\n\n  /**\n   * Set the run config of the composer. This is used to send custom configuration data to the model.\n   * Within your backend, you can access this data using the `runConfig` object.\n   * Example:\n   * ```ts\n   * composerRuntime.setRunConfig({\n   *   custom: { customField: \"customValue\" }\n   * });\n   * ```\n   * @param runConfig The run config to set in the composer.\n   */\n  setRunConfig(runConfig: RunConfig): void;\n\n  /**\n   * Reset the composer. This will clear the entire state of the composer, including all text and attachments.\n   */\n  reset(): Promise<void>;\n\n  /**\n   * Clear all attachments from the composer.\n   */\n  clearAttachments(): Promise<void>;\n\n  /**\n   * Send a message. This will send whatever text or attachments are in the composer.\n   */\n  send(): void;\n\n  /**\n   * Cancel the current run. In edit mode, this will exit edit mode.\n   */\n  cancel(): void;\n\n  /**\n   * Listens for changes to the composer state.\n   * @param callback The callback to call when the composer state changes.\n   */\n  subscribe(callback: () => void): Unsubscribe;\n\n  /**\n   * Get an attachment by index.\n   * @param idx The index of the attachment to get.\n   */\n  getAttachmentByIndex(idx: number): AttachmentRuntime;\n\n  /**\n   * Start dictation to convert voice to text input.\n   * Requires a DictationAdapter to be configured.\n   */\n  startDictation(): void;\n\n  /**\n   * Stop the current dictation session.\n   */\n  stopDictation(): void;\n\n  /**\n   * @deprecated This API is still under active development and might change without notice.\n   */\n  unstable_on(\n    event: ComposerRuntimeEventType,\n    callback: () => void,\n  ): Unsubscribe;\n};\n\nexport abstract class ComposerRuntimeImpl implements ComposerRuntime {\n  public get path() {\n    return this._core.path;\n  }\n\n  public abstract get type(): \"edit\" | \"thread\";\n\n  constructor(protected _core: ComposerRuntimeCoreBinding) {}\n\n  protected __internal_bindMethods() {\n    this.setText = this.setText.bind(this);\n    this.setRunConfig = this.setRunConfig.bind(this);\n    this.getState = this.getState.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n    this.addAttachment = this.addAttachment.bind(this);\n    this.reset = this.reset.bind(this);\n    this.clearAttachments = this.clearAttachments.bind(this);\n    this.send = this.send.bind(this);\n    this.cancel = this.cancel.bind(this);\n    this.setRole = this.setRole.bind(this);\n    this.getAttachmentByIndex = this.getAttachmentByIndex.bind(this);\n    this.startDictation = this.startDictation.bind(this);\n    this.stopDictation = this.stopDictation.bind(this);\n    this.unstable_on = this.unstable_on.bind(this);\n  }\n\n  public abstract getState(): ComposerState;\n\n  public setText(text: string) {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    core.setText(text);\n  }\n\n  public setRunConfig(runConfig: RunConfig) {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    core.setRunConfig(runConfig);\n  }\n\n  public addAttachment(file: File) {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    return core.addAttachment(file);\n  }\n\n  public reset() {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    return core.reset();\n  }\n\n  public clearAttachments() {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    return core.clearAttachments();\n  }\n\n  public send() {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    core.send();\n  }\n\n  public cancel() {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    core.cancel();\n  }\n\n  public setRole(role: MessageRole) {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    core.setRole(role);\n  }\n\n  public startDictation() {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    core.startDictation();\n  }\n\n  public stopDictation() {\n    const core = this._core.getState();\n    if (!core) throw new Error(\"Composer is not available\");\n    core.stopDictation();\n  }\n\n  public subscribe(callback: () => void) {\n    return this._core.subscribe(callback);\n  }\n\n  private _eventSubscriptionSubjects = new Map<\n    string,\n    EventSubscriptionSubject<ComposerRuntimeEventType>\n  >();\n\n  public unstable_on(\n    event: ComposerRuntimeEventType,\n    callback: () => void,\n  ): Unsubscribe {\n    let subject = this._eventSubscriptionSubjects.get(event);\n    if (!subject) {\n      subject = new EventSubscriptionSubject({\n        event: event,\n        binding: this._core,\n      });\n      this._eventSubscriptionSubjects.set(event, subject);\n    }\n    return subject.subscribe(callback);\n  }\n\n  public abstract getAttachmentByIndex(idx: number): AttachmentRuntime;\n}\n\nexport type ThreadComposerRuntime = Omit<\n  ComposerRuntime,\n  \"getState\" | \"getAttachmentByIndex\"\n> & {\n  readonly path: ComposerRuntimePath & { composerSource: \"thread\" };\n  readonly type: \"thread\";\n  getState(): ThreadComposerState;\n\n  getAttachmentByIndex(\n    idx: number,\n  ): AttachmentRuntime & { source: \"thread-composer\" };\n};\n\nexport class ThreadComposerRuntimeImpl\n  extends ComposerRuntimeImpl\n  implements ThreadComposerRuntime\n{\n  public override get path() {\n    return this._core.path as ComposerRuntimePath & {\n      composerSource: \"thread\";\n    };\n  }\n\n  public get type() {\n    return \"thread\" as const;\n  }\n\n  private _getState;\n\n  constructor(core: ThreadComposerRuntimeCoreBinding) {\n    const stateBinding = new LazyMemoizeSubject({\n      path: core.path,\n      getState: () => getThreadComposerState(core.getState()),\n      subscribe: (callback) => core.subscribe(callback),\n    });\n    super({\n      path: core.path,\n      getState: () => core.getState(),\n      subscribe: (callback) => stateBinding.subscribe(callback),\n    });\n    this._getState = stateBinding.getState.bind(stateBinding);\n\n    this.__internal_bindMethods();\n  }\n\n  public override getState(): ThreadComposerState {\n    return this._getState();\n  }\n\n  public getAttachmentByIndex(idx: number) {\n    return new ThreadComposerAttachmentRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ...this.path,\n          attachmentSource: \"thread-composer\",\n          attachmentSelector: { type: \"index\", index: idx },\n          ref: `${this.path.ref}.attachments[${idx}]`,\n        },\n        getState: () => {\n          const attachments = this.getState().attachments;\n          const attachment = attachments[idx];\n          if (!attachment) return SKIP_UPDATE;\n\n          return {\n            ...attachment,\n            source: \"thread-composer\",\n          } satisfies AttachmentState & { source: \"thread-composer\" };\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this._core,\n    );\n  }\n}\n\nexport type EditComposerRuntime = Omit<\n  ComposerRuntime,\n  \"getState\" | \"getAttachmentByIndex\"\n> & {\n  readonly path: ComposerRuntimePath & { composerSource: \"edit\" };\n  readonly type: \"edit\";\n\n  getState(): EditComposerState;\n  beginEdit(): void;\n\n  getAttachmentByIndex(\n    idx: number,\n  ): AttachmentRuntime & { source: \"edit-composer\" };\n};\n\nexport class EditComposerRuntimeImpl\n  extends ComposerRuntimeImpl\n  implements EditComposerRuntime\n{\n  public override get path() {\n    return this._core.path as ComposerRuntimePath & { composerSource: \"edit\" };\n  }\n\n  public get type() {\n    return \"edit\" as const;\n  }\n\n  private _getState;\n  constructor(\n    core: EditComposerRuntimeCoreBinding,\n    private _beginEdit: () => void,\n  ) {\n    const stateBinding = new LazyMemoizeSubject({\n      path: core.path,\n      getState: () => getEditComposerState(core.getState()),\n      subscribe: (callback) => core.subscribe(callback),\n    });\n\n    super({\n      path: core.path,\n      getState: () => core.getState(),\n      subscribe: (callback) => stateBinding.subscribe(callback),\n    });\n\n    this._getState = stateBinding.getState.bind(stateBinding);\n\n    this.__internal_bindMethods();\n  }\n\n  public override __internal_bindMethods() {\n    super.__internal_bindMethods();\n    this.beginEdit = this.beginEdit.bind(this);\n  }\n\n  public override getState(): EditComposerState {\n    return this._getState();\n  }\n\n  public beginEdit() {\n    this._beginEdit();\n  }\n\n  public getAttachmentByIndex(idx: number) {\n    return new EditComposerAttachmentRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ...this.path,\n          attachmentSource: \"edit-composer\",\n          attachmentSelector: { type: \"index\", index: idx },\n          ref: `${this.path.ref}.attachments[${idx}]`,\n        },\n        getState: () => {\n          const attachments = this.getState().attachments;\n          const attachment = attachments[idx];\n          if (!attachment) return SKIP_UPDATE;\n\n          return {\n            ...attachment,\n            source: \"edit-composer\",\n          } satisfies AttachmentState & { source: \"edit-composer\" };\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this._core,\n    );\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7325, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/message-part-runtime.ts"],"sourcesContent":["import {\n  ThreadAssistantMessagePart,\n  ThreadUserMessagePart,\n  MessagePartStatus,\n  ToolCallMessagePartStatus,\n} from \"../../types/assistant-types\";\nimport { ThreadRuntimeCoreBinding } from \"./thread-runtime\";\nimport type { MessageStateBinding } from \"./runtime-bindings\";\nimport { SubscribableWithState } from \"./subscribable/subscribable\";\nimport { Unsubscribe } from \"../../types\";\nimport { MessagePartRuntimePath } from \"./runtime-path-types\";\nimport { ToolResponse } from \"assistant-stream\";\n\nexport type MessagePartState = (\n  | ThreadUserMessagePart\n  | ThreadAssistantMessagePart\n) & {\n  readonly status: MessagePartStatus | ToolCallMessagePartStatus;\n};\n\ntype MessagePartSnapshotBinding = SubscribableWithState<\n  MessagePartState,\n  MessagePartRuntimePath\n>;\n\nexport type MessagePartRuntime = {\n  /**\n   * Add tool result to a tool call message part that has no tool result yet.\n   * This is useful when you are collecting a tool result via user input (\"human tool calls\").\n   */\n  addToolResult(result: any | ToolResponse<any>): void;\n\n  /**\n   * Resume a tool call that is waiting for human input with a payload.\n   * This is useful when a tool has requested human input and is waiting for a response.\n   */\n  resumeToolCall(payload: unknown): void;\n\n  readonly path: MessagePartRuntimePath;\n  getState(): MessagePartState;\n  subscribe(callback: () => void): Unsubscribe;\n};\n\nexport class MessagePartRuntimeImpl implements MessagePartRuntime {\n  public get path() {\n    return this.contentBinding.path;\n  }\n\n  constructor(\n    private contentBinding: MessagePartSnapshotBinding,\n    private messageApi?: MessageStateBinding,\n    private threadApi?: ThreadRuntimeCoreBinding,\n  ) {\n    this.__internal_bindMethods();\n  }\n\n  protected __internal_bindMethods() {\n    this.addToolResult = this.addToolResult.bind(this);\n    this.resumeToolCall = this.resumeToolCall.bind(this);\n    this.getState = this.getState.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n  }\n\n  public getState() {\n    return this.contentBinding.getState();\n  }\n\n  public addToolResult(result: any | ToolResponse<any>) {\n    const state = this.contentBinding.getState();\n    if (!state) throw new Error(\"Message part is not available\");\n\n    if (state.type !== \"tool-call\")\n      throw new Error(\"Tried to add tool result to non-tool message part\");\n\n    if (!this.messageApi)\n      throw new Error(\n        \"Message API is not available. This is likely a bug in assistant-ui.\",\n      );\n    if (!this.threadApi) throw new Error(\"Thread API is not available\");\n\n    const message = this.messageApi.getState();\n    if (!message) throw new Error(\"Message is not available\");\n\n    const toolName = state.toolName;\n    const toolCallId = state.toolCallId;\n\n    const response = ToolResponse.toResponse(result);\n    this.threadApi.getState().addToolResult({\n      messageId: message.id,\n      toolName,\n      toolCallId,\n      result: response.result,\n      artifact: response.artifact,\n      isError: response.isError,\n    });\n  }\n\n  public resumeToolCall(payload: unknown) {\n    const state = this.contentBinding.getState();\n    if (!state) throw new Error(\"Message part is not available\");\n\n    if (state.type !== \"tool-call\")\n      throw new Error(\"Tried to resume tool call on non-tool message part\");\n\n    if (!this.threadApi) throw new Error(\"Thread API is not available\");\n\n    const toolCallId = state.toolCallId;\n    this.threadApi.getState().resumeToolCall({\n      toolCallId,\n      payload,\n    });\n  }\n\n  public subscribe(callback: () => void) {\n    return this.contentBinding.subscribe(callback);\n  }\n}\n"],"names":[],"mappings":";;;;AAWA;;AAgCO,MAAM;;;;IACX,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI;IACjC;IAEA,YACE,AAAQ,cAA0C,EAClD,AAAQ,UAAgC,EACxC,AAAQ,SAAoC,CAC5C;aAHQ,iBAAA;aACA,aAAA;aACA,YAAA;QAER,IAAI,CAAC,sBAAsB;IAC7B;IAEU,yBAAyB;QACjC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI;QACjD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI;QACnD,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI;QACvC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI;IAC3C;IAEO,WAAW;QAChB,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ;IACrC;IAEO,cAAc,MAA+B,EAAE;QACpD,MAAM,QAAQ,IAAI,CAAC,cAAc,CAAC,QAAQ;QAC1C,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;QAE5B,IAAI,MAAM,IAAI,KAAK,aACjB,MAAM,IAAI,MAAM;QAElB,IAAI,CAAC,IAAI,CAAC,UAAU,EAClB,MAAM,IAAI,MACR;QAEJ,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,IAAI,MAAM;QAErC,MAAM,UAAU,IAAI,CAAC,UAAU,CAAC,QAAQ;QACxC,IAAI,CAAC,SAAS,MAAM,IAAI,MAAM;QAE9B,MAAM,WAAW,MAAM,QAAQ;QAC/B,MAAM,aAAa,MAAM,UAAU;QAEnC,MAAM,WAAW,2PAAY,CAAC,UAAU,CAAC;QACzC,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,aAAa,CAAC;YACtC,WAAW,QAAQ,EAAE;YACrB;YACA;YACA,QAAQ,SAAS,MAAM;YACvB,UAAU,SAAS,QAAQ;YAC3B,SAAS,SAAS,OAAO;QAC3B;IACF;IAEO,eAAe,OAAgB,EAAE;QACtC,MAAM,QAAQ,IAAI,CAAC,cAAc,CAAC,QAAQ;QAC1C,IAAI,CAAC,OAAO,MAAM,IAAI,MAAM;QAE5B,IAAI,MAAM,IAAI,KAAK,aACjB,MAAM,IAAI,MAAM;QAElB,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,MAAM,IAAI,MAAM;QAErC,MAAM,aAAa,MAAM,UAAU;QACnC,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,cAAc,CAAC;YACvC;YACA;QACF;IACF;IAEO,UAAU,QAAoB,EAAE;QACrC,OAAO,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC;IACvC;AACF"}},
    {"offset": {"line": 7392, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/subscribable/nested-subscription-subject.ts"],"sourcesContent":["import { Unsubscribe } from \"../../../types\";\nimport { BaseSubject } from \"./base-subject\";\nimport {\n  NestedSubscribable,\n  Subscribable,\n  SubscribableWithState,\n} from \"./subscribable\";\n\nexport class NestedSubscriptionSubject<\n    TState extends Subscribable | undefined,\n    TPath,\n  >\n  extends BaseSubject\n  implements\n    SubscribableWithState<TState, TPath>,\n    NestedSubscribable<TState, TPath>\n{\n  public get path() {\n    return this.binding.path;\n  }\n\n  constructor(private binding: NestedSubscribable<TState, TPath>) {\n    super();\n  }\n\n  public getState() {\n    return this.binding.getState();\n  }\n\n  public outerSubscribe(callback: () => void) {\n    return this.binding.subscribe(callback);\n  }\n\n  protected _connect(): Unsubscribe {\n    const callback = () => {\n      this.notifySubscribers();\n    };\n\n    let lastState = this.binding.getState();\n    let innerUnsubscribe = lastState?.subscribe(callback);\n    const onRuntimeUpdate = () => {\n      const newState = this.binding.getState();\n      if (newState === lastState) return;\n      lastState = newState;\n\n      innerUnsubscribe?.();\n      innerUnsubscribe = this.binding.getState()?.subscribe(callback);\n\n      callback();\n    };\n\n    const outerUnsubscribe = this.outerSubscribe(onRuntimeUpdate);\n    return () => {\n      outerUnsubscribe?.();\n      innerUnsubscribe?.();\n    };\n  }\n}\n"],"names":[],"mappings":";;;;AACA;;AAOO,MAAM,kCAIH,0MAAW;;IAKnB,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI;IAC1B;IAEA,YAAY,AAAQ,OAA0C,CAAE;QAC9D,KAAK,SADa,UAAA;IAEpB;IAEO,WAAW;QAChB,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ;IAC9B;IAEO,eAAe,QAAoB,EAAE;QAC1C,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC;IAChC;IAEU,WAAwB;QAChC,MAAM,WAAW;YACf,IAAI,CAAC,iBAAiB;QACxB;QAEA,IAAI,YAAY,IAAI,CAAC,OAAO,CAAC,QAAQ;QACrC,IAAI,mBAAmB,WAAW,UAAU;QAC5C,MAAM,kBAAkB;YACtB,MAAM,WAAW,IAAI,CAAC,OAAO,CAAC,QAAQ;YACtC,IAAI,aAAa,WAAW;YAC5B,YAAY;YAEZ;YACA,mBAAmB,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,UAAU;YAEtD;QACF;QAEA,MAAM,mBAAmB,IAAI,CAAC,cAAc,CAAC;QAC7C,OAAO;YACL;YACA;QACF;IACF;AACF"}},
    {"offset": {"line": 7437, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/message-runtime.ts"],"sourcesContent":["import {\n  SpeechState,\n  SubmittedFeedback,\n} from \"../runtime-cores/core/thread-runtime-core\";\nimport { symbolInnerMessage } from \"../runtime-cores/external-store/get-external-store-message\";\nimport {\n  ThreadMessage,\n  ThreadAssistantMessagePart,\n  ThreadUserMessagePart,\n  Unsubscribe,\n} from \"../../types\";\nimport {\n  MessagePartStatus,\n  RunConfig,\n  ToolCallMessagePartStatus,\n} from \"../../types/assistant-types\";\nimport { getThreadMessageText } from \"../../utils/get-thread-message-text\";\nimport {\n  AttachmentRuntime,\n  AttachmentState,\n  MessageAttachmentRuntimeImpl,\n} from \"./attachment-runtime\";\nimport {\n  EditComposerRuntime,\n  EditComposerRuntimeImpl,\n} from \"./composer-runtime\";\nimport {\n  MessagePartRuntime,\n  MessagePartRuntimeImpl,\n  MessagePartState,\n} from \"./message-part-runtime\";\nimport { MessageRuntimePath } from \"./runtime-path-types\";\nimport { ThreadRuntimeCoreBinding } from \"./thread-runtime\";\nimport { NestedSubscriptionSubject } from \"./subscribable/nested-subscription-subject\";\nimport { SKIP_UPDATE } from \"./subscribable/skip-update\";\nimport { ShallowMemoizeSubject } from \"./subscribable/shallow-memoize-subject\";\nimport type { MessageStateBinding } from \"./runtime-bindings\";\n\nconst COMPLETE_STATUS: MessagePartStatus = Object.freeze({\n  type: \"complete\",\n});\n\nexport const toMessagePartStatus = (\n  message: ThreadMessage,\n  partIndex: number,\n  part: ThreadUserMessagePart | ThreadAssistantMessagePart,\n): ToolCallMessagePartStatus => {\n  if (message.role !== \"assistant\") return COMPLETE_STATUS;\n\n  if (part.type === \"tool-call\") {\n    if (!part.result) {\n      return message.status as ToolCallMessagePartStatus;\n    } else {\n      return COMPLETE_STATUS;\n    }\n  }\n\n  const isLastPart = partIndex === Math.max(0, message.content.length - 1);\n  if (message.status.type === \"requires-action\") return COMPLETE_STATUS;\n  return isLastPart ? (message.status as MessagePartStatus) : COMPLETE_STATUS;\n};\n\nconst getMessagePartState = (\n  message: MessageState,\n  partIndex: number,\n): MessagePartState | SKIP_UPDATE => {\n  const part = message.content[partIndex];\n  if (!part) {\n    return SKIP_UPDATE;\n  }\n\n  // if the message part is the same, don't update\n  const status = toMessagePartStatus(message, partIndex, part);\n  return Object.freeze({\n    ...part,\n    ...{ [symbolInnerMessage]: (part as any)[symbolInnerMessage] },\n    status,\n  });\n};\n\nexport type MessageState = ThreadMessage & {\n  readonly parentId: string | null;\n  /** The position of this message in the thread (0 for first message) */\n  readonly index: number;\n  readonly isLast: boolean;\n\n  readonly branchNumber: number;\n  readonly branchCount: number;\n\n  /**\n   * @deprecated This API is still under active development and might change without notice.\n   */\n  readonly speech: SpeechState | undefined;\n  /**\n   * @deprecated Use `message.metadata.submittedFeedback` instead. This will be removed in 0.12.0.\n   */\n  readonly submittedFeedback: SubmittedFeedback | undefined;\n};\n\nexport type { MessageStateBinding } from \"./runtime-bindings\";\n\ntype ReloadConfig = {\n  runConfig?: RunConfig;\n};\n\nexport type MessageRuntime = {\n  readonly path: MessageRuntimePath;\n\n  readonly composer: EditComposerRuntime;\n\n  getState(): MessageState;\n  reload(config?: ReloadConfig): void;\n  /**\n   * @deprecated This API is still under active development and might change without notice.\n   */\n  speak(): void;\n  /**\n   * @deprecated This API is still under active development and might change without notice.\n   */\n  stopSpeaking(): void;\n  submitFeedback({ type }: { type: \"positive\" | \"negative\" }): void;\n  switchToBranch({\n    position,\n    branchId,\n  }: {\n    position?: \"previous\" | \"next\" | undefined;\n    branchId?: string | undefined;\n  }): void;\n  unstable_getCopyText(): string;\n\n  subscribe(callback: () => void): Unsubscribe;\n\n  getMessagePartByIndex(idx: number): MessagePartRuntime;\n  getMessagePartByToolCallId(toolCallId: string): MessagePartRuntime;\n\n  getAttachmentByIndex(idx: number): AttachmentRuntime & { source: \"message\" };\n};\n\nexport class MessageRuntimeImpl implements MessageRuntime {\n  public get path() {\n    return this._core.path;\n  }\n\n  constructor(\n    private _core: MessageStateBinding,\n    private _threadBinding: ThreadRuntimeCoreBinding,\n  ) {\n    this.composer = new EditComposerRuntimeImpl(\n      new NestedSubscriptionSubject({\n        path: {\n          ...this.path,\n          ref: `${this.path.ref}${this.path.ref}.composer`,\n          composerSource: \"edit\",\n        },\n        getState: this._getEditComposerRuntimeCore,\n        subscribe: (callback) => this._threadBinding.subscribe(callback),\n      }),\n      () => this._threadBinding.getState().beginEdit(this._core.getState().id),\n    );\n\n    this.__internal_bindMethods();\n  }\n\n  protected __internal_bindMethods() {\n    this.reload = this.reload.bind(this);\n    this.getState = this.getState.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n    this.getMessagePartByIndex = this.getMessagePartByIndex.bind(this);\n    this.getMessagePartByToolCallId =\n      this.getMessagePartByToolCallId.bind(this);\n    this.getAttachmentByIndex = this.getAttachmentByIndex.bind(this);\n    this.unstable_getCopyText = this.unstable_getCopyText.bind(this);\n    this.speak = this.speak.bind(this);\n    this.stopSpeaking = this.stopSpeaking.bind(this);\n    this.submitFeedback = this.submitFeedback.bind(this);\n    this.switchToBranch = this.switchToBranch.bind(this);\n  }\n\n  public readonly composer;\n\n  private _getEditComposerRuntimeCore = () => {\n    return this._threadBinding\n      .getState()\n      .getEditComposer(this._core.getState().id);\n  };\n\n  public getState() {\n    return this._core.getState();\n  }\n\n  public reload(reloadConfig: ReloadConfig = {}) {\n    const editComposerRuntimeCore = this._getEditComposerRuntimeCore();\n    const composerRuntimeCore =\n      editComposerRuntimeCore ?? this._threadBinding.getState().composer;\n    const composer = editComposerRuntimeCore ?? composerRuntimeCore;\n\n    const { runConfig = composer.runConfig } = reloadConfig;\n    const state = this._core.getState();\n    if (state.role !== \"assistant\")\n      throw new Error(\"Can only reload assistant messages\");\n\n    this._threadBinding.getState().startRun({\n      parentId: state.parentId,\n      sourceId: state.id,\n      runConfig,\n    });\n  }\n\n  public speak() {\n    const state = this._core.getState();\n    return this._threadBinding.getState().speak(state.id);\n  }\n\n  public stopSpeaking() {\n    const state = this._core.getState();\n    const thread = this._threadBinding.getState();\n    if (thread.speech?.messageId === state.id) {\n      this._threadBinding.getState().stopSpeaking();\n    } else {\n      throw new Error(\"Message is not being spoken\");\n    }\n  }\n\n  public submitFeedback({ type }: { type: \"positive\" | \"negative\" }) {\n    const state = this._core.getState();\n    this._threadBinding.getState().submitFeedback({\n      messageId: state.id,\n      type,\n    });\n  }\n\n  public switchToBranch({\n    position,\n    branchId,\n  }: {\n    position?: \"previous\" | \"next\" | undefined;\n    branchId?: string | undefined;\n  }) {\n    const state = this._core.getState();\n    if (branchId && position) {\n      throw new Error(\"May not specify both branchId and position\");\n    } else if (!branchId && !position) {\n      throw new Error(\"Must specify either branchId or position\");\n    }\n\n    const thread = this._threadBinding.getState();\n    const branches = thread.getBranches(state.id);\n    let targetBranch = branchId;\n    if (position === \"previous\") {\n      targetBranch = branches[state.branchNumber - 2];\n    } else if (position === \"next\") {\n      targetBranch = branches[state.branchNumber];\n    }\n    if (!targetBranch) throw new Error(\"Branch not found\");\n\n    this._threadBinding.getState().switchToBranch(targetBranch);\n  }\n\n  public unstable_getCopyText() {\n    return getThreadMessageText(this.getState());\n  }\n\n  public subscribe(callback: () => void) {\n    return this._core.subscribe(callback);\n  }\n\n  public getMessagePartByIndex(idx: number) {\n    if (idx < 0) throw new Error(\"Message part index must be >= 0\");\n    return new MessagePartRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ...this.path,\n          ref: `${this.path.ref}${this.path.ref}.content[${idx}]`,\n          messagePartSelector: { type: \"index\", index: idx },\n        },\n        getState: () => {\n          return getMessagePartState(this.getState(), idx);\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this._core,\n      this._threadBinding,\n    );\n  }\n\n  public getMessagePartByToolCallId(toolCallId: string) {\n    return new MessagePartRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ...this.path,\n          ref:\n            this.path.ref +\n            `${this.path.ref}.content[toolCallId=${JSON.stringify(toolCallId)}]`,\n          messagePartSelector: { type: \"toolCallId\", toolCallId },\n        },\n        getState: () => {\n          const state = this._core.getState();\n          const idx = state.content.findIndex(\n            (part) =>\n              part.type === \"tool-call\" && part.toolCallId === toolCallId,\n          );\n          if (idx === -1) return SKIP_UPDATE;\n          return getMessagePartState(state, idx);\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this._core,\n      this._threadBinding,\n    );\n  }\n\n  public getAttachmentByIndex(idx: number) {\n    return new MessageAttachmentRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ...this.path,\n          ref: `${this.path.ref}${this.path.ref}.attachments[${idx}]`,\n          attachmentSource: \"message\",\n          attachmentSelector: { type: \"index\", index: idx },\n        },\n        getState: () => {\n          const attachments = this.getState().attachments;\n          const attachment = attachments?.[idx];\n          if (!attachment) return SKIP_UPDATE;\n\n          return {\n            ...attachment,\n            source: \"message\",\n          } satisfies AttachmentState & { source: \"message\" };\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n    );\n  }\n}\n"],"names":[],"mappings":";;;;;;AAIA;AAYA;AACA;AAKA;AAIA;AAOA;AACA;AACA;;;;;;;;;AAGA,MAAM,kBAAqC,OAAO,MAAM,CAAC;IACvD,MAAM;AACR;AAEO,MAAM,sBAAsB,CACjC,SACA,WACA;IAEA,IAAI,QAAQ,IAAI,KAAK,aAAa,OAAO;IAEzC,IAAI,KAAK,IAAI,KAAK,aAAa;QAC7B,IAAI,CAAC,KAAK,MAAM,EAAE;YAChB,OAAO,QAAQ,MAAM;QACvB,OAAO;YACL,OAAO;QACT;IACF;IAEA,MAAM,aAAa,cAAc,KAAK,GAAG,CAAC,GAAG,QAAQ,OAAO,CAAC,MAAM,GAAG;IACtE,IAAI,QAAQ,MAAM,CAAC,IAAI,KAAK,mBAAmB,OAAO;IACtD,OAAO,aAAc,QAAQ,MAAM,GAAyB;AAC9D;AAEA,MAAM,sBAAsB,CAC1B,SACA;IAEA,MAAM,OAAO,QAAQ,OAAO,CAAC,UAAU;IACvC,IAAI,CAAC,MAAM;QACT,OAAO,yMAAW;IACpB;IAEA,gDAAgD;IAChD,MAAM,SAAS,oBAAoB,SAAS,WAAW;IACvD,OAAO,OAAO,MAAM,CAAC;QACnB,GAAG,IAAI;QACP,GAAG;YAAE,CAAC,oPAAkB,CAAC,EAAE,AAAC,IAAY,CAAC,oPAAkB,CAAC;QAAC,CAAC;QAC9D;IACF;AACF;AA4DO,MAAM;;;IACX,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI;IACxB;IAEA,YACE,AAAQ,KAA0B,EAClC,AAAQ,cAAwC,CAChD;aAFQ,QAAA;aACA,iBAAA;aAmCF,8BAA8B;YACpC,OAAO,IAAI,CAAC,cAAc,CACvB,QAAQ,GACR,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,EAAE;QAC7C;QArCE,IAAI,CAAC,QAAQ,GAAG,IAAI,0MAAuB,CACzC,IAAI,0OAAyB,CAAC;YAC5B,MAAM;gBACJ,GAAG,IAAI,CAAC,IAAI;gBACZ,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC;gBAChD,gBAAgB;YAClB;YACA,UAAU,IAAI,CAAC,2BAA2B;YAC1C,WAAW,CAAC,WAAa,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC;QACzD,IACA,IAAM,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,EAAE;QAGzE,IAAI,CAAC,sBAAsB;IAC7B;IAEU,yBAAyB;QACjC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI;QACnC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI;QACvC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI;QACzC,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI;QACjE,IAAI,CAAC,0BAA0B,GAC7B,IAAI,CAAC,0BAA0B,CAAC,IAAI,CAAC,IAAI;QAC3C,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI;QAC/D,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI;QAC/D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI;QACjC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI;QAC/C,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI;QACnD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI;IACrD;IAEgB,SAAS;IAEjB,4BAIN;IAEK,WAAW;QAChB,OAAO,IAAI,CAAC,KAAK,CAAC,QAAQ;IAC5B;IAEO,OAAO,eAA6B,CAAC,CAAC,EAAE;QAC7C,MAAM,0BAA0B,IAAI,CAAC,2BAA2B;QAChE,MAAM,sBACJ,2BAA2B,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,QAAQ;QACpE,MAAM,WAAW,2BAA2B;QAE5C,MAAM,EAAE,YAAY,SAAS,SAAS,EAAE,GAAG;QAC3C,MAAM,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ;QACjC,IAAI,MAAM,IAAI,KAAK,aACjB,MAAM,IAAI,MAAM;QAElB,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,QAAQ,CAAC;YACtC,UAAU,MAAM,QAAQ;YACxB,UAAU,MAAM,EAAE;YAClB;QACF;IACF;IAEO,QAAQ;QACb,MAAM,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ;QACjC,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,KAAK,CAAC,MAAM,EAAE;IACtD;IAEO,eAAe;QACpB,MAAM,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ;QACjC,MAAM,SAAS,IAAI,CAAC,cAAc,CAAC,QAAQ;QAC3C,IAAI,OAAO,MAAM,EAAE,cAAc,MAAM,EAAE,EAAE;YACzC,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,YAAY;QAC7C,OAAO;YACL,MAAM,IAAI,MAAM;QAClB;IACF;IAEO,eAAe,EAAE,IAAI,EAAqC,EAAE;QACjE,MAAM,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ;QACjC,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,cAAc,CAAC;YAC5C,WAAW,MAAM,EAAE;YACnB;QACF;IACF;IAEO,eAAe,EACpB,QAAQ,EACR,QAAQ,EAIT,EAAE;QACD,MAAM,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ;QACjC,IAAI,YAAY,UAAU;YACxB,MAAM,IAAI,MAAM;QAClB,OAAO,IAAI,CAAC,YAAY,CAAC,UAAU;YACjC,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,SAAS,IAAI,CAAC,cAAc,CAAC,QAAQ;QAC3C,MAAM,WAAW,OAAO,WAAW,CAAC,MAAM,EAAE;QAC5C,IAAI,eAAe;QACnB,IAAI,aAAa,YAAY;YAC3B,eAAe,QAAQ,CAAC,MAAM,YAAY,GAAG,EAAE;QACjD,OAAO,IAAI,aAAa,QAAQ;YAC9B,eAAe,QAAQ,CAAC,MAAM,YAAY,CAAC;QAC7C;QACA,IAAI,CAAC,cAAc,MAAM,IAAI,MAAM;QAEnC,IAAI,CAAC,cAAc,CAAC,QAAQ,GAAG,cAAc,CAAC;IAChD;IAEO,uBAAuB;QAC5B,OAAO,IAAA,8LAAoB,EAAC,IAAI,CAAC,QAAQ;IAC3C;IAEO,UAAU,QAAoB,EAAE;QACrC,OAAO,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;IAC9B;IAEO,sBAAsB,GAAW,EAAE;QACxC,IAAI,MAAM,GAAG,MAAM,IAAI,MAAM;QAC7B,OAAO,IAAI,gNAAsB,CAC/B,IAAI,kOAAqB,CAAC;YACxB,MAAM;gBACJ,GAAG,IAAI,CAAC,IAAI;gBACZ,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;gBACvD,qBAAqB;oBAAE,MAAM;oBAAS,OAAO;gBAAI;YACnD;YACA,UAAU;gBACR,OAAO,oBAAoB,IAAI,CAAC,QAAQ,IAAI;YAC9C;YACA,WAAW,CAAC,WAAa,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;QAChD,IACA,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,cAAc;IAEvB;IAEO,2BAA2B,UAAkB,EAAE;QACpD,OAAO,IAAI,gNAAsB,CAC/B,IAAI,kOAAqB,CAAC;YACxB,MAAM;gBACJ,GAAG,IAAI,CAAC,IAAI;gBACZ,KACE,IAAI,CAAC,IAAI,CAAC,GAAG,GACb,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,oBAAoB,EAAE,KAAK,SAAS,CAAC,YAAY,CAAC,CAAC;gBACtE,qBAAqB;oBAAE,MAAM;oBAAc;gBAAW;YACxD;YACA,UAAU;gBACR,MAAM,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ;gBACjC,MAAM,MAAM,MAAM,OAAO,CAAC,SAAS,CACjC,CAAC,OACC,KAAK,IAAI,KAAK,eAAe,KAAK,UAAU,KAAK;gBAErD,IAAI,QAAQ,CAAC,GAAG,OAAO,yMAAW;gBAClC,OAAO,oBAAoB,OAAO;YACpC;YACA,WAAW,CAAC,WAAa,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;QAChD,IACA,IAAI,CAAC,KAAK,EACV,IAAI,CAAC,cAAc;IAEvB;IAEO,qBAAqB,GAAW,EAAE;QACvC,OAAO,IAAI,iNAA4B,CACrC,IAAI,kOAAqB,CAAC;YACxB,MAAM;gBACJ,GAAG,IAAI,CAAC,IAAI;gBACZ,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;gBAC3D,kBAAkB;gBAClB,oBAAoB;oBAAE,MAAM;oBAAS,OAAO;gBAAI;YAClD;YACA,UAAU;gBACR,MAAM,cAAc,IAAI,CAAC,QAAQ,GAAG,WAAW;gBAC/C,MAAM,aAAa,aAAa,CAAC,IAAI;gBACrC,IAAI,CAAC,YAAY,OAAO,yMAAW;gBAEnC,OAAO;oBACL,GAAG,UAAU;oBACb,QAAQ;gBACV;YACF;YACA,WAAW,CAAC,WAAa,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC;QAChD;IAEJ;AACF"}},
    {"offset": {"line": 7652, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/thread-runtime.ts"],"sourcesContent":["import {\n  ThreadSuggestion,\n  RuntimeCapabilities,\n  ThreadRuntimeCore,\n  SpeechState,\n  ThreadRuntimeEventType,\n  StartRunConfig,\n  ResumeRunConfig,\n} from \"../runtime-cores/core/thread-runtime-core\";\nimport { ExportedMessageRepository } from \"../runtime-cores/utils/message-repository\";\nimport { AppendMessage, ThreadMessage, Unsubscribe } from \"../../types\";\nimport { ThreadMessageLike } from \"../runtime-cores/external-store\";\nimport {\n  MessageRuntime,\n  MessageRuntimeImpl,\n  MessageState,\n} from \"./message-runtime\";\nimport { NestedSubscriptionSubject } from \"./subscribable/nested-subscription-subject\";\nimport { ShallowMemoizeSubject } from \"./subscribable/shallow-memoize-subject\";\nimport { SubscribableWithState } from \"./subscribable/subscribable\";\nimport {\n  ThreadComposerRuntime,\n  ThreadComposerRuntimeImpl,\n} from \"./composer-runtime\";\nimport { SKIP_UPDATE } from \"./subscribable/skip-update\";\nimport {\n  MessageRuntimePath,\n  ThreadListItemRuntimePath,\n  ThreadRuntimePath,\n} from \"./runtime-path-types\";\nimport type { ThreadListItemState } from \"./runtime-bindings\";\nimport { RunConfig } from \"../../types/assistant-types\";\nimport { EventSubscriptionSubject } from \"./subscribable/event-subscription-subject\";\nimport { symbolInnerMessage } from \"../runtime-cores/external-store/get-external-store-message\";\nimport { ModelContext } from \"../../model-context\";\nimport { ChatModelRunOptions, ChatModelRunResult } from \"../runtime-cores\";\nimport { ReadonlyJSONValue } from \"assistant-stream/utils\";\n\nexport type CreateStartRunConfig = {\n  parentId: string | null;\n  sourceId?: string | null | undefined;\n  runConfig?: RunConfig | undefined;\n};\n\nexport type CreateResumeRunConfig = CreateStartRunConfig & {\n  stream?: (\n    options: ChatModelRunOptions,\n  ) => AsyncGenerator<ChatModelRunResult, void, unknown>;\n};\n\nconst toResumeRunConfig = (message: CreateResumeRunConfig): ResumeRunConfig => {\n  return {\n    parentId: message.parentId ?? null,\n    sourceId: message.sourceId ?? null,\n    runConfig: message.runConfig ?? {},\n    ...(message.stream ? { stream: message.stream } : {}),\n  };\n};\n\nconst toStartRunConfig = (message: CreateStartRunConfig): StartRunConfig => {\n  return {\n    parentId: message.parentId ?? null,\n    sourceId: message.sourceId ?? null,\n    runConfig: message.runConfig ?? {},\n  };\n};\n\nexport type CreateAppendMessage =\n  | string\n  | {\n      parentId?: string | null | undefined;\n      sourceId?: string | null | undefined;\n      role?: AppendMessage[\"role\"] | undefined;\n      content: AppendMessage[\"content\"];\n      attachments?: AppendMessage[\"attachments\"] | undefined;\n      metadata?: AppendMessage[\"metadata\"] | undefined;\n      createdAt?: Date | undefined;\n      runConfig?: AppendMessage[\"runConfig\"] | undefined;\n      startRun?: boolean | undefined;\n    };\n\nconst toAppendMessage = (\n  messages: readonly ThreadMessage[],\n  message: CreateAppendMessage,\n): AppendMessage => {\n  if (typeof message === \"string\") {\n    return {\n      createdAt: new Date(),\n      parentId: messages.at(-1)?.id ?? null,\n      sourceId: null,\n      runConfig: {},\n      role: \"user\",\n      content: [{ type: \"text\", text: message }],\n      attachments: [],\n      metadata: { custom: {} },\n    };\n  }\n\n  return {\n    createdAt: message.createdAt ?? new Date(),\n    parentId: message.parentId ?? messages.at(-1)?.id ?? null,\n    sourceId: message.sourceId ?? null,\n    role: message.role ?? \"user\",\n    content: message.content,\n    attachments: message.attachments ?? [],\n    metadata: message.metadata ?? { custom: {} },\n    runConfig: message.runConfig ?? {},\n    startRun: message.startRun,\n  } as AppendMessage;\n};\n\nexport type ThreadRuntimeCoreBinding = SubscribableWithState<\n  ThreadRuntimeCore,\n  ThreadRuntimePath\n> & {\n  outerSubscribe(callback: () => void): Unsubscribe;\n};\n\nexport type ThreadListItemRuntimeBinding = SubscribableWithState<\n  ThreadListItemState,\n  ThreadListItemRuntimePath\n>;\n\nexport type ThreadState = {\n  /**\n   * The thread ID.\n   * @deprecated This field is deprecated and will be removed in 0.12.0. Use `useThreadListItem().id` instead.\n   */\n  readonly threadId: string;\n\n  /**\n   * The thread metadata.\n   *\n   * @deprecated Use `useThreadListItem()` instead. This field is deprecated and will be removed in 0.12.0.\n   */\n  readonly metadata: ThreadListItemState;\n\n  /**\n   * Whether the thread is disabled. Disabled threads cannot receive new messages.\n   */\n  readonly isDisabled: boolean;\n\n  /**\n   * Whether the thread is loading its history.\n   */\n  readonly isLoading: boolean;\n\n  /**\n   * Whether the thread is running. A thread is considered running when there is an active stream connection to the backend.\n   */\n  readonly isRunning: boolean;\n\n  /**\n   * The capabilities of the thread, such as whether the thread supports editing, branch switching, etc.\n   */\n  readonly capabilities: RuntimeCapabilities;\n\n  /**\n   * The messages in the currently selected branch of the thread.\n   */\n  readonly messages: readonly ThreadMessage[];\n\n  /**\n   * The thread state.\n   *\n   * @deprecated This feature is experimental\n   */\n  readonly state: ReadonlyJSONValue;\n\n  /**\n   * Follow up message suggestions to show the user.\n   */\n  readonly suggestions: readonly ThreadSuggestion[];\n\n  /**\n   * Custom extra information provided by the runtime.\n   */\n  readonly extras: unknown;\n\n  /**\n   * @deprecated This API is still under active development and might change without notice.\n   */\n  readonly speech: SpeechState | undefined;\n};\n\nexport const getThreadState = (\n  runtime: ThreadRuntimeCore,\n  threadListItemState: ThreadListItemState,\n): ThreadState => {\n  const lastMessage = runtime.messages.at(-1);\n  return Object.freeze({\n    threadId: threadListItemState.id,\n    metadata: threadListItemState,\n    capabilities: runtime.capabilities,\n    isDisabled: runtime.isDisabled,\n    isLoading: runtime.isLoading,\n    isRunning:\n      lastMessage?.role !== \"assistant\"\n        ? false\n        : lastMessage.status.type === \"running\",\n    messages: runtime.messages,\n    state: runtime.state,\n    suggestions: runtime.suggestions,\n    extras: runtime.extras,\n    speech: runtime.speech,\n  });\n};\n\nexport type ThreadRuntime = {\n  /**\n   * The selector for the thread runtime.\n   */\n  readonly path: ThreadRuntimePath;\n\n  /**\n   * The thread composer runtime.\n   */\n  readonly composer: ThreadComposerRuntime;\n\n  /**\n   * Gets a snapshot of the thread state.\n   */\n  getState(): ThreadState;\n\n  /**\n   * Append a new message to the thread.\n   *\n   * @example ```ts\n   * // append a new user message with the text \"Hello, world!\"\n   * threadRuntime.append(\"Hello, world!\");\n   * ```\n   *\n   * @example ```ts\n   * // append a new assistant message with the text \"Hello, world!\"\n   * threadRuntime.append({\n   *   role: \"assistant\",\n   *   content: [{ type: \"text\", text: \"Hello, world!\" }],\n   * });\n   * ```\n   */\n  append(message: CreateAppendMessage): void;\n\n  /**\n   * @deprecated pass an object with `parentId` instead. This will be removed in 0.12.0.\n   */\n  startRun(parentId: string | null): void;\n  /**\n   * Start a new run with the given configuration.\n   * @param config The configuration for starting the run\n   */\n  startRun(config: CreateStartRunConfig): void;\n\n  /**\n   * Resume a run with the given configuration.\n   * @param config The configuration for resuming the run\n   **/\n  unstable_resumeRun(config: CreateResumeRunConfig): void;\n\n  /**\n   * Load external state into the thread.\n   * @param state The state to load into the thread\n   */\n  unstable_loadExternalState(state: any): void;\n\n  subscribe(callback: () => void): Unsubscribe;\n  cancelRun(): void;\n  getModelContext(): ModelContext;\n\n  /**\n   * @deprecated This method was renamed to `getModelContext`.\n   */\n  getModelConfig(): ModelContext;\n\n  export(): ExportedMessageRepository;\n  import(repository: ExportedMessageRepository): void;\n\n  /**\n   * Reset the thread with optional initial messages.\n   *\n   * @param initialMessages - Optional array of initial messages to populate the thread\n   */\n  reset(initialMessages?: readonly ThreadMessageLike[]): void;\n\n  getMessageByIndex(idx: number): MessageRuntime;\n  getMessageById(messageId: string): MessageRuntime;\n\n  /**\n   * @deprecated This API is still under active development and might change without notice.\n   */\n  stopSpeaking(): void;\n\n  unstable_on(event: ThreadRuntimeEventType, callback: () => void): Unsubscribe;\n};\n\nexport class ThreadRuntimeImpl implements ThreadRuntime {\n  public get path() {\n    return this._threadBinding.path;\n  }\n\n  public get __internal_threadBinding() {\n    return this._threadBinding;\n  }\n\n  private readonly _threadBinding: ThreadRuntimeCoreBinding & {\n    getStateState(): ThreadState;\n  };\n\n  constructor(\n    threadBinding: ThreadRuntimeCoreBinding,\n    threadListItemBinding: ThreadListItemRuntimeBinding,\n  ) {\n    const stateBinding = new ShallowMemoizeSubject({\n      path: threadBinding.path,\n      getState: () =>\n        getThreadState(\n          threadBinding.getState(),\n          threadListItemBinding.getState(),\n        ),\n      subscribe: (callback) => {\n        const sub1 = threadBinding.subscribe(callback);\n        const sub2 = threadListItemBinding.subscribe(callback);\n        return () => {\n          sub1();\n          sub2();\n        };\n      },\n    });\n\n    this._threadBinding = {\n      path: threadBinding.path,\n      getState: () => threadBinding.getState(),\n      getStateState: () => stateBinding.getState(),\n      outerSubscribe: (callback) => threadBinding.outerSubscribe(callback),\n      subscribe: (callback) => threadBinding.subscribe(callback),\n    };\n\n    this.composer = new ThreadComposerRuntimeImpl(\n      new NestedSubscriptionSubject({\n        path: {\n          ...this.path,\n          ref: `${this.path.ref}${this.path.ref}.composer`,\n          composerSource: \"thread\",\n        },\n        getState: () => this._threadBinding.getState().composer,\n        subscribe: (callback) => this._threadBinding.subscribe(callback),\n      }),\n    );\n\n    this.__internal_bindMethods();\n  }\n\n  protected __internal_bindMethods() {\n    this.append = this.append.bind(this);\n    this.unstable_resumeRun = this.unstable_resumeRun.bind(this);\n    this.unstable_loadExternalState =\n      this.unstable_loadExternalState.bind(this);\n    this.startRun = this.startRun.bind(this);\n    this.cancelRun = this.cancelRun.bind(this);\n    this.stopSpeaking = this.stopSpeaking.bind(this);\n    this.export = this.export.bind(this);\n    this.import = this.import.bind(this);\n    this.reset = this.reset.bind(this);\n    this.getMessageByIndex = this.getMessageByIndex.bind(this);\n    this.getMessageById = this.getMessageById.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n    this.unstable_on = this.unstable_on.bind(this);\n    this.getModelContext = this.getModelContext.bind(this);\n    this.getModelConfig = this.getModelConfig.bind(this);\n    this.getState = this.getState.bind(this);\n  }\n\n  public readonly composer;\n\n  public getState() {\n    return this._threadBinding.getStateState();\n  }\n\n  public append(message: CreateAppendMessage) {\n    this._threadBinding\n      .getState()\n      .append(\n        toAppendMessage(this._threadBinding.getState().messages, message),\n      );\n  }\n\n  public subscribe(callback: () => void) {\n    return this._threadBinding.subscribe(callback);\n  }\n\n  public getModelContext() {\n    return this._threadBinding.getState().getModelContext();\n  }\n\n  public getModelConfig() {\n    return this.getModelContext();\n  }\n\n  public startRun(configOrParentId: string | null | CreateStartRunConfig) {\n    const config =\n      configOrParentId === null || typeof configOrParentId === \"string\"\n        ? { parentId: configOrParentId }\n        : configOrParentId;\n    return this._threadBinding.getState().startRun(toStartRunConfig(config));\n  }\n\n  public unstable_resumeRun(config: CreateResumeRunConfig) {\n    return this._threadBinding.getState().resumeRun(toResumeRunConfig(config));\n  }\n\n  public unstable_loadExternalState(state: any) {\n    this._threadBinding.getState().unstable_loadExternalState(state);\n  }\n\n  public cancelRun() {\n    this._threadBinding.getState().cancelRun();\n  }\n\n  public stopSpeaking() {\n    return this._threadBinding.getState().stopSpeaking();\n  }\n\n  public export() {\n    return this._threadBinding.getState().export();\n  }\n\n  public import(data: ExportedMessageRepository) {\n    this._threadBinding.getState().import(data);\n  }\n\n  public reset(initialMessages?: readonly ThreadMessageLike[]) {\n    this._threadBinding.getState().reset(initialMessages);\n  }\n\n  public getMessageByIndex(idx: number) {\n    if (idx < 0) throw new Error(\"Message index must be >= 0\");\n\n    return this._getMessageRuntime(\n      {\n        ...this.path,\n        ref: `${this.path.ref}${this.path.ref}.messages[${idx}]`,\n        messageSelector: { type: \"index\", index: idx },\n      },\n      () => {\n        const messages = this._threadBinding.getState().messages;\n        const message = messages[idx];\n        if (!message) return undefined;\n        return {\n          message,\n          parentId: messages[idx - 1]?.id ?? null,\n          index: idx,\n        };\n      },\n    );\n  }\n\n  public getMessageById(messageId: string) {\n    return this._getMessageRuntime(\n      {\n        ...this.path,\n        ref:\n          this.path.ref +\n          `${this.path.ref}.messages[messageId=${JSON.stringify(messageId)}]`,\n        messageSelector: { type: \"messageId\", messageId: messageId },\n      },\n      () => this._threadBinding.getState().getMessageById(messageId),\n    );\n  }\n\n  private _getMessageRuntime(\n    path: MessageRuntimePath,\n    callback: () =>\n      | { parentId: string | null; message: ThreadMessage; index: number }\n      | undefined,\n  ) {\n    return new MessageRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path,\n        getState: () => {\n          const { message, parentId, index } = callback() ?? {};\n\n          const { messages, speech: speechState } =\n            this._threadBinding.getState();\n\n          if (!message || parentId === undefined || index === undefined)\n            return SKIP_UPDATE;\n\n          const thread = this._threadBinding.getState();\n\n          const branches = thread.getBranches(message.id);\n          const submittedFeedback = message.metadata.submittedFeedback;\n\n          return {\n            ...message,\n            ...{ [symbolInnerMessage]: (message as any)[symbolInnerMessage] },\n\n            index,\n            isLast: messages.at(-1)?.id === message.id,\n            parentId,\n\n            branchNumber: branches.indexOf(message.id) + 1,\n            branchCount: branches.length,\n\n            speech:\n              speechState?.messageId === message.id ? speechState : undefined,\n\n            submittedFeedback,\n          } satisfies MessageState;\n        },\n        subscribe: (callback) => this._threadBinding.subscribe(callback),\n      }),\n      this._threadBinding,\n    );\n  }\n\n  private _eventSubscriptionSubjects = new Map<\n    string,\n    EventSubscriptionSubject<ThreadRuntimeEventType>\n  >();\n\n  public unstable_on(\n    event: ThreadRuntimeEventType,\n    callback: () => void,\n  ): Unsubscribe {\n    let subject = this._eventSubscriptionSubjects.get(event);\n    if (!subject) {\n      subject = new EventSubscriptionSubject({\n        event: event,\n        binding: this._threadBinding,\n      });\n      this._eventSubscriptionSubjects.set(event, subject);\n    }\n    return subject.subscribe(callback);\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7913, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/thread-list-runtime.ts"],"sourcesContent":["import { LazyMemoizeSubject } from \"./subscribable/lazy-memoize-subject\";\nimport { ThreadListRuntimeCore } from \"../runtime-cores/core/thread-list-runtime-core\";\nimport { Unsubscribe } from \"../../types\";\nimport {\n  ThreadListItemRuntime,\n  ThreadListItemRuntimeImpl,\n  ThreadListItemState,\n} from \"./thread-list-item-runtime\";\nimport { SKIP_UPDATE } from \"./subscribable/skip-update\";\nimport { ShallowMemoizeSubject } from \"./subscribable/shallow-memoize-subject\";\nimport {\n  ThreadListItemRuntimeBinding,\n  ThreadRuntime,\n  ThreadRuntimeCoreBinding,\n  ThreadRuntimeImpl,\n} from \"./thread-runtime\";\nimport { NestedSubscriptionSubject } from \"./subscribable/nested-subscription-subject\";\n\nexport type ThreadListState = {\n  readonly mainThreadId: string;\n  readonly newThreadId: string | undefined;\n  readonly threadIds: readonly string[];\n  readonly archivedThreadIds: readonly string[];\n  readonly isLoading: boolean;\n  readonly threadItems: Readonly<\n    Record<string, Omit<ThreadListItemState, \"isMain\" | \"threadId\">>\n  >;\n};\n\nexport type ThreadListRuntime = {\n  getState(): ThreadListState;\n\n  subscribe(callback: () => void): Unsubscribe;\n\n  readonly main: ThreadRuntime;\n  getById(threadId: string): ThreadRuntime;\n\n  readonly mainItem: ThreadListItemRuntime;\n  getItemById(threadId: string): ThreadListItemRuntime;\n  getItemByIndex(idx: number): ThreadListItemRuntime;\n  getArchivedItemByIndex(idx: number): ThreadListItemRuntime;\n\n  switchToThread(threadId: string): Promise<void>;\n  switchToNewThread(): Promise<void>;\n};\n\nconst getThreadListState = (\n  threadList: ThreadListRuntimeCore,\n): ThreadListState => {\n  return {\n    mainThreadId: threadList.mainThreadId,\n    newThreadId: threadList.newThreadId,\n    threadIds: threadList.threadIds,\n    archivedThreadIds: threadList.archivedThreadIds,\n    isLoading: threadList.isLoading,\n    threadItems: threadList.threadItems,\n  };\n};\n\nconst getThreadListItemState = (\n  threadList: ThreadListRuntimeCore,\n  threadId: string | undefined,\n): ThreadListItemState | SKIP_UPDATE => {\n  if (threadId === undefined) return SKIP_UPDATE;\n\n  const threadData = threadList.getItemById(threadId);\n  if (!threadData) return SKIP_UPDATE;\n  return {\n    id: threadData.id,\n    remoteId: threadData.remoteId,\n    externalId: threadData.externalId,\n    title: threadData.title,\n    status: threadData.status,\n    isMain: threadData.id === threadList.mainThreadId,\n  };\n};\n\nexport type ThreadListRuntimeCoreBinding = ThreadListRuntimeCore;\n\nexport class ThreadListRuntimeImpl implements ThreadListRuntime {\n  private _getState;\n  constructor(\n    private _core: ThreadListRuntimeCoreBinding,\n    private _runtimeFactory: new (\n      binding: ThreadRuntimeCoreBinding,\n      threadListItemBinding: ThreadListItemRuntimeBinding,\n    ) => ThreadRuntime = ThreadRuntimeImpl,\n  ) {\n    const stateBinding = new LazyMemoizeSubject({\n      path: {},\n      getState: () => getThreadListState(_core),\n      subscribe: (callback) => _core.subscribe(callback),\n    });\n\n    this._getState = stateBinding.getState.bind(stateBinding);\n\n    this._mainThreadListItemRuntime = new ThreadListItemRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ref: `threadItems[main]`,\n          threadSelector: { type: \"main\" },\n        },\n        getState: () => {\n          return getThreadListItemState(this._core, this._core.mainThreadId);\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this._core,\n    );\n\n    this.main = new _runtimeFactory(\n      new NestedSubscriptionSubject({\n        path: {\n          ref: \"threads.main\",\n          threadSelector: { type: \"main\" },\n        },\n        getState: () => _core.getMainThreadRuntimeCore(),\n        subscribe: (callback) => _core.subscribe(callback),\n      }),\n      this._mainThreadListItemRuntime, // TODO capture \"main\" threadListItem from context around useLocalRuntime / useExternalStoreRuntime\n    );\n\n    this.__internal_bindMethods();\n  }\n\n  protected __internal_bindMethods() {\n    this.switchToThread = this.switchToThread.bind(this);\n    this.switchToNewThread = this.switchToNewThread.bind(this);\n    this.getState = this.getState.bind(this);\n    this.subscribe = this.subscribe.bind(this);\n    this.getById = this.getById.bind(this);\n    this.getItemById = this.getItemById.bind(this);\n    this.getItemByIndex = this.getItemByIndex.bind(this);\n    this.getArchivedItemByIndex = this.getArchivedItemByIndex.bind(this);\n  }\n\n  public switchToThread(threadId: string): Promise<void> {\n    return this._core.switchToThread(threadId);\n  }\n\n  public switchToNewThread(): Promise<void> {\n    return this._core.switchToNewThread();\n  }\n\n  public getState(): ThreadListState {\n    return this._getState();\n  }\n\n  public subscribe(callback: () => void): Unsubscribe {\n    return this._core.subscribe(callback);\n  }\n\n  private _mainThreadListItemRuntime;\n\n  public readonly main: ThreadRuntime;\n\n  public get mainItem() {\n    return this._mainThreadListItemRuntime;\n  }\n\n  public getById(threadId: string) {\n    return new this._runtimeFactory(\n      new NestedSubscriptionSubject({\n        path: {\n          ref: `threads[threadId=${JSON.stringify(threadId)}]`,\n          threadSelector: { type: \"threadId\", threadId },\n        },\n        getState: () => this._core.getThreadRuntimeCore(threadId),\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this.mainItem, // TODO capture \"main\" threadListItem from context around useLocalRuntime / useExternalStoreRuntime\n    );\n  }\n\n  public getItemByIndex(idx: number) {\n    return new ThreadListItemRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ref: `threadItems[${idx}]`,\n          threadSelector: { type: \"index\", index: idx },\n        },\n        getState: () => {\n          return getThreadListItemState(this._core, this._core.threadIds[idx]);\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this._core,\n    );\n  }\n\n  public getArchivedItemByIndex(idx: number) {\n    return new ThreadListItemRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ref: `archivedThreadItems[${idx}]`,\n          threadSelector: { type: \"archiveIndex\", index: idx },\n        },\n        getState: () => {\n          return getThreadListItemState(\n            this._core,\n            this._core.archivedThreadIds[idx],\n          );\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this._core,\n    );\n  }\n\n  public getItemById(threadId: string) {\n    return new ThreadListItemRuntimeImpl(\n      new ShallowMemoizeSubject({\n        path: {\n          ref: `threadItems[threadId=${threadId}]`,\n          threadSelector: { type: \"threadId\", threadId },\n        },\n        getState: () => {\n          return getThreadListItemState(this._core, threadId);\n        },\n        subscribe: (callback) => this._core.subscribe(callback),\n      }),\n      this._core,\n    );\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8079, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime/assistant-runtime.ts"],"sourcesContent":["import { AssistantRuntimeCore } from \"../runtime-cores/core/assistant-runtime-core\";\nimport { ModelContextProvider } from \"../../model-context/model-context-types\";\nimport { ThreadRuntime } from \"./thread-runtime\";\nimport { Unsubscribe } from \"../../types\";\nimport { ThreadListRuntime, ThreadListRuntimeImpl } from \"./thread-list-runtime\";\nimport { ExportedMessageRepository, ThreadMessageLike } from \"../runtime-cores\";\n\nexport type AssistantRuntime = {\n  /**\n   * The threads in this assistant.\n   */\n  readonly threads: ThreadListRuntime;\n\n  /**\n   * The currently selected main thread. Equivalent to `threads.main`.\n   */\n  readonly thread: ThreadRuntime;\n\n  /**\n   * @deprecated This field was renamed to `threads`.\n   */\n  readonly threadList: ThreadListRuntime;\n\n  /**\n   * Switch to a new thread.\n   *\n   * @deprecated This method was moved to `threads.switchToNewThread`.\n   */\n  switchToNewThread(): void;\n\n  /**\n   * Switch to a thread.\n   *\n   * @param threadId The thread ID to switch to.\n   * @deprecated This method was moved to `threads.switchToThread`.\n   */\n  switchToThread(threadId: string): void;\n\n  /**\n   * Register a model context provider. Model context providers are configuration such as system message, temperature, etc. that are set in the frontend.\n   *\n   * @param provider The model context provider to register.\n   */\n  registerModelContextProvider(provider: ModelContextProvider): Unsubscribe;\n\n  /**\n   * @deprecated This method was renamed to `registerModelContextProvider`.\n   */\n  registerModelConfigProvider(provider: ModelContextProvider): Unsubscribe;\n\n  /**\n   * @deprecated Use `runtime.thread.reset(initialMessages)`.\n   */\n  reset: unknown; // make it a type error\n};\n\nexport class AssistantRuntimeImpl implements AssistantRuntime {\n  public readonly threads;\n  public get threadList() {\n    return this.threads;\n  }\n\n  public readonly _thread: ThreadRuntime;\n\n  public constructor(private readonly _core: AssistantRuntimeCore) {\n    this.threads = new ThreadListRuntimeImpl(_core.threads);\n    this._thread = this.threads.main;\n\n    this.__internal_bindMethods();\n  }\n\n  protected __internal_bindMethods() {\n    this.switchToNewThread = this.switchToNewThread.bind(this);\n    this.switchToThread = this.switchToThread.bind(this);\n    this.registerModelContextProvider =\n      this.registerModelContextProvider.bind(this);\n    this.registerModelConfigProvider =\n      this.registerModelConfigProvider.bind(this);\n    this.reset = this.reset.bind(this);\n  }\n\n  public get thread() {\n    return this._thread;\n  }\n\n  public switchToNewThread() {\n    return this._core.threads.switchToNewThread();\n  }\n\n  public switchToThread(threadId: string) {\n    return this._core.threads.switchToThread(threadId);\n  }\n\n  public registerModelContextProvider(provider: ModelContextProvider) {\n    return this._core.registerModelContextProvider(provider);\n  }\n\n  public registerModelConfigProvider(provider: ModelContextProvider) {\n    return this.registerModelContextProvider(provider);\n  }\n\n  public reset({\n    initialMessages,\n  }: {\n    initialMessages?: ThreadMessageLike[];\n  } = {}) {\n    return this._core.threads\n      .getMainThreadRuntimeCore()\n      .import(ExportedMessageRepository.fromArray(initialMessages ?? []));\n  }\n}\n"],"names":[],"mappings":";;;;AAIA;AACA;;;AAmDO,MAAM;;IACK,QAAQ;IACxB,IAAW,aAAa;QACtB,OAAO,IAAI,CAAC,OAAO;IACrB;IAEgB,QAAuB;IAEvC,YAAmB,AAAiB,KAA2B,CAAE;aAA7B,QAAA;QAClC,IAAI,CAAC,OAAO,GAAG,IAAI,8MAAqB,CAAC,MAAM,OAAO;QACtD,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI;QAEhC,IAAI,CAAC,sBAAsB;IAC7B;IAEU,yBAAyB;QACjC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI;QACzD,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI;QACnD,IAAI,CAAC,4BAA4B,GAC/B,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,IAAI;QAC7C,IAAI,CAAC,2BAA2B,GAC9B,IAAI,CAAC,2BAA2B,CAAC,IAAI,CAAC,IAAI;QAC5C,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI;IACnC;IAEA,IAAW,SAAS;QAClB,OAAO,IAAI,CAAC,OAAO;IACrB;IAEO,oBAAoB;QACzB,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,iBAAiB;IAC7C;IAEO,eAAe,QAAgB,EAAE;QACtC,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,cAAc,CAAC;IAC3C;IAEO,6BAA6B,QAA8B,EAAE;QAClE,OAAO,IAAI,CAAC,KAAK,CAAC,4BAA4B,CAAC;IACjD;IAEO,4BAA4B,QAA8B,EAAE;QACjE,OAAO,IAAI,CAAC,4BAA4B,CAAC;IAC3C;IAEO,MAAM,EACX,eAAe,EAGhB,GAAG,CAAC,CAAC,EAAE;QACN,OAAO,IAAI,CAAC,KAAK,CAAC,OAAO,CACtB,wBAAwB,GACxB,MAAM,CAAC,iOAAyB,CAAC,SAAS,CAAC,mBAAmB,EAAE;IACrE;AACF"}},
    {"offset": {"line": 8130, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/local/local-runtime-options.tsx"],"sourcesContent":["import type { ThreadHistoryAdapter } from \"../adapters/thread-history/thread-history-adapter\";\nimport type { AttachmentAdapter } from \"../adapters/attachment/attachment-adapter\";\nimport type { ThreadMessageLike } from \"../external-store\";\nimport type { FeedbackAdapter } from \"../adapters/feedback/feedback-adapter\";\nimport type {\n  SpeechSynthesisAdapter,\n  DictationAdapter,\n} from \"../adapters/speech/speech-adapter-types\";\nimport type { ChatModelAdapter } from \"./chat-model-adapter\";\nimport type { AssistantCloud } from \"assistant-cloud\";\nimport type { SuggestionAdapter } from \"../adapters\";\n\nexport type LocalRuntimeOptionsBase = {\n  maxSteps?: number | undefined;\n  adapters: {\n    chatModel: ChatModelAdapter;\n    history?: ThreadHistoryAdapter | undefined;\n    attachments?: AttachmentAdapter | undefined;\n    speech?: SpeechSynthesisAdapter | undefined;\n    dictation?: DictationAdapter | undefined;\n    feedback?: FeedbackAdapter | undefined;\n    suggestion?: SuggestionAdapter | undefined;\n  };\n\n  /**\n   * Names of tools that are allowed to interrupt the run in order to wait for human/external approval.\n   */\n  unstable_humanToolNames?: string[] | undefined;\n};\n\n// TODO align LocalRuntimeOptions with LocalRuntimeOptionsBase\nexport type LocalRuntimeOptions = Omit<LocalRuntimeOptionsBase, \"adapters\"> & {\n  cloud?: AssistantCloud | undefined;\n  initialMessages?: readonly ThreadMessageLike[] | undefined;\n  adapters?: Omit<LocalRuntimeOptionsBase[\"adapters\"], \"chatModel\"> | undefined;\n};\n\nexport const splitLocalRuntimeOptions = <T extends LocalRuntimeOptions>(\n  options: T,\n) => {\n  const {\n    cloud,\n    initialMessages,\n    maxSteps,\n    adapters,\n    unstable_humanToolNames,\n    ...rest\n  } = options;\n\n  return {\n    localRuntimeOptions: {\n      cloud,\n      initialMessages,\n      maxSteps,\n      adapters,\n      unstable_humanToolNames,\n    },\n    otherOptions: rest,\n  };\n};\n"],"names":[],"mappings":";;;;AAqCO,MAAM,2BAA2B,CACtC;IAEA,MAAM,EACJ,KAAK,EACL,eAAe,EACf,QAAQ,EACR,QAAQ,EACR,uBAAuB,EACvB,GAAG,MACJ,GAAG;IAEJ,OAAO;QACL,qBAAqB;YACnB;YACA;YACA;YACA;YACA;QACF;QACA,cAAc;IAChB;AACF"}},
    {"offset": {"line": 8151, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/legacy-runtime/runtime-cores/assistant-transport/use-tool-invocations.ts"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport {\n  createAssistantStreamController,\n  type ToolCallStreamController,\n  ToolResponse,\n  unstable_toolResultStream,\n  type Tool,\n} from \"assistant-stream\";\nimport type {\n  AssistantTransportCommand,\n  AssistantTransportState,\n} from \"./types\";\nimport {\n  AssistantMetaTransformStream,\n  type ReadonlyJSONValue,\n} from \"assistant-stream/utils\";\n\nconst isArgsTextComplete = (argsText: string) => {\n  try {\n    JSON.parse(argsText);\n    return true;\n  } catch {\n    return false;\n  }\n};\n\ntype UseToolInvocationsParams = {\n  state: AssistantTransportState;\n  getTools: () => Record<string, Tool> | undefined;\n  onResult: (command: AssistantTransportCommand) => void;\n  setToolStatuses: (\n    updater:\n      | Record<string, ToolExecutionStatus>\n      | ((\n          prev: Record<string, ToolExecutionStatus>,\n        ) => Record<string, ToolExecutionStatus>),\n  ) => void;\n};\n\nexport type ToolExecutionStatus =\n  | { type: \"executing\" }\n  | { type: \"interrupt\"; payload: { type: \"human\"; payload: unknown } };\n\nexport function useToolInvocations({\n  state,\n  getTools,\n  onResult,\n  setToolStatuses,\n}: UseToolInvocationsParams) {\n  const lastToolStates = useRef<\n    Record<\n      string,\n      {\n        argsText: string;\n        hasResult: boolean;\n        argsComplete: boolean;\n        controller: ToolCallStreamController;\n      }\n    >\n  >({});\n\n  const humanInputRef = useRef<\n    Map<\n      string,\n      {\n        resolve: (payload: unknown) => void;\n        reject: (reason: unknown) => void;\n      }\n    >\n  >(new Map());\n\n  const acRef = useRef<AbortController>(new AbortController());\n  const executingCountRef = useRef(0);\n  const settledResolversRef = useRef<Array<() => void>>([]);\n\n  const [controller] = useState(() => {\n    const [stream, controller] = createAssistantStreamController();\n    const transform = unstable_toolResultStream(\n      getTools,\n      () => acRef.current?.signal ?? new AbortController().signal,\n      (toolCallId: string, payload: unknown) => {\n        return new Promise<unknown>((resolve, reject) => {\n          // Reject previous human input request if it exists\n          const previous = humanInputRef.current.get(toolCallId);\n          if (previous) {\n            previous.reject(\n              new Error(\"Human input request was superseded by a new request\"),\n            );\n          }\n\n          humanInputRef.current.set(toolCallId, { resolve, reject });\n          setToolStatuses((prev) => ({\n            ...prev,\n            [toolCallId]: {\n              type: \"interrupt\",\n              payload: { type: \"human\", payload },\n            },\n          }));\n        });\n      },\n      {\n        onExecutionStart: (toolCallId: string) => {\n          executingCountRef.current++;\n          setToolStatuses((prev) => ({\n            ...prev,\n            [toolCallId]: { type: \"executing\" },\n          }));\n        },\n        onExecutionEnd: (toolCallId: string) => {\n          executingCountRef.current--;\n          setToolStatuses((prev) => {\n            const next = { ...prev };\n            delete next[toolCallId];\n            return next;\n          });\n          // Resolve any waiting abort promises when all tools have settled\n          if (executingCountRef.current === 0) {\n            settledResolversRef.current.forEach((resolve) => resolve());\n            settledResolversRef.current = [];\n          }\n        },\n      },\n    );\n    stream\n      .pipeThrough(transform)\n      .pipeThrough(new AssistantMetaTransformStream())\n      .pipeTo(\n        new WritableStream({\n          write(chunk) {\n            if (chunk.type === \"result\") {\n              // the tool call result was already set by the backend\n              if (lastToolStates.current[chunk.meta.toolCallId]?.hasResult)\n                return;\n\n              onResult({\n                type: \"add-tool-result\",\n                toolCallId: chunk.meta.toolCallId,\n                toolName: chunk.meta.toolName,\n                result: chunk.result,\n                isError: chunk.isError,\n                ...(chunk.artifact && { artifact: chunk.artifact }),\n              });\n            }\n          },\n        }),\n      );\n\n    return controller;\n  });\n\n  const ignoredToolIds = useRef<Set<string>>(new Set());\n  const isInitialState = useRef(true);\n\n  useEffect(() => {\n    const processMessages = (\n      messages: readonly (typeof state.messages)[number][],\n    ) => {\n      messages.forEach((message) => {\n        message.content.forEach((content) => {\n          if (content.type === \"tool-call\") {\n            if (isInitialState.current) {\n              ignoredToolIds.current.add(content.toolCallId);\n            } else {\n              if (ignoredToolIds.current.has(content.toolCallId)) {\n                return;\n              }\n              let lastState = lastToolStates.current[content.toolCallId];\n              if (!lastState) {\n                const toolCallController = controller.addToolCallPart({\n                  toolName: content.toolName,\n                  toolCallId: content.toolCallId,\n                });\n                lastState = {\n                  argsText: \"\",\n                  hasResult: false,\n                  argsComplete: false,\n                  controller: toolCallController,\n                };\n                lastToolStates.current[content.toolCallId] = lastState;\n              }\n\n              if (content.argsText !== lastState.argsText) {\n                if (lastState.argsComplete) {\n                  if (process.env[\"NODE_ENV\"] !== \"production\") {\n                    console.warn(\n                      \"argsText updated after controller was closed:\",\n                      {\n                        previous: lastState.argsText,\n                        next: content.argsText,\n                      },\n                    );\n                  }\n                } else {\n                  if (!content.argsText.startsWith(lastState.argsText)) {\n                    // Check if this is key reordering (both are complete JSON)\n                    // This happens when transitioning from streaming to complete state\n                    // and the provider returns keys in a different order\n                    if (\n                      isArgsTextComplete(lastState.argsText) &&\n                      isArgsTextComplete(content.argsText)\n                    ) {\n                      lastState.controller.argsText.close();\n                      lastToolStates.current[content.toolCallId] = {\n                        argsText: content.argsText,\n                        hasResult: lastState.hasResult,\n                        argsComplete: true,\n                        controller: lastState.controller,\n                      };\n                      return; // Continue to next content part\n                    }\n                    throw new Error(\n                      `Tool call argsText can only be appended, not updated: ${content.argsText} does not start with ${lastState.argsText}`,\n                    );\n                  }\n\n                  const argsTextDelta = content.argsText.slice(\n                    lastState.argsText.length,\n                  );\n                  lastState.controller.argsText.append(argsTextDelta);\n\n                  const shouldClose = isArgsTextComplete(content.argsText);\n                  if (shouldClose) {\n                    lastState.controller.argsText.close();\n                  }\n\n                  lastToolStates.current[content.toolCallId] = {\n                    argsText: content.argsText,\n                    hasResult: lastState.hasResult,\n                    argsComplete: shouldClose,\n                    controller: lastState.controller,\n                  };\n                }\n              }\n\n              if (content.result !== undefined && !lastState.hasResult) {\n                lastState.controller.setResponse(\n                  new ToolResponse({\n                    result: content.result as ReadonlyJSONValue,\n                    artifact: content.artifact as ReadonlyJSONValue | undefined,\n                    isError: content.isError,\n                  }),\n                );\n                lastState.controller.close();\n\n                lastToolStates.current[content.toolCallId] = {\n                  hasResult: true,\n                  argsComplete: true,\n                  argsText: lastState.argsText,\n                  controller: lastState.controller,\n                };\n              }\n            }\n\n            // Recursively process nested messages\n            if (content.messages) {\n              processMessages(content.messages);\n            }\n          }\n        });\n      });\n    };\n\n    processMessages(state.messages);\n\n    if (isInitialState.current) {\n      isInitialState.current = false;\n    }\n  }, [state, controller]);\n\n  const abort = (): Promise<void> => {\n    humanInputRef.current.forEach(({ reject }) => {\n      reject(new Error(\"Tool execution aborted\"));\n    });\n    humanInputRef.current.clear();\n\n    acRef.current.abort();\n    acRef.current = new AbortController();\n\n    // Return a promise that resolves when all executing tools have settled\n    if (executingCountRef.current === 0) {\n      return Promise.resolve();\n    }\n    return new Promise<void>((resolve) => {\n      settledResolversRef.current.push(resolve);\n    });\n  };\n\n  return {\n    reset: () => {\n      void abort();\n      isInitialState.current = true;\n    },\n    abort,\n    resume: (toolCallId: string, payload: unknown) => {\n      const handlers = humanInputRef.current.get(toolCallId);\n      if (handlers) {\n        humanInputRef.current.delete(toolCallId);\n        setToolStatuses((prev) => ({\n          ...prev,\n          [toolCallId]: { type: \"executing\" },\n        }));\n        handlers.resolve(payload);\n      } else {\n        throw new Error(\n          `Tool call ${toolCallId} is not waiting for human input`,\n        );\n      }\n    },\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8386, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/smooth/index.ts"],"sourcesContent":["\"use client\";\n// TODO createContextStoreHook does not work well with server-side nextjs bundler\n// use client necessary here for now\n\nexport { useSmooth } from \"./use-smooth\";\nexport { useSmoothStatus, withSmoothContextProvider } from \"./smooth-context\";\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 8465, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react-markdown/src/memoization.tsx"],"sourcesContent":["import type { Element } from \"hast\";\nimport { ComponentProps, ComponentType, ElementType, memo } from \"react\";\nimport { CodeHeaderProps, SyntaxHighlighterProps } from \"./overrides/types\";\n\ntype Components = {\n  [Key in Extract<ElementType, string>]?: ComponentType<ComponentProps<Key>>;\n} & {\n  SyntaxHighlighter?:\n    | ComponentType<Omit<SyntaxHighlighterProps, \"node\">>\n    | undefined;\n  CodeHeader?: ComponentType<Omit<CodeHeaderProps, \"node\">> | undefined;\n};\n\nconst areChildrenEqual = (prev: string | unknown, next: string | unknown) => {\n  if (typeof prev === \"string\") return prev === next;\n  return JSON.stringify(prev) === JSON.stringify(next);\n};\n\nexport const areNodesEqual = (\n  prev: Element | undefined,\n  next: Element | undefined,\n) => {\n  if (!prev || !next) return false;\n\n  const excludeMetadata = (props: Element[\"properties\"]) => {\n    const { position, data, ...rest } =\n      (props as Record<string, unknown>) || {};\n    return rest;\n  };\n\n  return (\n    JSON.stringify(excludeMetadata(prev.properties)) ===\n      JSON.stringify(excludeMetadata(next.properties)) &&\n    areChildrenEqual(prev.children, next.children)\n  );\n};\n\nexport const memoCompareNodes = (\n  prev: { node?: Element | undefined },\n  next: { node?: Element | undefined },\n) => {\n  return areNodesEqual(prev.node, next.node);\n};\n\nexport const memoizeMarkdownComponents = (components: Components = {}) => {\n  return Object.fromEntries(\n    Object.entries(components ?? {}).map(([key, value]) => {\n      if (!value) return [key, value];\n\n      const Component = value as ComponentType;\n      const WithoutNode = ({ node, ...props }: { node?: Element }) => {\n        return <Component {...props} />;\n      };\n      return [key, memo(WithoutNode, memoCompareNodes)];\n    }),\n  );\n};\n"],"names":[],"mappings":";;;;;;;;;AACA;;;AAYA,MAAM,mBAAmB,CAAC,MAAwB;IAChD,IAAI,OAAO,SAAS,UAAU,OAAO,SAAS;IAC9C,OAAO,KAAK,SAAS,CAAC,UAAU,KAAK,SAAS,CAAC;AACjD;AAEO,MAAM,gBAAgB,CAC3B,MACA;IAEA,IAAI,CAAC,QAAQ,CAAC,MAAM,OAAO;IAE3B,MAAM,kBAAkB,CAAC;QACvB,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,GAC/B,AAAC,SAAqC,CAAC;QACzC,OAAO;IACT;IAEA,OACE,KAAK,SAAS,CAAC,gBAAgB,KAAK,UAAU,OAC5C,KAAK,SAAS,CAAC,gBAAgB,KAAK,UAAU,MAChD,iBAAiB,KAAK,QAAQ,EAAE,KAAK,QAAQ;AAEjD;AAEO,MAAM,mBAAmB,CAC9B,MACA;IAEA,OAAO,cAAc,KAAK,IAAI,EAAE,KAAK,IAAI;AAC3C;AAEO,MAAM,4BAA4B,CAAC,aAAyB,CAAC,CAAC;IACnE,OAAO,OAAO,WAAW,CACvB,OAAO,OAAO,CAAC,cAAc,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,KAAK,MAAM;QAChD,IAAI,CAAC,OAAO,OAAO;YAAC;YAAK;SAAM;QAE/B,MAAM,YAAY;QAClB,MAAM,cAAc,CAAC,EAAE,IAAI,EAAE,GAAG,OAA2B;YACzD,qBAAO,ubAAC;gBAAW,GAAG,KAAK;;;;;;QAC7B;QACA,OAAO;YAAC;0BAAK,IAAA,sZAAI,EAAC,aAAa;SAAkB;IACnD;AAEJ"}},
    {"offset": {"line": 8518, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react-markdown/src/overrides/PreOverride.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createContext,\n  ComponentPropsWithoutRef,\n  useContext,\n  memo,\n} from \"react\";\nimport { PreComponent } from \"./types\";\nimport { memoCompareNodes } from \"../memoization\";\n\nexport const PreContext = createContext<Omit<\n  ComponentPropsWithoutRef<PreComponent>,\n  \"children\"\n> | null>(null);\n\nexport const useIsMarkdownCodeBlock = () => {\n  return useContext(PreContext) !== null;\n};\n\nconst PreOverrideImpl: PreComponent = ({ children, ...rest }) => {\n  return <PreContext.Provider value={rest}>{children}</PreContext.Provider>;\n};\n\nexport const PreOverride = memo(PreOverrideImpl, memoCompareNodes);\n"],"names":[],"mappings":";;;;;;;;;AAEA;AAOA;AATA;;;;AAWO,MAAM,2BAAa,IAAA,+ZAAa,EAG7B;AAEH,MAAM,yBAAyB;IACpC,OAAO,IAAA,4ZAAU,EAAC,gBAAgB;AACpC;AAEA,MAAM,kBAAgC,CAAC,EAAE,QAAQ,EAAE,GAAG,MAAM;IAC1D,qBAAO,ubAAC,WAAW,QAAQ;QAAC,OAAO;kBAAO;;;;;;AAC5C;AAEO,MAAM,4BAAc,IAAA,sZAAI,EAAC,iBAAiB,wKAAgB"}},
    {"offset": {"line": 8552, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react-markdown/src/overrides/defaultComponents.tsx"],"sourcesContent":["import type { ComponentType, ReactNode } from \"react\";\nimport { PreComponent, CodeComponent, CodeHeaderProps } from \"./types\";\nimport type { Element } from \"hast\";\n\nexport const DefaultPre: PreComponent = ({ node, ...rest }) => (\n  <pre {...rest} />\n);\n\nexport const DefaultCode: CodeComponent = ({ node, ...rest }) => (\n  <code {...rest} />\n);\n\nexport const DefaultCodeBlockContent: ComponentType<{\n  node: Element | undefined;\n  components: { Pre: PreComponent; Code: CodeComponent };\n  code: string | ReactNode | undefined;\n}> = ({ node, components: { Pre, Code }, code }) => (\n  <Pre>\n    <Code node={node}>{code}</Code>\n  </Pre>\n);\n\nexport const DefaultCodeHeader: ComponentType<CodeHeaderProps> = () => null;\n"],"names":[],"mappings":";;;;;;;;;;;;AAIO,MAAM,aAA2B,CAAC,EAAE,IAAI,EAAE,GAAG,MAAM,iBACxD,ubAAC;QAAK,GAAG,IAAI;;;;;;AAGR,MAAM,cAA6B,CAAC,EAAE,IAAI,EAAE,GAAG,MAAM,iBAC1D,ubAAC;QAAM,GAAG,IAAI;;;;;;AAGT,MAAM,0BAIR,CAAC,EAAE,IAAI,EAAE,YAAY,EAAE,GAAG,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,iBAC7C,ubAAC;kBACC,cAAA,ubAAC;YAAK,MAAM;sBAAO;;;;;;;;;;;AAIhB,MAAM,oBAAoD,IAAM"}},
    {"offset": {"line": 8597, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react-markdown/src/overrides/CodeBlock.tsx"],"sourcesContent":["import { ComponentType, FC, useMemo } from \"react\";\n\nimport {\n  CodeComponent,\n  CodeHeaderProps,\n  PreComponent,\n  SyntaxHighlighterProps,\n} from \"./types\";\nimport { DefaultCodeBlockContent } from \"./defaultComponents\";\nimport type { Element } from \"hast\";\n\nexport type CodeBlockProps = {\n  node: Element | undefined;\n  language: string;\n  code: string;\n  components: {\n    Pre: PreComponent;\n    Code: CodeComponent;\n    CodeHeader: ComponentType<CodeHeaderProps>;\n    SyntaxHighlighter: ComponentType<SyntaxHighlighterProps>;\n  };\n};\n\nexport const DefaultCodeBlock: FC<CodeBlockProps> = ({\n  node,\n  components: { Pre, Code, SyntaxHighlighter, CodeHeader },\n  language,\n  code,\n}) => {\n  const components = useMemo(() => ({ Pre, Code }), [Pre, Code]);\n\n  const SH = language ? SyntaxHighlighter : DefaultCodeBlockContent;\n\n  return (\n    <>\n      <CodeHeader node={node} language={language} code={code} />\n      <SH\n        node={node}\n        components={components}\n        language={language ?? \"unknown\"}\n        code={code}\n      />\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;AAAA;AAQA;;;;AAeO,MAAM,mBAAuC,CAAC,EACnD,IAAI,EACJ,YAAY,EAAE,GAAG,EAAE,IAAI,EAAE,iBAAiB,EAAE,UAAU,EAAE,EACxD,QAAQ,EACR,IAAI,EACL;IACC,MAAM,aAAa,IAAA,yZAAO,EAAC,IAAM,CAAC;YAAE;YAAK;QAAK,CAAC,GAAG;QAAC;QAAK;KAAK;IAE7D,MAAM,KAAK,WAAW,oBAAoB,kMAAuB;IAEjE,qBACE;;0BACE,ubAAC;gBAAW,MAAM;gBAAM,UAAU;gBAAU,MAAM;;;;;;0BAClD,ubAAC;gBACC,MAAM;gBACN,YAAY;gBACZ,UAAU,YAAY;gBACtB,MAAM;;;;;;;;AAId"}},
    {"offset": {"line": 8644, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react-markdown/src/overrides/withDefaults.tsx"],"sourcesContent":["import classNames from \"classnames\";\n\nexport const withDefaultProps =\n  <TProps extends { className?: string | undefined }>({\n    className,\n    ...defaultProps\n  }: Partial<TProps>) =>\n  ({ className: classNameProp, ...props }: TProps) => {\n    return {\n      className: classNames(className, classNameProp),\n      ...defaultProps,\n      ...props,\n    } as TProps;\n  };\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,mBACX,CAAoD,EAClD,SAAS,EACT,GAAG,cACa,GAClB,CAAC,EAAE,WAAW,aAAa,EAAE,GAAG,OAAe;QAC7C,OAAO;YACL,WAAW,IAAA,qMAAU,EAAC,WAAW;YACjC,GAAG,YAAY;YACf,GAAG,KAAK;QACV;IACF"}},
    {"offset": {"line": 8661, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react-markdown/src/overrides/CodeOverride.tsx"],"sourcesContent":["import {\n  ComponentPropsWithoutRef,\n  ComponentType,\n  FC,\n  memo,\n  useContext,\n} from \"react\";\nimport { PreContext, useIsMarkdownCodeBlock } from \"./PreOverride\";\nimport {\n  CodeComponent,\n  CodeHeaderProps,\n  PreComponent,\n  SyntaxHighlighterProps,\n} from \"./types\";\nimport { DefaultCodeBlock } from \"./CodeBlock\";\nimport { useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { withDefaultProps } from \"./withDefaults\";\nimport { DefaultCodeBlockContent } from \"./defaultComponents\";\nimport { memoCompareNodes } from \"../memoization\";\n\nconst CodeBlockOverride: FC<CodeOverrideProps> = ({\n  node,\n  components: {\n    Pre,\n    Code,\n    SyntaxHighlighter: FallbackSyntaxHighlighter,\n    CodeHeader: FallbackCodeHeader,\n  },\n  componentsByLanguage = {},\n  children,\n  ...codeProps\n}) => {\n  const preProps = useContext(PreContext)!;\n  const getPreProps = withDefaultProps<any>(preProps);\n  const WrappedPre: PreComponent = useCallbackRef((props) => (\n    <Pre {...getPreProps(props)} />\n  ));\n\n  const getCodeProps = withDefaultProps<any>(codeProps);\n  const WrappedCode: CodeComponent = useCallbackRef((props) => (\n    <Code {...getCodeProps(props)} />\n  ));\n\n  const language = /language-(\\w+)/.exec(codeProps.className || \"\")?.[1] ?? \"\";\n\n  // if the code content is not string (due to rehype plugins), return a default code block\n  if (typeof children !== \"string\") {\n    return (\n      <DefaultCodeBlockContent\n        node={node}\n        components={{ Pre: WrappedPre, Code: WrappedCode }}\n        code={children}\n      />\n    );\n  }\n\n  const SyntaxHighlighter: ComponentType<SyntaxHighlighterProps> =\n    componentsByLanguage[language]?.SyntaxHighlighter ??\n    FallbackSyntaxHighlighter;\n\n  const CodeHeader: ComponentType<CodeHeaderProps> =\n    componentsByLanguage[language]?.CodeHeader ?? FallbackCodeHeader;\n\n  return (\n    <DefaultCodeBlock\n      node={node}\n      components={{\n        Pre: WrappedPre,\n        Code: WrappedCode,\n        SyntaxHighlighter,\n        CodeHeader,\n      }}\n      language={language || \"unknown\"}\n      code={children}\n    />\n  );\n};\n\nexport type CodeOverrideProps = ComponentPropsWithoutRef<CodeComponent> & {\n  components: {\n    Pre: PreComponent;\n    Code: CodeComponent;\n    CodeHeader: ComponentType<CodeHeaderProps>;\n    SyntaxHighlighter: ComponentType<SyntaxHighlighterProps>;\n  };\n  componentsByLanguage?:\n    | Record<\n        string,\n        {\n          CodeHeader?: ComponentType<CodeHeaderProps>;\n          SyntaxHighlighter?: ComponentType<SyntaxHighlighterProps>;\n        }\n      >\n    | undefined;\n};\n\nconst CodeOverrideImpl: FC<CodeOverrideProps> = ({\n  node,\n  components,\n  componentsByLanguage,\n  ...props\n}) => {\n  const isCodeBlock = useIsMarkdownCodeBlock();\n  if (!isCodeBlock) return <components.Code {...props} />;\n  return (\n    <CodeBlockOverride\n      node={node}\n      components={components}\n      componentsByLanguage={componentsByLanguage}\n      {...props}\n    />\n  );\n};\n\nexport const CodeOverride = memo(CodeOverrideImpl, (prev, next) => {\n  const isEqual =\n    prev.components === next.components &&\n    prev.componentsByLanguage === next.componentsByLanguage &&\n    memoCompareNodes(prev, next);\n  return isEqual;\n});\n"],"names":[],"mappings":";;;;;AAAA;AAOA;AAOA;AACA;AACA;AACA;AACA;;;;;;;;;AAEA,MAAM,oBAA2C,CAAC,EAChD,IAAI,EACJ,YAAY,EACV,GAAG,EACH,IAAI,EACJ,mBAAmB,yBAAyB,EAC5C,YAAY,kBAAkB,EAC/B,EACD,uBAAuB,CAAC,CAAC,EACzB,QAAQ,EACR,GAAG,WACJ;IACC,MAAM,WAAW,IAAA,4ZAAU,EAAC,+KAAU;IACtC,MAAM,cAAc,IAAA,sLAAgB,EAAM;IAC1C,MAAM,aAA2B,IAAA,2VAAc,EAAC,CAAC,sBAC/C,ubAAC;YAAK,GAAG,YAAY,MAAM;;;;;;IAG7B,MAAM,eAAe,IAAA,sLAAgB,EAAM;IAC3C,MAAM,cAA6B,IAAA,2VAAc,EAAC,CAAC,sBACjD,ubAAC;YAAM,GAAG,aAAa,MAAM;;;;;;IAG/B,MAAM,WAAW,iBAAiB,IAAI,CAAC,UAAU,SAAS,IAAI,KAAK,CAAC,EAAE,IAAI;IAE1E,yFAAyF;IACzF,IAAI,OAAO,aAAa,UAAU;QAChC,qBACE,ubAAC,kMAAuB;YACtB,MAAM;YACN,YAAY;gBAAE,KAAK;gBAAY,MAAM;YAAY;YACjD,MAAM;;;;;;IAGZ;IAEA,MAAM,oBACJ,oBAAoB,CAAC,SAAS,EAAE,qBAChC;IAEF,MAAM,aACJ,oBAAoB,CAAC,SAAS,EAAE,cAAc;IAEhD,qBACE,ubAAC,mLAAgB;QACf,MAAM;QACN,YAAY;YACV,KAAK;YACL,MAAM;YACN;YACA;QACF;QACA,UAAU,YAAY;QACtB,MAAM;;;;;;AAGZ;AAoBA,MAAM,mBAA0C,CAAC,EAC/C,IAAI,EACJ,UAAU,EACV,oBAAoB,EACpB,GAAG,OACJ;IACC,MAAM,cAAc,IAAA,2LAAsB;IAC1C,IAAI,CAAC,aAAa,qBAAO,ubAAC,WAAW,IAAI;QAAE,GAAG,KAAK;;;;;;IACnD,qBACE,ubAAC;QACC,MAAM;QACN,YAAY;QACZ,sBAAsB;QACrB,GAAG,KAAK;;;;;;AAGf;AAEO,MAAM,6BAAe,IAAA,sZAAI,EAAC,kBAAkB,CAAC,MAAM;IACxD,MAAM,UACJ,KAAK,UAAU,KAAK,KAAK,UAAU,IACnC,KAAK,oBAAoB,KAAK,KAAK,oBAAoB,IACvD,IAAA,wKAAgB,EAAC,MAAM;IACzB,OAAO;AACT"}},
    {"offset": {"line": 8761, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react-markdown/src/primitives/MarkdownText.tsx"],"sourcesContent":["\"use client\";\n\nimport { INTERNAL, useMessagePartText } from \"@creatorem/ai-react\";\nimport {\n  ComponentRef,\n  ElementType,\n  FC,\n  forwardRef,\n  ForwardRefExoticComponent,\n  RefAttributes,\n  useMemo,\n  type ComponentPropsWithoutRef,\n  type ComponentType,\n} from \"react\";\nimport ReactMarkdown, { type Options } from \"react-markdown\";\nimport { SyntaxHighlighterProps, CodeHeaderProps } from \"../overrides/types\";\nimport { PreOverride } from \"../overrides/PreOverride\";\nimport {\n  DefaultPre,\n  DefaultCode,\n  DefaultCodeBlockContent,\n  DefaultCodeHeader,\n} from \"../overrides/defaultComponents\";\nimport { useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { CodeOverride } from \"../overrides/CodeOverride\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport classNames from \"classnames\";\n\nconst { useSmooth, useSmoothStatus, withSmoothContextProvider } = INTERNAL;\n\ntype MarkdownTextPrimitiveElement = ComponentRef<typeof Primitive.div>;\ntype PrimitiveDivProps = ComponentPropsWithoutRef<typeof Primitive.div>;\n\nexport type MarkdownTextPrimitiveProps = Omit<\n  Options,\n  \"components\" | \"children\"\n> & {\n  className?: string | undefined;\n  containerProps?: Omit<PrimitiveDivProps, \"children\" | \"asChild\"> | undefined;\n  containerComponent?: ElementType | undefined;\n  components?:\n    | (NonNullable<Options[\"components\"]> & {\n        SyntaxHighlighter?: ComponentType<SyntaxHighlighterProps> | undefined;\n        CodeHeader?: ComponentType<CodeHeaderProps> | undefined;\n      })\n    | undefined;\n  /**\n   * Language-specific component overrides.\n   * @example { mermaid: { SyntaxHighlighter: MermaidDiagram } }\n   */\n  componentsByLanguage?:\n    | Record<\n        string,\n        {\n          CodeHeader?: ComponentType<CodeHeaderProps> | undefined;\n          SyntaxHighlighter?: ComponentType<SyntaxHighlighterProps> | undefined;\n        }\n      >\n    | undefined;\n  smooth?: boolean | undefined;\n  /**\n   * Function to transform text before markdown processing.\n   */\n  preprocess?: (text: string) => string;\n};\n\nconst MarkdownTextInner: FC<MarkdownTextPrimitiveProps> = ({\n  components: userComponents,\n  componentsByLanguage,\n  smooth = true,\n  preprocess,\n  ...rest\n}) => {\n  const messagePartText = useMessagePartText();\n\n  const processedMessagePart = useMemo(() => {\n    if (!preprocess) return messagePartText;\n\n    return {\n      ...messagePartText,\n      text: preprocess(messagePartText.text),\n    };\n  }, [messagePartText, preprocess]);\n\n  const { text } = useSmooth(processedMessagePart, smooth);\n\n  const {\n    pre = DefaultPre,\n    code = DefaultCode,\n    SyntaxHighlighter = DefaultCodeBlockContent,\n    CodeHeader = DefaultCodeHeader,\n  } = userComponents ?? {};\n  const useCodeOverrideComponents = useMemo(() => {\n    return {\n      Pre: pre,\n      Code: code,\n      SyntaxHighlighter,\n      CodeHeader,\n    };\n  }, [pre, code, SyntaxHighlighter, CodeHeader]);\n  const CodeComponent = useCallbackRef((props) => (\n    <CodeOverride\n      components={useCodeOverrideComponents}\n      componentsByLanguage={componentsByLanguage}\n      {...props}\n    />\n  ));\n\n  const components: Options[\"components\"] = useMemo(() => {\n    const { pre, code, SyntaxHighlighter, CodeHeader, ...componentsRest } =\n      userComponents ?? {};\n    return {\n      ...componentsRest,\n      pre: PreOverride,\n      code: CodeComponent,\n    };\n  }, [CodeComponent, userComponents]);\n\n  return (\n    <ReactMarkdown components={components} {...rest}>\n      {text}\n    </ReactMarkdown>\n  );\n};\n\nconst MarkdownTextPrimitiveImpl: ForwardRefExoticComponent<MarkdownTextPrimitiveProps> &\n  RefAttributes<MarkdownTextPrimitiveElement> = forwardRef<\n  MarkdownTextPrimitiveElement,\n  MarkdownTextPrimitiveProps\n>(\n  (\n    {\n      className,\n      containerProps,\n      containerComponent: Container = \"div\",\n      ...rest\n    },\n    forwardedRef,\n  ) => {\n    const status = useSmoothStatus();\n    return (\n      <Container\n        data-status={status.type}\n        {...containerProps}\n        className={classNames(className, containerProps?.className)}\n        ref={forwardedRef}\n      >\n        <MarkdownTextInner {...rest}></MarkdownTextInner>\n      </Container>\n    );\n  },\n);\n\nMarkdownTextPrimitiveImpl.displayName = \"MarkdownTextPrimitive\";\n\nexport const MarkdownTextPrimitive = withSmoothContextProvider(\n  MarkdownTextPrimitiveImpl,\n);\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AAWA;AAEA;AACA;AAMA;AACA;AAEA;AA1BA;;;;;;;;;;AA4BA,MAAM,EAAE,SAAS,EAAE,eAAe,EAAE,yBAAyB,EAAE,GAAG,oLAAQ;AAsC1E,MAAM,oBAAoD,CAAC,EACzD,YAAY,cAAc,EAC1B,oBAAoB,EACpB,SAAS,IAAI,EACb,UAAU,EACV,GAAG,MACJ;IACC,MAAM,kBAAkB,IAAA,kNAAkB;IAE1C,MAAM,uBAAuB,IAAA,yZAAO,EAAC;QACnC,IAAI,CAAC,YAAY,OAAO;QAExB,OAAO;YACL,GAAG,eAAe;YAClB,MAAM,WAAW,gBAAgB,IAAI;QACvC;IACF,GAAG;QAAC;QAAiB;KAAW;IAEhC,MAAM,EAAE,IAAI,EAAE,GAAG,UAAU,sBAAsB;IAEjD,MAAM,EACJ,MAAM,qLAAU,EAChB,OAAO,sLAAW,EAClB,oBAAoB,kMAAuB,EAC3C,aAAa,4LAAiB,EAC/B,GAAG,kBAAkB,CAAC;IACvB,MAAM,4BAA4B,IAAA,yZAAO,EAAC;QACxC,OAAO;YACL,KAAK;YACL,MAAM;YACN;YACA;QACF;IACF,GAAG;QAAC;QAAK;QAAM;QAAmB;KAAW;IAC7C,MAAM,gBAAgB,IAAA,2VAAc,EAAC,CAAC,sBACpC,ubAAC,kLAAY;YACX,YAAY;YACZ,sBAAsB;YACrB,GAAG,KAAK;;;;;;IAIb,MAAM,aAAoC,IAAA,yZAAO,EAAC;QAChD,MAAM,EAAE,GAAG,EAAE,IAAI,EAAE,iBAAiB,EAAE,UAAU,EAAE,GAAG,gBAAgB,GACnE,kBAAkB,CAAC;QACrB,OAAO;YACL,GAAG,cAAc;YACjB,KAAK,gLAAW;YAChB,MAAM;QACR;IACF,GAAG;QAAC;QAAe;KAAe;IAElC,qBACE,ubAAC,4TAAa;QAAC,YAAY;QAAa,GAAG,IAAI;kBAC5C;;;;;;AAGP;AAEA,MAAM,0CAC0C,IAAA,4ZAAU,EAIxD,CACE,EACE,SAAS,EACT,cAAc,EACd,oBAAoB,YAAY,KAAK,EACrC,GAAG,MACJ,EACD;IAEA,MAAM,SAAS;IACf,qBACE,ubAAC;QACC,eAAa,OAAO,IAAI;QACvB,GAAG,cAAc;QAClB,WAAW,IAAA,qMAAU,EAAC,WAAW,gBAAgB;QACjD,KAAK;kBAEL,cAAA,ubAAC;YAAmB,GAAG,IAAI;;;;;;;;;;;AAGjC;AAGF,0BAA0B,WAAW,GAAG;AAEjC,MAAM,wBAAwB,0BACnC"}},
    {"offset": {"line": 8878, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/reasoning/use-scroll-lock.tsx"],"sourcesContent":["\"use client\";\n\nimport { type RefObject, useCallback, useEffect, useRef } from \"react\";\n\n/**\n * Locks scroll position during collapsible/height animations and hides scrollbar.\n *\n * This utility prevents page jumps when content height changes during animations,\n * providing a smooth user experience. It finds the nearest scrollable ancestor and\n * temporarily locks its scroll position while the animation completes.\n *\n * - Prevents forced reflows: no layout reads, mutations scoped to scrollable parent only\n * - Reactive: only intercepts scroll events when browser actually adjusts\n * - Cleans up automatically after animation duration\n *\n * @param animatedElementRef - Ref to the animated element\n * @param animationDuration - Lock duration in milliseconds\n * @returns Function to activate the scroll lock\n *\n * @example\n * ```tsx\n * const collapsibleRef = useRef<HTMLDivElement>(null);\n * const lockScroll = useScrollLock(collapsibleRef, 200);\n *\n * const handleCollapse = () => {\n *   lockScroll(); // Lock scroll before collapsing\n *   setIsOpen(false);\n * };\n * ```\n */\nexport const useScrollLock = <T extends HTMLElement = HTMLElement>(\n  animatedElementRef: RefObject<T | null>,\n  animationDuration: number,\n) => {\n  const scrollContainerRef = useRef<HTMLElement | null>(null);\n  const cleanupRef = useRef<(() => void) | null>(null);\n\n  useEffect(() => {\n    return () => {\n      cleanupRef.current?.();\n    };\n  }, []);\n\n  const lockScroll = useCallback(() => {\n    cleanupRef.current?.();\n\n    (function findScrollableAncestor() {\n      if (scrollContainerRef.current || !animatedElementRef.current) return;\n\n      let el: HTMLElement | null = animatedElementRef.current;\n      while (el) {\n        const { overflowY } = getComputedStyle(el);\n        if (overflowY === \"scroll\" || overflowY === \"auto\") {\n          scrollContainerRef.current = el;\n          break;\n        }\n        el = el.parentElement;\n      }\n    })();\n\n    const scrollContainer = scrollContainerRef.current;\n    if (!scrollContainer) return;\n\n    const scrollPosition = scrollContainer.scrollTop;\n    const scrollbarWidth = scrollContainer.style.scrollbarWidth;\n\n    scrollContainer.style.scrollbarWidth = \"none\";\n\n    const resetPosition = () => (scrollContainer.scrollTop = scrollPosition);\n    scrollContainer.addEventListener(\"scroll\", resetPosition);\n\n    const timeoutId = setTimeout(() => {\n      scrollContainer.removeEventListener(\"scroll\", resetPosition);\n      scrollContainer.style.scrollbarWidth = scrollbarWidth;\n      cleanupRef.current = null;\n    }, animationDuration);\n\n    cleanupRef.current = () => {\n      clearTimeout(timeoutId);\n      scrollContainer.removeEventListener(\"scroll\", resetPosition);\n      scrollContainer.style.scrollbarWidth = scrollbarWidth;\n    };\n  }, [animationDuration, animatedElementRef]);\n\n  return lockScroll;\n};\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AA8BO,MAAM,gBAAgB,CAC3B,oBACA;IAEA,MAAM,qBAAqB,IAAA,wZAAM,EAAqB;IACtD,MAAM,aAAa,IAAA,wZAAM,EAAsB;IAE/C,IAAA,2ZAAS,EAAC;QACR,OAAO;YACL,WAAW,OAAO;QACpB;IACF,GAAG,EAAE;IAEL,MAAM,aAAa,IAAA,6ZAAW,EAAC;QAC7B,WAAW,OAAO;QAElB,CAAC,SAAS;YACR,IAAI,mBAAmB,OAAO,IAAI,CAAC,mBAAmB,OAAO,EAAE;YAE/D,IAAI,KAAyB,mBAAmB,OAAO;YACvD,MAAO,GAAI;gBACT,MAAM,EAAE,SAAS,EAAE,GAAG,iBAAiB;gBACvC,IAAI,cAAc,YAAY,cAAc,QAAQ;oBAClD,mBAAmB,OAAO,GAAG;oBAC7B;gBACF;gBACA,KAAK,GAAG,aAAa;YACvB;QACF,CAAC;QAED,MAAM,kBAAkB,mBAAmB,OAAO;QAClD,IAAI,CAAC,iBAAiB;QAEtB,MAAM,iBAAiB,gBAAgB,SAAS;QAChD,MAAM,iBAAiB,gBAAgB,KAAK,CAAC,cAAc;QAE3D,gBAAgB,KAAK,CAAC,cAAc,GAAG;QAEvC,MAAM,gBAAgB,IAAO,gBAAgB,SAAS,GAAG;QACzD,gBAAgB,gBAAgB,CAAC,UAAU;QAE3C,MAAM,YAAY,WAAW;YAC3B,gBAAgB,mBAAmB,CAAC,UAAU;YAC9C,gBAAgB,KAAK,CAAC,cAAc,GAAG;YACvC,WAAW,OAAO,GAAG;QACvB,GAAG;QAEH,WAAW,OAAO,GAAG;YACnB,aAAa;YACb,gBAAgB,mBAAmB,CAAC,UAAU;YAC9C,gBAAgB,KAAK,CAAC,cAAc,GAAG;QACzC;IACF,GAAG;QAAC;QAAmB;KAAmB;IAE1C,OAAO;AACT"}},
    {"offset": {"line": 8934, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 8944, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar-more/scope.tsx"],"sourcesContent":["import * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport type { Scope } from \"@radix-ui/react-context\";\n\nexport const useDropdownMenuScope: ReturnType<\n  typeof DropdownMenuPrimitive.createDropdownMenuScope\n> = DropdownMenuPrimitive.createDropdownMenuScope();\n\nexport type ScopedProps<P> = P & { __scopeActionBarMore?: Scope };\n"],"names":[],"mappings":";;;;AAAA;;AAGO,MAAM,uBAET,wZAA6C"}},
    {"offset": {"line": 8955, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar-more/action-bar-more-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { FC } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ActionBarMorePrimitiveRoot {\n  export type Props = DropdownMenuPrimitive.DropdownMenuProps;\n}\n\nexport const ActionBarMorePrimitiveRoot: FC<\n  ActionBarMorePrimitiveRoot.Props\n> = ({\n  __scopeActionBarMore,\n  ...rest\n}: ScopedProps<ActionBarMorePrimitiveRoot.Props>) => {\n  const scope = useDropdownMenuScope(__scopeActionBarMore);\n\n  return <DropdownMenuPrimitive.Root {...scope} {...rest} />;\n};\n\nActionBarMorePrimitiveRoot.displayName = \"ActionBarMorePrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;AAUO,MAAM,6BAET,CAAC,EACH,oBAAoB,EACpB,GAAG,MAC2C;IAC9C,MAAM,QAAQ,IAAA,iMAAoB,EAAC;IAEnC,qBAAO,ubAAC,qYAA0B;QAAE,GAAG,KAAK;QAAG,GAAG,IAAI;;;;;;AACxD;AAEA,2BAA2B,WAAW,GAAG"}},
    {"offset": {"line": 8982, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar-more/action-bar-more-trigger.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ActionBarMorePrimitiveTrigger {\n  export type Element = ComponentRef<typeof DropdownMenuPrimitive.Trigger>;\n  export type Props = ComponentPropsWithoutRef<\n    typeof DropdownMenuPrimitive.Trigger\n  >;\n}\n\nexport const ActionBarMorePrimitiveTrigger = forwardRef<\n  ActionBarMorePrimitiveTrigger.Element,\n  ActionBarMorePrimitiveTrigger.Props\n>(\n  (\n    {\n      __scopeActionBarMore,\n      ...rest\n    }: ScopedProps<ActionBarMorePrimitiveTrigger.Props>,\n    ref,\n  ) => {\n    const scope = useDropdownMenuScope(__scopeActionBarMore);\n\n    return <DropdownMenuPrimitive.Trigger {...scope} {...rest} ref={ref} />;\n  },\n);\n\nActionBarMorePrimitiveTrigger.displayName = \"ActionBarMorePrimitive.Trigger\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,MAAM,8CAAgC,IAAA,4ZAAU,EAIrD,CACE,EACE,oBAAoB,EACpB,GAAG,MAC8C,EACnD;IAEA,MAAM,QAAQ,IAAA,iMAAoB,EAAC;IAEnC,qBAAO,ubAAC,wYAA6B;QAAE,GAAG,KAAK;QAAG,GAAG,IAAI;QAAE,KAAK;;;;;;AAClE;AAGF,8BAA8B,WAAW,GAAG"}},
    {"offset": {"line": 9012, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar-more/action-bar-more-content.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ActionBarMorePrimitiveContent {\n  export type Element = ComponentRef<typeof DropdownMenuPrimitive.Content>;\n  export type Props = ComponentPropsWithoutRef<\n    typeof DropdownMenuPrimitive.Content\n  > & {\n    portalProps?:\n      | ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Portal>\n      | undefined;\n  };\n}\n\nexport const ActionBarMorePrimitiveContent = forwardRef<\n  ActionBarMorePrimitiveContent.Element,\n  ActionBarMorePrimitiveContent.Props\n>(\n  (\n    {\n      __scopeActionBarMore,\n      portalProps,\n      sideOffset = 4,\n      ...props\n    }: ScopedProps<ActionBarMorePrimitiveContent.Props>,\n    forwardedRef,\n  ) => {\n    const scope = useDropdownMenuScope(__scopeActionBarMore);\n\n    return (\n      <DropdownMenuPrimitive.Portal {...scope} {...portalProps}>\n        <DropdownMenuPrimitive.Content\n          {...scope}\n          {...props}\n          ref={forwardedRef}\n          sideOffset={sideOffset}\n        />\n      </DropdownMenuPrimitive.Portal>\n    );\n  },\n);\n\nActionBarMorePrimitiveContent.displayName = \"ActionBarMorePrimitive.Content\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAiBO,MAAM,8CAAgC,IAAA,4ZAAU,EAIrD,CACE,EACE,oBAAoB,EACpB,WAAW,EACX,aAAa,CAAC,EACd,GAAG,OAC8C,EACnD;IAEA,MAAM,QAAQ,IAAA,iMAAoB,EAAC;IAEnC,qBACE,ubAAC,uYAA4B;QAAE,GAAG,KAAK;QAAG,GAAG,WAAW;kBACtD,cAAA,ubAAC,wYAA6B;YAC3B,GAAG,KAAK;YACR,GAAG,KAAK;YACT,KAAK;YACL,YAAY;;;;;;;;;;;AAIpB;AAGF,8BAA8B,WAAW,GAAG"}},
    {"offset": {"line": 9051, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar-more/action-bar-more-item.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ActionBarMorePrimitiveItem {\n  export type Element = ComponentRef<typeof DropdownMenuPrimitive.Item>;\n  export type Props = ComponentPropsWithoutRef<\n    typeof DropdownMenuPrimitive.Item\n  >;\n}\n\nexport const ActionBarMorePrimitiveItem = forwardRef<\n  ActionBarMorePrimitiveItem.Element,\n  ActionBarMorePrimitiveItem.Props\n>(\n  (\n    {\n      __scopeActionBarMore,\n      ...rest\n    }: ScopedProps<ActionBarMorePrimitiveItem.Props>,\n    ref,\n  ) => {\n    const scope = useDropdownMenuScope(__scopeActionBarMore);\n\n    return <DropdownMenuPrimitive.Item {...scope} {...rest} ref={ref} />;\n  },\n);\n\nActionBarMorePrimitiveItem.displayName = \"ActionBarMorePrimitive.Item\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,MAAM,2CAA6B,IAAA,4ZAAU,EAIlD,CACE,EACE,oBAAoB,EACpB,GAAG,MAC2C,EAChD;IAEA,MAAM,QAAQ,IAAA,iMAAoB,EAAC;IAEnC,qBAAO,ubAAC,qYAA0B;QAAE,GAAG,KAAK;QAAG,GAAG,IAAI;QAAE,KAAK;;;;;;AAC/D;AAGF,2BAA2B,WAAW,GAAG"}},
    {"offset": {"line": 9081, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar-more/action-bar-more-separator.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ActionBarMorePrimitiveSeparator {\n  export type Element = ComponentRef<typeof DropdownMenuPrimitive.Separator>;\n  export type Props = ComponentPropsWithoutRef<\n    typeof DropdownMenuPrimitive.Separator\n  >;\n}\n\nexport const ActionBarMorePrimitiveSeparator = forwardRef<\n  ActionBarMorePrimitiveSeparator.Element,\n  ActionBarMorePrimitiveSeparator.Props\n>(\n  (\n    {\n      __scopeActionBarMore,\n      ...rest\n    }: ScopedProps<ActionBarMorePrimitiveSeparator.Props>,\n    ref,\n  ) => {\n    const scope = useDropdownMenuScope(__scopeActionBarMore);\n\n    return <DropdownMenuPrimitive.Separator {...scope} {...rest} ref={ref} />;\n  },\n);\n\nActionBarMorePrimitiveSeparator.displayName =\n  \"ActionBarMorePrimitive.Separator\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,MAAM,gDAAkC,IAAA,4ZAAU,EAIvD,CACE,EACE,oBAAoB,EACpB,GAAG,MACgD,EACrD;IAEA,MAAM,QAAQ,IAAA,iMAAoB,EAAC;IAEnC,qBAAO,ubAAC,0YAA+B;QAAE,GAAG,KAAK;QAAG,GAAG,IAAI;QAAE,KAAK;;;;;;AACpE;AAGF,gCAAgC,WAAW,GACzC"}},
    {"offset": {"line": 9142, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 9156, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/use-action-bar-float-status.tsx"],"sourcesContent":["\"use client\";\n\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nexport enum HideAndFloatStatus {\n  Hidden = \"hidden\",\n  Floating = \"floating\",\n  Normal = \"normal\",\n}\n\nexport type UseActionBarFloatStatusProps = {\n  hideWhenRunning?: boolean | undefined;\n  autohide?: \"always\" | \"not-last\" | \"never\" | undefined;\n  autohideFloat?: \"always\" | \"single-branch\" | \"never\" | undefined;\n};\n\nexport const useActionBarFloatStatus = ({\n  hideWhenRunning,\n  autohide,\n  autohideFloat,\n}: UseActionBarFloatStatusProps) => {\n  return useAuiState(({ thread, message }) => {\n    if (hideWhenRunning && thread.isRunning) return HideAndFloatStatus.Hidden;\n\n    const autohideEnabled =\n      autohide === \"always\" || (autohide === \"not-last\" && !message.isLast);\n\n    // normal status\n    if (!autohideEnabled) return HideAndFloatStatus.Normal;\n\n    // hidden status\n    if (!message.isHovering) return HideAndFloatStatus.Hidden;\n\n    // floating status\n    if (\n      autohideFloat === \"always\" ||\n      (autohideFloat === \"single-branch\" && message.branchCount <= 1)\n    )\n      return HideAndFloatStatus.Floating;\n\n    return HideAndFloatStatus.Normal;\n  });\n};\n"],"names":[],"mappings":";;;;;;AAEA;AAFA;;AAIO,IAAA,AAAK,4CAAA;;;;WAAA;;AAYL,MAAM,0BAA0B,CAAC,EACtC,eAAe,EACf,QAAQ,EACR,aAAa,EACgB;IAC7B,OAAO,IAAA,+JAAW,EAAC,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE;QACrC,IAAI,mBAAmB,OAAO,SAAS,EAAE;QAEzC,MAAM,kBACJ,aAAa,YAAa,aAAa,cAAc,CAAC,QAAQ,MAAM;QAEtE,gBAAgB;QAChB,IAAI,CAAC,iBAAiB;QAEtB,gBAAgB;QAChB,IAAI,CAAC,QAAQ,UAAU,EAAE;QAEzB,kBAAkB;QAClB,IACE,kBAAkB,YACjB,kBAAkB,mBAAmB,QAAQ,WAAW,IAAI,GAE7D;QAEF;IACF;AACF"}},
    {"offset": {"line": 9188, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { type ComponentRef, forwardRef, ComponentPropsWithoutRef } from \"react\";\nimport {\n  useActionBarFloatStatus,\n  HideAndFloatStatus,\n} from \"./use-action-bar-float-status\";\n\ntype PrimitiveDivProps = ComponentPropsWithoutRef<typeof Primitive.div>;\n\nexport namespace ActionBarPrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  export type Props = PrimitiveDivProps & {\n    /**\n     * Whether to hide the action bar when the thread is running.\n     * @default false\n     */\n    hideWhenRunning?: boolean | undefined;\n    /**\n     * Controls when the action bar should automatically hide.\n     * - \"always\": Always hide unless hovered\n     * - \"not-last\": Hide unless this is the last message\n     * - \"never\": Never auto-hide\n     * @default \"never\"\n     */\n    autohide?: \"always\" | \"not-last\" | \"never\" | undefined;\n    /**\n     * Controls floating behavior when auto-hidden.\n     * - \"always\": Always float when hidden\n     * - \"single-branch\": Float only for single-branch messages\n     * - \"never\": Never float\n     * @default \"never\"\n     */\n    autohideFloat?: \"always\" | \"single-branch\" | \"never\" | undefined;\n  };\n}\n\n/**\n * The root container for action bar components.\n *\n * This component provides intelligent visibility and floating behavior for action bars,\n * automatically hiding and showing based on message state, hover status, and configuration.\n * It supports floating mode for better UX when space is limited.\n *\n * @example\n * ```tsx\n * <ActionBarPrimitive.Root\n *   hideWhenRunning={true}\n *   autohide=\"not-last\"\n *   autohideFloat=\"single-branch\"\n * >\n *   <ActionBarPrimitive.Copy />\n *   <ActionBarPrimitive.Edit />\n *   <ActionBarPrimitive.Reload />\n * </ActionBarPrimitive.Root>\n * ```\n */\nexport const ActionBarPrimitiveRoot = forwardRef<\n  ActionBarPrimitiveRoot.Element,\n  ActionBarPrimitiveRoot.Props\n>(({ hideWhenRunning, autohide, autohideFloat, ...rest }, ref) => {\n  const hideAndfloatStatus = useActionBarFloatStatus({\n    hideWhenRunning,\n    autohide,\n    autohideFloat,\n  });\n\n  if (hideAndfloatStatus === HideAndFloatStatus.Hidden) return null;\n\n  return (\n    <Primitive.div\n      {...(hideAndfloatStatus === HideAndFloatStatus.Floating\n        ? { \"data-floating\": \"true\" }\n        : null)}\n      {...rest}\n      ref={ref}\n    />\n  );\n});\n\nActionBarPrimitiveRoot.displayName = \"ActionBarPrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AA0DO,MAAM,uCAAyB,IAAA,4ZAAU,EAG9C,CAAC,EAAE,eAAe,EAAE,QAAQ,EAAE,aAAa,EAAE,GAAG,MAAM,EAAE;IACxD,MAAM,qBAAqB,IAAA,8NAAuB,EAAC;QACjD;QACA;QACA;IACF;IAEA,IAAI,uBAAuB,yNAAkB,CAAC,MAAM,EAAE,OAAO;IAE7D,qBACE,ubAAC,mYAAS,CAAC,GAAG;QACX,GAAI,uBAAuB,yNAAkB,CAAC,QAAQ,GACnD;YAAE,iBAAiB;QAAO,IAC1B,IAAI;QACP,GAAG,IAAI;QACR,KAAK;;;;;;AAGX;AAEA,uBAAuB,WAAW,GAAG"}},
    {"offset": {"line": 9225, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-copy.tsx"],"sourcesContent":["\"use client\";\n\nimport { forwardRef } from \"react\";\nimport { ActionButtonProps } from \"../../utils/create-action-button\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\n/**\n * Hook that provides copy functionality for action bar buttons.\n *\n * This hook returns a callback function that copies message content to the clipboard,\n * or null if copying is not available. It handles both regular message content and\n * composer text when in editing mode.\n *\n * @param options Configuration options\n * @param options.copiedDuration Duration in milliseconds to show the copied state\n * @returns A copy callback function, or null if copying is disabled\n *\n * @example\n * ```tsx\n * function CustomCopyButton() {\n *   const copy = useActionBarPrimitiveCopy({ copiedDuration: 2000 });\n *\n *   return (\n *     <button onClick={copy} disabled={!copy}>\n *       {copy ? \"Copy\" : \"Cannot Copy\"}\n *     </button>\n *   );\n * }\n * ```\n */\nconst useActionBarPrimitiveCopy = ({\n  copiedDuration = 3000,\n}: {\n  copiedDuration?: number | undefined;\n} = {}) => {\n  const aui = useAui();\n  const hasCopyableContent = useAuiState(({ message }) => {\n    return (\n      (message.role !== \"assistant\" || message.status?.type !== \"running\") &&\n      message.parts.some((c) => c.type === \"text\" && c.text.length > 0)\n    );\n  });\n\n  const isEditing = useAuiState(({ composer }) => composer.isEditing);\n  const composerValue = useAuiState(({ composer }) => composer.text);\n\n  const callback = useCallback(() => {\n    const valueToCopy = isEditing ? composerValue : aui.message().getCopyText();\n\n    if (!valueToCopy) return;\n\n    navigator.clipboard.writeText(valueToCopy).then(() => {\n      aui.message().setIsCopied(true);\n      setTimeout(() => aui.message().setIsCopied(false), copiedDuration);\n    });\n  }, [aui, isEditing, composerValue, copiedDuration]);\n\n  if (!hasCopyableContent) return null;\n  return callback;\n};\n\nexport namespace ActionBarPrimitiveCopy {\n  export type Element = HTMLButtonElement;\n  /**\n   * Props for the ActionBarPrimitive.Copy component.\n   * Inherits all button element props and action button functionality.\n   */\n  export type Props = ActionButtonProps<typeof useActionBarPrimitiveCopy>;\n}\n\n/**\n * A button component that copies message content to the clipboard.\n *\n * This component automatically handles copying message text to the clipboard\n * and provides visual feedback through the data-copied attribute. It's disabled\n * when there's no copyable content available.\n *\n * @example\n * ```tsx\n * <ActionBarPrimitive.Copy copiedDuration={2000}>\n *   Copy Message\n * </ActionBarPrimitive.Copy>\n * ```\n */\nexport const ActionBarPrimitiveCopy = forwardRef<\n  ActionBarPrimitiveCopy.Element,\n  ActionBarPrimitiveCopy.Props\n>(({ copiedDuration, onClick, disabled, ...props }, forwardedRef) => {\n  const isCopied = useAuiState(({ message }) => message.isCopied);\n  const callback = useActionBarPrimitiveCopy({ copiedDuration });\n  return (\n    <Primitive.button\n      type=\"button\"\n      {...(isCopied ? { \"data-copied\": \"true\" } : {})}\n      {...props}\n      ref={forwardedRef}\n      disabled={disabled || !callback}\n      onClick={composeEventHandlers(onClick, () => {\n        callback?.();\n      })}\n    />\n  );\n});\n\nActionBarPrimitiveCopy.displayName = \"ActionBarPrimitive.Copy\";\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AAEA;AAAA;AAPA;;;;;;;AASA;;;;;;;;;;;;;;;;;;;;;;;CAuBC,GACD,MAAM,4BAA4B,CAAC,EACjC,iBAAiB,IAAI,EAGtB,GAAG,CAAC,CAAC;IACJ,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,qBAAqB,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE;QACjD,OACE,CAAC,QAAQ,IAAI,KAAK,eAAe,QAAQ,MAAM,EAAE,SAAS,SAAS,KACnE,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,KAAK,UAAU,EAAE,IAAI,CAAC,MAAM,GAAG;IAEnE;IAEA,MAAM,YAAY,IAAA,+JAAW,EAAC,CAAC,EAAE,QAAQ,EAAE,GAAK,SAAS,SAAS;IAClE,MAAM,gBAAgB,IAAA,+JAAW,EAAC,CAAC,EAAE,QAAQ,EAAE,GAAK,SAAS,IAAI;IAEjE,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,MAAM,cAAc,YAAY,gBAAgB,IAAI,OAAO,GAAG,WAAW;QAEzE,IAAI,CAAC,aAAa;QAElB,UAAU,SAAS,CAAC,SAAS,CAAC,aAAa,IAAI,CAAC;YAC9C,IAAI,OAAO,GAAG,WAAW,CAAC;YAC1B,WAAW,IAAM,IAAI,OAAO,GAAG,WAAW,CAAC,QAAQ;QACrD;IACF,GAAG;QAAC;QAAK;QAAW;QAAe;KAAe;IAElD,IAAI,CAAC,oBAAoB,OAAO;IAChC,OAAO;AACT;AAyBO,MAAM,uCAAyB,IAAA,4ZAAU,EAG9C,CAAC,EAAE,cAAc,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IAClD,MAAM,WAAW,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE,GAAK,QAAQ,QAAQ;IAC9D,MAAM,WAAW,0BAA0B;QAAE;IAAe;IAC5D,qBACE,ubAAC,mYAAS,CAAC,MAAM;QACf,MAAK;QACJ,GAAI,WAAW;YAAE,eAAe;QAAO,IAAI,CAAC,CAAC;QAC7C,GAAG,KAAK;QACT,KAAK;QACL,UAAU,YAAY,CAAC;QACvB,SAAS,IAAA,2PAAoB,EAAC,SAAS;YACrC;QACF;;;;;;AAGN;AAEA,uBAAuB,WAAW,GAAG"}},
    {"offset": {"line": 9315, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-reload.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\n/**\n * Hook that provides reload functionality for action bar buttons.\n *\n * This hook returns a callback function that reloads/regenerates the current assistant message,\n * or null if reloading is not available (e.g., thread is running, disabled, or message is not from assistant).\n *\n * @returns A reload callback function, or null if reloading is disabled\n *\n * @example\n * ```tsx\n * function CustomReloadButton() {\n *   const reload = useActionBarReload();\n *\n *   return (\n *     <button onClick={reload} disabled={!reload}>\n *       {reload ? \"Reload Message\" : \"Cannot Reload\"}\n *     </button>\n *   );\n * }\n * ```\n */\nconst useActionBarReload = () => {\n  const aui = useAui();\n\n  const disabled = useAuiState(\n    (s) =>\n      s.thread.isRunning ||\n      s.thread.isDisabled ||\n      s.message.role !== \"assistant\",\n  );\n\n  const callback = useCallback(() => {\n    aui.message().reload();\n  }, [aui]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace ActionBarPrimitiveReload {\n  export type Element = ActionButtonElement;\n  /**\n   * Props for the ActionBarPrimitive.Reload component.\n   * Inherits all button element props and action button functionality.\n   */\n  export type Props = ActionButtonProps<typeof useActionBarReload>;\n}\n\n/**\n * A button component that reloads/regenerates the current assistant message.\n *\n * This component automatically handles reloading the current assistant message\n * and is disabled when reloading is not available (e.g., thread is running,\n * disabled, or message is not from assistant).\n *\n * @example\n * ```tsx\n * <ActionBarPrimitive.Reload>\n *   Reload Message\n * </ActionBarPrimitive.Reload>\n * ```\n */\nexport const ActionBarPrimitiveReload = createActionButton(\n  \"ActionBarPrimitive.Reload\",\n  useActionBarReload,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AAAA;AARA;;;;AAUA;;;;;;;;;;;;;;;;;;;;CAoBC,GACD,MAAM,qBAAqB;IACzB,MAAM,MAAM,IAAA,iJAAM;IAElB,MAAM,WAAW,IAAA,+JAAW,EAC1B,CAAC,IACC,EAAE,MAAM,CAAC,SAAS,IAClB,EAAE,MAAM,CAAC,UAAU,IACnB,EAAE,OAAO,CAAC,IAAI,KAAK;IAGvB,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,OAAO,GAAG,MAAM;IACtB,GAAG;QAAC;KAAI;IAER,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAyBO,MAAM,2BAA2B,IAAA,sLAAkB,EACxD,6BACA"}},
    {"offset": {"line": 9363, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-edit.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\n/**\n * Hook that provides edit functionality for action bar buttons.\n *\n * This hook returns a callback function that starts editing the current message,\n * or null if editing is not available (e.g., already in editing mode).\n *\n * @returns An edit callback function, or null if editing is disabled\n *\n * @example\n * ```tsx\n * function CustomEditButton() {\n *   const edit = useActionBarEdit();\n *\n *   return (\n *     <button onClick={edit} disabled={!edit}>\n *       {edit ? \"Edit Message\" : \"Cannot Edit\"}\n *     </button>\n *   );\n * }\n * ```\n */\nconst useActionBarEdit = () => {\n  const aui = useAui();\n  const disabled = useAuiState(({ composer }) => composer.isEditing);\n\n  const callback = useCallback(() => {\n    aui.composer().beginEdit();\n  }, [aui]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace ActionBarPrimitiveEdit {\n  export type Element = ActionButtonElement;\n  /**\n   * Props for the ActionBarPrimitive.Edit component.\n   * Inherits all button element props and action button functionality.\n   */\n  export type Props = ActionButtonProps<typeof useActionBarEdit>;\n}\n\n/**\n * A button component that starts editing the current message.\n *\n * This component automatically handles starting the edit mode for the current message\n * and is disabled when editing is not available (e.g., already in editing mode).\n *\n * @example\n * ```tsx\n * <ActionBarPrimitive.Edit>\n *   Edit Message\n * </ActionBarPrimitive.Edit>\n * ```\n */\nexport const ActionBarPrimitiveEdit = createActionButton(\n  \"ActionBarPrimitive.Edit\",\n  useActionBarEdit,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AAAA;AARA;;;;AAUA;;;;;;;;;;;;;;;;;;;;CAoBC,GACD,MAAM,mBAAmB;IACvB,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,WAAW,IAAA,+JAAW,EAAC,CAAC,EAAE,QAAQ,EAAE,GAAK,SAAS,SAAS;IAEjE,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,QAAQ,GAAG,SAAS;IAC1B,GAAG;QAAC;KAAI;IAER,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAwBO,MAAM,yBAAyB,IAAA,sLAAkB,EACtD,2BACA"}},
    {"offset": {"line": 9411, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-speak.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\n\nconst useActionBarSpeak = () => {\n  const aui = useAui();\n  const callback = useCallback(async () => {\n    aui.message().speak();\n  }, [aui]);\n\n  const hasSpeakableContent = useAuiState(({ message }) => {\n    return (\n      (message.role !== \"assistant\" || message.status?.type !== \"running\") &&\n      message.parts.some((c) => c.type === \"text\" && c.text.length > 0)\n    );\n  });\n\n  if (!hasSpeakableContent) return null;\n  return callback;\n};\n\nexport namespace ActionBarPrimitiveSpeak {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useActionBarSpeak>;\n}\n\nexport const ActionBarPrimitiveSpeak = createActionButton(\n  \"ActionBarPrimitive.Speak\",\n  useActionBarSpeak,\n);\n"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AACA;AAJA;;;;AAUA,MAAM,oBAAoB;IACxB,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,OAAO,GAAG,KAAK;IACrB,GAAG;QAAC;KAAI;IAER,MAAM,sBAAsB,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE;QAClD,OACE,CAAC,QAAQ,IAAI,KAAK,eAAe,QAAQ,MAAM,EAAE,SAAS,SAAS,KACnE,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,KAAK,UAAU,EAAE,IAAI,CAAC,MAAM,GAAG;IAEnE;IAEA,IAAI,CAAC,qBAAqB,OAAO;IACjC,OAAO;AACT;AAOO,MAAM,0BAA0B,IAAA,sLAAkB,EACvD,4BACA"}},
    {"offset": {"line": 9441, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-stop-speaking.tsx"],"sourcesContent":["\"use client\";\n\nimport { forwardRef } from \"react\";\nimport { ActionButtonProps } from \"../../utils/create-action-button\";\nimport { useEscapeKeydown } from \"@radix-ui/react-use-escape-keydown\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nconst useActionBarStopSpeaking = () => {\n  const aui = useAui();\n  const isSpeaking = useAuiState(({ message }) => message.speech != null);\n\n  const callback = useCallback(() => {\n    aui.message().stopSpeaking();\n  }, [aui]);\n\n  if (!isSpeaking) return null;\n\n  return callback;\n};\n\nexport namespace ActionBarPrimitiveStopSpeaking {\n  export type Element = HTMLButtonElement;\n  export type Props = ActionButtonProps<typeof useActionBarStopSpeaking>;\n}\n\nexport const ActionBarPrimitiveStopSpeaking = forwardRef<\n  ActionBarPrimitiveStopSpeaking.Element,\n  ActionBarPrimitiveStopSpeaking.Props\n>((props, ref) => {\n  const callback = useActionBarStopSpeaking();\n\n  // TODO this stops working if the user is not hovering over an older message\n  useEscapeKeydown((e) => {\n    if (callback) {\n      e.preventDefault();\n      callback();\n    }\n  });\n\n  return (\n    <Primitive.button\n      type=\"button\"\n      disabled={!callback}\n      {...props}\n      ref={ref}\n      onClick={composeEventHandlers(props.onClick, () => {\n        callback?.();\n      })}\n    />\n  );\n});\n\nActionBarPrimitiveStopSpeaking.displayName = \"ActionBarPrimitive.StopSpeaking\";\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AACA;AAEA;AAAA;AARA;;;;;;;;AAUA,MAAM,2BAA2B;IAC/B,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,aAAa,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE,GAAK,QAAQ,MAAM,IAAI;IAElE,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,OAAO,GAAG,YAAY;IAC5B,GAAG;QAAC;KAAI;IAER,IAAI,CAAC,YAAY,OAAO;IAExB,OAAO;AACT;AAOO,MAAM,+CAAiC,IAAA,4ZAAU,EAGtD,CAAC,OAAO;IACR,MAAM,WAAW;IAEjB,4EAA4E;IAC5E,IAAA,iWAAgB,EAAC,CAAC;QAChB,IAAI,UAAU;YACZ,EAAE,cAAc;YAChB;QACF;IACF;IAEA,qBACE,ubAAC,mYAAS,CAAC,MAAM;QACf,MAAK;QACL,UAAU,CAAC;QACV,GAAG,KAAK;QACT,KAAK;QACL,SAAS,IAAA,2PAAoB,EAAC,MAAM,OAAO,EAAE;YAC3C;QACF;;;;;;AAGN;AAEA,+BAA+B,WAAW,GAAG"}},
    {"offset": {"line": 9499, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-feedback-positive.tsx"],"sourcesContent":["\"use client\";\n\nimport { forwardRef, useCallback } from \"react\";\nimport { ActionButtonProps } from \"../../utils/create-action-button\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\n\nconst useActionBarFeedbackPositive = () => {\n  const aui = useAui();\n\n  const callback = useCallback(() => {\n    aui.message().submitFeedback({ type: \"positive\" });\n  }, [aui]);\n\n  return callback;\n};\n\nexport namespace ActionBarPrimitiveFeedbackPositive {\n  export type Element = HTMLButtonElement;\n  export type Props = ActionButtonProps<typeof useActionBarFeedbackPositive>;\n}\n\nexport const ActionBarPrimitiveFeedbackPositive = forwardRef<\n  ActionBarPrimitiveFeedbackPositive.Element,\n  ActionBarPrimitiveFeedbackPositive.Props\n>(({ onClick, disabled, ...props }, forwardedRef) => {\n  const isSubmitted = useAuiState(\n    (s) => s.message.metadata.submittedFeedback?.type === \"positive\",\n  );\n  const callback = useActionBarFeedbackPositive();\n  return (\n    <Primitive.button\n      type=\"button\"\n      {...(isSubmitted ? { \"data-submitted\": \"true\" } : {})}\n      {...props}\n      ref={forwardedRef}\n      disabled={disabled || !callback}\n      onClick={composeEventHandlers(onClick, () => {\n        callback?.();\n      })}\n    />\n  );\n});\n\nActionBarPrimitiveFeedbackPositive.displayName =\n  \"ActionBarPrimitive.FeedbackPositive\";\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AAAA;AACA;AANA;;;;;;AAQA,MAAM,+BAA+B;IACnC,MAAM,MAAM,IAAA,iJAAM;IAElB,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,OAAO,GAAG,cAAc,CAAC;YAAE,MAAM;QAAW;IAClD,GAAG;QAAC;KAAI;IAER,OAAO;AACT;AAOO,MAAM,mDAAqC,IAAA,4ZAAU,EAG1D,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IAClC,MAAM,cAAc,IAAA,+JAAW,EAC7B,CAAC,IAAM,EAAE,OAAO,CAAC,QAAQ,CAAC,iBAAiB,EAAE,SAAS;IAExD,MAAM,WAAW;IACjB,qBACE,ubAAC,mYAAS,CAAC,MAAM;QACf,MAAK;QACJ,GAAI,cAAc;YAAE,kBAAkB;QAAO,IAAI,CAAC,CAAC;QACnD,GAAG,KAAK;QACT,KAAK;QACL,UAAU,YAAY,CAAC;QACvB,SAAS,IAAA,2PAAoB,EAAC,SAAS;YACrC;QACF;;;;;;AAGN;AAEA,mCAAmC,WAAW,GAC5C"}},
    {"offset": {"line": 9551, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-feedback-negative.tsx"],"sourcesContent":["\"use client\";\n\nimport { forwardRef } from \"react\";\nimport { ActionButtonProps } from \"../../utils/create-action-button\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nconst useActionBarFeedbackNegative = () => {\n  const aui = useAui();\n\n  const callback = useCallback(() => {\n    aui.message().submitFeedback({ type: \"negative\" });\n  }, [aui]);\n\n  return callback;\n};\n\nexport namespace ActionBarPrimitiveFeedbackNegative {\n  export type Element = HTMLButtonElement;\n  export type Props = ActionButtonProps<typeof useActionBarFeedbackNegative>;\n}\n\nexport const ActionBarPrimitiveFeedbackNegative = forwardRef<\n  ActionBarPrimitiveFeedbackNegative.Element,\n  ActionBarPrimitiveFeedbackNegative.Props\n>(({ onClick, disabled, ...props }, forwardedRef) => {\n  const isSubmitted = useAuiState(\n    (s) => s.message.metadata.submittedFeedback?.type === \"negative\",\n  );\n  const callback = useActionBarFeedbackNegative();\n  return (\n    <Primitive.button\n      type=\"button\"\n      {...(isSubmitted ? { \"data-submitted\": \"true\" } : {})}\n      {...props}\n      ref={forwardedRef}\n      disabled={disabled || !callback}\n      onClick={composeEventHandlers(onClick, () => {\n        callback?.();\n      })}\n    />\n  );\n});\n\nActionBarPrimitiveFeedbackNegative.displayName =\n  \"ActionBarPrimitive.FeedbackNegative\";\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AAEA;AAAA;AAPA;;;;;;;AASA,MAAM,+BAA+B;IACnC,MAAM,MAAM,IAAA,iJAAM;IAElB,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,OAAO,GAAG,cAAc,CAAC;YAAE,MAAM;QAAW;IAClD,GAAG;QAAC;KAAI;IAER,OAAO;AACT;AAOO,MAAM,mDAAqC,IAAA,4ZAAU,EAG1D,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IAClC,MAAM,cAAc,IAAA,+JAAW,EAC7B,CAAC,IAAM,EAAE,OAAO,CAAC,QAAQ,CAAC,iBAAiB,EAAE,SAAS;IAExD,MAAM,WAAW;IACjB,qBACE,ubAAC,mYAAS,CAAC,MAAM;QACf,MAAK;QACJ,GAAI,cAAc;YAAE,kBAAkB;QAAO,IAAI,CAAC,CAAC;QACnD,GAAG,KAAK;QACT,KAAK;QACL,UAAU,YAAY,CAAC;QACvB,SAAS,IAAA,2PAAoB,EAAC,SAAS;YACrC;QACF;;;;;;AAGN;AAEA,mCAAmC,WAAW,GAC5C"}},
    {"offset": {"line": 9604, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/action-bar/action-bar-export-markdown.tsx"],"sourcesContent":["\"use client\";\n\nimport { forwardRef, useCallback } from \"react\";\nimport { ActionButtonProps } from \"../../utils/create-action-button\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nconst useActionBarExportMarkdown = ({\n  filename,\n  onExport,\n}: {\n  filename?: string | undefined;\n  onExport?: ((content: string) => void | Promise<void>) | undefined;\n} = {}) => {\n  const aui = useAui();\n  const hasExportableContent = useAuiState(({ message }) => {\n    return (\n      (message.role !== \"assistant\" || message.status?.type !== \"running\") &&\n      message.parts.some((c) => c.type === \"text\" && c.text.length > 0)\n    );\n  });\n\n  const callback = useCallback(async () => {\n    const content = aui.message().getCopyText();\n    if (!content) return;\n\n    if (onExport) {\n      await onExport(content);\n      return;\n    }\n\n    const blob = new Blob([content], { type: \"text/markdown\" });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = filename ?? `message-${Date.now()}.md`;\n    a.click();\n    URL.revokeObjectURL(url);\n  }, [aui, filename, onExport]);\n\n  if (!hasExportableContent) return null;\n  return callback;\n};\n\nexport namespace ActionBarPrimitiveExportMarkdown {\n  export type Element = HTMLButtonElement;\n  export type Props = ActionButtonProps<typeof useActionBarExportMarkdown>;\n}\n\nexport const ActionBarPrimitiveExportMarkdown = forwardRef<\n  ActionBarPrimitiveExportMarkdown.Element,\n  ActionBarPrimitiveExportMarkdown.Props\n>(({ filename, onExport, onClick, disabled, ...props }, forwardedRef) => {\n  const callback = useActionBarExportMarkdown({ filename, onExport });\n  return (\n    <Primitive.button\n      type=\"button\"\n      {...props}\n      ref={forwardedRef}\n      disabled={disabled || !callback}\n      onClick={composeEventHandlers(onClick, () => {\n        callback?.();\n      })}\n    />\n  );\n});\n\nActionBarPrimitiveExportMarkdown.displayName =\n  \"ActionBarPrimitive.ExportMarkdown\";\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AACA;AAAA;AANA;;;;;;AAQA,MAAM,6BAA6B,CAAC,EAClC,QAAQ,EACR,QAAQ,EAIT,GAAG,CAAC,CAAC;IACJ,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,uBAAuB,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE;QACnD,OACE,CAAC,QAAQ,IAAI,KAAK,eAAe,QAAQ,MAAM,EAAE,SAAS,SAAS,KACnE,QAAQ,KAAK,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,KAAK,UAAU,EAAE,IAAI,CAAC,MAAM,GAAG;IAEnE;IAEA,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,MAAM,UAAU,IAAI,OAAO,GAAG,WAAW;QACzC,IAAI,CAAC,SAAS;QAEd,IAAI,UAAU;YACZ,MAAM,SAAS;YACf;QACF;QAEA,MAAM,OAAO,IAAI,KAAK;YAAC;SAAQ,EAAE;YAAE,MAAM;QAAgB;QACzD,MAAM,MAAM,IAAI,eAAe,CAAC;QAChC,MAAM,IAAI,SAAS,aAAa,CAAC;QACjC,EAAE,IAAI,GAAG;QACT,EAAE,QAAQ,GAAG,YAAY,CAAC,QAAQ,EAAE,KAAK,GAAG,GAAG,GAAG,CAAC;QACnD,EAAE,KAAK;QACP,IAAI,eAAe,CAAC;IACtB,GAAG;QAAC;QAAK;QAAU;KAAS;IAE5B,IAAI,CAAC,sBAAsB,OAAO;IAClC,OAAO;AACT;AAOO,MAAM,iDAAmC,IAAA,4ZAAU,EAGxD,CAAC,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IACtD,MAAM,WAAW,2BAA2B;QAAE;QAAU;IAAS;IACjE,qBACE,ubAAC,mYAAS,CAAC,MAAM;QACf,MAAK;QACJ,GAAG,KAAK;QACT,KAAK;QACL,UAAU,YAAY,CAAC;QACvB,SAAS,IAAA,2PAAoB,EAAC,SAAS;YACrC;QACF;;;;;;AAGN;AAEA,iCAAiC,WAAW,GAC1C"}},
    {"offset": {"line": 9718, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/aui-if.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC, PropsWithChildren } from \"react\";\nimport { useAuiState } from \"./use-aui-state\";\nimport type { AssistantState } from \"./types/client\";\n\nexport namespace AuiIf {\n  export type Props = PropsWithChildren<{ condition: AuiIf.Condition }>;\n  export type Condition = (state: AssistantState) => boolean;\n}\n\nexport const AuiIf: FC<AuiIf.Props> = ({ children, condition }) => {\n  const result = useAuiState(condition);\n  return result ? children : null;\n};\n\nAuiIf.displayName = \"AuiIf\";\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AAWO,MAAM,QAAyB,CAAC,EAAE,QAAQ,EAAE,SAAS,EAAE;IAC5D,MAAM,SAAS,IAAA,+JAAW,EAAC;IAC3B,OAAO,SAAS,WAAW;AAC7B;AAEA,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 9743, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 9753, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/branch-picker/branch-picker-next.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nconst useBranchPickerNext = () => {\n  const aui = useAui();\n  const disabled = useAuiState(({ thread, message }) => {\n    // Disabled if no next branch\n    if (message.branchNumber >= message.branchCount) return true;\n\n    // Disabled if running and capability not supported\n    if (thread.isRunning && !thread.capabilities.switchBranchDuringRun) {\n      return true;\n    }\n\n    return false;\n  });\n\n  const callback = useCallback(() => {\n    aui.message().switchToBranch({ position: \"next\" });\n  }, [aui]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace BranchPickerPrimitiveNext {\n  export type Element = ActionButtonElement;\n  /**\n   * Props for the BranchPickerPrimitive.Next component.\n   * Inherits all button element props and action button functionality.\n   */\n  export type Props = ActionButtonProps<typeof useBranchPickerNext>;\n}\n\n/**\n * A button component that navigates to the next branch in the message tree.\n *\n * This component automatically handles switching to the next available branch\n * and is disabled when there are no more branches to navigate to.\n *\n * @example\n * ```tsx\n * <BranchPickerPrimitive.Next>\n *   Next \n * </BranchPickerPrimitive.Next>\n * ```\n */\nexport const BranchPickerPrimitiveNext = createActionButton(\n  \"BranchPickerPrimitive.Next\",\n  useBranchPickerNext,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AAAA;AARA;;;;AAUA,MAAM,sBAAsB;IAC1B,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,WAAW,IAAA,+JAAW,EAAC,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE;QAC/C,6BAA6B;QAC7B,IAAI,QAAQ,YAAY,IAAI,QAAQ,WAAW,EAAE,OAAO;QAExD,mDAAmD;QACnD,IAAI,OAAO,SAAS,IAAI,CAAC,OAAO,YAAY,CAAC,qBAAqB,EAAE;YAClE,OAAO;QACT;QAEA,OAAO;IACT;IAEA,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,OAAO,GAAG,cAAc,CAAC;YAAE,UAAU;QAAO;IAClD,GAAG;QAAC;KAAI;IAER,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAwBO,MAAM,4BAA4B,IAAA,sLAAkB,EACzD,8BACA"}},
    {"offset": {"line": 9791, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/branch-picker/branch-picker-previous.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\n/**\n * Hook that provides navigation to the previous branch functionality.\n *\n * This hook returns a callback function that switches to the previous branch\n * in the message branch tree, or null if there is no previous branch available.\n *\n * @returns A previous branch callback function, or null if navigation is disabled\n *\n * @example\n * ```tsx\n * function CustomPreviousButton() {\n *   const previous = useBranchPickerPrevious();\n *\n *   return (\n *     <button onClick={previous} disabled={!previous}>\n *       {previous ? \"Previous Branch\" : \"No Previous Branch\"}\n *     </button>\n *   );\n * }\n * ```\n */\nconst useBranchPickerPrevious = () => {\n  const aui = useAui();\n  const disabled = useAuiState(({ thread, message }) => {\n    // Disabled if no previous branch\n    if (message.branchNumber <= 1) return true;\n\n    // Disabled if running and capability not supported\n    if (thread.isRunning && !thread.capabilities.switchBranchDuringRun) {\n      return true;\n    }\n\n    return false;\n  });\n\n  const callback = useCallback(() => {\n    aui.message().switchToBranch({ position: \"previous\" });\n  }, [aui]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace BranchPickerPrimitivePrevious {\n  export type Element = ActionButtonElement;\n  /**\n   * Props for the BranchPickerPrimitive.Previous component.\n   * Inherits all button element props and action button functionality.\n   */\n  export type Props = ActionButtonProps<typeof useBranchPickerPrevious>;\n}\n\n/**\n * A button component that navigates to the previous branch in the message tree.\n *\n * This component automatically handles switching to the previous available branch\n * and is disabled when there are no previous branches to navigate to.\n *\n * @example\n * ```tsx\n * <BranchPickerPrimitive.Previous>\n *    Previous\n * </BranchPickerPrimitive.Previous>\n * ```\n */\nexport const BranchPickerPrimitivePrevious = createActionButton(\n  \"BranchPickerPrimitive.Previous\",\n  useBranchPickerPrevious,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AAAA;AARA;;;;AAUA;;;;;;;;;;;;;;;;;;;;CAoBC,GACD,MAAM,0BAA0B;IAC9B,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,WAAW,IAAA,+JAAW,EAAC,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE;QAC/C,iCAAiC;QACjC,IAAI,QAAQ,YAAY,IAAI,GAAG,OAAO;QAEtC,mDAAmD;QACnD,IAAI,OAAO,SAAS,IAAI,CAAC,OAAO,YAAY,CAAC,qBAAqB,EAAE;YAClE,OAAO;QACT;QAEA,OAAO;IACT;IAEA,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,IAAI,OAAO,GAAG,cAAc,CAAC;YAAE,UAAU;QAAW;IACtD,GAAG;QAAC;KAAI;IAER,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAwBO,MAAM,gCAAgC,IAAA,sLAAkB,EAC7D,kCACA"}},
    {"offset": {"line": 9849, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/branch-picker/branch-picker-count.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nconst useBranchPickerCount = () => {\n  const branchCount = useAuiState(({ message }) => message.branchCount);\n  return branchCount;\n};\n\nexport namespace BranchPickerPrimitiveCount {\n  /**\n   * Props for the BranchPickerPrimitive.Count component.\n   * This component takes no props.\n   */\n  export type Props = Record<string, never>;\n}\n\n/**\n * A component that displays the total number of branches for the current message.\n *\n * This component renders the branch count as plain text, useful for showing\n * users how many alternative responses are available.\n *\n * @example\n * ```tsx\n * <div>\n *   Branch <BranchPickerPrimitive.Count /> of {totalBranches}\n * </div>\n * ```\n */\nexport const BranchPickerPrimitiveCount: FC<\n  BranchPickerPrimitiveCount.Props\n> = () => {\n  const branchCount = useBranchPickerCount();\n  return <>{branchCount}</>;\n};\n\nBranchPickerPrimitiveCount.displayName = \"BranchPickerPrimitive.Count\";\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAKA,MAAM,uBAAuB;IAC3B,MAAM,cAAc,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE,GAAK,QAAQ,WAAW;IACpE,OAAO;AACT;AAuBO,MAAM,6BAET;IACF,MAAM,cAAc;IACpB,qBAAO;kBAAG;;AACZ;AAEA,2BAA2B,WAAW,GAAG"}},
    {"offset": {"line": 9873, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/branch-picker/branch-picker-number.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nconst useBranchPickerNumber = () => {\n  const branchNumber = useAuiState(({ message }) => message.branchNumber);\n  return branchNumber;\n};\n\nexport namespace BranchPickerPrimitiveNumber {\n  export type Props = Record<string, never>;\n}\n\nexport const BranchPickerPrimitiveNumber: FC<\n  BranchPickerPrimitiveNumber.Props\n> = () => {\n  const branchNumber = useBranchPickerNumber();\n  return <>{branchNumber}</>;\n};\n\nBranchPickerPrimitiveNumber.displayName = \"BranchPickerPrimitive.Number\";\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAKA,MAAM,wBAAwB;IAC5B,MAAM,eAAe,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE,GAAK,QAAQ,YAAY;IACtE,OAAO;AACT;AAMO,MAAM,8BAET;IACF,MAAM,eAAe;IACrB,qBAAO;kBAAG;;AACZ;AAEA,4BAA4B,WAAW,GAAG"}},
    {"offset": {"line": 9906, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/branch-picker/branch-picker-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { type ComponentRef, forwardRef, ComponentPropsWithoutRef } from \"react\";\nimport { If } from \"../message\";\n\nexport namespace BranchPickerPrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.div> & {\n    /**\n     * Whether to hide the branch picker when there's only one branch available.\n     * When true, the component will only render when multiple branches exist.\n     * @default false\n     */\n    hideWhenSingleBranch?: boolean | undefined;\n  };\n}\n\n/**\n * The root container for branch picker components.\n *\n * This component provides a container for branch navigation controls,\n * with optional conditional rendering based on the number of available branches.\n * It integrates with the message branching system to allow users to navigate\n * between different response variations.\n *\n * @example\n * ```tsx\n * <BranchPickerPrimitive.Root hideWhenSingleBranch={true}>\n *   <BranchPickerPrimitive.Previous />\n *   <BranchPickerPrimitive.Count />\n *   <BranchPickerPrimitive.Next />\n * </BranchPickerPrimitive.Root>\n * ```\n */\nexport const BranchPickerPrimitiveRoot = forwardRef<\n  BranchPickerPrimitiveRoot.Element,\n  BranchPickerPrimitiveRoot.Props\n>(({ hideWhenSingleBranch, ...rest }, ref) => {\n  return (\n    <If hasBranches={hideWhenSingleBranch ? true : undefined}>\n      <Primitive.div {...rest} ref={ref} />\n    </If>\n  );\n});\n\nBranchPickerPrimitiveRoot.displayName = \"BranchPickerPrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAmCO,MAAM,0CAA4B,IAAA,4ZAAU,EAGjD,CAAC,EAAE,oBAAoB,EAAE,GAAG,MAAM,EAAE;IACpC,qBACE,ubAAC,qNAAE;QAAC,aAAa,uBAAuB,OAAO;kBAC7C,cAAA,ubAAC,mYAAS,CAAC,GAAG;YAAE,GAAG,IAAI;YAAE,KAAK;;;;;;;;;;;AAGpC;AAEA,0BAA0B,WAAW,GAAG"}},
    {"offset": {"line": 9972, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 9979, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/error/error-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { type ComponentRef, forwardRef, ComponentPropsWithoutRef } from \"react\";\n\nexport namespace ErrorPrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.div>;\n}\n\nexport const ErrorPrimitiveRoot = forwardRef<\n  ErrorPrimitiveRoot.Element,\n  ErrorPrimitiveRoot.Props\n>((props, forwardRef) => {\n  return <Primitive.div role=\"alert\" {...props} ref={forwardRef} />;\n});\n\nErrorPrimitiveRoot.displayName = \"ErrorPrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAUO,MAAM,mCAAqB,IAAA,4ZAAU,EAG1C,CAAC,OAAO;IACR,qBAAO,ubAAC,mYAAS,CAAC,GAAG;QAAC,MAAK;QAAS,GAAG,KAAK;QAAE,KAAK;;;;;;AACrD;AAEA,mBAAmB,WAAW,GAAG"}},
    {"offset": {"line": 10006, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/error/error-message.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { type ComponentRef, forwardRef, ComponentPropsWithoutRef } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nexport namespace ErrorPrimitiveMessage {\n  export type Element = ComponentRef<typeof Primitive.span>;\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.span>;\n}\n\nexport const ErrorPrimitiveMessage = forwardRef<\n  ErrorPrimitiveMessage.Element,\n  ErrorPrimitiveMessage.Props\n>(({ children, ...props }, forwardRef) => {\n  const error = useAuiState(({ message }) => {\n    return message.status?.type === \"incomplete\" &&\n      message.status.reason === \"error\"\n      ? message.status.error\n      : undefined;\n  });\n\n  if (error === undefined) return null;\n\n  return (\n    <Primitive.span {...props} ref={forwardRef}>\n      {children ?? String(error)}\n    </Primitive.span>\n  );\n});\n\nErrorPrimitiveMessage.displayName = \"ErrorPrimitive.Message\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAWO,MAAM,sCAAwB,IAAA,4ZAAU,EAG7C,CAAC,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IACzB,MAAM,QAAQ,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE;QACpC,OAAO,QAAQ,MAAM,EAAE,SAAS,gBAC9B,QAAQ,MAAM,CAAC,MAAM,KAAK,UACxB,QAAQ,MAAM,CAAC,KAAK,GACpB;IACN;IAEA,IAAI,UAAU,WAAW,OAAO;IAEhC,qBACE,ubAAC,mYAAS,CAAC,IAAI;QAAE,GAAG,KAAK;QAAE,KAAK;kBAC7B,YAAY,OAAO;;;;;;AAG1B;AAEA,sBAAsB,WAAW,GAAG"}},
    {"offset": {"line": 10061, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 10078, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { type ComponentRef, forwardRef, ComponentPropsWithoutRef } from \"react\";\n\nexport namespace ThreadPrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  /**\n   * Props for the ThreadPrimitive.Root component.\n   * Accepts all standard div element props.\n   */\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.div>;\n}\n\n/**\n * The root container component for a thread.\n *\n * This component serves as the foundational wrapper for all thread-related components.\n * It provides the basic structure and context needed for thread functionality.\n *\n * @example\n * ```tsx\n * <ThreadPrimitive.Root>\n *   <ThreadPrimitive.Viewport>\n *     <ThreadPrimitive.Messages components={{ Message: MyMessage }} />\n *   </ThreadPrimitive.Viewport>\n * </ThreadPrimitive.Root>\n * ```\n */\nexport const ThreadPrimitiveRoot = forwardRef<\n  ThreadPrimitiveRoot.Element,\n  ThreadPrimitiveRoot.Props\n>((props, ref) => {\n  return <Primitive.div {...props} ref={ref} />;\n});\n\nThreadPrimitiveRoot.displayName = \"ThreadPrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AA6BO,MAAM,oCAAsB,IAAA,4ZAAU,EAG3C,CAAC,OAAO;IACR,qBAAO,ubAAC,mYAAS,CAAC,GAAG;QAAE,GAAG,KAAK;QAAE,KAAK;;;;;;AACxC;AAEA,oBAAoB,WAAW,GAAG"}},
    {"offset": {"line": 10104, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-empty.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC, PropsWithChildren } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nexport namespace ThreadPrimitiveEmpty {\n  export type Props = PropsWithChildren;\n}\n\nexport const ThreadPrimitiveEmpty: FC<ThreadPrimitiveEmpty.Props> = ({\n  children,\n}) => {\n  const empty = useAuiState(\n    ({ thread }) => thread.messages.length === 0 && !thread.isLoading,\n  );\n  return empty ? children : null;\n};\n\nThreadPrimitiveEmpty.displayName = \"ThreadPrimitive.Empty\";\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AASO,MAAM,uBAAuD,CAAC,EACnE,QAAQ,EACT;IACC,MAAM,QAAQ,IAAA,+JAAW,EACvB,CAAC,EAAE,MAAM,EAAE,GAAK,OAAO,QAAQ,CAAC,MAAM,KAAK,KAAK,CAAC,OAAO,SAAS;IAEnE,OAAO,QAAQ,WAAW;AAC5B;AAEA,qBAAqB,WAAW,GAAG"}},
    {"offset": {"line": 10120, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-if.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC, PropsWithChildren } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport type { RequireAtLeastOne } from \"../../utils/require-at-least-one\";\n\ntype ThreadIfFilters = {\n  empty: boolean | undefined;\n  running: boolean | undefined;\n  disabled: boolean | undefined;\n};\n\ntype UseThreadIfProps = RequireAtLeastOne<ThreadIfFilters>;\n\nconst useThreadIf = (props: UseThreadIfProps) => {\n  return useAuiState(({ thread }) => {\n    if (props.empty === true && !thread.isEmpty) return false;\n    if (props.empty === false && thread.isEmpty) return false;\n\n    if (props.running === true && !thread.isRunning) return false;\n    if (props.running === false && thread.isRunning) return false;\n    if (props.disabled === true && !thread.isDisabled) return false;\n    if (props.disabled === false && thread.isDisabled) return false;\n\n    return true;\n  });\n};\n\nexport namespace ThreadPrimitiveIf {\n  export type Props = PropsWithChildren<UseThreadIfProps>;\n}\n\n/**\n * @deprecated Use `<AuiIf condition={({ thread }) => ...} />` instead.\n */\nexport const ThreadPrimitiveIf: FC<ThreadPrimitiveIf.Props> = ({\n  children,\n  ...query\n}) => {\n  const result = useThreadIf(query);\n  return result ? children : null;\n};\n\nThreadPrimitiveIf.displayName = \"ThreadPrimitive.If\";\n"],"names":[],"mappings":";;;;AAGA;AAHA;;AAcA,MAAM,cAAc,CAAC;IACnB,OAAO,IAAA,+JAAW,EAAC,CAAC,EAAE,MAAM,EAAE;QAC5B,IAAI,MAAM,KAAK,KAAK,QAAQ,CAAC,OAAO,OAAO,EAAE,OAAO;QACpD,IAAI,MAAM,KAAK,KAAK,SAAS,OAAO,OAAO,EAAE,OAAO;QAEpD,IAAI,MAAM,OAAO,KAAK,QAAQ,CAAC,OAAO,SAAS,EAAE,OAAO;QACxD,IAAI,MAAM,OAAO,KAAK,SAAS,OAAO,SAAS,EAAE,OAAO;QACxD,IAAI,MAAM,QAAQ,KAAK,QAAQ,CAAC,OAAO,UAAU,EAAE,OAAO;QAC1D,IAAI,MAAM,QAAQ,KAAK,SAAS,OAAO,UAAU,EAAE,OAAO;QAE1D,OAAO;IACT;AACF;AASO,MAAM,oBAAiD,CAAC,EAC7D,QAAQ,EACR,GAAG,OACJ;IACC,MAAM,SAAS,YAAY;IAC3B,OAAO,SAAS,WAAW;AAC7B;AAEA,kBAAkB,WAAW,GAAG"}},
    {"offset": {"line": 10147, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/store/src/use-aui-event.ts"],"sourcesContent":["import { useEffect } from \"react\";\nimport { useEffectEvent } from \"use-effect-event\";\nimport { useAui } from \"./use-aui\";\nimport type {\n  AssistantEventName,\n  AssistantEventCallback,\n  AssistantEventSelector,\n} from \"./types/events\";\nimport { normalizeEventSelector } from \"./types/events\";\n\nexport const useAuiEvent = <TEvent extends AssistantEventName>(\n  selector: AssistantEventSelector<TEvent>,\n  callback: AssistantEventCallback<TEvent>,\n) => {\n  const aui = useAui();\n  const callbackRef = useEffectEvent(callback);\n\n  const { scope, event } = normalizeEventSelector(selector);\n  useEffect(\n    () => aui.on({ scope, event }, callbackRef),\n    [aui, scope, event, callbackRef],\n  );\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AAMA;;;;;AAEO,MAAM,cAAc,CACzB,UACA;IAEA,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,cAAc,IAAA,kQAAc,EAAC;IAEnC,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,IAAA,qKAAsB,EAAC;IAChD,IAAA,2ZAAS,EACP,IAAM,IAAI,EAAE,CAAC;YAAE;YAAO;QAAM,GAAG,cAC/B;QAAC;QAAK;QAAO;QAAO;KAAY;AAEpC"}},
    {"offset": {"line": 10177, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/utils/hooks/use-on-resize-content.tsx"],"sourcesContent":["import { useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { useCallback } from \"react\";\nimport { useManagedRef } from \"./use-managed-ref\";\n\nexport const useOnResizeContent = (callback: () => void) => {\n  const callbackRef = useCallbackRef(callback);\n\n  const refCallback = useCallback(\n    (el: HTMLElement) => {\n      const resizeObserver = new ResizeObserver(() => {\n        callbackRef();\n      });\n\n      const mutationObserver = new MutationObserver((mutations) => {\n        // Filter out style-only attribute mutations to prevent feedback loops\n        // with components like ThreadViewportSlack that write styles in response\n        // to viewport changes\n        const hasRelevantMutation = mutations.some(\n          (m) => m.type !== \"attributes\" || m.attributeName !== \"style\",\n        );\n        if (hasRelevantMutation) {\n          callbackRef();\n        }\n      });\n\n      resizeObserver.observe(el);\n      mutationObserver.observe(el, {\n        childList: true,\n        subtree: true,\n        attributes: true,\n        characterData: true,\n      });\n\n      return () => {\n        resizeObserver.disconnect();\n        mutationObserver.disconnect();\n      };\n    },\n    [callbackRef],\n  );\n\n  return useManagedRef(refCallback);\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,MAAM,qBAAqB,CAAC;IACjC,MAAM,cAAc,IAAA,2VAAc,EAAC;IAEnC,MAAM,cAAc,IAAA,6ZAAW,EAC7B,CAAC;QACC,MAAM,iBAAiB,IAAI,eAAe;YACxC;QACF;QAEA,MAAM,mBAAmB,IAAI,iBAAiB,CAAC;YAC7C,sEAAsE;YACtE,yEAAyE;YACzE,sBAAsB;YACtB,MAAM,sBAAsB,UAAU,IAAI,CACxC,CAAC,IAAM,EAAE,IAAI,KAAK,gBAAgB,EAAE,aAAa,KAAK;YAExD,IAAI,qBAAqB;gBACvB;YACF;QACF;QAEA,eAAe,OAAO,CAAC;QACvB,iBAAiB,OAAO,CAAC,IAAI;YAC3B,WAAW;YACX,SAAS;YACT,YAAY;YACZ,eAAe;QACjB;QAEA,OAAO;YACL,eAAe,UAAU;YACzB,iBAAiB,UAAU;QAC7B;IACF,GACA;QAAC;KAAY;IAGf,OAAO,IAAA,oLAAa,EAAC;AACvB"}},
    {"offset": {"line": 10222, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/use-thread-viewport-auto-scroll.tsx"],"sourcesContent":["\"use client\";\n\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { useCallback, useRef, type RefCallback } from \"react\";\nimport { useAuiEvent } from \"@creatorem/ai-store\";\nimport { useOnResizeContent } from \"../../utils/hooks/use-on-resize-content\";\nimport { useOnScrollToBottom } from \"../../utils/hooks/use-on-scroll-to-bottom\";\nimport { useManagedRef } from \"../../utils/hooks/use-managed-ref\";\nimport { writableStore } from \"../../context/readonly-store\";\nimport { useThreadViewportStore } from \"../../context/react/thread-viewport-context\";\n\nexport namespace useThreadViewportAutoScroll {\n  export type Options = {\n    /**\n     * Whether to automatically scroll to the bottom when new messages are added.\n     * When enabled, the viewport will automatically scroll to show the latest content.\n     *\n     * Default false if `turnAnchor` is \"top\", otherwise defaults to true.\n     */\n    autoScroll?: boolean | undefined;\n\n    /**\n     * Whether to scroll to bottom when a new run starts.\n     *\n     * Defaults to true.\n     */\n    scrollToBottomOnRunStart?: boolean | undefined;\n\n    /**\n     * Whether to scroll to bottom when thread history is first loaded.\n     *\n     * Defaults to true.\n     */\n    scrollToBottomOnInitialize?: boolean | undefined;\n\n    /**\n     * Whether to scroll to bottom when switching to a different thread.\n     *\n     * Defaults to true.\n     */\n    scrollToBottomOnThreadSwitch?: boolean | undefined;\n  };\n}\n\nexport const useThreadViewportAutoScroll = <TElement extends HTMLElement>({\n  autoScroll,\n  scrollToBottomOnRunStart = true,\n  scrollToBottomOnInitialize = true,\n  scrollToBottomOnThreadSwitch = true,\n}: useThreadViewportAutoScroll.Options): RefCallback<TElement> => {\n  const divRef = useRef<TElement>(null);\n\n  const threadViewportStore = useThreadViewportStore();\n  if (autoScroll === undefined) {\n    autoScroll = threadViewportStore.getState().turnAnchor !== \"top\";\n  }\n\n  const lastScrollTop = useRef<number>(0);\n\n  // bug: when ScrollToBottom's button changes its disabled state, the scroll stops\n  // fix: delay the state change until the scroll is done\n  // stores the scroll behavior to reuse during content resize, or null if not scrolling\n  const scrollingToBottomBehaviorRef = useRef<ScrollBehavior | null>(null);\n\n  const scrollToBottom = useCallback((behavior: ScrollBehavior) => {\n    const div = divRef.current;\n    if (!div) return;\n\n    scrollingToBottomBehaviorRef.current = behavior;\n    div.scrollTo({ top: div.scrollHeight, behavior });\n  }, []);\n\n  const handleScroll = () => {\n    const div = divRef.current;\n    if (!div) return;\n\n    const isAtBottom = threadViewportStore.getState().isAtBottom;\n    const newIsAtBottom =\n      Math.abs(div.scrollHeight - div.scrollTop - div.clientHeight) < 1 ||\n      div.scrollHeight <= div.clientHeight;\n\n    if (!newIsAtBottom && lastScrollTop.current < div.scrollTop) {\n      // ignore scroll down\n    } else {\n      if (newIsAtBottom) {\n        scrollingToBottomBehaviorRef.current = null;\n      }\n\n      const shouldUpdate =\n        newIsAtBottom || scrollingToBottomBehaviorRef.current === null;\n\n      if (shouldUpdate && newIsAtBottom !== isAtBottom) {\n        writableStore(threadViewportStore).setState({\n          isAtBottom: newIsAtBottom,\n        });\n      }\n    }\n\n    lastScrollTop.current = div.scrollTop;\n  };\n\n  const resizeRef = useOnResizeContent(() => {\n    const scrollBehavior = scrollingToBottomBehaviorRef.current;\n    if (scrollBehavior) {\n      scrollToBottom(scrollBehavior);\n    } else if (autoScroll && threadViewportStore.getState().isAtBottom) {\n      scrollToBottom(\"instant\");\n    }\n\n    handleScroll();\n  });\n\n  const scrollRef = useManagedRef<HTMLElement>((el) => {\n    el.addEventListener(\"scroll\", handleScroll);\n    return () => {\n      el.removeEventListener(\"scroll\", handleScroll);\n    };\n  });\n\n  useOnScrollToBottom(({ behavior }) => {\n    scrollToBottom(behavior);\n  });\n\n  // autoscroll on run start\n  useAuiEvent(\"thread.runStart\", () => {\n    if (!scrollToBottomOnRunStart) return;\n    scrollingToBottomBehaviorRef.current = \"auto\";\n    requestAnimationFrame(() => {\n      scrollToBottom(\"auto\");\n    });\n  });\n\n  // scroll to bottom instantly when thread history is first loaded\n  useAuiEvent(\"thread.initialize\", () => {\n    if (!scrollToBottomOnInitialize) return;\n    scrollingToBottomBehaviorRef.current = \"instant\";\n    requestAnimationFrame(() => {\n      scrollToBottom(\"instant\");\n    });\n  });\n\n  // scroll to bottom instantly when switching threads\n  useAuiEvent(\"threadListItem.switchedTo\", () => {\n    if (!scrollToBottomOnThreadSwitch) return;\n    scrollingToBottomBehaviorRef.current = \"instant\";\n    requestAnimationFrame(() => {\n      scrollToBottom(\"instant\");\n    });\n  });\n\n  const autoScrollRef = useComposedRefs<TElement>(resizeRef, scrollRef, divRef);\n  return autoScrollRef as RefCallback<TElement>;\n};\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;;;;;;;;;AA4CO,MAAM,8BAA8B,CAA+B,EACxE,UAAU,EACV,2BAA2B,IAAI,EAC/B,6BAA6B,IAAI,EACjC,+BAA+B,IAAI,EACC;IACpC,MAAM,SAAS,IAAA,wZAAM,EAAW;IAEhC,MAAM,sBAAsB,IAAA,uMAAsB;IAClD,IAAI,eAAe,WAAW;QAC5B,aAAa,oBAAoB,QAAQ,GAAG,UAAU,KAAK;IAC7D;IAEA,MAAM,gBAAgB,IAAA,wZAAM,EAAS;IAErC,iFAAiF;IACjF,uDAAuD;IACvD,sFAAsF;IACtF,MAAM,+BAA+B,IAAA,wZAAM,EAAwB;IAEnE,MAAM,iBAAiB,IAAA,6ZAAW,EAAC,CAAC;QAClC,MAAM,MAAM,OAAO,OAAO;QAC1B,IAAI,CAAC,KAAK;QAEV,6BAA6B,OAAO,GAAG;QACvC,IAAI,QAAQ,CAAC;YAAE,KAAK,IAAI,YAAY;YAAE;QAAS;IACjD,GAAG,EAAE;IAEL,MAAM,eAAe;QACnB,MAAM,MAAM,OAAO,OAAO;QAC1B,IAAI,CAAC,KAAK;QAEV,MAAM,aAAa,oBAAoB,QAAQ,GAAG,UAAU;QAC5D,MAAM,gBACJ,KAAK,GAAG,CAAC,IAAI,YAAY,GAAG,IAAI,SAAS,GAAG,IAAI,YAAY,IAAI,KAChE,IAAI,YAAY,IAAI,IAAI,YAAY;QAEtC,IAAI,CAAC,iBAAiB,cAAc,OAAO,GAAG,IAAI,SAAS,EAAE;QAC3D,qBAAqB;QACvB,OAAO;YACL,IAAI,eAAe;gBACjB,6BAA6B,OAAO,GAAG;YACzC;YAEA,MAAM,eACJ,iBAAiB,6BAA6B,OAAO,KAAK;YAE5D,IAAI,gBAAgB,kBAAkB,YAAY;gBAChD,IAAA,yKAAa,EAAC,qBAAqB,QAAQ,CAAC;oBAC1C,YAAY;gBACd;YACF;QACF;QAEA,cAAc,OAAO,GAAG,IAAI,SAAS;IACvC;IAEA,MAAM,YAAY,IAAA,mMAAkB,EAAC;QACnC,MAAM,iBAAiB,6BAA6B,OAAO;QAC3D,IAAI,gBAAgB;YAClB,eAAe;QACjB,OAAO,IAAI,cAAc,oBAAoB,QAAQ,GAAG,UAAU,EAAE;YAClE,eAAe;QACjB;QAEA;IACF;IAEA,MAAM,YAAY,IAAA,oLAAa,EAAc,CAAC;QAC5C,GAAG,gBAAgB,CAAC,UAAU;QAC9B,OAAO;YACL,GAAG,mBAAmB,CAAC,UAAU;QACnC;IACF;IAEA,IAAA,yMAAmB,EAAC,CAAC,EAAE,QAAQ,EAAE;QAC/B,eAAe;IACjB;IAEA,0BAA0B;IAC1B,IAAA,8JAAW,EAAC,mBAAmB;QAC7B,IAAI,CAAC,0BAA0B;QAC/B,6BAA6B,OAAO,GAAG;QACvC,sBAAsB;YACpB,eAAe;QACjB;IACF;IAEA,iEAAiE;IACjE,IAAA,8JAAW,EAAC,qBAAqB;QAC/B,IAAI,CAAC,4BAA4B;QACjC,6BAA6B,OAAO,GAAG;QACvC,sBAAsB;YACpB,eAAe;QACjB;IACF;IAEA,oDAAoD;IACpD,IAAA,8JAAW,EAAC,6BAA6B;QACvC,IAAI,CAAC,8BAA8B;QACnC,6BAA6B,OAAO,GAAG;QACvC,sBAAsB;YACpB,eAAe;QACjB;IACF;IAEA,MAAM,gBAAgB,IAAA,8UAAe,EAAW,WAAW,WAAW;IACtE,OAAO;AACT"}},
    {"offset": {"line": 10332, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-viewport.tsx"],"sourcesContent":["\"use client\";\n\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport {\n  type ComponentRef,\n  forwardRef,\n  ComponentPropsWithoutRef,\n  useCallback,\n} from \"react\";\nimport { useThreadViewportAutoScroll } from \"./use-thread-viewport-auto-scroll\";\nimport { ThreadPrimitiveViewportProvider } from \"../../context/providers/thread-viewport-provider\";\nimport { useSizeHandle } from \"../../utils/hooks/use-size-handle\";\nimport { useThreadViewport } from \"../../context/react/thread-viewport-context\";\n\nexport namespace ThreadPrimitiveViewport {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.div> & {\n    /**\n     * Whether to automatically scroll to the bottom when new messages are added.\n     * When enabled, the viewport will automatically scroll to show the latest content.\n     *\n     * Default false if `turnAnchor` is \"top\", otherwise defaults to true.\n     */\n    autoScroll?: boolean | undefined;\n\n    /**\n     * Controls scroll anchoring behavior for new messages.\n     * - \"bottom\" (default): Messages anchor at the bottom, classic chat behavior.\n     * - \"top\": New user messages anchor at the top of the viewport for a focused reading experience.\n     */\n    turnAnchor?: \"top\" | \"bottom\" | undefined;\n\n    /**\n     * Whether to scroll to bottom when a new run starts.\n     *\n     * Defaults to true.\n     */\n    scrollToBottomOnRunStart?: boolean | undefined;\n\n    /**\n     * Whether to scroll to bottom when thread history is first loaded.\n     *\n     * Defaults to true.\n     */\n    scrollToBottomOnInitialize?: boolean | undefined;\n\n    /**\n     * Whether to scroll to bottom when switching to a different thread.\n     *\n     * Defaults to true.\n     */\n    scrollToBottomOnThreadSwitch?: boolean | undefined;\n  };\n}\n\nconst useViewportSizeRef = () => {\n  const register = useThreadViewport((s) => s.registerViewport);\n  const getHeight = useCallback((el: HTMLElement) => el.clientHeight, []);\n  return useSizeHandle(register, getHeight);\n};\n\nconst ThreadPrimitiveViewportScrollable = forwardRef<\n  ThreadPrimitiveViewport.Element,\n  ThreadPrimitiveViewport.Props\n>(\n  (\n    {\n      autoScroll,\n      scrollToBottomOnRunStart,\n      scrollToBottomOnInitialize,\n      scrollToBottomOnThreadSwitch,\n      children,\n      ...rest\n    },\n    forwardedRef,\n  ) => {\n    const autoScrollRef = useThreadViewportAutoScroll<HTMLDivElement>({\n      autoScroll,\n      scrollToBottomOnRunStart,\n      scrollToBottomOnInitialize,\n      scrollToBottomOnThreadSwitch,\n    });\n    const viewportSizeRef = useViewportSizeRef();\n    const ref = useComposedRefs(forwardedRef, autoScrollRef, viewportSizeRef);\n\n    return (\n      <Primitive.div {...rest} ref={ref}>\n        {children}\n      </Primitive.div>\n    );\n  },\n);\n\nThreadPrimitiveViewportScrollable.displayName =\n  \"ThreadPrimitive.ViewportScrollable\";\n\n/**\n * A scrollable viewport container for thread messages.\n *\n * This component provides a scrollable area for displaying thread messages with\n * automatic scrolling capabilities. It manages the viewport state and provides\n * context for child components to access viewport-related functionality.\n *\n * @example\n * ```tsx\n * <ThreadPrimitive.Viewport turnAnchor=\"top\">\n *   <ThreadPrimitive.Messages components={{ Message: MyMessage }} />\n * </ThreadPrimitive.Viewport>\n * ```\n */\nexport const ThreadPrimitiveViewport = forwardRef<\n  ThreadPrimitiveViewport.Element,\n  ThreadPrimitiveViewport.Props\n>(({ turnAnchor, ...props }, ref) => {\n  return (\n    <ThreadPrimitiveViewportProvider options={{ turnAnchor }}>\n      <ThreadPrimitiveViewportScrollable {...props} ref={ref} />\n    </ThreadPrimitiveViewportProvider>\n  );\n});\n\nThreadPrimitiveViewport.displayName = \"ThreadPrimitive.Viewport\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAMA;AACA;AACA;AACA;AAbA;;;;;;;;;AAwDA,MAAM,qBAAqB;IACzB,MAAM,WAAW,IAAA,kMAAiB,EAAC,CAAC,IAAM,EAAE,gBAAgB;IAC5D,MAAM,YAAY,IAAA,6ZAAW,EAAC,CAAC,KAAoB,GAAG,YAAY,EAAE,EAAE;IACtE,OAAO,IAAA,oLAAa,EAAC,UAAU;AACjC;AAEA,MAAM,kDAAoC,IAAA,4ZAAU,EAIlD,CACE,EACE,UAAU,EACV,wBAAwB,EACxB,0BAA0B,EAC1B,4BAA4B,EAC5B,QAAQ,EACR,GAAG,MACJ,EACD;IAEA,MAAM,gBAAgB,IAAA,+NAA2B,EAAiB;QAChE;QACA;QACA;QACA;IACF;IACA,MAAM,kBAAkB;IACxB,MAAM,MAAM,IAAA,8UAAe,EAAC,cAAc,eAAe;IAEzD,qBACE,ubAAC,mYAAS,CAAC,GAAG;QAAE,GAAG,IAAI;QAAE,KAAK;kBAC3B;;;;;;AAGP;AAGF,kCAAkC,WAAW,GAC3C;AAgBK,MAAM,wCAA0B,IAAA,4ZAAU,EAG/C,CAAC,EAAE,UAAU,EAAE,GAAG,OAAO,EAAE;IAC3B,qBACE,ubAAC,sNAA+B;QAAC,SAAS;YAAE;QAAW;kBACrD,cAAA,ubAAC;YAAmC,GAAG,KAAK;YAAE,KAAK;;;;;;;;;;;AAGzD;AAEA,wBAAwB,WAAW,GAAG"}},
    {"offset": {"line": 10402, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-viewport-footer.tsx"],"sourcesContent":["\"use client\";\n\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport {\n  type ComponentRef,\n  forwardRef,\n  ComponentPropsWithoutRef,\n  useCallback,\n} from \"react\";\nimport { useSizeHandle } from \"../../utils/hooks/use-size-handle\";\nimport { useThreadViewport } from \"../../context/react/thread-viewport-context\";\n\nexport namespace ThreadPrimitiveViewportFooter {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  export type Props = ComponentPropsWithoutRef<typeof Primitive.div>;\n}\n\n/**\n * A footer container that measures its height for scroll calculations.\n *\n * This component measures its height and provides it to the viewport context\n * for use in scroll calculations (e.g., ViewportSlack min-height).\n *\n * Multiple ViewportFooter components can be used - their heights are summed.\n *\n * Typically used with `className=\"sticky bottom-0\"` to keep the footer\n * visible at the bottom of the viewport while scrolling.\n *\n * @example\n * ```tsx\n * <ThreadPrimitive.Viewport>\n *   <ThreadPrimitive.Messages components={{ ... }} />\n *   <ThreadPrimitive.ViewportFooter className=\"sticky bottom-0\">\n *     <Composer />\n *   </ThreadPrimitive.ViewportFooter>\n * </ThreadPrimitive.Viewport>\n * ```\n */\nexport const ThreadPrimitiveViewportFooter = forwardRef<\n  ThreadPrimitiveViewportFooter.Element,\n  ThreadPrimitiveViewportFooter.Props\n>((props, forwardedRef) => {\n  const register = useThreadViewport((s) => s.registerContentInset);\n  const getHeight = useCallback((el: HTMLElement) => {\n    const marginTop = parseFloat(getComputedStyle(el).marginTop) || 0;\n    return el.offsetHeight + marginTop;\n  }, []);\n\n  const resizeRef = useSizeHandle(register, getHeight);\n\n  const ref = useComposedRefs(forwardedRef, resizeRef);\n\n  return <Primitive.div {...props} ref={ref} />;\n});\n\nThreadPrimitiveViewportFooter.displayName = \"ThreadPrimitive.ViewportFooter\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAMA;AACA;AAXA;;;;;;;AAuCO,MAAM,8CAAgC,IAAA,4ZAAU,EAGrD,CAAC,OAAO;IACR,MAAM,WAAW,IAAA,kMAAiB,EAAC,CAAC,IAAM,EAAE,oBAAoB;IAChE,MAAM,YAAY,IAAA,6ZAAW,EAAC,CAAC;QAC7B,MAAM,YAAY,WAAW,iBAAiB,IAAI,SAAS,KAAK;QAChE,OAAO,GAAG,YAAY,GAAG;IAC3B,GAAG,EAAE;IAEL,MAAM,YAAY,IAAA,oLAAa,EAAC,UAAU;IAE1C,MAAM,MAAM,IAAA,8UAAe,EAAC,cAAc;IAE1C,qBAAO,ubAAC,mYAAS,CAAC,GAAG;QAAE,GAAG,KAAK;QAAE,KAAK;;;;;;AACxC;AAEA,8BAA8B,WAAW,GAAG"}},
    {"offset": {"line": 10441, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/providers/message-by-index-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { type FC, type PropsWithChildren } from \"react\";\nimport { useAui, AuiProvider, Derived } from \"@creatorem/ai-store\";\n\nexport const MessageByIndexProvider: FC<\n  PropsWithChildren<{\n    index: number;\n  }>\n> = ({ index, children }) => {\n  const aui = useAui({\n    message: Derived({\n      source: \"thread\",\n      query: { type: \"index\", index },\n      get: (aui) => aui.thread().message({ index }),\n    }),\n    composer: Derived({\n      source: \"message\",\n      query: {},\n      get: (aui) => aui.thread().message({ index }).composer,\n    }),\n  });\n\n  return <AuiProvider value={aui}>{children}</AuiProvider>;\n};\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAAA;AAHA;;;AAKO,MAAM,yBAIT,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE;IACtB,MAAM,MAAM,IAAA,iJAAM,EAAC;QACjB,SAAS,IAAA,8IAAO,EAAC;YACf,QAAQ;YACR,OAAO;gBAAE,MAAM;gBAAS;YAAM;YAC9B,KAAK,CAAC,MAAQ,IAAI,MAAM,GAAG,OAAO,CAAC;oBAAE;gBAAM;QAC7C;QACA,UAAU,IAAA,8IAAO,EAAC;YAChB,QAAQ;YACR,OAAO,CAAC;YACR,KAAK,CAAC,MAAQ,IAAI,MAAM,GAAG,OAAO,CAAC;oBAAE;gBAAM,GAAG,QAAQ;QACxD;IACF;IAEA,qBAAO,ubAAC,kLAAW;QAAC,OAAO;kBAAM;;;;;;AACnC"}},
    {"offset": {"line": 10485, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-messages.tsx"],"sourcesContent":["\"use client\";\n\nimport { type ComponentType, type FC, memo, useMemo } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { MessageByIndexProvider } from \"../../context/providers\";\nimport { ThreadMessage as ThreadMessageType } from \"../../types\";\n\nexport namespace ThreadPrimitiveMessages {\n  export type Props = {\n    /**\n     * Component configuration for rendering different types of messages and composers.\n     *\n     * You can provide either:\n     * 1. A single `Message` component that handles all message types\n     * 2. Specific components for `UserMessage` and `AssistantMessage` (with optional `SystemMessage`)\n     *\n     * Optional edit composer components can be provided to customize the editing experience\n     * for different message types when users edit their messages.\n     */\n    components:\n      | {\n          /** Component used to render all message types */\n          Message: ComponentType;\n          /** Component used when editing any message type */\n          EditComposer?: ComponentType | undefined;\n          /** Component used when editing user messages specifically */\n          UserEditComposer?: ComponentType | undefined;\n          /** Component used when editing assistant messages specifically */\n          AssistantEditComposer?: ComponentType | undefined;\n          /** Component used when editing system messages specifically */\n          SystemEditComposer?: ComponentType | undefined;\n          /** Component used to render user messages specifically */\n          UserMessage?: ComponentType | undefined;\n          /** Component used to render assistant messages specifically */\n          AssistantMessage?: ComponentType | undefined;\n          /** Component used to render system messages specifically */\n          SystemMessage?: ComponentType | undefined;\n        }\n      | {\n          /** Component used to render all message types (fallback) */\n          Message?: ComponentType | undefined;\n          /** Component used when editing any message type */\n          EditComposer?: ComponentType | undefined;\n          /** Component used when editing user messages specifically */\n          UserEditComposer?: ComponentType | undefined;\n          /** Component used when editing assistant messages specifically */\n          AssistantEditComposer?: ComponentType | undefined;\n          /** Component used when editing system messages specifically */\n          SystemEditComposer?: ComponentType | undefined;\n          /** Component used to render user messages */\n          UserMessage: ComponentType;\n          /** Component used to render assistant messages */\n          AssistantMessage: ComponentType;\n          /** Component used to render system messages */\n          SystemMessage?: ComponentType | undefined;\n        };\n  };\n}\n\nconst isComponentsSame = (\n  prev: ThreadPrimitiveMessages.Props[\"components\"],\n  next: ThreadPrimitiveMessages.Props[\"components\"],\n) => {\n  return (\n    prev.Message === next.Message &&\n    prev.EditComposer === next.EditComposer &&\n    prev.UserEditComposer === next.UserEditComposer &&\n    prev.AssistantEditComposer === next.AssistantEditComposer &&\n    prev.SystemEditComposer === next.SystemEditComposer &&\n    prev.UserMessage === next.UserMessage &&\n    prev.AssistantMessage === next.AssistantMessage &&\n    prev.SystemMessage === next.SystemMessage\n  );\n};\n\nconst DEFAULT_SYSTEM_MESSAGE = () => null;\n\nconst getComponent = (\n  components: ThreadPrimitiveMessages.Props[\"components\"],\n  role: ThreadMessageType[\"role\"],\n  isEditing: boolean,\n) => {\n  switch (role) {\n    case \"user\":\n      if (isEditing) {\n        return (\n          components.UserEditComposer ??\n          components.EditComposer ??\n          components.UserMessage ??\n          (components.Message as ComponentType)\n        );\n      } else {\n        return components.UserMessage ?? (components.Message as ComponentType);\n      }\n    case \"assistant\":\n      if (isEditing) {\n        return (\n          components.AssistantEditComposer ??\n          components.EditComposer ??\n          components.AssistantMessage ??\n          (components.Message as ComponentType)\n        );\n      } else {\n        return (\n          components.AssistantMessage ?? (components.Message as ComponentType)\n        );\n      }\n    case \"system\":\n      if (isEditing) {\n        return (\n          components.SystemEditComposer ??\n          components.EditComposer ??\n          components.SystemMessage ??\n          (components.Message as ComponentType)\n        );\n      } else {\n        return components.SystemMessage ?? DEFAULT_SYSTEM_MESSAGE;\n      }\n    default:\n      const _exhaustiveCheck: never = role;\n      throw new Error(`Unknown message role: ${_exhaustiveCheck}`);\n  }\n};\n\ntype ThreadMessageComponentProps = {\n  components: ThreadPrimitiveMessages.Props[\"components\"];\n};\n\nconst ThreadMessageComponent: FC<ThreadMessageComponentProps> = ({\n  components,\n}) => {\n  const role = useAuiState(({ message }) => message.role);\n  const isEditing = useAuiState(({ message }) => message.composer.isEditing);\n  const Component = getComponent(components, role, isEditing);\n\n  return <Component />;\n};\nexport namespace ThreadPrimitiveMessageByIndex {\n  export type Props = {\n    index: number;\n    components: ThreadPrimitiveMessages.Props[\"components\"];\n  };\n}\n\n/**\n * Renders a single message at the specified index in the current thread.\n *\n * This component provides message context for a specific message in the thread\n * and renders it using the provided component configuration.\n *\n * @example\n * ```tsx\n * <ThreadPrimitive.MessageByIndex\n *   index={0}\n *   components={{\n *     UserMessage: MyUserMessage,\n *     AssistantMessage: MyAssistantMessage\n *   }}\n * />\n * ```\n */\nexport const ThreadPrimitiveMessageByIndex: FC<ThreadPrimitiveMessageByIndex.Props> =\n  memo(\n    ({ index, components }) => {\n      return (\n        <MessageByIndexProvider index={index}>\n          <ThreadMessageComponent components={components} />\n        </MessageByIndexProvider>\n      );\n    },\n    (prev, next) =>\n      prev.index === next.index &&\n      isComponentsSame(prev.components, next.components),\n  );\n\nThreadPrimitiveMessageByIndex.displayName = \"ThreadPrimitive.MessageByIndex\";\n\n/**\n * Renders all messages in the current thread using the provided component configuration.\n *\n * This component automatically renders all messages in the thread, providing the appropriate\n * message context for each message. It handles different message types (user, assistant, system)\n * and supports editing mode through the provided edit composer components.\n *\n * @example\n * ```tsx\n * <ThreadPrimitive.Messages\n *   components={{\n *     UserMessage: MyUserMessage,\n *     AssistantMessage: MyAssistantMessage,\n *     EditComposer: MyEditComposer\n *   }}\n * />\n * ```\n */\nexport const ThreadPrimitiveMessagesImpl: FC<ThreadPrimitiveMessages.Props> = ({\n  components,\n}) => {\n  const messagesLength = useAuiState(({ thread }) => thread.messages.length);\n\n  const messageElements = useMemo(() => {\n    if (messagesLength === 0) return null;\n    return Array.from({ length: messagesLength }, (_, index) => (\n      <ThreadPrimitiveMessageByIndex\n        key={index}\n        index={index}\n        components={components}\n      />\n    ));\n  }, [messagesLength, components]);\n\n  return messageElements;\n};\n\nThreadPrimitiveMessagesImpl.displayName = \"ThreadPrimitive.Messages\";\n\nexport const ThreadPrimitiveMessages = memo(\n  ThreadPrimitiveMessagesImpl,\n  (prev, next) => isComponentsSame(prev.components, next.components),\n);\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;AAJA;;;;;AA2DA,MAAM,mBAAmB,CACvB,MACA;IAEA,OACE,KAAK,OAAO,KAAK,KAAK,OAAO,IAC7B,KAAK,YAAY,KAAK,KAAK,YAAY,IACvC,KAAK,gBAAgB,KAAK,KAAK,gBAAgB,IAC/C,KAAK,qBAAqB,KAAK,KAAK,qBAAqB,IACzD,KAAK,kBAAkB,KAAK,KAAK,kBAAkB,IACnD,KAAK,WAAW,KAAK,KAAK,WAAW,IACrC,KAAK,gBAAgB,KAAK,KAAK,gBAAgB,IAC/C,KAAK,aAAa,KAAK,KAAK,aAAa;AAE7C;AAEA,MAAM,yBAAyB,IAAM;AAErC,MAAM,eAAe,CACnB,YACA,MACA;IAEA,OAAQ;QACN,KAAK;YACH,IAAI,WAAW;gBACb,OACE,WAAW,gBAAgB,IAC3B,WAAW,YAAY,IACvB,WAAW,WAAW,IACrB,WAAW,OAAO;YAEvB,OAAO;gBACL,OAAO,WAAW,WAAW,IAAK,WAAW,OAAO;YACtD;QACF,KAAK;YACH,IAAI,WAAW;gBACb,OACE,WAAW,qBAAqB,IAChC,WAAW,YAAY,IACvB,WAAW,gBAAgB,IAC1B,WAAW,OAAO;YAEvB,OAAO;gBACL,OACE,WAAW,gBAAgB,IAAK,WAAW,OAAO;YAEtD;QACF,KAAK;YACH,IAAI,WAAW;gBACb,OACE,WAAW,kBAAkB,IAC7B,WAAW,YAAY,IACvB,WAAW,aAAa,IACvB,WAAW,OAAO;YAEvB,OAAO;gBACL,OAAO,WAAW,aAAa,IAAI;YACrC;QACF;YACE,MAAM,mBAA0B;YAChC,MAAM,IAAI,MAAM,CAAC,sBAAsB,EAAE,kBAAkB;IAC/D;AACF;AAMA,MAAM,yBAA0D,CAAC,EAC/D,UAAU,EACX;IACC,MAAM,OAAO,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE,GAAK,QAAQ,IAAI;IACtD,MAAM,YAAY,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE,GAAK,QAAQ,QAAQ,CAAC,SAAS;IACzE,MAAM,YAAY,aAAa,YAAY,MAAM;IAEjD,qBAAO,ubAAC;;;;;AACV;AAyBO,MAAM,8CACX,IAAA,sZAAI,EACF,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE;IACpB,qBACE,ubAAC,iNAAsB;QAAC,OAAO;kBAC7B,cAAA,ubAAC;YAAuB,YAAY;;;;;;;;;;;AAG1C,GACA,CAAC,MAAM,OACL,KAAK,KAAK,KAAK,KAAK,KAAK,IACzB,iBAAiB,KAAK,UAAU,EAAE,KAAK,UAAU;AAGvD,8BAA8B,WAAW,GAAG;AAoBrC,MAAM,8BAAiE,CAAC,EAC7E,UAAU,EACX;IACC,MAAM,iBAAiB,IAAA,+JAAW,EAAC,CAAC,EAAE,MAAM,EAAE,GAAK,OAAO,QAAQ,CAAC,MAAM;IAEzE,MAAM,kBAAkB,IAAA,yZAAO,EAAC;QAC9B,IAAI,mBAAmB,GAAG,OAAO;QACjC,OAAO,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAe,GAAG,CAAC,GAAG,sBAChD,ubAAC;gBAEC,OAAO;gBACP,YAAY;eAFP;;;;;IAKX,GAAG;QAAC;QAAgB;KAAW;IAE/B,OAAO;AACT;AAEA,4BAA4B,WAAW,GAAG;AAEnC,MAAM,wCAA0B,IAAA,sZAAI,EACzC,6BACA,CAAC,MAAM,OAAS,iBAAiB,KAAK,UAAU,EAAE,KAAK,UAAU"}},
    {"offset": {"line": 10584, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-scroll-to-bottom.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport {\n  useThreadViewport,\n  useThreadViewportStore,\n} from \"../../context/react/thread-viewport-context\";\n\nexport namespace useThreadScrollToBottom {\n  export type Options = {\n    behavior?: ScrollBehavior | undefined;\n  };\n}\n\nconst useThreadScrollToBottom = ({\n  behavior,\n}: useThreadScrollToBottom.Options = {}) => {\n  const isAtBottom = useThreadViewport((s) => s.isAtBottom);\n\n  const threadViewportStore = useThreadViewportStore();\n\n  const handleScrollToBottom = useCallback(() => {\n    threadViewportStore.getState().scrollToBottom({ behavior });\n  }, [threadViewportStore, behavior]);\n\n  if (isAtBottom) return null;\n  return handleScrollToBottom;\n};\n\nexport namespace ThreadPrimitiveScrollToBottom {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useThreadScrollToBottom>;\n}\n\nexport const ThreadPrimitiveScrollToBottom = createActionButton(\n  \"ThreadPrimitive.ScrollToBottom\",\n  useThreadScrollToBottom,\n  [\"behavior\"],\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AARA;;;;AAmBA,MAAM,0BAA0B,CAAC,EAC/B,QAAQ,EACwB,GAAG,CAAC,CAAC;IACrC,MAAM,aAAa,IAAA,kMAAiB,EAAC,CAAC,IAAM,EAAE,UAAU;IAExD,MAAM,sBAAsB,IAAA,uMAAsB;IAElD,MAAM,uBAAuB,IAAA,6ZAAW,EAAC;QACvC,oBAAoB,QAAQ,GAAG,cAAc,CAAC;YAAE;QAAS;IAC3D,GAAG;QAAC;QAAqB;KAAS;IAElC,IAAI,YAAY,OAAO;IACvB,OAAO;AACT;AAOO,MAAM,gCAAgC,IAAA,sLAAkB,EAC7D,kCACA,yBACA;IAAC;CAAW"}},
    {"offset": {"line": 10616, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-suggestion.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useCallback } from \"react\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nconst useThreadSuggestion = ({\n  prompt,\n  send,\n  clearComposer = true,\n  autoSend,\n  method: _method,\n}: {\n  /** The suggestion prompt. */\n  prompt: string;\n\n  /**\n   * When true, automatically sends the message.\n   * When false, replaces or appends the composer text with the suggestion - depending on the value of `clearComposer`.\n   */\n  send?: boolean | undefined;\n\n  /**\n   * Whether to clear the composer after sending.\n   * When send is set to false, determines if composer text is replaced with suggestion (true, default),\n   * or if it's appended to the composer text (false).\n   *\n   * @default true\n   */\n  clearComposer?: boolean | undefined;\n\n  /** @deprecated Use `send` instead. */\n  autoSend?: boolean | undefined;\n\n  /** @deprecated Use `clearComposer` instead. */\n  method?: \"replace\";\n}) => {\n  const aui = useAui();\n  const disabled = useAuiState(({ thread }) => thread.isDisabled);\n\n  // ========== Deprecation Mapping ==========\n  const resolvedSend = send ?? autoSend ?? false;\n  // ==========================================\n\n  const callback = useCallback(() => {\n    const isRunning = aui.thread().getState().isRunning;\n\n    if (resolvedSend && !isRunning) {\n      aui.thread().append(prompt);\n      if (clearComposer) {\n        aui.composer().setText(\"\");\n      }\n    } else {\n      if (clearComposer) {\n        aui.composer().setText(prompt);\n      } else {\n        const currentText = aui.composer().getState().text;\n        aui\n          .composer()\n          .setText(currentText.trim() ? `${currentText} ${prompt}` : prompt);\n      }\n    }\n  }, [aui, resolvedSend, clearComposer, prompt]);\n\n  if (disabled) return null;\n  return callback;\n};\n\nexport namespace ThreadPrimitiveSuggestion {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useThreadSuggestion>;\n}\n\nexport const ThreadPrimitiveSuggestion = createActionButton(\n  \"ThreadPrimitive.Suggestion\",\n  useThreadSuggestion,\n  [\"prompt\", \"send\", \"clearComposer\", \"autoSend\", \"method\"],\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AAAA;AARA;;;;AAUA,MAAM,sBAAsB,CAAC,EAC3B,MAAM,EACN,IAAI,EACJ,gBAAgB,IAAI,EACpB,QAAQ,EACR,QAAQ,OAAO,EAyBhB;IACC,MAAM,MAAM,IAAA,iJAAM;IAClB,MAAM,WAAW,IAAA,+JAAW,EAAC,CAAC,EAAE,MAAM,EAAE,GAAK,OAAO,UAAU;IAE9D,4CAA4C;IAC5C,MAAM,eAAe,QAAQ,YAAY;IACzC,6CAA6C;IAE7C,MAAM,WAAW,IAAA,6ZAAW,EAAC;QAC3B,MAAM,YAAY,IAAI,MAAM,GAAG,QAAQ,GAAG,SAAS;QAEnD,IAAI,gBAAgB,CAAC,WAAW;YAC9B,IAAI,MAAM,GAAG,MAAM,CAAC;YACpB,IAAI,eAAe;gBACjB,IAAI,QAAQ,GAAG,OAAO,CAAC;YACzB;QACF,OAAO;YACL,IAAI,eAAe;gBACjB,IAAI,QAAQ,GAAG,OAAO,CAAC;YACzB,OAAO;gBACL,MAAM,cAAc,IAAI,QAAQ,GAAG,QAAQ,GAAG,IAAI;gBAClD,IACG,QAAQ,GACR,OAAO,CAAC,YAAY,IAAI,KAAK,GAAG,YAAY,CAAC,EAAE,QAAQ,GAAG;YAC/D;QACF;IACF,GAAG;QAAC;QAAK;QAAc;QAAe;KAAO;IAE7C,IAAI,UAAU,OAAO;IACrB,OAAO;AACT;AAOO,MAAM,4BAA4B,IAAA,sLAAkB,EACzD,8BACA,qBACA;IAAC;IAAU;IAAQ;IAAiB;IAAY;CAAS"}},
    {"offset": {"line": 10669, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/providers/suggestion-by-index-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { type FC, type PropsWithChildren } from \"react\";\nimport { AuiProvider, Derived, useAui } from \"@creatorem/ai-store\";\n\nexport type SuggestionByIndexProviderProps = PropsWithChildren<{\n  index: number;\n}>;\n\nexport const SuggestionByIndexProvider: FC<SuggestionByIndexProviderProps> = ({\n  index,\n  children,\n}) => {\n  const aui = useAui({\n    suggestion: Derived({\n      source: \"suggestions\",\n      query: { index },\n      get: (aui) => aui.suggestions().suggestion({ index }),\n    }),\n  });\n\n  return <AuiProvider value={aui}>{children}</AuiProvider>;\n};\n"],"names":[],"mappings":";;;;;AAGA;AAAA;AAAA;AAHA;;;AASO,MAAM,4BAAgE,CAAC,EAC5E,KAAK,EACL,QAAQ,EACT;IACC,MAAM,MAAM,IAAA,iJAAM,EAAC;QACjB,YAAY,IAAA,8IAAO,EAAC;YAClB,QAAQ;YACR,OAAO;gBAAE;YAAM;YACf,KAAK,CAAC,MAAQ,IAAI,WAAW,GAAG,UAAU,CAAC;oBAAE;gBAAM;QACrD;IACF;IAEA,qBAAO,ubAAC,kLAAW;QAAC,OAAO;kBAAM;;;;;;AACnC"}},
    {"offset": {"line": 10705, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread/thread-suggestions.tsx"],"sourcesContent":["\"use client\";\n\nimport { type ComponentType, type FC, memo, useMemo } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { SuggestionByIndexProvider } from \"../../context/providers\";\n\nexport namespace ThreadPrimitiveSuggestions {\n  export type Props = {\n    /**\n     * Component to render for each suggestion.\n     */\n    components: {\n      /** Component used to render each suggestion */\n      Suggestion: ComponentType;\n    };\n  };\n}\n\ntype SuggestionComponentProps = {\n  components: ThreadPrimitiveSuggestions.Props[\"components\"];\n};\n\nconst SuggestionComponent: FC<SuggestionComponentProps> = ({ components }) => {\n  const Component = components.Suggestion;\n  return <Component />;\n};\n\nexport namespace ThreadPrimitiveSuggestionByIndex {\n  export type Props = {\n    index: number;\n    components: ThreadPrimitiveSuggestions.Props[\"components\"];\n  };\n}\n\n/**\n * Renders a single suggestion at the specified index.\n *\n * This component provides suggestion context for a specific suggestion\n * and renders it using the provided component configuration.\n *\n * @example\n * ```tsx\n * <ThreadPrimitive.SuggestionByIndex\n *   index={0}\n *   components={{\n *     Suggestion: MySuggestion\n *   }}\n * />\n * ```\n */\nexport const ThreadPrimitiveSuggestionByIndex: FC<ThreadPrimitiveSuggestionByIndex.Props> =\n  memo(\n    ({ index, components }) => {\n      return (\n        <SuggestionByIndexProvider index={index}>\n          <SuggestionComponent components={components} />\n        </SuggestionByIndexProvider>\n      );\n    },\n    (prev, next) =>\n      prev.index === next.index &&\n      prev.components.Suggestion === next.components.Suggestion,\n  );\n\nThreadPrimitiveSuggestionByIndex.displayName =\n  \"ThreadPrimitive.SuggestionByIndex\";\n\n/**\n * Renders all suggestions using the provided component configuration.\n *\n * This component automatically renders all suggestions from the suggestions scope,\n * providing the appropriate suggestion context for each one.\n *\n * @example\n * ```tsx\n * <ThreadPrimitive.Suggestions\n *   components={{\n *     Suggestion: MySuggestion\n *   }}\n * />\n * ```\n */\nexport const ThreadPrimitiveSuggestionsImpl: FC<\n  ThreadPrimitiveSuggestions.Props\n> = ({ components }) => {\n  const suggestionsLength = useAuiState(\n    ({ suggestions }) => suggestions.suggestions.length,\n  );\n\n  const suggestionElements = useMemo(() => {\n    if (suggestionsLength === 0) return null;\n    return Array.from({ length: suggestionsLength }, (_, index) => (\n      <ThreadPrimitiveSuggestionByIndex\n        key={index}\n        index={index}\n        components={components}\n      />\n    ));\n  }, [suggestionsLength, components]);\n\n  return suggestionElements;\n};\n\nThreadPrimitiveSuggestionsImpl.displayName = \"ThreadPrimitive.Suggestions\";\n\nexport const ThreadPrimitiveSuggestions = memo(\n  ThreadPrimitiveSuggestionsImpl,\n  (prev, next) => prev.components.Suggestion === next.components.Suggestion,\n);\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAsBA,MAAM,sBAAoD,CAAC,EAAE,UAAU,EAAE;IACvE,MAAM,YAAY,WAAW,UAAU;IACvC,qBAAO,ubAAC;;;;;AACV;AAyBO,MAAM,iDACX,IAAA,sZAAI,EACF,CAAC,EAAE,KAAK,EAAE,UAAU,EAAE;IACpB,qBACE,ubAAC,uNAAyB;QAAC,OAAO;kBAChC,cAAA,ubAAC;YAAoB,YAAY;;;;;;;;;;;AAGvC,GACA,CAAC,MAAM,OACL,KAAK,KAAK,KAAK,KAAK,KAAK,IACzB,KAAK,UAAU,CAAC,UAAU,KAAK,KAAK,UAAU,CAAC,UAAU;AAG/D,iCAAiC,WAAW,GAC1C;AAiBK,MAAM,iCAET,CAAC,EAAE,UAAU,EAAE;IACjB,MAAM,oBAAoB,IAAA,+JAAW,EACnC,CAAC,EAAE,WAAW,EAAE,GAAK,YAAY,WAAW,CAAC,MAAM;IAGrD,MAAM,qBAAqB,IAAA,yZAAO,EAAC;QACjC,IAAI,sBAAsB,GAAG,OAAO;QACpC,OAAO,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAkB,GAAG,CAAC,GAAG,sBACnD,ubAAC;gBAEC,OAAO;gBACP,YAAY;eAFP;;;;;IAKX,GAAG;QAAC;QAAmB;KAAW;IAElC,OAAO;AACT;AAEA,+BAA+B,WAAW,GAAG;AAEtC,MAAM,2CAA6B,IAAA,sZAAI,EAC5C,gCACA,CAAC,MAAM,OAAS,KAAK,UAAU,CAAC,UAAU,KAAK,KAAK,UAAU,CAAC,UAAU"}},
    {"offset": {"line": 10826, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 10836, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item-more/scope.tsx"],"sourcesContent":["import * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport type { Scope } from \"@radix-ui/react-context\";\n\nexport const useDropdownMenuScope: ReturnType<\n  typeof DropdownMenuPrimitive.createDropdownMenuScope\n> = DropdownMenuPrimitive.createDropdownMenuScope();\n\nexport type ScopedProps<P> = P & { __scopeThreadListItemMore?: Scope };\n"],"names":[],"mappings":";;;;AAAA;;AAGO,MAAM,uBAET,wZAA6C"}},
    {"offset": {"line": 10847, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item-more/thread-list-item-more-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { FC } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ThreadListItemMorePrimitiveRoot {\n  export type Props = DropdownMenuPrimitive.DropdownMenuProps;\n}\n\nexport const ThreadListItemMorePrimitiveRoot: FC<\n  ThreadListItemMorePrimitiveRoot.Props\n> = ({\n  __scopeThreadListItemMore,\n  ...rest\n}: ScopedProps<ThreadListItemMorePrimitiveRoot.Props>) => {\n  const scope = useDropdownMenuScope(__scopeThreadListItemMore);\n\n  return <DropdownMenuPrimitive.Root {...scope} {...rest} />;\n};\n\nThreadListItemMorePrimitiveRoot.displayName =\n  \"ThreadListItemMorePrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;AAUO,MAAM,kCAET,CAAC,EACH,yBAAyB,EACzB,GAAG,MACgD;IACnD,MAAM,QAAQ,IAAA,0MAAoB,EAAC;IAEnC,qBAAO,ubAAC,qYAA0B;QAAE,GAAG,KAAK;QAAG,GAAG,IAAI;;;;;;AACxD;AAEA,gCAAgC,WAAW,GACzC"}},
    {"offset": {"line": 10874, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item-more/thread-list-item-more-trigger.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ThreadListItemMorePrimitiveTrigger {\n  export type Element = ComponentRef<typeof DropdownMenuPrimitive.Trigger>;\n  export type Props = ComponentPropsWithoutRef<\n    typeof DropdownMenuPrimitive.Trigger\n  >;\n}\n\nexport const ThreadListItemMorePrimitiveTrigger = forwardRef<\n  ThreadListItemMorePrimitiveTrigger.Element,\n  ThreadListItemMorePrimitiveTrigger.Props\n>(\n  (\n    {\n      __scopeThreadListItemMore,\n      ...rest\n    }: ScopedProps<ThreadListItemMorePrimitiveTrigger.Props>,\n    ref,\n  ) => {\n    const scope = useDropdownMenuScope(__scopeThreadListItemMore);\n\n    return <DropdownMenuPrimitive.Trigger {...scope} {...rest} ref={ref} />;\n  },\n);\n\nThreadListItemMorePrimitiveTrigger.displayName =\n  \"ThreadListItemMorePrimitive.Trigger\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,MAAM,mDAAqC,IAAA,4ZAAU,EAI1D,CACE,EACE,yBAAyB,EACzB,GAAG,MACmD,EACxD;IAEA,MAAM,QAAQ,IAAA,0MAAoB,EAAC;IAEnC,qBAAO,ubAAC,wYAA6B;QAAE,GAAG,KAAK;QAAG,GAAG,IAAI;QAAE,KAAK;;;;;;AAClE;AAGF,mCAAmC,WAAW,GAC5C"}},
    {"offset": {"line": 10904, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item-more/thread-list-item-more-content.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ThreadListItemMorePrimitiveContent {\n  export type Element = ComponentRef<typeof DropdownMenuPrimitive.Content>;\n  export type Props = ComponentPropsWithoutRef<\n    typeof DropdownMenuPrimitive.Content\n  > & {\n    portalProps?:\n      | ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Portal>\n      | undefined;\n  };\n}\n\nexport const ThreadListItemMorePrimitiveContent = forwardRef<\n  ThreadListItemMorePrimitiveContent.Element,\n  ThreadListItemMorePrimitiveContent.Props\n>(\n  (\n    {\n      __scopeThreadListItemMore,\n      portalProps,\n      sideOffset = 4,\n      ...props\n    }: ScopedProps<ThreadListItemMorePrimitiveContent.Props>,\n    forwardedRef,\n  ) => {\n    const scope = useDropdownMenuScope(__scopeThreadListItemMore);\n\n    return (\n      <DropdownMenuPrimitive.Portal {...scope} {...portalProps}>\n        <DropdownMenuPrimitive.Content\n          {...scope}\n          {...props}\n          ref={forwardedRef}\n          sideOffset={sideOffset}\n        />\n      </DropdownMenuPrimitive.Portal>\n    );\n  },\n);\n\nThreadListItemMorePrimitiveContent.displayName =\n  \"ThreadListItemMorePrimitive.Content\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAiBO,MAAM,mDAAqC,IAAA,4ZAAU,EAI1D,CACE,EACE,yBAAyB,EACzB,WAAW,EACX,aAAa,CAAC,EACd,GAAG,OACmD,EACxD;IAEA,MAAM,QAAQ,IAAA,0MAAoB,EAAC;IAEnC,qBACE,ubAAC,uYAA4B;QAAE,GAAG,KAAK;QAAG,GAAG,WAAW;kBACtD,cAAA,ubAAC,wYAA6B;YAC3B,GAAG,KAAK;YACR,GAAG,KAAK;YACT,KAAK;YACL,YAAY;;;;;;;;;;;AAIpB;AAGF,mCAAmC,WAAW,GAC5C"}},
    {"offset": {"line": 10943, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item-more/thread-list-item-more-item.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ThreadListItemMorePrimitiveItem {\n  export type Element = ComponentRef<typeof DropdownMenuPrimitive.Item>;\n  export type Props = ComponentPropsWithoutRef<\n    typeof DropdownMenuPrimitive.Item\n  >;\n}\n\nexport const ThreadListItemMorePrimitiveItem = forwardRef<\n  ThreadListItemMorePrimitiveItem.Element,\n  ThreadListItemMorePrimitiveItem.Props\n>(\n  (\n    {\n      __scopeThreadListItemMore,\n      ...rest\n    }: ScopedProps<ThreadListItemMorePrimitiveItem.Props>,\n    ref,\n  ) => {\n    const scope = useDropdownMenuScope(__scopeThreadListItemMore);\n\n    return <DropdownMenuPrimitive.Item {...scope} {...rest} ref={ref} />;\n  },\n);\n\nThreadListItemMorePrimitiveItem.displayName =\n  \"ThreadListItemMorePrimitive.Item\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,MAAM,gDAAkC,IAAA,4ZAAU,EAIvD,CACE,EACE,yBAAyB,EACzB,GAAG,MACgD,EACrD;IAEA,MAAM,QAAQ,IAAA,0MAAoB,EAAC;IAEnC,qBAAO,ubAAC,qYAA0B;QAAE,GAAG,KAAK;QAAG,GAAG,IAAI;QAAE,KAAK;;;;;;AAC/D;AAGF,gCAAgC,WAAW,GACzC"}},
    {"offset": {"line": 10973, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item-more/thread-list-item-more-separator.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\";\nimport { ScopedProps, useDropdownMenuScope } from \"./scope\";\n\nexport namespace ThreadListItemMorePrimitiveSeparator {\n  export type Element = ComponentRef<typeof DropdownMenuPrimitive.Separator>;\n  export type Props = ComponentPropsWithoutRef<\n    typeof DropdownMenuPrimitive.Separator\n  >;\n}\n\nexport const ThreadListItemMorePrimitiveSeparator = forwardRef<\n  ThreadListItemMorePrimitiveSeparator.Element,\n  ThreadListItemMorePrimitiveSeparator.Props\n>(\n  (\n    {\n      __scopeThreadListItemMore,\n      ...rest\n    }: ScopedProps<ThreadListItemMorePrimitiveSeparator.Props>,\n    ref,\n  ) => {\n    const scope = useDropdownMenuScope(__scopeThreadListItemMore);\n\n    return <DropdownMenuPrimitive.Separator {...scope} {...rest} ref={ref} />;\n  },\n);\n\nThreadListItemMorePrimitiveSeparator.displayName =\n  \"ThreadListItemMorePrimitive.Separator\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,MAAM,qDAAuC,IAAA,4ZAAU,EAI5D,CACE,EACE,yBAAyB,EACzB,GAAG,MACqD,EAC1D;IAEA,MAAM,QAAQ,IAAA,0MAAoB,EAAC;IAEnC,qBAAO,ubAAC,0YAA+B;QAAE,GAAG,KAAK;QAAG,GAAG,IAAI;QAAE,KAAK;;;;;;AACpE;AAGF,qCAAqC,WAAW,GAC9C"}},
    {"offset": {"line": 11034, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 11045, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item/thread-list-item-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { type ComponentRef, forwardRef, ComponentPropsWithoutRef } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\ntype PrimitiveDivProps = ComponentPropsWithoutRef<typeof Primitive.div>;\n\nexport namespace ThreadListItemPrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  export type Props = PrimitiveDivProps;\n}\n\nexport const ThreadListItemPrimitiveRoot = forwardRef<\n  ThreadListItemPrimitiveRoot.Element,\n  ThreadListItemPrimitiveRoot.Props\n>((props, ref) => {\n  const isMain = useAuiState(\n    ({ threads, threadListItem }) => threads.mainThreadId === threadListItem.id,\n  );\n\n  return (\n    <Primitive.div\n      {...(isMain ? { \"data-active\": \"true\", \"aria-current\": \"true\" } : null)}\n      {...props}\n      ref={ref}\n    />\n  );\n});\n\nThreadListItemPrimitiveRoot.displayName = \"ThreadListItemPrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAaO,MAAM,4CAA8B,IAAA,4ZAAU,EAGnD,CAAC,OAAO;IACR,MAAM,SAAS,IAAA,+JAAW,EACxB,CAAC,EAAE,OAAO,EAAE,cAAc,EAAE,GAAK,QAAQ,YAAY,KAAK,eAAe,EAAE;IAG7E,qBACE,ubAAC,mYAAS,CAAC,GAAG;QACX,GAAI,SAAS;YAAE,eAAe;YAAQ,gBAAgB;QAAO,IAAI,IAAI;QACrE,GAAG,KAAK;QACT,KAAK;;;;;;AAGX;AAEA,4BAA4B,WAAW,GAAG"}},
    {"offset": {"line": 11078, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item/thread-list-item-archive.ts"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useAui } from \"@creatorem/ai-store\";\nimport { useCallback } from \"react\";\n\nconst useThreadListItemArchive = () => {\n  const aui = useAui();\n  return useCallback(() => {\n    aui.threadListItem().archive();\n  }, [aui]);\n};\n\nexport namespace ThreadListItemPrimitiveArchive {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useThreadListItemArchive>;\n}\n\nexport const ThreadListItemPrimitiveArchive = createActionButton(\n  \"ThreadListItemPrimitive.Archive\",\n  useThreadListItemArchive,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AARA;;;;AAUA,MAAM,2BAA2B;IAC/B,MAAM,MAAM,IAAA,iJAAM;IAClB,OAAO,IAAA,6ZAAW,EAAC;QACjB,IAAI,cAAc,GAAG,OAAO;IAC9B,GAAG;QAAC;KAAI;AACV;AAOO,MAAM,iCAAiC,IAAA,sLAAkB,EAC9D,mCACA"}},
    {"offset": {"line": 11102, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item/thread-list-item-unarchive.ts"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useAui } from \"@creatorem/ai-store\";\nimport { useCallback } from \"react\";\n\nconst useThreadListItemUnarchive = () => {\n  const aui = useAui();\n  return useCallback(() => {\n    aui.threadListItem().unarchive();\n  }, [aui]);\n};\n\nexport namespace ThreadListItemPrimitiveUnarchive {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useThreadListItemUnarchive>;\n}\n\nexport const ThreadListItemPrimitiveUnarchive = createActionButton(\n  \"ThreadListItemPrimitive.Unarchive\",\n  useThreadListItemUnarchive,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AARA;;;;AAUA,MAAM,6BAA6B;IACjC,MAAM,MAAM,IAAA,iJAAM;IAClB,OAAO,IAAA,6ZAAW,EAAC;QACjB,IAAI,cAAc,GAAG,SAAS;IAChC,GAAG;QAAC;KAAI;AACV;AAOO,MAAM,mCAAmC,IAAA,sLAAkB,EAChE,qCACA"}},
    {"offset": {"line": 11126, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item/thread-list-item-delete.ts"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useAui } from \"@creatorem/ai-store\";\nimport { useCallback } from \"react\";\n\nconst useThreadListItemDelete = () => {\n  const aui = useAui();\n  return useCallback(() => {\n    aui.threadListItem().delete();\n  }, [aui]);\n};\n\nexport namespace ThreadListItemPrimitiveDelete {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useThreadListItemDelete>;\n}\n\nexport const ThreadListItemPrimitiveDelete = createActionButton(\n  \"ThreadListItemPrimitive.Delete\",\n  useThreadListItemDelete,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AARA;;;;AAUA,MAAM,0BAA0B;IAC9B,MAAM,MAAM,IAAA,iJAAM;IAClB,OAAO,IAAA,6ZAAW,EAAC;QACjB,IAAI,cAAc,GAAG,MAAM;IAC7B,GAAG;QAAC;KAAI;AACV;AAOO,MAAM,gCAAgC,IAAA,sLAAkB,EAC7D,kCACA"}},
    {"offset": {"line": 11150, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item/thread-list-item-trigger.ts"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n  createActionButton,\n} from \"../../utils/create-action-button\";\nimport { useAui } from \"@creatorem/ai-store\";\nimport { useCallback } from \"react\";\n\nconst useThreadListItemTrigger = () => {\n  const aui = useAui();\n  return useCallback(() => {\n    aui.threadListItem().switchTo();\n  }, [aui]);\n};\n\nexport namespace ThreadListItemPrimitiveTrigger {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<typeof useThreadListItemTrigger>;\n}\n\nexport const ThreadListItemPrimitiveTrigger = createActionButton(\n  \"ThreadListItemPrimitive.Trigger\",\n  useThreadListItemTrigger,\n);\n"],"names":[],"mappings":";;;;AAEA;AAKA;AACA;AARA;;;;AAUA,MAAM,2BAA2B;IAC/B,MAAM,MAAM,IAAA,iJAAM;IAClB,OAAO,IAAA,6ZAAW,EAAC;QACjB,IAAI,cAAc,GAAG,QAAQ;IAC/B,GAAG;QAAC;KAAI;AACV;AAOO,MAAM,iCAAiC,IAAA,sLAAkB,EAC9D,mCACA"}},
    {"offset": {"line": 11174, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list-item/thread-list-item-title.tsx"],"sourcesContent":["\"use client\";\n\nimport type { FC, ReactNode } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\n\nexport namespace ThreadListItemPrimitiveTitle {\n  export type Props = {\n    fallback?: ReactNode;\n  };\n}\n\nexport const ThreadListItemPrimitiveTitle: FC<\n  ThreadListItemPrimitiveTitle.Props\n> = ({ fallback }) => {\n  const title = useAuiState(({ threadListItem }) => threadListItem.title);\n  return <>{title || fallback}</>;\n};\n\nThreadListItemPrimitiveTitle.displayName = \"ThreadListItemPrimitive.Title\";\n"],"names":[],"mappings":";;;;;AAGA;AAHA;;;AAWO,MAAM,+BAET,CAAC,EAAE,QAAQ,EAAE;IACf,MAAM,QAAQ,IAAA,+JAAW,EAAC,CAAC,EAAE,cAAc,EAAE,GAAK,eAAe,KAAK;IACtE,qBAAO;kBAAG,SAAS;;AACrB;AAEA,6BAA6B,WAAW,GAAG"}},
    {"offset": {"line": 11228, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 11237, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list/thread-list-new.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  ActionButtonElement,\n  ActionButtonProps,\n} from \"../../utils/create-action-button\";\nimport { forwardRef } from \"react\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { useAuiState, useAui } from \"@creatorem/ai-store\";\n\nexport namespace ThreadListPrimitiveNew {\n  export type Element = ActionButtonElement;\n  export type Props = ActionButtonProps<() => void>;\n}\n\nexport const ThreadListPrimitiveNew = forwardRef<\n  ThreadListPrimitiveNew.Element,\n  ThreadListPrimitiveNew.Props\n>(({ onClick, disabled, ...props }, forwardedRef) => {\n  const isMain = useAuiState(\n    ({ threads }) => threads.newThreadId === threads.mainThreadId,\n  );\n\n  const aui = useAui();\n\n  return (\n    <Primitive.button\n      type=\"button\"\n      {...(isMain ? { \"data-active\": \"true\", \"aria-current\": \"true\" } : null)}\n      {...props}\n      ref={forwardedRef}\n      disabled={disabled}\n      onClick={composeEventHandlers(onClick, () => {\n        aui.threads().switchToNewThread();\n      })}\n    />\n  );\n});\n\nThreadListPrimitiveNew.displayName = \"ThreadListPrimitive.New\";\n"],"names":[],"mappings":";;;;;AAMA;AACA;AACA;AACA;AAAA;AATA;;;;;;AAgBO,MAAM,uCAAyB,IAAA,4ZAAU,EAG9C,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IAClC,MAAM,SAAS,IAAA,+JAAW,EACxB,CAAC,EAAE,OAAO,EAAE,GAAK,QAAQ,WAAW,KAAK,QAAQ,YAAY;IAG/D,MAAM,MAAM,IAAA,iJAAM;IAElB,qBACE,ubAAC,mYAAS,CAAC,MAAM;QACf,MAAK;QACJ,GAAI,SAAS;YAAE,eAAe;YAAQ,gBAAgB;QAAO,IAAI,IAAI;QACrE,GAAG,KAAK;QACT,KAAK;QACL,UAAU;QACV,SAAS,IAAA,2PAAoB,EAAC,SAAS;YACrC,IAAI,OAAO,GAAG,iBAAiB;QACjC;;;;;;AAGN;AAEA,uBAAuB,WAAW,GAAG"}},
    {"offset": {"line": 11279, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/context/providers/thread-list-item-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport { type FC, type PropsWithChildren } from \"react\";\nimport { useAui, AuiProvider, Derived } from \"@creatorem/ai-store\";\nimport type { ThreadListItemRuntime } from \"../../legacy-runtime/runtime/thread-list-item-runtime\";\nimport { ThreadListItemClient } from \"../../legacy-runtime/client/thread-list-item-runtime-client\";\n\nexport const ThreadListItemByIndexProvider: FC<\n  PropsWithChildren<{\n    index: number;\n    archived: boolean;\n  }>\n> = ({ index, archived, children }) => {\n  const aui = useAui({\n    threadListItem: Derived({\n      source: \"threads\",\n      query: { type: \"index\", index, archived },\n      get: (aui) => aui.threads().item({ index, archived }),\n    }),\n  });\n\n  return <AuiProvider value={aui}>{children}</AuiProvider>;\n};\n\nexport const ThreadListItemRuntimeProvider: FC<\n  PropsWithChildren<{\n    runtime: ThreadListItemRuntime;\n  }>\n> = ({ runtime, children }) => {\n  const aui = useAui({\n    threadListItem: ThreadListItemClient({ runtime }),\n  });\n\n  return <AuiProvider value={aui}>{children}</AuiProvider>;\n};\n"],"names":[],"mappings":";;;;;;;AAGA;AAAA;AAAA;AAEA;AALA;;;;AAOO,MAAM,gCAKT,CAAC,EAAE,KAAK,EAAE,QAAQ,EAAE,QAAQ,EAAE;IAChC,MAAM,MAAM,IAAA,iJAAM,EAAC;QACjB,gBAAgB,IAAA,8IAAO,EAAC;YACtB,QAAQ;YACR,OAAO;gBAAE,MAAM;gBAAS;gBAAO;YAAS;YACxC,KAAK,CAAC,MAAQ,IAAI,OAAO,GAAG,IAAI,CAAC;oBAAE;oBAAO;gBAAS;QACrD;IACF;IAEA,qBAAO,ubAAC,kLAAW;QAAC,OAAO;kBAAM;;;;;;AACnC;AAEO,MAAM,gCAIT,CAAC,EAAE,OAAO,EAAE,QAAQ,EAAE;IACxB,MAAM,MAAM,IAAA,iJAAM,EAAC;QACjB,gBAAgB,IAAA,8NAAoB,EAAC;YAAE;QAAQ;IACjD;IAEA,qBAAO,ubAAC,kLAAW;QAAC,OAAO;kBAAM;;;;;;AACnC"}},
    {"offset": {"line": 11337, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list/thread-list-items.tsx"],"sourcesContent":["\"use client\";\n\nimport { ComponentType, FC, memo, useMemo } from \"react\";\nimport { useAuiState } from \"@creatorem/ai-store\";\nimport { ThreadListItemByIndexProvider } from \"../../context/providers\";\n\nexport namespace ThreadListPrimitiveItems {\n  export type Props = {\n    archived?: boolean | undefined;\n    components: {\n      ThreadListItem: ComponentType;\n    };\n  };\n}\n\nexport namespace ThreadListPrimitiveItemByIndex {\n  export type Props = {\n    index: number;\n    archived?: boolean | undefined;\n    components: ThreadListPrimitiveItems.Props[\"components\"];\n  };\n}\n\n/**\n * Renders a single thread list item at the specified index.\n *\n * This component provides direct access to render a specific thread\n * from the thread list using the provided component configuration.\n *\n * @example\n * ```tsx\n * <ThreadListPrimitive.ItemByIndex\n *   index={0}\n *   components={{\n *     ThreadListItem: MyThreadListItem\n *   }}\n * />\n * ```\n */\nexport const ThreadListPrimitiveItemByIndex: FC<ThreadListPrimitiveItemByIndex.Props> =\n  memo(\n    ({ index, archived = false, components }) => {\n      const ThreadListItemComponent = components.ThreadListItem;\n\n      return (\n        <ThreadListItemByIndexProvider index={index} archived={archived}>\n          <ThreadListItemComponent />\n        </ThreadListItemByIndexProvider>\n      );\n    },\n    (prev, next) =>\n      prev.index === next.index &&\n      prev.archived === next.archived &&\n      prev.components.ThreadListItem === next.components.ThreadListItem,\n  );\n\nThreadListPrimitiveItemByIndex.displayName = \"ThreadListPrimitive.ItemByIndex\";\n\nexport const ThreadListPrimitiveItems: FC<ThreadListPrimitiveItems.Props> = ({\n  archived = false,\n  components,\n}) => {\n  const contentLength = useAuiState(({ threads }) =>\n    archived ? threads.archivedThreadIds.length : threads.threadIds.length,\n  );\n\n  const listElements = useMemo(() => {\n    return Array.from({ length: contentLength }, (_, index) => (\n      <ThreadListPrimitiveItemByIndex\n        key={index}\n        index={index}\n        archived={archived}\n        components={components}\n      />\n    ));\n  }, [contentLength, archived, components]);\n\n  return listElements;\n};\n\nThreadListPrimitiveItems.displayName = \"ThreadListPrimitive.Items\";\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAuCO,MAAM,+CACX,IAAA,sZAAI,EACF,CAAC,EAAE,KAAK,EAAE,WAAW,KAAK,EAAE,UAAU,EAAE;IACtC,MAAM,0BAA0B,WAAW,cAAc;IAEzD,qBACE,ubAAC,wNAA6B;QAAC,OAAO;QAAO,UAAU;kBACrD,cAAA,ubAAC;;;;;;;;;;AAGP,GACA,CAAC,MAAM,OACL,KAAK,KAAK,KAAK,KAAK,KAAK,IACzB,KAAK,QAAQ,KAAK,KAAK,QAAQ,IAC/B,KAAK,UAAU,CAAC,cAAc,KAAK,KAAK,UAAU,CAAC,cAAc;AAGvE,+BAA+B,WAAW,GAAG;AAEtC,MAAM,2BAA+D,CAAC,EAC3E,WAAW,KAAK,EAChB,UAAU,EACX;IACC,MAAM,gBAAgB,IAAA,+JAAW,EAAC,CAAC,EAAE,OAAO,EAAE,GAC5C,WAAW,QAAQ,iBAAiB,CAAC,MAAM,GAAG,QAAQ,SAAS,CAAC,MAAM;IAGxE,MAAM,eAAe,IAAA,yZAAO,EAAC;QAC3B,OAAO,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAc,GAAG,CAAC,GAAG,sBAC/C,ubAAC;gBAEC,OAAO;gBACP,UAAU;gBACV,YAAY;eAHP;;;;;IAMX,GAAG;QAAC;QAAe;QAAU;KAAW;IAExC,OAAO;AACT;AAEA,yBAAyB,WAAW,GAAG"}},
    {"offset": {"line": 11395, "column": 0}, "map": {"version":3,"sources":["file:///Users/arnaudpfu/nextjs-expo-boilerplate/main_august/ai/packages/react/src/primitives/thread-list/thread-list-root.tsx"],"sourcesContent":["\"use client\";\n\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { ComponentPropsWithoutRef, ComponentRef, forwardRef } from \"react\";\n\ntype PrimitiveDivProps = ComponentPropsWithoutRef<typeof Primitive.div>;\n\nexport namespace ThreadListPrimitiveRoot {\n  export type Element = ComponentRef<typeof Primitive.div>;\n  export type Props = PrimitiveDivProps;\n}\n\nexport const ThreadListPrimitiveRoot = forwardRef<\n  ThreadListPrimitiveRoot.Element,\n  ThreadListPrimitiveRoot.Props\n>((props, ref) => {\n  return <Primitive.div {...props} ref={ref} />;\n});\n\nThreadListPrimitiveRoot.displayName = \"ThreadListPrimitive.Root\";\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAYO,MAAM,wCAA0B,IAAA,4ZAAU,EAG/C,CAAC,OAAO;IACR,qBAAO,ubAAC,mYAAS,CAAC,GAAG;QAAE,GAAG,KAAK;QAAE,KAAK;;;;;;AACxC;AAEA,wBAAwB,WAAW,GAAG"}}]
}